[0m10:45:44.310529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2c0b5ad040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2c0b5ac9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2c0b5ad820>]}


============================== 10:45:44.345106 | 48ba8877-16a0-4463-9b2f-8d3d0c4414a7 ==============================
[0m10:45:44.345106 [info ] [MainThread]: Running with dbt=1.7.9
[0m10:45:44.348122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m10:45:44.375464 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ var('core_dataset') }}: Required var 'core_dataset' not found in config:
  Vars supplied to <Configuration> = {}
[0m10:45:44.377450 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.16960587, "process_user_time": 5.716847, "process_kernel_time": 0.573163, "process_mem_max_rss": "120156", "process_out_blocks": "13056", "command_success": false, "process_in_blocks": "0"}
[0m10:45:44.379458 [debug] [MainThread]: Command `dbt deps` failed at 10:45:44.378864 after 0.17 seconds
[0m10:45:44.380557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2c100772c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2c0b604380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2c0b605e50>]}
[0m10:45:44.381571 [debug] [MainThread]: Flushing usage events
[0m10:46:15.476675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdaaa94fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdaade26c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdaaa94e60>]}


============================== 10:46:15.508395 | 4e5c7451-0d76-4f90-a2cb-c190dc0a6d9b ==============================
[0m10:46:15.508395 [info ] [MainThread]: Running with dbt=1.7.9
[0m10:46:15.511378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m10:46:15.516922 [info ] [MainThread]: dbt version: 1.7.9
[0m10:46:15.518845 [info ] [MainThread]: python version: 3.12.10
[0m10:46:15.520642 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m10:46:15.521841 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m10:46:15.570088 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_PROJECT_ID'
[0m10:46:15.572073 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.21486267, "process_user_time": 4.851077, "process_kernel_time": 0.583755, "process_mem_max_rss": "120276", "process_out_blocks": "13056", "command_success": false, "process_in_blocks": "0"}
[0m10:46:15.573623 [debug] [MainThread]: Command `dbt debug` failed at 10:46:15.573305 after 0.22 seconds
[0m10:46:15.575061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdaade37d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdaade26c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdaacf3b90>]}
[0m10:46:15.576425 [debug] [MainThread]: Flushing usage events
[0m10:48:18.323257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afb94cfd0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afb94d6c560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afb94cfe990>]}


============================== 10:48:18.345704 | 41cc31ef-fd98-4c3f-a6de-95c2a514731c ==============================
[0m10:48:18.345704 [info ] [MainThread]: Running with dbt=1.7.9
[0m10:48:18.346770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:48:18.366511 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ var('core_dataset') }}: Required var 'core_dataset' not found in config:
  Vars supplied to <Configuration> = {}
[0m10:48:18.367892 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.11687918, "process_user_time": 3.194711, "process_kernel_time": 0.362363, "process_mem_max_rss": "120344", "process_out_blocks": "13056", "command_success": false, "process_in_blocks": "0"}
[0m10:48:18.368792 [debug] [MainThread]: Command `dbt deps` failed at 10:48:18.368625 after 0.12 seconds
[0m10:48:18.369418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afb94d6ccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afb94d5bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afb953cc6b0>]}
[0m10:48:18.369992 [debug] [MainThread]: Flushing usage events
[0m02:27:02.188892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ca15071bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ca1518ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ca15071790>]}


============================== 02:27:02.209688 | cff65415-c729-4636-bf9b-3016eed21dcf ==============================
[0m02:27:02.209688 [info ] [MainThread]: Running with dbt=1.7.9
[0m02:27:02.211230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:27:02.238181 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ var('core_dataset') }}: Required var 'core_dataset' not found in config:
  Vars supplied to <Configuration> = {}
[0m02:27:02.239659 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.23918837, "process_user_time": 2.762952, "process_kernel_time": 0.236595, "process_mem_max_rss": "163232", "process_in_blocks": "16", "process_out_blocks": "4224", "command_success": false}
[0m02:27:02.240799 [debug] [MainThread]: Command `dbt deps` failed at 02:27:02.240569 after 0.24 seconds
[0m02:27:02.241872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ca15125670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ca1521fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ca1527a3f0>]}
[0m02:27:02.242898 [debug] [MainThread]: Flushing usage events
[0m02:30:06.528194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbdfc48350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbe0242c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbdff70a70>]}


============================== 02:30:06.534358 | 0c3515a2-6e94-42ee-9241-96b2920ab0b0 ==============================
[0m02:30:06.534358 [info ] [MainThread]: Running with dbt=1.7.9
[0m02:30:06.535371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:30:06.546371 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ var('core_dataset') }}: Required var 'core_dataset' not found in config:
  Vars supplied to <Configuration> = {}
[0m02:30:06.547665 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.0867534, "process_user_time": 1.962763, "process_kernel_time": 0.167894, "process_mem_max_rss": "217936", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:30:06.548330 [debug] [MainThread]: Command `dbt deps` failed at 02:30:06.548194 after 0.09 seconds
[0m02:30:06.548806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbe0bcfb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbe085c3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbdfbfbf50>]}
[0m02:30:06.549419 [debug] [MainThread]: Flushing usage events
[0m09:34:57.741305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002633C919940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002633A620190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002633EA6D6D0>]}


============================== 09:34:57.745304 | 45c3db77-e2de-474a-b515-ae0cbe456d46 ==============================
[0m09:34:57.745304 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:34:57.745971 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m09:34:57.785496 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ var('core_dataset') }}: Required var 'core_dataset' not found in config:
  Vars supplied to <Configuration> = {}
[0m09:34:57.786507 [debug] [MainThread]: Command `dbt deps` failed at 09:34:57.786396 after 0.24 seconds
[0m09:34:57.786792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002633EB4C770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002633EAF9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002633D942BE0>]}
[0m09:34:57.787093 [debug] [MainThread]: Flushing usage events
[0m09:34:59.335443 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:36:00.153361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A392C09940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A390910190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A393D8D6D0>]}


============================== 09:36:00.157714 | f16641ef-048c-4326-a75d-7e73a82e8573 ==============================
[0m09:36:00.157714 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:36:00.158437 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m09:36:00.165436 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ var('core_dataset') }}: Required var 'core_dataset' not found in config:
  Vars supplied to <Configuration> = {}
[0m09:36:00.166372 [debug] [MainThread]: Command `dbt deps` failed at 09:36:00.166258 after 0.21 seconds
[0m09:36:00.166637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A393E6C3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A393E19010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A393C32BE0>]}
[0m09:36:00.167008 [debug] [MainThread]: Flushing usage events
[0m09:36:01.767315 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:36:33.204455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012411339940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001240F040190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012411E3CE10>]}


============================== 09:36:33.208620 | 6bbf45e9-0fae-4e0a-adc0-fc2a1a7ce099 ==============================
[0m09:36:33.208620 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:36:33.209071 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m09:36:33.217245 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ var('core_dataset') }}: Required var 'core_dataset' not found in config:
  Vars supplied to <Configuration> = {}
[0m09:36:33.218099 [debug] [MainThread]: Command `dbt deps` failed at 09:36:33.217992 after 0.17 seconds
[0m09:36:33.218387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001241356C3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012413519010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012412362BE0>]}
[0m09:36:33.218658 [debug] [MainThread]: Flushing usage events
[0m09:36:34.523610 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:42:21.368271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C6B69940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C4870190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C8CBD6D0>]}


============================== 09:42:21.372310 | 1c438488-a6b6-4c9a-8015-4d37c80763f9 ==============================
[0m09:42:21.372310 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:42:21.372972 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m09:42:21.379807 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ var('core_dataset') }}: Required var 'core_dataset' not found in config:
  Vars supplied to <Configuration> = {}
[0m09:42:21.380627 [debug] [MainThread]: Command `dbt deps` failed at 09:42:21.380535 after 0.27 seconds
[0m09:42:21.380883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C8D9C3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C8D49010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C7B92BE0>]}
[0m09:42:21.381151 [debug] [MainThread]: Flushing usage events
[0m09:42:23.276427 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:44:30.359372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07C409940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07A100190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07E55D6D0>]}


============================== 09:44:30.364097 | 9bbcdfec-5ccb-4533-827e-4c55ae61af36 ==============================
[0m09:44:30.364097 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:44:30.364866 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m09:44:30.373112 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ var('core_dataset') }}: Required var 'core_dataset' not found in config:
  Vars supplied to <Configuration> = {}
[0m09:44:30.375388 [debug] [MainThread]: Command `dbt deps` failed at 09:44:30.375095 after 0.29 seconds
[0m09:44:30.376319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07E63C3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07E5E9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07D432BE0>]}
[0m09:44:30.377239 [debug] [MainThread]: Flushing usage events
[0m09:44:32.214112 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:49:15.395033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DB3D29940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DB1A50190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DB5E7D6D0>]}


============================== 09:49:15.399168 | 1a22d16d-30ca-4282-924e-f68d80955938 ==============================
[0m09:49:15.399168 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:49:15.399962 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'static_parser': 'True', 'write_json': 'True'}
[0m09:49:15.404415 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_PROJECT_ID'
[0m09:49:15.405287 [debug] [MainThread]: Command `dbt run` failed at 09:49:15.405198 after 0.27 seconds
[0m09:49:15.405533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DB5F148A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DB5EF8EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DB4D51BF0>]}
[0m09:49:15.405794 [debug] [MainThread]: Flushing usage events
[0m09:49:16.924789 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:49:38.856854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001765AE49940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017658B50190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001765CF9D6D0>]}


============================== 09:49:38.861042 | aa3f0c87-8c63-40d0-955a-4996414079f4 ==============================
[0m09:49:38.861042 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:49:38.861711 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail'}
[0m09:49:38.868451 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ var('core_dataset') }}: Required var 'core_dataset' not found in config:
  Vars supplied to <Configuration> = {}
[0m09:49:38.869262 [debug] [MainThread]: Command `dbt deps` failed at 09:49:38.869169 after 0.16 seconds
[0m09:49:38.869519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001765D0783E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001765D025010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001765BE72BE0>]}
[0m09:49:38.869796 [debug] [MainThread]: Flushing usage events
[0m09:49:40.121809 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:50:35.343686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015609309940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001560700C190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001560B4596D0>]}


============================== 09:50:35.348490 | 48311fc8-db8a-446b-adbf-a453ed4f9dc1 ==============================
[0m09:50:35.348490 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:50:35.349086 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m09:50:35.357036 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ var('core_dataset') }}: Required var 'core_dataset' not found in config:
  Vars supplied to <Configuration> = {}
[0m09:50:35.358429 [debug] [MainThread]: Command `dbt deps` failed at 09:50:35.358239 after 0.18 seconds
[0m09:50:35.358985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001560B53C3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001560B4E9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001560A332BE0>]}
[0m09:50:35.359356 [debug] [MainThread]: Flushing usage events
[0m09:50:36.900491 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:50:44.887742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EB4ED9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EB2BD0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EB70296D0>]}


============================== 09:50:44.891917 | 9fccc0e4-5b1f-4c91-836e-84eb533ad3d1 ==============================
[0m09:50:44.891917 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:50:44.892605 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m09:50:44.900329 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ var('core_dataset') }}: Required var 'core_dataset' not found in config:
  Vars supplied to <Configuration> = {}
[0m09:50:44.901773 [debug] [MainThread]: Command `dbt deps` failed at 09:50:44.901644 after 0.16 seconds
[0m09:50:44.902090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EB710C3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EB70B9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EB5F02BE0>]}
[0m09:50:44.902460 [debug] [MainThread]: Flushing usage events
[0m09:50:46.182716 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:57:48.580360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A6DA9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A4AAC190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A8EFD6D0>]}


============================== 09:57:48.584525 | e1a15f19-2d65-4cf1-b1f3-553f47f323cf ==============================
[0m09:57:48.584525 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:57:48.585202 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'static_parser': 'True', 'write_json': 'True'}
[0m09:57:48.779100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1a15f19-2d65-4cf1-b1f3-553f47f323cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A72375C0>]}
[0m09:57:49.295951 [debug] [MainThread]: Set downloads directory='C:\Users\CAU~1.TRA\AppData\Local\Temp\dbt-downloads-yoisn3gd'
[0m09:57:49.296367 [error] [MainThread]: Encountered an error:
">=1.1.1,<2.0.0" is not a valid semantic version.
[0m09:57:49.349802 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\main.py", line 461, in deps
    results = task.run()
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\task\deps.py", line 215, in run
    self.lock()
    ~~~~~~~~~^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\task\deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\resolver.py", line 121, in resolve_packages
    pending = PackageListing.from_contracts(packages)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\resolver.py", line 91, in from_contracts
    self.update_from(src)
    ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\resolver.py", line 83, in update_from
    pkg = RegistryUnpinnedPackage.from_contract(contract)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\registry.py", line 83, in from_contract
    versions = [semver.VersionSpecifier.from_version_string(v) for v in raw_version]
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt_common\semver.py", line 99, in from_version_string
    raise dbt_common.exceptions.base.SemverError(
        f'"{version_string}" is not a valid semantic version.'
    )
dbt_common.exceptions.base.SemverError: ">=1.1.1,<2.0.0" is not a valid semantic version.

[0m09:57:49.351382 [debug] [MainThread]: Command `dbt deps` failed at 09:57:49.351239 after 1.06 seconds
[0m09:57:49.351764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A9EE0F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A9EE1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A9F25F50>]}
[0m09:57:49.352111 [debug] [MainThread]: Flushing usage events
[0m09:57:51.313769 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:59:36.559390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDE7439940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDE5130190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDE958D6D0>]}


============================== 09:59:36.563734 | 0cc9fe67-46bf-4ed6-bba8-6ef5da6a4cf9 ==============================
[0m09:59:36.563734 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:59:36.564524 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m09:59:36.713665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cc9fe67-46bf-4ed6-bba8-6ef5da6a4cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDE78C75C0>]}
[0m09:59:36.752432 [debug] [MainThread]: Command `dbt clean` succeeded at 09:59:36.752338 after 0.45 seconds
[0m09:59:36.752702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDE8462580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDE8461D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEA4C8B50>]}
[0m09:59:36.752978 [debug] [MainThread]: Flushing usage events
[0m09:59:38.362666 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:59:44.758662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA40A9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA1DA0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA61FD6D0>]}


============================== 09:59:44.764733 | f08e85bc-8e78-4198-bf9e-1adddd2d5daa ==============================
[0m09:59:44.764733 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:59:44.765648 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m09:59:44.772586 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_PROJECT_ID'
[0m09:59:44.774225 [debug] [MainThread]: Command `dbt run` failed at 09:59:44.774054 after 0.18 seconds
[0m09:59:44.774609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA62948A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA6278EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA50D1BF0>]}
[0m09:59:44.774976 [debug] [MainThread]: Flushing usage events
[0m09:59:46.193196 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:00:00.528902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C95379940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C9307C190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C974CD6D0>]}


============================== 10:00:00.533312 | 96752bb0-9853-4276-8210-849b18606088 ==============================
[0m10:00:00.533312 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:00:00.534294 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m10:00:00.692251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96752bb0-9853-4276-8210-849b18606088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C958075C0>]}
[0m10:00:00.744830 [debug] [MainThread]: Set downloads directory='C:\Users\CAU~1.TRA\AppData\Local\Temp\dbt-downloads-c7nw2nlj'
[0m10:00:00.745278 [error] [MainThread]: Encountered an error:
">=1.1.1,<2.0.0" is not a valid semantic version.
[0m10:00:00.749589 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\main.py", line 461, in deps
    results = task.run()
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\task\deps.py", line 215, in run
    self.lock()
    ~~~~~~~~~^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\task\deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\resolver.py", line 121, in resolve_packages
    pending = PackageListing.from_contracts(packages)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\resolver.py", line 91, in from_contracts
    self.update_from(src)
    ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\resolver.py", line 83, in update_from
    pkg = RegistryUnpinnedPackage.from_contract(contract)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\registry.py", line 83, in from_contract
    versions = [semver.VersionSpecifier.from_version_string(v) for v in raw_version]
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt_common\semver.py", line 99, in from_version_string
    raise dbt_common.exceptions.base.SemverError(
        f'"{version_string}" is not a valid semantic version.'
    )
dbt_common.exceptions.base.SemverError: ">=1.1.1,<2.0.0" is not a valid semantic version.

[0m10:00:00.751861 [debug] [MainThread]: Command `dbt deps` failed at 10:00:00.751537 after 0.39 seconds
[0m10:00:00.752564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C98424F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C98425040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C98405C50>]}
[0m10:00:00.753121 [debug] [MainThread]: Flushing usage events
[0m10:00:02.039094 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:00:55.558299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4DB09940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4B80C190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4FC596D0>]}


============================== 10:00:55.562751 | 78cd6e3e-4bb5-4fc0-b8a4-402ec86994ad ==============================
[0m10:00:55.562751 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:00:55.563538 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m10:00:55.737354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78cd6e3e-4bb5-4fc0-b8a4-402ec86994ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4DF975C0>]}
[0m10:00:55.776554 [debug] [MainThread]: Set downloads directory='C:\Users\CAU~1.TRA\AppData\Local\Temp\dbt-downloads-atx2k4lz'
[0m10:00:55.777068 [error] [MainThread]: Encountered an error:
">=1.1.1,<2.0.0" is not a valid semantic version.
[0m10:00:55.780894 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\main.py", line 461, in deps
    results = task.run()
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\task\deps.py", line 215, in run
    self.lock()
    ~~~~~~~~~^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\task\deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\resolver.py", line 121, in resolve_packages
    pending = PackageListing.from_contracts(packages)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\resolver.py", line 91, in from_contracts
    self.update_from(src)
    ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\resolver.py", line 83, in update_from
    pkg = RegistryUnpinnedPackage.from_contract(contract)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\registry.py", line 83, in from_contract
    versions = [semver.VersionSpecifier.from_version_string(v) for v in raw_version]
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt_common\semver.py", line 99, in from_version_string
    raise dbt_common.exceptions.base.SemverError(
        f'"{version_string}" is not a valid semantic version.'
    )
dbt_common.exceptions.base.SemverError: ">=1.1.1,<2.0.0" is not a valid semantic version.

[0m10:00:55.782324 [debug] [MainThread]: Command `dbt deps` failed at 10:00:55.782186 after 0.42 seconds
[0m10:00:55.782664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB50BB4F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB50BB5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB50B95C50>]}
[0m10:00:55.783050 [debug] [MainThread]: Flushing usage events
[0m10:00:57.328175 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:01:54.737629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B58A9C9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5886BC190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B58CB196D0>]}


============================== 10:01:54.742191 | 4bb05b5a-f1ec-48ab-ad34-8784bbecfa09 ==============================
[0m10:01:54.742191 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:01:54.742887 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt clean', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m10:01:54.884920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bb05b5a-f1ec-48ab-ad34-8784bbecfa09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B58AE575C0>]}
[0m10:01:54.907549 [debug] [MainThread]: Command `dbt clean` succeeded at 10:01:54.907447 after 0.33 seconds
[0m10:01:54.907833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B58B9F2580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B58B9F1E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B58DA58B50>]}
[0m10:01:54.908106 [debug] [MainThread]: Flushing usage events
[0m10:01:56.270647 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:02:02.250204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91E8F9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91C5FC190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A920A456D0>]}


============================== 10:02:02.254139 | 754babe4-365d-4afa-a0ee-d375fb648435 ==============================
[0m10:02:02.254139 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:02:02.254834 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'static_parser': 'True', 'write_json': 'True'}
[0m10:02:02.389980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '754babe4-365d-4afa-a0ee-d375fb648435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91ED875C0>]}
[0m10:02:02.417586 [debug] [MainThread]: Set downloads directory='C:\Users\CAU~1.TRA\AppData\Local\Temp\dbt-downloads-2qo14q6o'
[0m10:02:02.417966 [error] [MainThread]: Encountered an error:
">=1.1.1,<2.0.0" is not a valid semantic version.
[0m10:02:02.421126 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\main.py", line 461, in deps
    results = task.run()
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\task\deps.py", line 215, in run
    self.lock()
    ~~~~~~~~~^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\task\deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\resolver.py", line 121, in resolve_packages
    pending = PackageListing.from_contracts(packages)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\resolver.py", line 91, in from_contracts
    self.update_from(src)
    ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\resolver.py", line 83, in update_from
    pkg = RegistryUnpinnedPackage.from_contract(contract)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\registry.py", line 83, in from_contract
    versions = [semver.VersionSpecifier.from_version_string(v) for v in raw_version]
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt_common\semver.py", line 99, in from_version_string
    raise dbt_common.exceptions.base.SemverError(
        f'"{version_string}" is not a valid semantic version.'
    )
dbt_common.exceptions.base.SemverError: ">=1.1.1,<2.0.0" is not a valid semantic version.

[0m10:02:02.422654 [debug] [MainThread]: Command `dbt deps` failed at 10:02:02.422536 after 0.32 seconds
[0m10:02:02.422956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9219A4F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9219A5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A921985C50>]}
[0m10:02:02.423256 [debug] [MainThread]: Flushing usage events
[0m10:02:04.019741 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:02:51.393457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c47dc941160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c47dcc08860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c47dcac5b80>]}


============================== 03:02:51.400166 | aba4a7a5-a5eb-4477-a638-b6f725217799 ==============================
[0m03:02:51.400166 [info ] [MainThread]: Running with dbt=1.7.9
[0m03:02:51.401221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/retail', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:02:51.566268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aba4a7a5-a5eb-4477-a638-b6f725217799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c47dc7d03b0>]}
[0m03:02:51.594103 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.30254495, "process_user_time": 1.873558, "process_kernel_time": 0.163786, "process_mem_max_rss": "110304", "process_in_blocks": "1440", "process_out_blocks": "0"}
[0m03:02:51.595069 [debug] [MainThread]: Command `dbt clean` succeeded at 03:02:51.594894 after 0.30 seconds
[0m03:02:51.595916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c47dc9470b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c47dcb9f980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c47dca70cb0>]}
[0m03:02:51.596999 [debug] [MainThread]: Flushing usage events
[0m10:04:49.546434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBD0D9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBADE0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBF22D6D0>]}


============================== 10:04:49.550909 | a1d8c5dd-ff65-4195-9887-432e962bb9f0 ==============================
[0m10:04:49.550909 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:04:49.551591 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail'}
[0m10:04:49.692188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1d8c5dd-ff65-4195-9887-432e962bb9f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBD5675C0>]}
[0m10:04:49.719313 [debug] [MainThread]: Set downloads directory='C:\Users\CAU~1.TRA\AppData\Local\Temp\dbt-downloads-v2buf0ax'
[0m10:04:49.719663 [error] [MainThread]: Encountered an error:
">=1.1.1,<2.0.0" is not a valid semantic version.
[0m10:04:49.722600 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\main.py", line 461, in deps
    results = task.run()
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\task\deps.py", line 215, in run
    self.lock()
    ~~~~~~~~~^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\task\deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\resolver.py", line 121, in resolve_packages
    pending = PackageListing.from_contracts(packages)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\resolver.py", line 91, in from_contracts
    self.update_from(src)
    ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\resolver.py", line 83, in update_from
    pkg = RegistryUnpinnedPackage.from_contract(contract)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\registry.py", line 83, in from_contract
    versions = [semver.VersionSpecifier.from_version_string(v) for v in raw_version]
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt_common\semver.py", line 99, in from_version_string
    raise dbt_common.exceptions.base.SemverError(
        f'"{version_string}" is not a valid semantic version.'
    )
dbt_common.exceptions.base.SemverError: ">=1.1.1,<2.0.0" is not a valid semantic version.

[0m10:04:49.723818 [debug] [MainThread]: Command `dbt deps` failed at 10:04:49.723701 after 0.43 seconds
[0m10:04:49.724125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC0184F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC0185040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC0165C50>]}
[0m10:04:49.724403 [debug] [MainThread]: Flushing usage events
[0m10:04:51.126231 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:10:59.041032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7023e0be84a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7023e0beb590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7023e0be8350>]}


============================== 03:10:59.047896 | f1e33a6c-58b0-4ed9-a5a8-3b31e90b761a ==============================
[0m03:10:59.047896 [info ] [MainThread]: Running with dbt=1.7.9
[0m03:10:59.048803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:10:59.144168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1e33a6c-58b0-4ed9-a5a8-3b31e90b761a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7023e0aa4470>]}
[0m03:10:59.149391 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-w3guiytf'
[0m03:10:59.150337 [error] [MainThread]: Encountered an error:
">=1.1.1,<2.0.0" is not a valid semantic version.
[0m03:10:59.151656 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.24151266, "process_user_time": 1.962696, "process_kernel_time": 0.214545, "process_mem_max_rss": "217936", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m03:10:59.152494 [debug] [MainThread]: Command `dbt deps` failed at 03:10:59.152345 after 0.24 seconds
[0m03:10:59.153227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7023e557b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7023e0aa6840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7023e0bd15e0>]}
[0m03:10:59.154063 [debug] [MainThread]: Flushing usage events
[0m10:12:13.121538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A3B229940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A38F20190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A3D37D6D0>]}


============================== 10:12:13.125725 | 15c9fc85-def5-4f11-ad27-8d3077341850 ==============================
[0m10:12:13.125725 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:12:13.126403 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail'}
[0m10:12:13.261746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15c9fc85-def5-4f11-ad27-8d3077341850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A3B6B75C0>]}
[0m10:12:13.290932 [debug] [MainThread]: Command `dbt clean` succeeded at 10:12:13.290769 after 0.43 seconds
[0m10:12:13.291531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A3C252580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A3C251D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A3E2B8B50>]}
[0m10:12:13.291968 [debug] [MainThread]: Flushing usage events
[0m10:12:14.798756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:12:20.198743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022529979940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022527670190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002252BACD6D0>]}


============================== 10:12:20.204019 | 01ca9944-2fa2-48ef-8189-dfbc8fd22aa8 ==============================
[0m10:12:20.204019 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:12:20.204730 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m10:12:20.340208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01ca9944-2fa2-48ef-8189-dfbc8fd22aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022529E075C0>]}
[0m10:12:20.368894 [debug] [MainThread]: Set downloads directory='C:\Users\CAU~1.TRA\AppData\Local\Temp\dbt-downloads-b7b2a29b'
[0m10:12:20.369635 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:12:20.964195 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:12:20.965345 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:12:21.363254 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:12:21.368260 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m10:12:21.726792 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m10:12:21.728592 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m10:12:21.729380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '01ca9944-2fa2-48ef-8189-dfbc8fd22aa8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002252A9A2F10>]}
[0m10:12:21.731298 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m10:12:22.073047 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m10:12:22.083370 [info ] [MainThread]: Updating lock file in file path: C:\Users\cau.tran\retail-data-pipeline\dbt\retail/package-lock.yml
[0m10:12:22.095489 [debug] [MainThread]: Set downloads directory='C:\Users\CAU~1.TRA\AppData\Local\Temp\dbt-downloads-8g7tjxul'
[0m10:12:22.099365 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:12:23.051282 [info ] [MainThread]: Installed from version 1.3.1
[0m10:12:23.051773 [info ] [MainThread]: Up to date!
[0m10:12:23.052139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '01ca9944-2fa2-48ef-8189-dfbc8fd22aa8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002252CA05E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002252CA05C50>]}
[0m10:12:23.052421 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m10:12:24.379031 [info ] [MainThread]: Installed from version 0.10.4
[0m10:12:24.379475 [info ] [MainThread]: Up to date!
[0m10:12:24.379816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '01ca9944-2fa2-48ef-8189-dfbc8fd22aa8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002252A97EE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002252CA2DB70>]}
[0m10:12:24.380104 [info ] [MainThread]: Installing calogica/dbt_date
[0m10:12:25.055377 [info ] [MainThread]: Installed from version 0.10.1
[0m10:12:25.055833 [info ] [MainThread]: Up to date!
[0m10:12:25.056224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '01ca9944-2fa2-48ef-8189-dfbc8fd22aa8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002252CACD8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002252A933F50>]}
[0m10:12:25.058623 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:12:25.060499 [debug] [MainThread]: Command `dbt deps` succeeded at 10:12:25.060372 after 5.01 seconds
[0m10:12:25.060865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002252A9EAF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002252A9EAD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002252CA63570>]}
[0m10:12:25.061156 [debug] [MainThread]: Flushing usage events
[0m10:12:26.298470 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:12:43.895789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4f86b5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4f86b6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4f86b42c0>]}


============================== 03:12:43.902579 | fd826ec5-a6d3-47af-bc34-8048693e486b ==============================
[0m03:12:43.902579 [info ] [MainThread]: Running with dbt=1.7.9
[0m03:12:43.903584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:12:43.998902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd826ec5-a6d3-47af-bc34-8048693e486b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4f86b7680>]}
[0m03:12:45.366753 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.1', 'unrendered': {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.1'}} is not valid under any of the given schemas
  
[0m03:12:45.368196 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 1.5940124, "process_user_time": 2.060056, "process_kernel_time": 0.315356, "process_mem_max_rss": "217936", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:12:45.368873 [debug] [MainThread]: Command `dbt deps` failed at 03:12:45.368718 after 1.59 seconds
[0m03:12:45.369502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4f8667f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4f8667d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4f89ecb00>]}
[0m03:12:45.370726 [debug] [MainThread]: Flushing usage events
[0m03:13:58.910907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7448797ec2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744879b15520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74487a5cca70>]}


============================== 03:13:58.916995 | 807bed5b-c2a2-4472-a8de-9e8dbf4fc663 ==============================
[0m03:13:58.916995 [info ] [MainThread]: Running with dbt=1.7.9
[0m03:13:58.918025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/retail', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:13:59.016923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '807bed5b-c2a2-4472-a8de-9e8dbf4fc663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744879682660>]}
[0m03:13:59.027765 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-pk1izdme'
[0m03:13:59.028733 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:13:59.441735 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:13:59.442916 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:13:59.574755 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:13:59.580330 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m03:13:59.717055 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m03:13:59.719226 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m03:13:59.720103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '807bed5b-c2a2-4472-a8de-9e8dbf4fc663', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74487a89da00>]}
[0m03:13:59.722481 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m03:13:59.858041 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m03:13:59.873171 [info ] [MainThread]: Updating lock file in file path: /opt/airflow/dbt/retail/package-lock.yml
[0m03:13:59.896680 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-cr2dk93r'
[0m03:13:59.901979 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:14:06.843134 [info ] [MainThread]: Installed from version 1.3.1
[0m03:14:06.844117 [info ] [MainThread]: Up to date!
[0m03:14:06.844845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '807bed5b-c2a2-4472-a8de-9e8dbf4fc663', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7448797d9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7448797d9b80>]}
[0m03:14:06.845536 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m03:14:11.981375 [info ] [MainThread]: Installed from version 0.10.4
[0m03:14:11.982439 [info ] [MainThread]: Up to date!
[0m03:14:11.983209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '807bed5b-c2a2-4472-a8de-9e8dbf4fc663', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744879543830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744879543a10>]}
[0m03:14:11.984212 [info ] [MainThread]: Installing calogica/dbt_date
[0m03:14:14.171483 [info ] [MainThread]: Installed from version 0.10.1
[0m03:14:14.172412 [info ] [MainThread]: Up to date!
[0m03:14:14.173553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '807bed5b-c2a2-4472-a8de-9e8dbf4fc663', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7448797d9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7448797d9700>]}
[0m03:14:14.175847 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 15.413624, "process_user_time": 2.356645, "process_kernel_time": 0.727006, "process_mem_max_rss": "217936", "process_in_blocks": "16", "process_out_blocks": "7560"}
[0m03:14:14.176845 [debug] [MainThread]: Command `dbt deps` succeeded at 03:14:14.176687 after 15.41 seconds
[0m03:14:14.177538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744879b1fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744879681970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744879682570>]}
[0m03:14:14.178245 [debug] [MainThread]: Flushing usage events
[0m03:14:19.082492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d951d180e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d951d1a900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d951d180b0>]}


============================== 03:14:19.095476 | 38f2a3ae-46f8-4782-9075-20dff1a9d707 ==============================
[0m03:14:19.095476 [info ] [MainThread]: Running with dbt=1.7.9
[0m03:14:19.098091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/retail', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:14:19.130191 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_PROJECT_ID'
[0m03:14:19.134206 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2040699, "process_user_time": 2.114115, "process_kernel_time": 0.107903, "process_mem_max_rss": "217936", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:14:19.136693 [debug] [MainThread]: Command `dbt run` failed at 03:14:19.136143 after 0.21 seconds
[0m03:14:19.138089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d951e26810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d952033980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d951e906b0>]}
[0m03:14:19.140928 [debug] [MainThread]: Flushing usage events
[0m03:42:12.445223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d95ab9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d95dd0530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d95e15190>]}


============================== 03:42:12.465200 | 1fce2b92-5f0a-4b0b-ab08-7c87c86455b5 ==============================
[0m03:42:12.465200 [info ] [MainThread]: Running with dbt=1.7.9
[0m03:42:12.466001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/retail', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:42:12.596193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fce2b92-5f0a-4b0b-ab08-7c87c86455b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d95a761b0>]}
[0m03:42:13.845474 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-n07ug_ik'
[0m03:42:13.846689 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:42:14.229534 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:42:14.230881 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:42:14.359522 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:42:14.363237 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m03:42:14.523059 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m03:42:14.524557 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m03:42:14.525230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1fce2b92-5f0a-4b0b-ab08-7c87c86455b5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d95b28cb0>]}
[0m03:42:14.527475 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m03:42:14.826794 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m03:42:14.829651 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:42:21.616195 [info ] [MainThread]: Installed from version 1.3.1
[0m03:42:21.616942 [info ] [MainThread]: Up to date!
[0m03:42:21.617591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1fce2b92-5f0a-4b0b-ab08-7c87c86455b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d95c8f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d95b2aea0>]}
[0m03:42:21.618171 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m03:42:26.443918 [info ] [MainThread]: Installed from version 0.10.4
[0m03:42:26.444927 [info ] [MainThread]: Up to date!
[0m03:42:26.446146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1fce2b92-5f0a-4b0b-ab08-7c87c86455b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d95b50ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d95a2e180>]}
[0m03:42:26.447282 [info ] [MainThread]: Installing calogica/dbt_date
[0m03:42:29.113650 [info ] [MainThread]: Installed from version 0.10.1
[0m03:42:29.114608 [info ] [MainThread]: Up to date!
[0m03:42:29.115553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1fce2b92-5f0a-4b0b-ab08-7c87c86455b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d95d25a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d95d26030>]}
[0m03:42:29.118332 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 16.785534, "process_user_time": 3.569329, "process_kernel_time": 1.14832, "process_mem_max_rss": "163692", "process_out_blocks": "11768", "process_in_blocks": "0"}
[0m03:42:29.119943 [debug] [MainThread]: Command `dbt deps` succeeded at 03:42:29.119498 after 16.79 seconds
[0m03:42:29.121076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d96a05c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d95a761b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d9a5fb3e0>]}
[0m03:42:29.122022 [debug] [MainThread]: Flushing usage events
[0m03:42:34.037373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d5ae5066f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d5ae506ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d5ae5063f0>]}


============================== 03:42:34.043831 | cbe998d2-d38a-4523-b3c9-fd82c79d3184 ==============================
[0m03:42:34.043831 [info ] [MainThread]: Running with dbt=1.7.9
[0m03:42:34.044813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:42:36.495888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbe998d2-d38a-4523-b3c9-fd82c79d3184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d5815bfc20>]}
[0m03:42:36.567578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbe998d2-d38a-4523-b3c9-fd82c79d3184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d581477020>]}
[0m03:42:36.593274 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m03:42:36.692908 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m03:42:36.717437 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:42:36.718260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cbe998d2-d38a-4523-b3c9-fd82c79d3184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d5887e85f0>]}
[0m03:42:44.418120 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.retail
[0m03:42:44.424113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbe998d2-d38a-4523-b3c9-fd82c79d3184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d583282b70>]}
[0m03:42:44.479324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbe998d2-d38a-4523-b3c9-fd82c79d3184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d58100bb90>]}
[0m03:42:44.480732 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 838 macros, 0 groups, 0 semantic models
[0m03:42:44.482076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbe998d2-d38a-4523-b3c9-fd82c79d3184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d581069ca0>]}
[0m03:42:44.494411 [info ] [MainThread]: 
[0m03:42:44.495883 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:42:44.498226 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m03:42:44.499347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:42:44.505494 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/keys/airflow-sa.json''
[0m03:42:44.507737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:42:44.508993 [debug] [MainThread]: Connection 'list_retail-data-pipeline-dev' was properly closed.
[0m03:42:44.510036 [info ] [MainThread]: 
[0m03:42:44.511173 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.01 seconds (0.01s).
[0m03:42:44.512503 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/keys/airflow-sa.json'
[0m03:42:44.514237 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.55136, "process_user_time": 6.480956, "process_kernel_time": 1.785444, "process_mem_max_rss": "241992", "process_in_blocks": "2736", "process_out_blocks": "30624", "command_success": false}
[0m03:42:44.515385 [debug] [MainThread]: Command `dbt run` failed at 03:42:44.515124 after 10.55 seconds
[0m03:42:44.516596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d5b2f633b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d58141e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d56b4b8620>]}
[0m03:42:44.517837 [debug] [MainThread]: Flushing usage events
[0m03:44:54.387371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73824f7b5100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73824fa7cbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73824f7b4200>]}


============================== 03:44:54.394486 | 1c55ea07-7258-4155-9a3e-4d5cda1d14bb ==============================
[0m03:44:54.394486 [info ] [MainThread]: Running with dbt=1.7.9
[0m03:44:54.395428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'send_anonymous_usage_stats': 'True'}
[0m03:44:54.513710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c55ea07-7258-4155-9a3e-4d5cda1d14bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73824f66d370>]}
[0m03:44:56.066021 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2dbznu3v'
[0m03:44:56.067013 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:44:56.413791 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:44:56.415323 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:44:56.552744 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:44:56.557278 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m03:44:56.707236 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m03:44:56.710076 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m03:44:56.711162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1c55ea07-7258-4155-9a3e-4d5cda1d14bb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73824f647500>]}
[0m03:44:56.713367 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m03:44:56.863102 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m03:44:56.866694 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:45:04.090946 [info ] [MainThread]: Installed from version 1.3.1
[0m03:45:04.091920 [info ] [MainThread]: Up to date!
[0m03:45:04.092833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1c55ea07-7258-4155-9a3e-4d5cda1d14bb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73824f79daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73824f79db50>]}
[0m03:45:04.093738 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m03:45:08.832633 [info ] [MainThread]: Installed from version 0.10.4
[0m03:45:08.833648 [info ] [MainThread]: Up to date!
[0m03:45:08.834431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1c55ea07-7258-4155-9a3e-4d5cda1d14bb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73824f703c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73824f703b30>]}
[0m03:45:08.835407 [info ] [MainThread]: Installing calogica/dbt_date
[0m03:45:11.070176 [info ] [MainThread]: Installed from version 0.10.1
[0m03:45:11.071197 [info ] [MainThread]: Up to date!
[0m03:45:11.071960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1c55ea07-7258-4155-9a3e-4d5cda1d14bb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73824f703b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73824f79d970>]}
[0m03:45:11.073979 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 16.826591, "process_user_time": 2.394468, "process_kernel_time": 0.868861, "process_mem_max_rss": "219200", "process_out_blocks": "7560", "process_in_blocks": "0"}
[0m03:45:11.075099 [debug] [MainThread]: Command `dbt deps` succeeded at 03:45:11.074933 after 16.83 seconds
[0m03:45:11.075800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73824fb03230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73824f93a720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73824fa7ca40>]}
[0m03:45:11.076398 [debug] [MainThread]: Flushing usage events
[0m03:45:16.579416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abafa829370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abafaaf0bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abafa82a000>]}


============================== 03:45:16.585712 | daa9fe49-a600-48ac-9fe3-2c99bdd7427c ==============================
[0m03:45:16.585712 [info ] [MainThread]: Running with dbt=1.7.9
[0m03:45:16.586816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:45:17.542599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'daa9fe49-a600-48ac-9fe3-2c99bdd7427c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abacda8adb0>]}
[0m03:45:17.625084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'daa9fe49-a600-48ac-9fe3-2c99bdd7427c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abaceca0bc0>]}
[0m03:45:17.626660 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m03:45:17.750094 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m03:45:24.283585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:45:24.284521 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:45:24.285478 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.retail
[0m03:45:24.290642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'daa9fe49-a600-48ac-9fe3-2c99bdd7427c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abacd952b40>]}
[0m03:45:24.335460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'daa9fe49-a600-48ac-9fe3-2c99bdd7427c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abacd5e5ac0>]}
[0m03:45:24.336508 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 838 macros, 0 groups, 0 semantic models
[0m03:45:24.337407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daa9fe49-a600-48ac-9fe3-2c99bdd7427c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abafabae7b0>]}
[0m03:45:24.347695 [info ] [MainThread]: 
[0m03:45:24.348941 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:45:24.350537 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m03:45:24.351180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:45:24.351786 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/keys/airflow-sa.json''
[0m03:45:24.353167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:45:24.353682 [debug] [MainThread]: Connection 'list_retail-data-pipeline-dev' was properly closed.
[0m03:45:24.354271 [info ] [MainThread]: 
[0m03:45:24.354953 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.01 seconds (0.01s).
[0m03:45:24.355546 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/keys/airflow-sa.json'
[0m03:45:24.356590 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.851448, "process_user_time": 3.475768, "process_kernel_time": 1.546131, "process_mem_max_rss": "230820", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:45:24.357199 [debug] [MainThread]: Command `dbt run` failed at 03:45:24.357064 after 7.85 seconds
[0m03:45:24.357748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abafa93bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abacdb46690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abaceca0bc0>]}
[0m03:45:24.358353 [debug] [MainThread]: Flushing usage events
[0m03:46:24.416808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088b7d313a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088b7ce3c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088b7c5d0a0>]}


============================== 03:46:24.422929 | 0174591a-91d3-44ab-adfe-72c988ff6577 ==============================
[0m03:46:24.422929 [info ] [MainThread]: Running with dbt=1.7.9
[0m03:46:24.424113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:46:24.512759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0174591a-91d3-44ab-adfe-72c988ff6577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088b7fb92b0>]}
[0m03:46:25.789110 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4ia9akts'
[0m03:46:25.790011 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:46:26.136072 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:46:26.137733 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:46:26.268386 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:46:26.271794 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m03:46:26.406026 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m03:46:26.408610 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m03:46:26.409464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0174591a-91d3-44ab-adfe-72c988ff6577', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088b7d30470>]}
[0m03:46:26.411808 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m03:46:26.566319 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m03:46:26.569218 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:46:32.819407 [info ] [MainThread]: Installed from version 1.3.1
[0m03:46:32.820253 [info ] [MainThread]: Up to date!
[0m03:46:32.821091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0174591a-91d3-44ab-adfe-72c988ff6577', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088b7e67c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088b7bee930>]}
[0m03:46:32.821756 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m03:46:46.397388 [info ] [MainThread]: Installed from version 0.10.4
[0m03:46:46.398307 [info ] [MainThread]: Up to date!
[0m03:46:46.399249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0174591a-91d3-44ab-adfe-72c988ff6577', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088b7a946b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088b7a83f80>]}
[0m03:46:46.399865 [info ] [MainThread]: Installing calogica/dbt_date
[0m03:46:48.754830 [info ] [MainThread]: Installed from version 0.10.1
[0m03:46:48.755660 [info ] [MainThread]: Up to date!
[0m03:46:48.756341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0174591a-91d3-44ab-adfe-72c988ff6577', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088b7c17bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088b7c17800>]}
[0m03:46:48.758425 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 24.480907, "process_user_time": 2.394625, "process_kernel_time": 1.184664, "process_mem_max_rss": "219200", "process_out_blocks": "7560", "process_in_blocks": "0"}
[0m03:46:48.759414 [debug] [MainThread]: Command `dbt deps` succeeded at 03:46:48.759223 after 24.48 seconds
[0m03:46:48.760137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088b7ce3e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088b7ce3c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088b7ce3ce0>]}
[0m03:46:48.760974 [debug] [MainThread]: Flushing usage events
[0m03:46:53.430280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0058049430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b00581c1460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0058049b20>]}


============================== 03:46:53.436591 | b9540f66-5d6a-4902-ab5a-78c6e930f86b ==============================
[0m03:46:53.436591 [info ] [MainThread]: Running with dbt=1.7.9
[0m03:46:53.437620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:46:54.285994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9540f66-5d6a-4902-ab5a-78c6e930f86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b002b0bbb60>]}
[0m03:46:54.388301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9540f66-5d6a-4902-ab5a-78c6e930f86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b002afdb0e0>]}
[0m03:46:54.389895 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m03:46:54.503552 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m03:47:00.607745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:47:00.608931 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:47:00.610406 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.retail
[0m03:47:00.616599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9540f66-5d6a-4902-ab5a-78c6e930f86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b002aea9880>]}
[0m03:47:00.665100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9540f66-5d6a-4902-ab5a-78c6e930f86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b002aef92e0>]}
[0m03:47:00.666254 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 838 macros, 0 groups, 0 semantic models
[0m03:47:00.667186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9540f66-5d6a-4902-ab5a-78c6e930f86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b002aacf9e0>]}
[0m03:47:00.676817 [info ] [MainThread]: 
[0m03:47:00.678082 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:47:00.679961 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m03:47:00.680862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:47:00.681619 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/keys/airflow-sa.json''
[0m03:47:00.683242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:47:00.684285 [debug] [MainThread]: Connection 'list_retail-data-pipeline-dev' was properly closed.
[0m03:47:00.685164 [info ] [MainThread]: 
[0m03:47:00.686006 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.01 seconds (0.01s).
[0m03:47:00.686774 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/keys/airflow-sa.json'
[0m03:47:00.688016 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.321934, "process_user_time": 3.118857, "process_kernel_time": 1.418743, "process_mem_max_rss": "231296", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:47:00.688931 [debug] [MainThread]: Command `dbt run` failed at 03:47:00.688795 after 7.32 seconds
[0m03:47:00.689625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b00581c6900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b002aacfa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b002aefae10>]}
[0m03:47:00.690275 [debug] [MainThread]: Flushing usage events
[0m03:52:11.924133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748145d5e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748145d5e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748145d5d7f0>]}


============================== 03:52:11.942523 | ed8c67cb-9373-417f-901a-058667b0bee5 ==============================
[0m03:52:11.942523 [info ] [MainThread]: Running with dbt=1.7.9
[0m03:52:11.943516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:52:12.054763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed8c67cb-9373-417f-901a-058667b0bee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748145baab10>]}
[0m03:52:13.149619 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rk6aq3xw'
[0m03:52:13.150361 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:52:13.652055 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:52:13.653369 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:52:13.763911 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:52:13.767116 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m03:52:13.891228 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m03:52:13.892652 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m03:52:13.893633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ed8c67cb-9373-417f-901a-058667b0bee5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748145c16840>]}
[0m03:52:13.896029 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m03:52:13.999927 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m03:52:14.002494 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:52:21.524294 [info ] [MainThread]: Installed from version 1.3.1
[0m03:52:21.525186 [info ] [MainThread]: Up to date!
[0m03:52:21.525869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ed8c67cb-9373-417f-901a-058667b0bee5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748145c18320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748145c1bc80>]}
[0m03:52:21.526441 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m03:52:26.249097 [info ] [MainThread]: Installed from version 0.10.4
[0m03:52:26.250091 [info ] [MainThread]: Up to date!
[0m03:52:26.250857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ed8c67cb-9373-417f-901a-058667b0bee5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748145c53d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748145c53e00>]}
[0m03:52:26.251891 [info ] [MainThread]: Installing calogica/dbt_date
[0m03:52:28.338823 [info ] [MainThread]: Installed from version 0.10.1
[0m03:52:28.339962 [info ] [MainThread]: Up to date!
[0m03:52:28.341104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ed8c67cb-9373-417f-901a-058667b0bee5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748145bab200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748145baa7b0>]}
[0m03:52:28.343356 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 16.49689, "process_user_time": 2.835781, "process_kernel_time": 0.846126, "process_mem_max_rss": "163452", "process_out_blocks": "11768", "process_in_blocks": "0"}
[0m03:52:28.344215 [debug] [MainThread]: Command `dbt deps` succeeded at 03:52:28.344019 after 16.50 seconds
[0m03:52:28.344933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748145e11670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74814a6ff380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748145e9cb00>]}
[0m03:52:28.345523 [debug] [MainThread]: Flushing usage events
[0m03:52:32.736195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72532d1e0fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72532d4d7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72532d309880>]}


============================== 03:52:32.742957 | 35272661-5c4f-45e1-ad82-275e1fb1bab5 ==============================
[0m03:52:32.742957 [info ] [MainThread]: Running with dbt=1.7.9
[0m03:52:32.744045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:52:34.650921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35272661-5c4f-45e1-ad82-275e1fb1bab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725305327080>]}
[0m03:52:34.719237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35272661-5c4f-45e1-ad82-275e1fb1bab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72530437bbc0>]}
[0m03:52:34.720578 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m03:52:34.806127 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m03:52:34.843444 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m03:52:34.844326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '35272661-5c4f-45e1-ad82-275e1fb1bab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7252ffe01d90>]}
[0m03:52:42.445882 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.retail
[0m03:52:42.451601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35272661-5c4f-45e1-ad82-275e1fb1bab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7252fe4342c0>]}
[0m03:52:42.498540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35272661-5c4f-45e1-ad82-275e1fb1bab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7252ffc74f20>]}
[0m03:52:42.499672 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 838 macros, 0 groups, 0 semantic models
[0m03:52:42.500559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35272661-5c4f-45e1-ad82-275e1fb1bab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7252ffcd0800>]}
[0m03:52:42.511350 [info ] [MainThread]: 
[0m03:52:42.512936 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:52:42.515373 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m03:52:42.516291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:52:43.650386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now create_retail-data-pipeline-dev_retail_prod_retail_stg)
[0m03:52:43.652855 [debug] [ThreadPool]: Creating schema "database: "retail-data-pipeline-dev"
schema: "retail_prod_retail_stg"
"
[0m03:52:43.661572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:52:43.696849 [debug] [ThreadPool]: On create_retail-data-pipeline-dev_retail_prod_retail_stg: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "connection_name": "create_retail-data-pipeline-dev_retail_prod_retail_stg"} */
create schema if not exists `retail-data-pipeline-dev`.`retail_prod_retail_stg`
  
[0m03:52:44.896782 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:452cd78f-bdc6-4d68-a1ff-68bc5dec4a8e&page=queryresults
[0m03:52:49.551655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_retail-data-pipeline-dev_retail_prod_retail_stg, now list_retail-data-pipeline-dev_retail_prod_retail_stg)
[0m03:52:49.552615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:52:50.233568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35272661-5c4f-45e1-ad82-275e1fb1bab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72532d18fb90>]}
[0m03:52:50.235510 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:52:50.236652 [info ] [MainThread]: 
[0m03:52:50.247148 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m03:52:50.247720 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m03:52:50.248317 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod_retail_stg.bronze__orders ............. [RUN]
[0m03:52:50.249071 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod_retail_stg.bronze__users .............. [RUN]
[0m03:52:50.250032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod_retail_stg, now model.retail.bronze__orders)
[0m03:52:50.251072 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m03:52:50.251756 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m03:52:50.252459 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m03:52:50.258640 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m03:52:50.263959 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m03:52:50.293022 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 03:52:50.252902 => 03:52:50.292465
[0m03:52:50.293967 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m03:52:50.320202 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 03:52:50.259356 => 03:52:50.319844
[0m03:52:50.325715 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m03:52:50.326262 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m03:52:50.330692 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m03:52:50.354734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:52:50.357800 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:52:50.392833 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_stg`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m03:52:50.428841 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_stg`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m03:52:51.309906 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:d3965a8d-ebf8-4d5f-8103-3f5803ef1ae7&page=queryresults
[0m03:52:51.311967 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid dataset ID "{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.; reason: invalid, location: retail-data-pipeline-dev.{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}.orders, message: Invalid dataset ID "{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.')
[0m03:52:51.371023 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:44195af0-f23b-4d27-9fe1-86bcd1ba86fd&page=queryresults
[0m03:52:51.373426 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid dataset ID "{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.; reason: invalid, location: retail-data-pipeline-dev.{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}.users, message: Invalid dataset ID "{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.')
[0m03:52:52.564589 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:e6b7ab0c-1791-45bf-b9e0-2670c2c32195&page=queryresults
[0m03:52:52.566485 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:e6b7ab0c-1791-45bf-b9e0-2670c2c32195&page=queryresults
[0m03:52:52.568047 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 03:52:50.327471 => 03:52:52.567576
[0m03:52:52.598525 [debug] [Thread-2 (]: Database Error in model bronze__users (models/bronze/bronze__users.sql)
  Invalid dataset ID "{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.
  compiled Code at target/run/retail/models/bronze/bronze__users.sql
[0m03:52:52.599633 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35272661-5c4f-45e1-ad82-275e1fb1bab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7252fe4f4230>]}
[0m03:52:52.600654 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model retail_prod_retail_stg.bronze__users ..... [[31mERROR[0m in 2.35s]
[0m03:52:52.601608 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m03:52:52.891075 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:6999eeb1-bf28-452d-9a75-5ccd16e4b3af&page=queryresults
[0m03:52:52.893211 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:6999eeb1-bf28-452d-9a75-5ccd16e4b3af&page=queryresults
[0m03:52:52.894378 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 03:52:50.294634 => 03:52:52.894122
[0m03:52:52.896928 [debug] [Thread-1 (]: Database Error in model bronze__orders (models/bronze/bronze__orders.sql)
  Invalid dataset ID "{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.
  compiled Code at target/run/retail/models/bronze/bronze__orders.sql
[0m03:52:52.897644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35272661-5c4f-45e1-ad82-275e1fb1bab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7252fe32d490>]}
[0m03:52:52.898336 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model retail_prod_retail_stg.bronze__orders .... [[31mERROR[0m in 2.65s]
[0m03:52:52.899062 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m03:52:52.901746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:52:52.902643 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m03:52:52.903427 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m03:52:52.904135 [info ] [MainThread]: 
[0m03:52:52.904877 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 10.39 seconds (10.39s).
[0m03:52:52.923806 [debug] [MainThread]: Command end result
[0m03:52:52.967258 [info ] [MainThread]: 
[0m03:52:52.968470 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m03:52:52.969476 [info ] [MainThread]: 
[0m03:52:52.970625 [error] [MainThread]:   Database Error in model bronze__users (models/bronze/bronze__users.sql)
  Invalid dataset ID "{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.
  compiled Code at target/run/retail/models/bronze/bronze__users.sql
[0m03:52:52.971656 [info ] [MainThread]: 
[0m03:52:52.972309 [error] [MainThread]:   Database Error in model bronze__orders (models/bronze/bronze__orders.sql)
  Invalid dataset ID "{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.
  compiled Code at target/run/retail/models/bronze/bronze__orders.sql
[0m03:52:52.972934 [info ] [MainThread]: 
[0m03:52:52.973638 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m03:52:52.975406 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 20.30999, "process_user_time": 5.892447, "process_kernel_time": 1.421459, "process_mem_max_rss": "247816", "process_in_blocks": "1872", "process_out_blocks": "30624", "command_success": false}
[0m03:52:52.976965 [debug] [MainThread]: Command `dbt run` failed at 03:52:52.976742 after 20.31 seconds
[0m03:52:52.977991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72532d10d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7252fff29700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7253040396d0>]}
[0m03:52:52.978818 [debug] [MainThread]: Flushing usage events
[0m03:56:41.724166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703e344106e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703e3450f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703e34770f20>]}


============================== 03:56:41.732122 | 883ef2ce-904a-4de1-8dc5-162a944d998b ==============================
[0m03:56:41.732122 [info ] [MainThread]: Running with dbt=1.7.9
[0m03:56:41.733090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/retail', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'send_anonymous_usage_stats': 'True'}
[0m03:56:42.434903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e5b99c6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e5b9c10c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e5b99c7500>]}


============================== 03:56:42.441348 | 405eda94-0105-4ba7-a8f2-c59d5f0c7a9a ==============================
[0m03:56:42.441348 [info ] [MainThread]: Running with dbt=1.7.9
[0m03:56:42.442464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:56:42.540254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '405eda94-0105-4ba7-a8f2-c59d5f0c7a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e5b9d01f70>]}
[0m03:56:42.838998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '883ef2ce-904a-4de1-8dc5-162a944d998b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703e076572c0>]}
[0m03:56:42.921322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '883ef2ce-904a-4de1-8dc5-162a944d998b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703e0f918470>]}
[0m03:56:42.922518 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m03:56:42.984225 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path /opt/airflow/dbt/retail/dbt_packages/dbt_utils/dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
    

Error encountered in /opt/airflow/dbt/retail/dbt_packages/dbt_utils
[0m03:56:42.985743 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3475662, "process_user_time": 3.530854, "process_kernel_time": 1.23338, "process_mem_max_rss": "262328", "process_out_blocks": "2408", "command_success": false, "process_in_blocks": "0"}
[0m03:56:42.987522 [debug] [MainThread]: Command `dbt run` failed at 03:56:42.987069 after 1.35 seconds
[0m03:56:42.988669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703e34411be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703e075772c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703e079b16d0>]}
[0m03:56:42.989686 [debug] [MainThread]: Flushing usage events
[0m03:56:43.900567 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-awzkmhul'
[0m03:56:43.902016 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:56:44.223416 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:56:44.224810 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:56:44.362173 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:56:44.365464 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m03:56:44.574531 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m03:56:44.577249 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m03:56:44.578689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '405eda94-0105-4ba7-a8f2-c59d5f0c7a9a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e5b9913b90>]}
[0m03:56:44.580870 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m03:56:44.723666 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m03:56:44.726296 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:56:52.053671 [info ] [MainThread]: Installed from version 1.3.1
[0m03:56:52.054387 [info ] [MainThread]: Up to date!
[0m03:56:52.055059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '405eda94-0105-4ba7-a8f2-c59d5f0c7a9a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e5be1bb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e5be1b90d0>]}
[0m03:56:52.055781 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m03:56:56.776832 [info ] [MainThread]: Installed from version 0.10.4
[0m03:56:56.777556 [info ] [MainThread]: Up to date!
[0m03:56:56.778215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '405eda94-0105-4ba7-a8f2-c59d5f0c7a9a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e5b98a7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e5b98a7e60>]}
[0m03:56:56.778817 [info ] [MainThread]: Installing calogica/dbt_date
[0m03:56:59.044574 [info ] [MainThread]: Installed from version 0.10.1
[0m03:56:59.045288 [info ] [MainThread]: Up to date!
[0m03:56:59.045950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '405eda94-0105-4ba7-a8f2-c59d5f0c7a9a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e5b99ad640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e5b99adc40>]}
[0m03:56:59.048704 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 16.702538, "process_user_time": 2.717451, "process_kernel_time": 0.828292, "process_mem_max_rss": "218028", "process_out_blocks": "7560", "process_in_blocks": "0"}
[0m03:56:59.049777 [debug] [MainThread]: Command `dbt deps` succeeded at 03:56:59.049533 after 16.70 seconds
[0m03:56:59.050661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e5b9d16ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e5b9750fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e5be1c9130>]}
[0m03:56:59.051404 [debug] [MainThread]: Flushing usage events
[0m03:57:16.643117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffa610f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffa84eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffa6137a0>]}


============================== 03:57:16.649076 | 1bc381f0-119b-40b6-81e4-94681d6d1a3b ==============================
[0m03:57:16.649076 [info ] [MainThread]: Running with dbt=1.7.9
[0m03:57:16.650467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:57:17.486017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5fd80b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5fd809d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5fd809370>]}


============================== 03:57:17.492100 | 480afa86-57c2-4464-b34b-d67c7dead2cd ==============================
[0m03:57:17.492100 [info ] [MainThread]: Running with dbt=1.7.9
[0m03:57:17.493090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:57:17.598584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '480afa86-57c2-4464-b34b-d67c7dead2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5fd6c5280>]}
[0m03:57:17.698530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bc381f0-119b-40b6-81e4-94681d6d1a3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffa622d50>]}
[0m03:57:17.780846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bc381f0-119b-40b6-81e4-94681d6d1a3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effcd9224e0>]}
[0m03:57:17.782045 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m03:57:17.846264 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path /opt/airflow/dbt/retail/dbt_packages/dbt_utils/dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
    

Error encountered in /opt/airflow/dbt/retail/dbt_packages/dbt_utils
[0m03:57:17.849210 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2850384, "process_user_time": 3.784851, "process_kernel_time": 1.183264, "process_mem_max_rss": "262308", "process_out_blocks": "2408", "command_success": false, "process_in_blocks": "0"}
[0m03:57:17.850333 [debug] [MainThread]: Command `dbt run` failed at 03:57:17.850145 after 1.29 seconds
[0m03:57:17.851034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffa6137a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effcd657620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effcd657dd0>]}
[0m03:57:17.851833 [debug] [MainThread]: Flushing usage events
[0m03:57:18.845276 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4ng93njb'
[0m03:57:18.846293 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:57:19.112048 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:57:19.113628 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:57:19.251707 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:57:19.254990 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m03:57:19.385380 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m03:57:19.388862 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m03:57:19.390157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '480afa86-57c2-4464-b34b-d67c7dead2cd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5fd6c79b0>]}
[0m03:57:19.392289 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m03:57:19.531592 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m03:57:19.537885 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:57:33.351754 [info ] [MainThread]: Installed from version 1.3.1
[0m03:57:33.352480 [info ] [MainThread]: Up to date!
[0m03:57:33.353176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '480afa86-57c2-4464-b34b-d67c7dead2cd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5fd6132f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5fd613470>]}
[0m03:57:33.353783 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m03:57:37.846832 [info ] [MainThread]: Installed from version 0.10.4
[0m03:57:37.847623 [info ] [MainThread]: Up to date!
[0m03:57:37.848317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '480afa86-57c2-4464-b34b-d67c7dead2cd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5fd55be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5fd6c79b0>]}
[0m03:57:37.848977 [info ] [MainThread]: Installing calogica/dbt_date
[0m03:57:40.153093 [info ] [MainThread]: Installed from version 0.10.1
[0m03:57:40.154023 [info ] [MainThread]: Up to date!
[0m03:57:40.154895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '480afa86-57c2-4464-b34b-d67c7dead2cd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5fd7f1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5fd7f2060>]}
[0m03:57:40.157012 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 22.81155, "process_user_time": 3.056192, "process_kernel_time": 0.704341, "process_mem_max_rss": "218028", "process_out_blocks": "7560", "process_in_blocks": "0"}
[0m03:57:40.157862 [debug] [MainThread]: Command `dbt deps` succeeded at 03:57:40.157656 after 22.81 seconds
[0m03:57:40.158761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5fd973740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb600459f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5fd734260>]}
[0m03:57:40.159550 [debug] [MainThread]: Flushing usage events
[0m03:59:33.293189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76640f7b50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76640f7b5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76640f7b6ab0>]}


============================== 03:59:33.300314 | 1e86bcc2-97cc-473d-afe0-293b8674b149 ==============================
[0m03:59:33.300314 [info ] [MainThread]: Running with dbt=1.7.9
[0m03:59:33.301514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:59:33.403571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e86bcc2-97cc-473d-afe0-293b8674b149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76640f7c6c60>]}
[0m03:59:34.366740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743851527800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743851525c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7438515243b0>]}


============================== 03:59:34.374149 | 125bf538-62a8-457c-af4b-8b4346a04fe9 ==============================
[0m03:59:34.374149 [info ] [MainThread]: Running with dbt=1.7.9
[0m03:59:34.375387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:59:34.496086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '125bf538-62a8-457c-af4b-8b4346a04fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7438513de1e0>]}
[0m03:59:34.535313 [error] [MainThread]: Encountered an error:
[Errno 2] No such file or directory: 'dbt_packages/dbt_date/macros/calendar_date'
[0m03:59:34.551508 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 152, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/main.py", line 492, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/deps.py", line 228, in run
    system.rmtree(self.project.packages_install_path)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/clients/system.py", line 570, in rmtree
    return shutil.rmtree(path, onerror=chmod_and_retry)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/shutil.py", line 759, in rmtree
    _rmtree_safe_fd(stack, onexc)
  File "/usr/local/lib/python3.12/shutil.py", line 703, in _rmtree_safe_fd
    onexc(func, path, err)
  File "/usr/local/lib/python3.12/shutil.py", line 750, in onexc
    return onerror(func, path, exc_info)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/shutil.py", line 700, in _rmtree_safe_fd
    onexc(os.unlink, fullname, err)
  File "/usr/local/lib/python3.12/shutil.py", line 750, in onexc
    return onerror(func, path, exc_info)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/shutil.py", line 698, in _rmtree_safe_fd
    os.unlink(entry.name, dir_fd=topfd)
FileNotFoundError: [Errno 2] No such file or directory: 'dbt_packages/dbt_date/macros/calendar_date'

[0m03:59:34.553524 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.26911694, "process_user_time": 2.454115, "process_kernel_time": 0.185673, "process_mem_max_rss": "218028", "process_in_blocks": "128", "command_success": false, "process_out_blocks": "0"}
[0m03:59:34.555056 [debug] [MainThread]: Command `dbt deps` failed at 03:59:34.554686 after 0.27 seconds
[0m03:59:34.555827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743853cc6f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743851637200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743851525100>]}
[0m03:59:34.556743 [debug] [MainThread]: Flushing usage events
[0m03:59:34.716643 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kexfjxdf'
[0m03:59:34.717558 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:59:35.194268 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:59:35.207830 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:59:35.340243 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:59:35.343890 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m03:59:35.471667 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m03:59:35.473278 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m03:59:35.474962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1e86bcc2-97cc-473d-afe0-293b8674b149', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76640f7c62a0>]}
[0m03:59:35.477785 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m03:59:35.612509 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m03:59:35.615195 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:59:42.132330 [info ] [MainThread]: Installed from version 1.3.1
[0m03:59:42.133484 [info ] [MainThread]: Up to date!
[0m03:59:42.134608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1e86bcc2-97cc-473d-afe0-293b8674b149', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76640f7c18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76640f51e5d0>]}
[0m03:59:42.135389 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m03:59:46.764844 [info ] [MainThread]: Installed from version 0.10.4
[0m03:59:46.765783 [info ] [MainThread]: Up to date!
[0m03:59:46.766701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1e86bcc2-97cc-473d-afe0-293b8674b149', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76640f6e11c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76640f6e1910>]}
[0m03:59:46.767354 [info ] [MainThread]: Installing calogica/dbt_date
[0m03:59:48.914418 [info ] [MainThread]: Installed from version 0.10.1
[0m03:59:48.916529 [info ] [MainThread]: Up to date!
[0m03:59:48.918434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1e86bcc2-97cc-473d-afe0-293b8674b149', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76640f6e1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76640f6e1250>]}
[0m03:59:48.921965 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 15.710246, "process_user_time": 2.778541, "process_kernel_time": 0.772977, "process_mem_max_rss": "262276", "process_out_blocks": "9808", "process_in_blocks": "0"}
[0m03:59:48.923487 [debug] [MainThread]: Command `dbt deps` succeeded at 03:59:48.923165 after 15.71 seconds
[0m03:59:48.924689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76641223ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766410497d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76640f65eb40>]}
[0m03:59:48.926456 [debug] [MainThread]: Flushing usage events
[0m04:00:10.469318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759b0e728c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759b0e729e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759b0e7289e0>]}


============================== 04:00:10.492143 | 3fc3bb0a-3d44-4a11-8265-4cb5816bba95 ==============================
[0m04:00:10.492143 [info ] [MainThread]: Running with dbt=1.7.9
[0m04:00:10.493765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'send_anonymous_usage_stats': 'True'}
[0m04:00:11.007052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf068f864b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf068ea53a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf068ea5820>]}


============================== 04:00:11.013493 | fc613d4c-fcc9-4364-a1fc-51e8b0beefeb ==============================
[0m04:00:11.013493 [info ] [MainThread]: Running with dbt=1.7.9
[0m04:00:11.014751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:00:11.120251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc613d4c-fcc9-4364-a1fc-51e8b0beefeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf068cb51c0>]}
[0m04:00:11.629399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fc3bb0a-3d44-4a11-8265-4cb5816bba95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ae1abc830>]}
[0m04:00:11.739423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fc3bb0a-3d44-4a11-8265-4cb5816bba95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ae1a8c4a0>]}
[0m04:00:11.740618 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m04:00:11.809092 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path /opt/airflow/dbt/retail/dbt_packages/dbt_utils/dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
    

Error encountered in /opt/airflow/dbt/retail/dbt_packages/dbt_utils
[0m04:00:11.810383 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4247466, "process_user_time": 3.889661, "process_kernel_time": 1.336819, "process_mem_max_rss": "262248", "process_out_blocks": "2408", "command_success": false, "process_in_blocks": "0"}
[0m04:00:11.811534 [debug] [MainThread]: Command `dbt run` failed at 04:00:11.811072 after 1.43 seconds
[0m04:00:11.812552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759b0e7289e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ae1ae4ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ae1715a60>]}
[0m04:00:11.813332 [debug] [MainThread]: Flushing usage events
[0m04:00:12.448257 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-k4v2hstg'
[0m04:00:12.449860 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:00:12.598141 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:00:12.599483 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:00:12.748619 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:00:12.752326 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m04:00:12.885772 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m04:00:12.889109 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m04:00:12.890934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fc613d4c-fcc9-4364-a1fc-51e8b0beefeb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf068b6cdd0>]}
[0m04:00:12.894240 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m04:00:13.029370 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m04:00:13.031940 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:00:20.138237 [info ] [MainThread]: Installed from version 1.3.1
[0m04:00:20.138921 [info ] [MainThread]: Up to date!
[0m04:00:20.139580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fc613d4c-fcc9-4364-a1fc-51e8b0beefeb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf068bb17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf068bb17c0>]}
[0m04:00:20.140179 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m04:00:24.642967 [info ] [MainThread]: Installed from version 0.10.4
[0m04:00:24.644336 [info ] [MainThread]: Up to date!
[0m04:00:24.645347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fc613d4c-fcc9-4364-a1fc-51e8b0beefeb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf068cb75f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf068cb4a40>]}
[0m04:00:24.646199 [info ] [MainThread]: Installing calogica/dbt_date
[0m04:00:27.221918 [info ] [MainThread]: Installed from version 0.10.1
[0m04:00:27.224549 [info ] [MainThread]: Up to date!
[0m04:00:27.226151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fc613d4c-fcc9-4364-a1fc-51e8b0beefeb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf068bb17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf068bb17c0>]}
[0m04:00:27.232494 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 16.33052, "process_user_time": 3.144575, "process_kernel_time": 0.900811, "process_mem_max_rss": "218028", "process_out_blocks": "7560", "process_in_blocks": "0"}
[0m04:00:27.234038 [debug] [MainThread]: Command `dbt deps` succeeded at 04:00:27.233678 after 16.33 seconds
[0m04:00:27.236082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf0693ce900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf068e1c140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf0690ff890>]}
[0m04:00:27.238034 [debug] [MainThread]: Flushing usage events
[0m04:00:35.455912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7169c47e5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7169c4a11550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7169c4968c20>]}


============================== 04:00:35.464846 | ee5dc27c-5e89-45e9-a39f-3f990bc1bb9c ==============================
[0m04:00:35.464846 [info ] [MainThread]: Running with dbt=1.7.9
[0m04:00:35.466093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:00:35.574612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee5dc27c-5e89-45e9-a39f-3f990bc1bb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7169c4965370>]}
[0m04:00:36.553886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796816451ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7968167687d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7968167b59a0>]}


============================== 04:00:36.573834 | 537e64d7-ac71-4f0a-8aba-fa9202ea5956 ==============================
[0m04:00:36.573834 [info ] [MainThread]: Running with dbt=1.7.9
[0m04:00:36.574793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'send_anonymous_usage_stats': 'True'}
[0m04:00:36.683352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '537e64d7-ac71-4f0a-8aba-fa9202ea5956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7968164c60f0>]}
[0m04:00:36.706463 [error] [MainThread]: Encountered an error:
[Errno 2] No such file or directory: 'dbt_packages/dbt_expectations/macros'
[0m04:00:36.708777 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 152, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/main.py", line 492, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/deps.py", line 228, in run
    system.rmtree(self.project.packages_install_path)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/clients/system.py", line 570, in rmtree
    return shutil.rmtree(path, onerror=chmod_and_retry)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/shutil.py", line 759, in rmtree
    _rmtree_safe_fd(stack, onexc)
  File "/usr/local/lib/python3.12/shutil.py", line 703, in _rmtree_safe_fd
    onexc(func, path, err)
  File "/usr/local/lib/python3.12/shutil.py", line 750, in onexc
    return onerror(func, path, exc_info)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/shutil.py", line 662, in _rmtree_safe_fd
    os.rmdir(name, dir_fd=dirfd)
FileNotFoundError: [Errno 2] No such file or directory: 'dbt_packages/dbt_expectations/macros'

[0m04:00:36.710576 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.24274471, "process_user_time": 2.755464, "process_kernel_time": 0.181546, "process_mem_max_rss": "226348", "process_out_blocks": "4208", "command_success": false, "process_in_blocks": "0"}
[0m04:00:36.711757 [debug] [MainThread]: Command `dbt deps` failed at 04:00:36.711421 after 0.24 seconds
[0m04:00:36.713441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7968167a2780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796816767260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796816878b00>]}
[0m04:00:36.718676 [debug] [MainThread]: Flushing usage events
[0m04:00:37.137873 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qrgt1cwe'
[0m04:00:37.140647 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:00:37.498588 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:00:37.499893 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:00:37.736829 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:00:37.740378 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m04:00:37.888927 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m04:00:37.891602 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m04:00:37.892591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ee5dc27c-5e89-45e9-a39f-3f990bc1bb9c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7169c472fbc0>]}
[0m04:00:37.894842 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m04:00:38.033200 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m04:00:38.036265 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:00:45.424743 [info ] [MainThread]: Installed from version 1.3.1
[0m04:00:45.425847 [info ] [MainThread]: Up to date!
[0m04:00:45.426811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ee5dc27c-5e89-45e9-a39f-3f990bc1bb9c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7169c469e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7169c469fa10>]}
[0m04:00:45.427746 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m04:00:49.815810 [info ] [MainThread]: Installed from version 0.10.4
[0m04:00:49.816609 [info ] [MainThread]: Up to date!
[0m04:00:49.817356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ee5dc27c-5e89-45e9-a39f-3f990bc1bb9c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7169c4571100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7169c4571040>]}
[0m04:00:49.817981 [info ] [MainThread]: Installing calogica/dbt_date
[0m04:00:52.327740 [info ] [MainThread]: Installed from version 0.10.1
[0m04:00:52.328444 [info ] [MainThread]: Up to date!
[0m04:00:52.329065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ee5dc27c-5e89-45e9-a39f-3f990bc1bb9c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7169c46c6630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7169c46c5dc0>]}
[0m04:00:52.331013 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 16.942263, "process_user_time": 2.615732, "process_kernel_time": 0.777867, "process_mem_max_rss": "218028", "process_out_blocks": "7560", "process_in_blocks": "0"}
[0m04:00:52.331830 [debug] [MainThread]: Command `dbt deps` succeeded at 04:00:52.331616 after 16.94 seconds
[0m04:00:52.332539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7169c47eb3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7169c4a11550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7169c5402000>]}
[0m04:00:52.333223 [debug] [MainThread]: Flushing usage events
[0m04:02:00.217060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8c25461e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8c261453a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8c254fcbf0>]}


============================== 04:02:00.223378 | 26641950-7e3e-41f9-81a5-84204321a39c ==============================
[0m04:02:00.223378 [info ] [MainThread]: Running with dbt=1.7.9
[0m04:02:00.224345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:02:00.326541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26641950-7e3e-41f9-81a5-84204321a39c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8c2558cd40>]}
[0m04:02:00.348969 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jnglp0nd'
[0m04:02:00.350277 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:02:00.636527 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:02:00.638028 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:02:00.768929 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:02:00.772979 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m04:02:00.900126 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m04:02:00.903510 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m04:02:00.904562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '26641950-7e3e-41f9-81a5-84204321a39c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8c252ecb90>]}
[0m04:02:00.908676 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m04:02:01.036459 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m04:02:01.039980 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:02:01.370047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db3a2115e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db3a9510a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db3a4b38c0>]}


============================== 04:02:01.391375 | 34a3c634-c6df-46be-8d5c-0b8f34d99c68 ==============================
[0m04:02:01.391375 [info ] [MainThread]: Running with dbt=1.7.9
[0m04:02:01.392743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:02:01.494464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34a3c634-c6df-46be-8d5c-0b8f34d99c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db3a2138f0>]}
[0m04:02:01.521682 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-j48kro97'
[0m04:02:01.522638 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:02:01.679759 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:02:01.680732 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:02:01.815914 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:02:01.819143 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m04:02:02.201509 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m04:02:02.202973 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m04:02:02.203873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '34a3c634-c6df-46be-8d5c-0b8f34d99c68', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db3a2cbbf0>]}
[0m04:02:02.206903 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m04:02:02.374637 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m04:02:02.377009 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:02:05.821126 [error] [MainThread]: Encountered an error:
[Errno 2] No such file or directory: 'dbt_packages/dbt-utils-1.3.1/macros/jinja_helpers/_is_relation.sql'
[0m04:02:05.821698 [info ] [MainThread]: Installed from version 1.3.1
[0m04:02:05.823102 [info ] [MainThread]: Up to date!
[0m04:02:05.824040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '26641950-7e3e-41f9-81a5-84204321a39c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8c253fbb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8c29d47e00>]}
[0m04:02:05.824726 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m04:02:05.826725 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 152, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/main.py", line 492, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/deps.py", line 255, in run
    package.install(self.project, renderer)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/deps/registry.py", line 66, in install
    self._install(project, renderer)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/deps/base.py", line 121, in _install
    connection_exception_retry(download_untar_fn, 5)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/utils.py", line 607, in _connection_exception_retry
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/deps/base.py", line 133, in download_and_untar
    system.untar_package(tar_path, deps_path, package_name)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/clients/system.py", line 500, in untar_package
    tarball.extractall(dest_dir)
  File "/usr/local/lib/python3.12/tarfile.py", line 2302, in extractall
    self._extract_one(tarinfo, path, set_attrs=not tarinfo.isdir(),
  File "/usr/local/lib/python3.12/tarfile.py", line 2369, in _extract_one
    self._handle_fatal_error(e)
  File "/usr/local/lib/python3.12/tarfile.py", line 2365, in _extract_one
    self._extract_member(tarinfo, os.path.join(path, tarinfo.name),
  File "/usr/local/lib/python3.12/tarfile.py", line 2448, in _extract_member
    self.makefile(tarinfo, targetpath)
  File "/usr/local/lib/python3.12/tarfile.py", line 2494, in makefile
    with bltn_open(targetpath, "wb") as target:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'dbt_packages/dbt-utils-1.3.1/macros/jinja_helpers/_is_relation.sql'

[0m04:02:05.828806 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 4.5482907, "process_user_time": 2.75044, "process_kernel_time": 0.37581, "process_mem_max_rss": "226496", "process_in_blocks": "80", "process_out_blocks": "4376", "command_success": false}
[0m04:02:05.830033 [debug] [MainThread]: Command `dbt deps` failed at 04:02:05.829736 after 4.55 seconds
[0m04:02:05.832137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db3a211af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db3a41ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db3a11a840>]}
[0m04:02:05.833251 [debug] [MainThread]: Flushing usage events
[0m04:02:10.794610 [info ] [MainThread]: Installed from version 0.10.4
[0m04:02:10.795635 [info ] [MainThread]: Up to date!
[0m04:02:10.796502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '26641950-7e3e-41f9-81a5-84204321a39c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8c251e9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8c251e93d0>]}
[0m04:02:10.797657 [info ] [MainThread]: Installing calogica/dbt_date
[0m04:02:13.196569 [info ] [MainThread]: Installed from version 0.10.1
[0m04:02:13.197744 [info ] [MainThread]: Up to date!
[0m04:02:13.198875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '26641950-7e3e-41f9-81a5-84204321a39c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8c2533f620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8c2533f2f0>]}
[0m04:02:13.201120 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 13.066936, "process_user_time": 2.912836, "process_kernel_time": 0.622976, "process_mem_max_rss": "218028", "process_out_blocks": "7560", "process_in_blocks": "0"}
[0m04:02:13.202030 [debug] [MainThread]: Command `dbt deps` succeeded at 04:02:13.201870 after 13.07 seconds
[0m04:02:13.202769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8c29d47e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8c256a54c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8c25316810>]}
[0m04:02:13.203478 [debug] [MainThread]: Flushing usage events
[0m04:02:28.786969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fce9f9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fceb56b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fcf655b20>]}


============================== 04:02:28.808558 | 59212214-16fa-4c01-b027-fa2cf113ff40 ==============================
[0m04:02:28.808558 [info ] [MainThread]: Running with dbt=1.7.9
[0m04:02:28.809714 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:02:28.907728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59212214-16fa-4c01-b027-fa2cf113ff40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fce87e030>]}
[0m04:02:30.309808 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ynhjqi_5'
[0m04:02:30.311130 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:02:30.479197 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:02:30.480340 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:02:30.611457 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:02:30.614602 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m04:02:30.750839 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m04:02:30.752982 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m04:02:30.754442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '59212214-16fa-4c01-b027-fa2cf113ff40', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fce710200>]}
[0m04:02:30.757383 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m04:02:30.897213 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m04:02:30.900601 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:02:37.955529 [info ] [MainThread]: Installed from version 1.3.1
[0m04:02:37.956445 [info ] [MainThread]: Up to date!
[0m04:02:37.957250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '59212214-16fa-4c01-b027-fa2cf113ff40', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fce7f6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fce7f64b0>]}
[0m04:02:37.958078 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m04:05:20.603481 [info ] [MainThread]: Installed from version 0.10.4
[0m04:05:20.605053 [info ] [MainThread]: Up to date!
[0m04:05:20.606365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '59212214-16fa-4c01-b027-fa2cf113ff40', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fce710e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fce7105c0>]}
[0m04:05:20.607922 [info ] [MainThread]: Installing calogica/dbt_date
[0m04:05:22.944813 [info ] [MainThread]: Installed from version 0.10.1
[0m04:05:22.945633 [info ] [MainThread]: Up to date!
[0m04:05:22.946368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '59212214-16fa-4c01-b027-fa2cf113ff40', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fce9fa120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fce9fa060>]}
[0m04:05:22.948677 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 174.61955, "process_user_time": 3.300342, "process_kernel_time": 0.951707, "process_mem_max_rss": "120340", "process_out_blocks": "20584", "process_in_blocks": "0"}
[0m04:05:22.950399 [debug] [MainThread]: Command `dbt deps` succeeded at 04:05:22.949780 after 174.62 seconds
[0m04:05:22.951602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fceb56b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fcecb7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fcea4c710>]}
[0m04:05:22.952835 [debug] [MainThread]: Flushing usage events
[0m04:05:37.540762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b4adc11c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b4adc02f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b4adc0140>]}


============================== 04:05:37.547934 | 8ebbcb82-05fc-4db1-8085-ed105d53d9e5 ==============================
[0m04:05:37.547934 [info ] [MainThread]: Running with dbt=1.7.9
[0m04:05:37.549034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:05:38.489125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ebbcb82-05fc-4db1-8085-ed105d53d9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b1dcd8830>]}
[0m04:05:38.564035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ebbcb82-05fc-4db1-8085-ed105d53d9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b4b63e9f0>]}
[0m04:05:38.565453 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m04:05:38.650344 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m04:05:44.830137 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:05:44.830846 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:05:44.832215 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.retail
[0m04:05:44.838164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ebbcb82-05fc-4db1-8085-ed105d53d9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b1dd0a150>]}
[0m04:05:44.885150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ebbcb82-05fc-4db1-8085-ed105d53d9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b1dc59070>]}
[0m04:05:44.886466 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 838 macros, 0 groups, 0 semantic models
[0m04:05:44.887436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ebbcb82-05fc-4db1-8085-ed105d53d9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b1d82b9b0>]}
[0m04:05:44.896172 [info ] [MainThread]: 
[0m04:05:44.897445 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:05:44.900247 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m04:05:44.901445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:05:45.924173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod_retail_stg)
[0m04:05:45.925261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:05:46.557888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ebbcb82-05fc-4db1-8085-ed105d53d9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b1d82ba40>]}
[0m04:05:46.559398 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:05:46.560257 [info ] [MainThread]: 
[0m04:05:46.568598 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m04:05:46.569153 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m04:05:46.569723 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod_retail_stg.bronze__orders ............. [RUN]
[0m04:05:46.570675 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod_retail_stg.bronze__users .............. [RUN]
[0m04:05:46.571906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod_retail_stg, now model.retail.bronze__orders)
[0m04:05:46.573077 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m04:05:46.573902 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m04:05:46.574467 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m04:05:46.582709 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m04:05:46.585340 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m04:05:46.593926 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 04:05:46.583031 => 04:05:46.593575
[0m04:05:46.594820 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m04:05:46.595601 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 04:05:46.575037 => 04:05:46.595232
[0m04:05:46.606904 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m04:05:46.642918 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m04:05:46.643880 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m04:05:46.654436 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:05:46.656228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:46.689802 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_stg`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m04:05:46.728076 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_stg`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m04:05:47.640150 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:981f145a-3d62-473c-9da9-bb16f54c8862&page=queryresults
[0m04:05:47.641185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:ad2d7d34-a41f-46f5-aee0-9f77b1d5b2db&page=queryresults
[0m04:05:47.643630 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid dataset ID "{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.; reason: invalid, location: retail-data-pipeline-dev.{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}.users, message: Invalid dataset ID "{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.')
[0m04:05:47.644750 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid dataset ID "{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.; reason: invalid, location: retail-data-pipeline-dev.{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}.orders, message: Invalid dataset ID "{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.')
[0m04:05:48.398637 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:1e3c30b0-e3e5-4fc7-aac9-0c96838e5633&page=queryresults
[0m04:05:48.400840 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:1e3c30b0-e3e5-4fc7-aac9-0c96838e5633&page=queryresults
[0m04:05:48.401934 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 04:05:46.612869 => 04:05:48.401710
[0m04:05:48.407884 [debug] [Thread-1 (]: Database Error in model bronze__orders (models/bronze/bronze__orders.sql)
  Invalid dataset ID "{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.
  compiled Code at target/run/retail/models/bronze/bronze__orders.sql
[0m04:05:48.408850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ebbcb82-05fc-4db1-8085-ed105d53d9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b1d86b4d0>]}
[0m04:05:48.409995 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model retail_prod_retail_stg.bronze__orders .... [[31mERROR[0m in 1.84s]
[0m04:05:48.411020 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m04:05:48.742661 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:e895a502-fc2d-4538-9249-fcb41d1d234e&page=queryresults
[0m04:05:48.744678 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:e895a502-fc2d-4538-9249-fcb41d1d234e&page=queryresults
[0m04:05:48.745898 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 04:05:46.596017 => 04:05:48.745633
[0m04:05:48.748799 [debug] [Thread-2 (]: Database Error in model bronze__users (models/bronze/bronze__users.sql)
  Invalid dataset ID "{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.
  compiled Code at target/run/retail/models/bronze/bronze__users.sql
[0m04:05:48.749460 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ebbcb82-05fc-4db1-8085-ed105d53d9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b1d8859a0>]}
[0m04:05:48.750178 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model retail_prod_retail_stg.bronze__users ..... [[31mERROR[0m in 2.18s]
[0m04:05:48.751181 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m04:05:48.754220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:05:48.755252 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m04:05:48.755845 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m04:05:48.756399 [info ] [MainThread]: 
[0m04:05:48.757047 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m04:05:48.758545 [debug] [MainThread]: Command end result
[0m04:05:48.792080 [info ] [MainThread]: 
[0m04:05:48.793468 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m04:05:48.794548 [info ] [MainThread]: 
[0m04:05:48.795573 [error] [MainThread]:   Database Error in model bronze__orders (models/bronze/bronze__orders.sql)
  Invalid dataset ID "{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.
  compiled Code at target/run/retail/models/bronze/bronze__orders.sql
[0m04:05:48.796492 [info ] [MainThread]: 
[0m04:05:48.797220 [error] [MainThread]:   Database Error in model bronze__users (models/bronze/bronze__users.sql)
  Invalid dataset ID "{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.
  compiled Code at target/run/retail/models/bronze/bronze__users.sql
[0m04:05:48.798162 [info ] [MainThread]: 
[0m04:05:48.799280 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m04:05:48.801462 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.324266, "process_user_time": 3.753731, "process_kernel_time": 1.303261, "process_mem_max_rss": "260468", "process_out_blocks": "160", "command_success": false, "process_in_blocks": "0"}
[0m04:05:48.802353 [debug] [MainThread]: Command `dbt run` failed at 04:05:48.802120 after 11.33 seconds
[0m04:05:48.803140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b4aef60f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b1d885520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b4ada8830>]}
[0m04:05:48.803865 [debug] [MainThread]: Flushing usage events
[0m04:08:07.578966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734ac3a44d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734ac3a46d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734ac3a44c50>]}


============================== 04:08:07.606647 | 375705ed-9430-40da-8c33-ee8ff854425c ==============================
[0m04:08:07.606647 [info ] [MainThread]: Running with dbt=1.7.9
[0m04:08:07.607550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:08:07.738444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '375705ed-9430-40da-8c33-ee8ff854425c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734ac3a460f0>]}
[0m04:08:09.166705 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-w89qosug'
[0m04:08:09.167770 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:08:09.516539 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:08:09.517851 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:08:09.665686 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:08:09.669845 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m04:08:09.958480 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m04:08:09.960222 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m04:08:09.960999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '375705ed-9430-40da-8c33-ee8ff854425c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734ac48b58e0>]}
[0m04:08:09.963056 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m04:08:10.114153 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m04:08:10.117045 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:08:17.859644 [info ] [MainThread]: Installed from version 1.3.1
[0m04:08:17.860949 [info ] [MainThread]: Up to date!
[0m04:08:17.862233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '375705ed-9430-40da-8c33-ee8ff854425c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734ac4112600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734ac38d4c80>]}
[0m04:08:17.863186 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m04:08:23.170096 [info ] [MainThread]: Installed from version 0.10.4
[0m04:08:23.171244 [info ] [MainThread]: Up to date!
[0m04:08:23.172353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '375705ed-9430-40da-8c33-ee8ff854425c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734ac38cbc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734ac380a360>]}
[0m04:08:23.173486 [info ] [MainThread]: Installing calogica/dbt_date
[0m04:08:25.578235 [info ] [MainThread]: Installed from version 0.10.1
[0m04:08:25.579132 [info ] [MainThread]: Up to date!
[0m04:08:25.579950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '375705ed-9430-40da-8c33-ee8ff854425c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734ac380a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734ac380a2d0>]}
[0m04:08:25.581860 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 18.091223, "process_user_time": 3.754441, "process_kernel_time": 1.034429, "process_mem_max_rss": "120436", "process_out_blocks": "20584", "process_in_blocks": "0"}
[0m04:08:25.582554 [debug] [MainThread]: Command `dbt deps` succeeded at 04:08:25.582424 after 18.09 seconds
[0m04:08:25.583230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734ac3c099d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734ac4124e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734ac421d4f0>]}
[0m04:08:25.583936 [debug] [MainThread]: Flushing usage events
[0m04:08:39.307431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75572f838530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75572f961250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75572fac1940>]}


============================== 04:08:39.313528 | ca22e12b-2f99-41ee-9164-b73e74b2ff7f ==============================
[0m04:08:39.313528 [info ] [MainThread]: Running with dbt=1.7.9
[0m04:08:39.314614 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'send_anonymous_usage_stats': 'True'}
[0m04:08:40.294544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca22e12b-2f99-41ee-9164-b73e74b2ff7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7557027774d0>]}
[0m04:08:40.378850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca22e12b-2f99-41ee-9164-b73e74b2ff7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755703071eb0>]}
[0m04:08:40.380283 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m04:08:40.482758 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m04:08:40.531660 [info ] [MainThread]: Unable to do partial parsing because env vars used in dbt_project.yml have changed
[0m04:08:40.532641 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m04:08:40.533722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ca22e12b-2f99-41ee-9164-b73e74b2ff7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7557023d4c80>]}
[0m04:08:48.409419 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.retail
[0m04:08:48.415930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca22e12b-2f99-41ee-9164-b73e74b2ff7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75570091bfe0>]}
[0m04:08:48.461892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca22e12b-2f99-41ee-9164-b73e74b2ff7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75570248e570>]}
[0m04:08:48.463039 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 838 macros, 0 groups, 0 semantic models
[0m04:08:48.464634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca22e12b-2f99-41ee-9164-b73e74b2ff7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755702677ec0>]}
[0m04:08:48.473618 [info ] [MainThread]: 
[0m04:08:48.474971 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:08:48.476875 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m04:08:48.477987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:08:49.300479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now create_retail-data-pipeline-dev_retail_prod_retail_raw)
[0m04:08:49.302376 [debug] [ThreadPool]: Creating schema "database: "retail-data-pipeline-dev"
schema: "retail_prod_retail_raw"
"
[0m04:08:49.310978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:08:49.357795 [debug] [ThreadPool]: On create_retail-data-pipeline-dev_retail_prod_retail_raw: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "connection_name": "create_retail-data-pipeline-dev_retail_prod_retail_raw"} */
create schema if not exists `retail-data-pipeline-dev`.`retail_prod_retail_raw`
  
[0m04:08:49.991941 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:63687d7a-b1d2-4e3f-99a1-ec30e49dac9d&page=queryresults
[0m04:08:54.292868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_retail-data-pipeline-dev_retail_prod_retail_raw, now list_retail-data-pipeline-dev_retail_prod_retail_raw)
[0m04:08:54.293666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:08:54.872345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca22e12b-2f99-41ee-9164-b73e74b2ff7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7557022ec7a0>]}
[0m04:08:54.874119 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:08:54.875530 [info ] [MainThread]: 
[0m04:08:54.887821 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m04:08:54.889043 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m04:08:54.890003 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod_retail_raw.bronze__orders ............. [RUN]
[0m04:08:54.891400 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod_retail_raw.bronze__users .............. [RUN]
[0m04:08:54.893386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod_retail_raw, now model.retail.bronze__orders)
[0m04:08:54.894921 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m04:08:54.895653 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m04:08:54.896372 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m04:08:54.903913 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m04:08:54.908671 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m04:08:54.920857 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 04:08:54.897142 => 04:08:54.920305
[0m04:08:54.921919 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 04:08:54.905068 => 04:08:54.921672
[0m04:08:54.922572 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m04:08:54.923603 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m04:08:54.976838 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m04:08:54.977575 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m04:08:54.987492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:54.990459 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:08:55.028236 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_raw`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m04:08:55.065031 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_raw`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m04:08:55.640240 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:39438b9b-65c9-4dc9-aec1-88d3aab4379d&page=queryresults
[0m04:08:55.642668 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid dataset ID "{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.; reason: invalid, location: retail-data-pipeline-dev.{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}.orders, message: Invalid dataset ID "{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.')
[0m04:08:55.676621 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:7f31e59c-8783-45ee-bc1c-94b467a2d2d4&page=queryresults
[0m04:08:55.678593 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid dataset ID "{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.; reason: invalid, location: retail-data-pipeline-dev.{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}.users, message: Invalid dataset ID "{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.')
[0m04:08:56.090048 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:b9d41713-19cb-46ed-aaa7-6cedbb9bb018&page=queryresults
[0m04:08:56.091897 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:b9d41713-19cb-46ed-aaa7-6cedbb9bb018&page=queryresults
[0m04:08:56.093285 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 04:08:54.931045 => 04:08:56.093015
[0m04:08:56.098762 [debug] [Thread-2 (]: Database Error in model bronze__users (models/bronze/bronze__users.sql)
  Invalid dataset ID "{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.
  compiled Code at target/run/retail/models/bronze/bronze__users.sql
[0m04:08:56.099852 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca22e12b-2f99-41ee-9164-b73e74b2ff7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75570077ac30>]}
[0m04:08:56.100804 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model retail_prod_retail_raw.bronze__users ..... [[31mERROR[0m in 1.21s]
[0m04:08:56.102141 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m04:08:56.230412 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:24cc2cda-be91-43e3-ad6a-cc7488e29d12&page=queryresults
[0m04:08:56.232556 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:24cc2cda-be91-43e3-ad6a-cc7488e29d12&page=queryresults
[0m04:08:56.234103 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 04:08:54.924150 => 04:08:56.233794
[0m04:08:56.236918 [debug] [Thread-1 (]: Database Error in model bronze__orders (models/bronze/bronze__orders.sql)
  Invalid dataset ID "{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.
  compiled Code at target/run/retail/models/bronze/bronze__orders.sql
[0m04:08:56.237784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca22e12b-2f99-41ee-9164-b73e74b2ff7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75570080b650>]}
[0m04:08:56.238566 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model retail_prod_retail_raw.bronze__orders .... [[31mERROR[0m in 1.34s]
[0m04:08:56.239577 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m04:08:56.242908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:08:56.243728 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m04:08:56.244366 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m04:08:56.245085 [info ] [MainThread]: 
[0m04:08:56.246461 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 7.77 seconds (7.77s).
[0m04:08:56.247798 [debug] [MainThread]: Command end result
[0m04:08:56.287775 [info ] [MainThread]: 
[0m04:08:56.289154 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m04:08:56.290224 [info ] [MainThread]: 
[0m04:08:56.291302 [error] [MainThread]:   Database Error in model bronze__users (models/bronze/bronze__users.sql)
  Invalid dataset ID "{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.
  compiled Code at target/run/retail/models/bronze/bronze__users.sql
[0m04:08:56.292260 [info ] [MainThread]: 
[0m04:08:56.293125 [error] [MainThread]:   Database Error in model bronze__orders (models/bronze/bronze__orders.sql)
  Invalid dataset ID "{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.
  compiled Code at target/run/retail/models/bronze/bronze__orders.sql
[0m04:08:56.294059 [info ] [MainThread]: 
[0m04:08:56.295157 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m04:08:56.296915 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 17.072042, "process_user_time": 5.093414, "process_kernel_time": 1.49619, "process_mem_max_rss": "260472", "process_out_blocks": "160", "command_success": false, "process_in_blocks": "0"}
[0m04:08:56.297809 [debug] [MainThread]: Command `dbt run` failed at 04:08:56.297637 after 17.07 seconds
[0m04:08:56.298525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75572f961250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755702433230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7557029a95e0>]}
[0m04:08:56.299220 [debug] [MainThread]: Flushing usage events
[0m04:10:33.719520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a70757560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a70a22540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a70755010>]}


============================== 04:10:33.745938 | 87c50ea4-5e79-4ca1-88bd-7db64e4d3b9e ==============================
[0m04:10:33.745938 [info ] [MainThread]: Running with dbt=1.7.9
[0m04:10:33.747447 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:10:33.870912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87c50ea4-5e79-4ca1-88bd-7db64e4d3b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a7086ac00>]}
[0m04:10:35.388333 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 1.7697228, "process_user_time": 3.969997, "process_kernel_time": 0.414472, "process_mem_max_rss": "119940", "process_out_blocks": "13024", "process_in_blocks": "0"}
[0m04:10:35.389829 [debug] [MainThread]: Command `dbt clean` succeeded at 04:10:35.389476 after 1.77 seconds
[0m04:10:35.391288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a70a22540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a707af980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a7086ac00>]}
[0m04:10:35.392810 [debug] [MainThread]: Flushing usage events
[0m04:10:39.458199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd60788c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd60788ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd60788c2c0>]}


============================== 04:10:39.465342 | d69eb8d1-6f3d-40cc-8ae7-8b7069597f15 ==============================
[0m04:10:39.465342 [info ] [MainThread]: Running with dbt=1.7.9
[0m04:10:39.466289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:10:39.571891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd69eb8d1-6f3d-40cc-8ae7-8b7069597f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd607697650>]}
[0m04:10:39.595991 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-d789lrlx'
[0m04:10:39.596971 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:10:40.134809 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:10:40.136057 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:10:40.290558 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:10:40.294710 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m04:10:40.438370 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m04:10:40.440840 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m04:10:40.441763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd69eb8d1-6f3d-40cc-8ae7-8b7069597f15', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd60774b5f0>]}
[0m04:10:40.444187 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m04:10:40.790245 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m04:10:40.792978 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:10:48.362204 [info ] [MainThread]: Installed from version 1.3.1
[0m04:10:48.363572 [info ] [MainThread]: Up to date!
[0m04:10:48.364309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd69eb8d1-6f3d-40cc-8ae7-8b7069597f15', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd607697710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd607875190>]}
[0m04:10:48.364959 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m04:11:07.364861 [debug] [MainThread]: External call exception: HTTPSConnectionPool(host='codeload.github.com', port=443): Read timed out.
[0m04:11:07.366385 [debug] [MainThread]: Retrying external call. Attempt: 0 Max attempts: 5
[0m04:11:15.638171 [info ] [MainThread]: Installed from version 0.10.4
[0m04:11:15.639362 [info ] [MainThread]: Up to date!
[0m04:11:15.640418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd69eb8d1-6f3d-40cc-8ae7-8b7069597f15', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd607620f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd607620f50>]}
[0m04:11:15.641458 [info ] [MainThread]: Installing calogica/dbt_date
[0m04:11:18.037268 [info ] [MainThread]: Installed from version 0.10.1
[0m04:11:18.038186 [info ] [MainThread]: Up to date!
[0m04:11:18.038927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd69eb8d1-6f3d-40cc-8ae7-8b7069597f15', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd607620fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd607621070>]}
[0m04:11:18.041453 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 38.73335, "process_user_time": 2.61563, "process_kernel_time": 0.66721, "process_mem_max_rss": "117260", "process_out_blocks": "7560", "process_in_blocks": "0"}
[0m04:11:18.042549 [debug] [MainThread]: Command `dbt deps` succeeded at 04:11:18.042230 after 38.73 seconds
[0m04:11:18.043928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd6077bc560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd607748410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd60774a180>]}
[0m04:11:18.044848 [debug] [MainThread]: Flushing usage events
[0m04:11:31.789633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44d5c8ad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44d5ee78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44d5f50bc0>]}


============================== 04:11:31.795586 | e578efc9-e71e-47f1-92e7-7909c0f3944e ==============================
[0m04:11:31.795586 [info ] [MainThread]: Running with dbt=1.7.9
[0m04:11:31.796428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:11:32.831191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e578efc9-e71e-47f1-92e7-7909c0f3944e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44accf7890>]}
[0m04:11:32.918277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e578efc9-e71e-47f1-92e7-7909c0f3944e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44afadf950>]}
[0m04:11:32.919911 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m04:11:33.018687 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m04:11:33.040094 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m04:11:33.040922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e578efc9-e71e-47f1-92e7-7909c0f3944e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44acc55490>]}
[0m04:11:41.611159 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.retail
[0m04:11:41.618003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e578efc9-e71e-47f1-92e7-7909c0f3944e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c449edb7d70>]}
[0m04:11:41.675008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e578efc9-e71e-47f1-92e7-7909c0f3944e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44aca6f3e0>]}
[0m04:11:41.676122 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 838 macros, 0 groups, 0 semantic models
[0m04:11:41.677309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e578efc9-e71e-47f1-92e7-7909c0f3944e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c449ee9b230>]}
[0m04:11:41.688851 [info ] [MainThread]: 
[0m04:11:41.690616 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:11:41.692914 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m04:11:41.693753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:11:42.732884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod_retail_raw)
[0m04:11:42.733904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:11:43.384843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e578efc9-e71e-47f1-92e7-7909c0f3944e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44ac8f7ef0>]}
[0m04:11:43.386429 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:11:43.387660 [info ] [MainThread]: 
[0m04:11:43.404141 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m04:11:43.406603 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m04:11:43.407625 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod_retail_raw.bronze__orders ............. [RUN]
[0m04:11:43.409157 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod_retail_raw.bronze__users .............. [RUN]
[0m04:11:43.410481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod_retail_raw, now model.retail.bronze__orders)
[0m04:11:43.411520 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m04:11:43.412536 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m04:11:43.413275 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m04:11:43.421477 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m04:11:43.424816 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m04:11:43.448679 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 04:11:43.413907 => 04:11:43.448187
[0m04:11:43.450135 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m04:11:43.460701 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 04:11:43.422006 => 04:11:43.460401
[0m04:11:43.467105 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m04:11:43.497550 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m04:11:43.500013 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m04:11:43.525620 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:11:43.529241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:11:43.561290 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_raw`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m04:11:43.601856 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_raw`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m04:11:44.318348 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:f80ab0bb-c1da-4622-bcd1-937e5fd0e4d8&page=queryresults
[0m04:11:44.321118 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid dataset ID "{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.; reason: invalid, location: retail-data-pipeline-dev.{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}.orders, message: Invalid dataset ID "{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.')
[0m04:11:44.551504 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:52da8a3b-6e56-4f7d-888a-f6b44f51eae6&page=queryresults
[0m04:11:44.553424 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid dataset ID "{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.; reason: invalid, location: retail-data-pipeline-dev.{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}.users, message: Invalid dataset ID "{{ env_var(\'DBT_RAW_DATASET\', \'retail_raw\') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.')
[0m04:11:44.779944 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:3e891fba-a8b5-4c5f-9437-2e66c7150e80&page=queryresults
[0m04:11:44.781560 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:3e891fba-a8b5-4c5f-9437-2e66c7150e80&page=queryresults
[0m04:11:44.782570 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 04:11:43.473270 => 04:11:44.782353
[0m04:11:44.786497 [debug] [Thread-2 (]: Database Error in model bronze__users (models/bronze/bronze__users.sql)
  Invalid dataset ID "{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.
  compiled Code at target/run/retail/models/bronze/bronze__users.sql
[0m04:11:44.787218 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e578efc9-e71e-47f1-92e7-7909c0f3944e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c449eda1010>]}
[0m04:11:44.788153 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model retail_prod_retail_raw.bronze__users ..... [[31mERROR[0m in 1.38s]
[0m04:11:44.790078 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m04:11:45.404806 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:bc2097fc-ea20-4949-af18-d6880316d5b1&page=queryresults
[0m04:11:45.406580 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:bc2097fc-ea20-4949-af18-d6880316d5b1&page=queryresults
[0m04:11:45.407725 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 04:11:43.451360 => 04:11:45.407439
[0m04:11:45.411069 [debug] [Thread-1 (]: Database Error in model bronze__orders (models/bronze/bronze__orders.sql)
  Invalid dataset ID "{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.
  compiled Code at target/run/retail/models/bronze/bronze__orders.sql
[0m04:11:45.412599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e578efc9-e71e-47f1-92e7-7909c0f3944e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c449ec26150>]}
[0m04:11:45.413912 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model retail_prod_retail_raw.bronze__orders .... [[31mERROR[0m in 2.00s]
[0m04:11:45.415098 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m04:11:45.418593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:11:45.419557 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m04:11:45.420129 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m04:11:45.420698 [info ] [MainThread]: 
[0m04:11:45.421379 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.73 seconds (3.73s).
[0m04:11:45.422395 [debug] [MainThread]: Command end result
[0m04:11:45.461398 [info ] [MainThread]: 
[0m04:11:45.462885 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m04:11:45.463962 [info ] [MainThread]: 
[0m04:11:45.464850 [error] [MainThread]:   Database Error in model bronze__users (models/bronze/bronze__users.sql)
  Invalid dataset ID "{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.
  compiled Code at target/run/retail/models/bronze/bronze__users.sql
[0m04:11:45.466111 [info ] [MainThread]: 
[0m04:11:45.467361 [error] [MainThread]:   Database Error in model bronze__orders (models/bronze/bronze__orders.sql)
  Invalid dataset ID "{{ env_var('DBT_RAW_DATASET', 'retail_raw') }}". Dataset IDs must be alphanumeric (plus underscores and dashes) and must be at most 1024 characters long.
  compiled Code at target/run/retail/models/bronze/bronze__orders.sql
[0m04:11:45.468270 [info ] [MainThread]: 
[0m04:11:45.469351 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m04:11:45.470795 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.748876, "process_user_time": 6.090594, "process_kernel_time": 1.540293, "process_mem_max_rss": "260528", "process_out_blocks": "160", "command_success": false, "process_in_blocks": "0"}
[0m04:11:45.471671 [debug] [MainThread]: Command `dbt run` failed at 04:11:45.471513 after 13.75 seconds
[0m04:11:45.472334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44d5ee78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44acbdaa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44acd8cf80>]}
[0m04:11:45.472892 [debug] [MainThread]: Flushing usage events
[0m04:12:20.100033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c0ea88d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c0ea8fcaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c0ea88f530>]}


============================== 04:12:20.133604 | 659ff869-412b-4050-aafa-37724919b78c ==============================
[0m04:12:20.133604 [info ] [MainThread]: Running with dbt=1.7.9
[0m04:12:20.134464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:12:20.136962 [info ] [MainThread]: dbt version: 1.7.9
[0m04:12:20.137614 [info ] [MainThread]: python version: 3.12.10
[0m04:12:20.138447 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m04:12:20.139546 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m04:12:22.824733 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt/retail
[0m04:12:22.825881 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt/retail/profiles.yml
[0m04:12:22.827530 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/retail/dbt_project.yml
[0m04:12:22.828977 [info ] [MainThread]: adapter type: bigquery
[0m04:12:22.829850 [info ] [MainThread]: adapter version: 1.7.5
[0m04:12:22.930171 [info ] [MainThread]: Configuration:
[0m04:12:22.934571 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m04:12:22.936783 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m04:12:22.937686 [info ] [MainThread]: Required dependencies:
[0m04:12:22.939194 [debug] [MainThread]: Executing "git --help"
[0m04:12:22.945610 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m04:12:22.947148 [info ] [MainThread]: Connection:
[0m04:12:22.948775 [info ] [MainThread]:   method: service-account
[0m04:12:22.950864 [info ] [MainThread]:   database: retail-data-pipeline-dev
[0m04:12:22.952312 [info ] [MainThread]:   execution_project: retail-data-pipeline-dev
[0m04:12:22.953693 [info ] [MainThread]:   schema: retail_prod
[0m04:12:22.954678 [info ] [MainThread]:   location: asia-southeast1
[0m04:12:22.955433 [info ] [MainThread]:   priority: interactive
[0m04:12:22.956162 [info ] [MainThread]:   maximum_bytes_billed: None
[0m04:12:22.956798 [info ] [MainThread]:   impersonate_service_account: None
[0m04:12:22.957453 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m04:12:22.958505 [info ] [MainThread]:   job_retries: 1
[0m04:12:22.959645 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m04:12:22.960495 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m04:12:22.961837 [info ] [MainThread]:   keyfile: /opt/airflow/keys/airflow-sa.json
[0m04:12:22.963000 [info ] [MainThread]:   timeout_seconds: 300
[0m04:12:22.963807 [info ] [MainThread]:   client_id: None
[0m04:12:22.964399 [info ] [MainThread]:   token_uri: None
[0m04:12:22.964990 [info ] [MainThread]:   dataproc_region: None
[0m04:12:22.965612 [info ] [MainThread]:   dataproc_cluster_name: None
[0m04:12:22.966319 [info ] [MainThread]:   gcs_bucket: None
[0m04:12:22.966871 [info ] [MainThread]:   dataproc_batch: None
[0m04:12:22.967589 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m04:12:22.968709 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m04:12:22.969614 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:12:23.007403 [debug] [MainThread]: On debug: select 1 as id
[0m04:12:27.494568 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:d6108c4a-26b5-4755-a46e-4ff9ffd7bdfb&page=queryresults
[0m04:12:27.854353 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m04:12:27.855436 [info ] [MainThread]: [31m1 check failed:[0m
[0m04:12:27.856719 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m04:12:27.859166 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 7.920033, "process_user_time": 6.82284, "process_kernel_time": 1.662842, "process_mem_max_rss": "232880", "process_out_blocks": "53616", "command_success": false, "process_in_blocks": "0"}
[0m04:12:27.860574 [debug] [MainThread]: Command `dbt debug` failed at 04:12:27.860328 after 7.92 seconds
[0m04:12:27.861493 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m04:12:27.862286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c0ef32f440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c0ef32f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c0bdb91b20>]}
[0m04:12:27.863058 [debug] [MainThread]: Flushing usage events
[0m04:12:51.411317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aef74ceb1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aef74594bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aef74337a40>]}


============================== 04:12:51.445829 | 2dea4a68-9b39-485c-aa02-26616e4468b5 ==============================
[0m04:12:51.445829 [info ] [MainThread]: Running with dbt=1.7.9
[0m04:12:51.447284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ls --resource-type source --output json', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:12:54.678998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2dea4a68-9b39-485c-aa02-26616e4468b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aef471af980>]}
[0m04:12:54.764895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2dea4a68-9b39-485c-aa02-26616e4468b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aef4727a8a0>]}
[0m04:12:54.766190 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m04:12:54.875575 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m04:13:01.692922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:13:01.693718 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:13:01.695038 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.retail
[0m04:13:01.700209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2dea4a68-9b39-485c-aa02-26616e4468b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aef47387d40>]}
[0m04:13:01.748334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2dea4a68-9b39-485c-aa02-26616e4468b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aef46d49100>]}
[0m04:13:01.749364 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 838 macros, 0 groups, 0 semantic models
[0m04:13:01.750123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dea4a68-9b39-485c-aa02-26616e4468b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aef4da28f50>]}
[0m04:13:01.752762 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 10.535629, "process_user_time": 7.327274, "process_kernel_time": 1.738471, "process_mem_max_rss": "237976", "process_out_blocks": "53616", "process_in_blocks": "0"}
[0m04:13:01.753953 [debug] [MainThread]: Command `dbt ls` succeeded at 04:13:01.753633 after 10.54 seconds
[0m04:13:01.755122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aef745a4b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aef476dc860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aef4c4a3440>]}
[0m04:13:01.756545 [debug] [MainThread]: Flushing usage events
[0m04:13:32.624728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76108d686090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76108d685100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76108d684e90>]}


============================== 04:13:32.647937 | 2bf0691f-a369-40cd-b699-0fbdde0f7ad9 ==============================
[0m04:13:32.647937 [info ] [MainThread]: Running with dbt=1.7.9
[0m04:13:32.648982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:13:35.785894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bf0691f-a369-40cd-b699-0fbdde0f7ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76108d685850>]}
[0m04:13:35.860198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bf0691f-a369-40cd-b699-0fbdde0f7ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76108910e870>]}
[0m04:13:35.861708 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m04:13:36.035558 [debug] [MainThread]: checksum: da3f3fd19af0b14e2e45b34d8a09fd4695d9e53cdd1b7bca5d37bbdb008d784a, vars: {}, profile: , target: dev, version: 1.7.9
[0m04:13:36.113445 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m04:13:36.115183 [debug] [MainThread]: previous checksum: da3f3fd19af0b14e2e45b34d8a09fd4695d9e53cdd1b7bca5d37bbdb008d784a, current checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39
[0m04:13:36.117399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2bf0691f-a369-40cd-b699-0fbdde0f7ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76105ff96270>]}
[0m04:13:44.062311 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.retail
[0m04:13:44.068281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bf0691f-a369-40cd-b699-0fbdde0f7ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7610642f97c0>]}
[0m04:13:44.114666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bf0691f-a369-40cd-b699-0fbdde0f7ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76105e7cbb90>]}
[0m04:13:44.115877 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 838 macros, 0 groups, 0 semantic models
[0m04:13:44.116551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bf0691f-a369-40cd-b699-0fbdde0f7ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76105ffc4ef0>]}
[0m04:13:44.119277 [info ] [MainThread]: 
[0m04:13:44.120613 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:13:44.122290 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev_retail_prod_retail_raw'
[0m04:13:44.123195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:13:44.882256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bf0691f-a369-40cd-b699-0fbdde0f7ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76105fe3bcb0>]}
[0m04:13:44.883478 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:13:44.884149 [info ] [MainThread]: 
[0m04:13:44.892256 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m04:13:44.892784 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m04:13:44.893222 [debug] [Thread-3 (]: Began running node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m04:13:44.894176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod_retail_raw, now model.retail.bronze__orders)
[0m04:13:44.894873 [debug] [Thread-4 (]: Began running node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m04:13:44.896400 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m04:13:44.898120 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2'
[0m04:13:44.899291 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m04:13:44.900777 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336'
[0m04:13:44.901723 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m04:13:44.902901 [debug] [Thread-3 (]: Began compiling node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m04:13:44.909279 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m04:13:44.909774 [debug] [Thread-4 (]: Began compiling node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m04:13:44.913979 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m04:13:44.927833 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"
[0m04:13:44.934991 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"
[0m04:13:44.940011 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 04:13:44.903709 => 04:13:44.939519
[0m04:13:44.940920 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 04:13:44.910901 => 04:13:44.940562
[0m04:13:44.941445 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m04:13:44.942207 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m04:13:44.942991 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 04:13:44.942777 => 04:13:44.942795
[0m04:13:44.943623 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 04:13:44.943436 => 04:13:44.943446
[0m04:13:44.945285 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m04:13:44.946200 [debug] [Thread-3 (]: Timing info for test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2 (compile): 04:13:44.915257 => 04:13:44.945717
[0m04:13:44.947684 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m04:13:44.948888 [debug] [Thread-1 (]: Began running node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m04:13:44.950015 [debug] [Thread-3 (]: Began executing node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m04:13:44.950882 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336 (compile): 04:13:44.928529 => 04:13:44.950588
[0m04:13:44.951364 [debug] [Thread-2 (]: Began running node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m04:13:44.952508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.bronze__orders, now test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6)
[0m04:13:44.953526 [debug] [Thread-3 (]: Timing info for test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2 (execute): 04:13:44.953292 => 04:13:44.953303
[0m04:13:44.954525 [debug] [Thread-4 (]: Began executing node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m04:13:44.955768 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail.bronze__users, now test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194)
[0m04:13:44.956444 [debug] [Thread-1 (]: Began compiling node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m04:13:44.957483 [debug] [Thread-3 (]: Finished running node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m04:13:44.958152 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336 (execute): 04:13:44.957958 => 04:13:44.957966
[0m04:13:44.958767 [debug] [Thread-2 (]: Began compiling node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m04:13:44.963633 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"
[0m04:13:44.964703 [debug] [Thread-3 (]: Began running node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m04:13:44.965991 [debug] [Thread-4 (]: Finished running node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m04:13:44.970752 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"
[0m04:13:44.972258 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2, now test.retail.source_not_null_raw_csv_users_user_id.3380c1257d)
[0m04:13:44.973108 [debug] [Thread-4 (]: Began running node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m04:13:44.974129 [debug] [Thread-3 (]: Began compiling node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m04:13:44.975400 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336, now test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53)
[0m04:13:44.979991 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"
[0m04:13:44.980825 [debug] [Thread-4 (]: Began compiling node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m04:13:44.988430 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"
[0m04:13:44.990217 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194 (compile): 04:13:44.966582 => 04:13:44.989795
[0m04:13:44.991161 [debug] [Thread-2 (]: Began executing node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m04:13:44.992245 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194 (execute): 04:13:44.991843 => 04:13:44.991864
[0m04:13:44.993006 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6 (compile): 04:13:44.959249 => 04:13:44.992594
[0m04:13:44.994100 [debug] [Thread-2 (]: Finished running node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m04:13:44.995086 [debug] [Thread-3 (]: Timing info for test.retail.source_not_null_raw_csv_users_user_id.3380c1257d (compile): 04:13:44.976217 => 04:13:44.994586
[0m04:13:44.995673 [debug] [Thread-1 (]: Began executing node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m04:13:44.997832 [debug] [Thread-2 (]: Began running node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m04:13:44.998916 [debug] [Thread-3 (]: Began executing node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m04:13:45.000083 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6 (execute): 04:13:44.999761 => 04:13:44.999777
[0m04:13:45.001034 [debug] [Thread-4 (]: Timing info for test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53 (compile): 04:13:44.981741 => 04:13:45.000524
[0m04:13:45.001950 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194, now test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1)
[0m04:13:45.003143 [debug] [Thread-3 (]: Timing info for test.retail.source_not_null_raw_csv_users_user_id.3380c1257d (execute): 04:13:45.002803 => 04:13:45.002817
[0m04:13:45.004500 [debug] [Thread-1 (]: Finished running node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m04:13:45.005239 [debug] [Thread-4 (]: Began executing node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m04:13:45.005877 [debug] [Thread-2 (]: Began compiling node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m04:13:45.007244 [debug] [Thread-3 (]: Finished running node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m04:13:45.008248 [debug] [Thread-1 (]: Began running node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m04:13:45.009177 [debug] [Thread-4 (]: Timing info for test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53 (execute): 04:13:45.008957 => 04:13:45.008966
[0m04:13:45.013561 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"
[0m04:13:45.014834 [debug] [Thread-3 (]: Began running node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m04:13:45.016073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6, now test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8)
[0m04:13:45.018135 [debug] [Thread-4 (]: Finished running node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m04:13:45.019848 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_users_user_id.3380c1257d, now test.retail.source_unique_raw_csv_users_user_id.d8f871acc9)
[0m04:13:45.020785 [debug] [Thread-1 (]: Began compiling node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m04:13:45.021618 [debug] [Thread-4 (]: Began running node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m04:13:45.022525 [debug] [Thread-3 (]: Began compiling node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m04:13:45.026993 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"
[0m04:13:45.028170 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53, now test.retail.not_null_bronze__orders_order_created_at.05e711bf75)
[0m04:13:45.033230 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"
[0m04:13:45.034923 [debug] [Thread-4 (]: Began compiling node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m04:13:45.036435 [debug] [Thread-2 (]: Timing info for test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1 (compile): 04:13:45.009765 => 04:13:45.036085
[0m04:13:45.042553 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"
[0m04:13:45.043665 [debug] [Thread-2 (]: Began executing node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m04:13:45.045298 [debug] [Thread-1 (]: Timing info for test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8 (compile): 04:13:45.023132 => 04:13:45.044745
[0m04:13:45.046206 [debug] [Thread-2 (]: Timing info for test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1 (execute): 04:13:45.045936 => 04:13:45.045948
[0m04:13:45.047352 [debug] [Thread-1 (]: Began executing node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m04:13:45.049145 [debug] [Thread-2 (]: Finished running node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m04:13:45.050020 [debug] [Thread-3 (]: Timing info for test.retail.source_unique_raw_csv_users_user_id.d8f871acc9 (compile): 04:13:45.029032 => 04:13:45.049682
[0m04:13:45.050983 [debug] [Thread-1 (]: Timing info for test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8 (execute): 04:13:45.050571 => 04:13:45.050586
[0m04:13:45.052505 [debug] [Thread-2 (]: Began running node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m04:13:45.053978 [debug] [Thread-3 (]: Began executing node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m04:13:45.055579 [debug] [Thread-1 (]: Finished running node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m04:13:45.056518 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1, now test.retail.not_null_bronze__orders_order_id.4b38fb230a)
[0m04:13:45.057558 [debug] [Thread-3 (]: Timing info for test.retail.source_unique_raw_csv_users_user_id.d8f871acc9 (execute): 04:13:45.057131 => 04:13:45.057149
[0m04:13:45.058901 [debug] [Thread-1 (]: Began running node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m04:13:45.059682 [debug] [Thread-2 (]: Began compiling node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m04:13:45.060968 [debug] [Thread-3 (]: Finished running node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m04:13:45.062061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8, now test.retail.unique_bronze__orders_order_id.cd2f27ce5f)
[0m04:13:45.062733 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__orders_order_created_at.05e711bf75 (compile): 04:13:45.037062 => 04:13:45.062452
[0m04:13:45.067496 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.not_null_bronze__orders_order_id.4b38fb230a"
[0m04:13:45.068836 [debug] [Thread-3 (]: Began running node model.retail.silver__orders_enriched
[0m04:13:45.069991 [debug] [Thread-1 (]: Began compiling node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m04:13:45.071132 [debug] [Thread-4 (]: Began executing node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m04:13:45.072904 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.source_unique_raw_csv_users_user_id.d8f871acc9, now model.retail.silver__orders_enriched)
[0m04:13:45.077363 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"
[0m04:13:45.078407 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__orders_order_created_at.05e711bf75 (execute): 04:13:45.078003 => 04:13:45.078021
[0m04:13:45.079561 [debug] [Thread-3 (]: Began compiling node model.retail.silver__orders_enriched
[0m04:13:45.081834 [debug] [Thread-4 (]: Finished running node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m04:13:45.085374 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail.silver__orders_enriched"
[0m04:13:45.086234 [debug] [Thread-4 (]: Began running node test.retail.not_null_bronze__users_email.2bec59e73f
[0m04:13:45.088017 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__orders_order_created_at.05e711bf75, now test.retail.not_null_bronze__users_email.2bec59e73f)
[0m04:13:45.089210 [debug] [Thread-4 (]: Began compiling node test.retail.not_null_bronze__users_email.2bec59e73f
[0m04:13:45.093658 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.not_null_bronze__users_email.2bec59e73f"
[0m04:13:45.094265 [debug] [Thread-2 (]: Timing info for test.retail.not_null_bronze__orders_order_id.4b38fb230a (compile): 04:13:45.063009 => 04:13:45.094020
[0m04:13:45.095548 [debug] [Thread-2 (]: Began executing node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m04:13:45.097142 [debug] [Thread-2 (]: Timing info for test.retail.not_null_bronze__orders_order_id.4b38fb230a (execute): 04:13:45.096692 => 04:13:45.096722
[0m04:13:45.098776 [debug] [Thread-2 (]: Finished running node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m04:13:45.099409 [debug] [Thread-1 (]: Timing info for test.retail.unique_bronze__orders_order_id.cd2f27ce5f (compile): 04:13:45.073466 => 04:13:45.099118
[0m04:13:45.100249 [debug] [Thread-2 (]: Began running node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m04:13:45.101204 [debug] [Thread-1 (]: Began executing node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m04:13:45.102618 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__orders_order_id.4b38fb230a, now test.retail.not_null_bronze__users_user_id.cb91e05164)
[0m04:13:45.103754 [debug] [Thread-3 (]: Timing info for model.retail.silver__orders_enriched (compile): 04:13:45.082585 => 04:13:45.103274
[0m04:13:45.104499 [debug] [Thread-1 (]: Timing info for test.retail.unique_bronze__orders_order_id.cd2f27ce5f (execute): 04:13:45.104160 => 04:13:45.104181
[0m04:13:45.105172 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__users_email.2bec59e73f (compile): 04:13:45.089872 => 04:13:45.104787
[0m04:13:45.106234 [debug] [Thread-2 (]: Began compiling node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m04:13:45.107190 [debug] [Thread-3 (]: Began executing node model.retail.silver__orders_enriched
[0m04:13:45.108612 [debug] [Thread-1 (]: Finished running node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m04:13:45.109515 [debug] [Thread-4 (]: Began executing node test.retail.not_null_bronze__users_email.2bec59e73f
[0m04:13:45.115864 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.not_null_bronze__users_user_id.cb91e05164"
[0m04:13:45.116490 [debug] [Thread-3 (]: Timing info for model.retail.silver__orders_enriched (execute): 04:13:45.116212 => 04:13:45.116224
[0m04:13:45.117445 [debug] [Thread-1 (]: Began running node test.retail.unique_bronze__users_user_id.129342c645
[0m04:13:45.118455 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__users_email.2bec59e73f (execute): 04:13:45.118177 => 04:13:45.118187
[0m04:13:45.121266 [debug] [Thread-3 (]: Finished running node model.retail.silver__orders_enriched
[0m04:13:45.122537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.unique_bronze__orders_order_id.cd2f27ce5f, now test.retail.unique_bronze__users_user_id.129342c645)
[0m04:13:45.123618 [debug] [Thread-4 (]: Finished running node test.retail.not_null_bronze__users_email.2bec59e73f
[0m04:13:45.124667 [debug] [Thread-3 (]: Began running node model.retail.gold__daily_branch_metrics
[0m04:13:45.125028 [debug] [Thread-1 (]: Began compiling node test.retail.unique_bronze__users_user_id.129342c645
[0m04:13:45.126049 [debug] [Thread-4 (]: Began running node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m04:13:45.127223 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail.silver__orders_enriched, now model.retail.gold__daily_branch_metrics)
[0m04:13:45.132022 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.unique_bronze__users_user_id.129342c645"
[0m04:13:45.133046 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__users_email.2bec59e73f, now test.retail.not_null_silver__orders_enriched_order_date.658d753d80)
[0m04:13:45.134159 [debug] [Thread-3 (]: Began compiling node model.retail.gold__daily_branch_metrics
[0m04:13:45.135728 [debug] [Thread-2 (]: Timing info for test.retail.not_null_bronze__users_user_id.cb91e05164 (compile): 04:13:45.110251 => 04:13:45.135136
[0m04:13:45.136432 [debug] [Thread-4 (]: Began compiling node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m04:13:45.141410 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail.gold__daily_branch_metrics"
[0m04:13:45.142315 [debug] [Thread-2 (]: Began executing node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m04:13:45.146345 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.not_null_silver__orders_enriched_order_date.658d753d80"
[0m04:13:45.148124 [debug] [Thread-2 (]: Timing info for test.retail.not_null_bronze__users_user_id.cb91e05164 (execute): 04:13:45.147692 => 04:13:45.147712
[0m04:13:45.150565 [debug] [Thread-2 (]: Finished running node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m04:13:45.151607 [debug] [Thread-1 (]: Timing info for test.retail.unique_bronze__users_user_id.129342c645 (compile): 04:13:45.127864 => 04:13:45.151104
[0m04:13:45.152559 [debug] [Thread-2 (]: Began running node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m04:13:45.153481 [debug] [Thread-1 (]: Began executing node test.retail.unique_bronze__users_user_id.129342c645
[0m04:13:45.155097 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__users_user_id.cb91e05164, now test.retail.not_null_silver__orders_enriched_order_id.782515c964)
[0m04:13:45.156144 [debug] [Thread-1 (]: Timing info for test.retail.unique_bronze__users_user_id.129342c645 (execute): 04:13:45.155863 => 04:13:45.155876
[0m04:13:45.156890 [debug] [Thread-2 (]: Began compiling node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m04:13:45.158308 [debug] [Thread-1 (]: Finished running node test.retail.unique_bronze__users_user_id.129342c645
[0m04:13:45.165011 [debug] [Thread-3 (]: Timing info for model.retail.gold__daily_branch_metrics (compile): 04:13:45.137410 => 04:13:45.164674
[0m04:13:45.165477 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.not_null_silver__orders_enriched_order_id.782515c964"
[0m04:13:45.166141 [debug] [Thread-1 (]: Began running node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m04:13:45.167277 [debug] [Thread-3 (]: Began executing node model.retail.gold__daily_branch_metrics
[0m04:13:45.168742 [debug] [Thread-4 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_date.658d753d80 (compile): 04:13:45.142861 => 04:13:45.168436
[0m04:13:45.169736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.unique_bronze__users_user_id.129342c645, now test.retail.unique_silver__orders_enriched_order_id.761e0577f3)
[0m04:13:45.171406 [debug] [Thread-3 (]: Timing info for model.retail.gold__daily_branch_metrics (execute): 04:13:45.170843 => 04:13:45.170875
[0m04:13:45.172310 [debug] [Thread-4 (]: Began executing node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m04:13:45.172952 [debug] [Thread-1 (]: Began compiling node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m04:13:45.174172 [debug] [Thread-3 (]: Finished running node model.retail.gold__daily_branch_metrics
[0m04:13:45.174909 [debug] [Thread-4 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_date.658d753d80 (execute): 04:13:45.174665 => 04:13:45.174674
[0m04:13:45.180286 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.unique_silver__orders_enriched_order_id.761e0577f3"
[0m04:13:45.183985 [debug] [Thread-4 (]: Finished running node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m04:13:45.184722 [debug] [Thread-3 (]: Began running node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m04:13:45.186015 [debug] [Thread-2 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_id.782515c964 (compile): 04:13:45.159337 => 04:13:45.185469
[0m04:13:45.187560 [debug] [Thread-4 (]: Began running node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m04:13:45.189189 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail.gold__daily_branch_metrics, now test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761)
[0m04:13:45.190068 [debug] [Thread-2 (]: Began executing node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m04:13:45.191144 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.not_null_silver__orders_enriched_order_date.658d753d80, now test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948)
[0m04:13:45.192039 [debug] [Thread-3 (]: Began compiling node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m04:13:45.192910 [debug] [Thread-2 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_id.782515c964 (execute): 04:13:45.192671 => 04:13:45.192684
[0m04:13:45.193711 [debug] [Thread-4 (]: Began compiling node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m04:13:45.198999 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761"
[0m04:13:45.201661 [debug] [Thread-2 (]: Finished running node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m04:13:45.206884 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948"
[0m04:13:45.210573 [debug] [Thread-1 (]: Timing info for test.retail.unique_silver__orders_enriched_order_id.761e0577f3 (compile): 04:13:45.175422 => 04:13:45.210209
[0m04:13:45.211580 [debug] [Thread-1 (]: Began executing node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m04:13:45.212722 [debug] [Thread-1 (]: Timing info for test.retail.unique_silver__orders_enriched_order_id.761e0577f3 (execute): 04:13:45.212394 => 04:13:45.212411
[0m04:13:45.214609 [debug] [Thread-1 (]: Finished running node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m04:13:45.220208 [debug] [Thread-3 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761 (compile): 04:13:45.194434 => 04:13:45.219654
[0m04:13:45.221783 [debug] [Thread-3 (]: Began executing node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m04:13:45.223135 [debug] [Thread-3 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761 (execute): 04:13:45.222875 => 04:13:45.222887
[0m04:13:45.224883 [debug] [Thread-3 (]: Finished running node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m04:13:45.226199 [debug] [Thread-4 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948 (compile): 04:13:45.202464 => 04:13:45.225944
[0m04:13:45.226957 [debug] [Thread-4 (]: Began executing node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m04:13:45.227836 [debug] [Thread-4 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948 (execute): 04:13:45.227631 => 04:13:45.227640
[0m04:13:45.229124 [debug] [Thread-4 (]: Finished running node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m04:13:45.232095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:13:45.232982 [debug] [MainThread]: Connection 'test.retail.unique_silver__orders_enriched_order_id.761e0577f3' was properly closed.
[0m04:13:45.233868 [debug] [MainThread]: Connection 'test.retail.not_null_silver__orders_enriched_order_id.782515c964' was properly closed.
[0m04:13:45.234833 [debug] [MainThread]: Connection 'test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761' was properly closed.
[0m04:13:45.235869 [debug] [MainThread]: Connection 'test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948' was properly closed.
[0m04:13:45.239197 [debug] [MainThread]: Command end result
[0m04:13:45.281557 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 12.7317505, "process_user_time": 7.851918, "process_kernel_time": 1.833608, "process_mem_max_rss": "249388", "process_out_blocks": "53632", "process_in_blocks": "0"}
[0m04:13:45.282581 [debug] [MainThread]: Command `dbt compile` succeeded at 04:13:45.282414 after 12.73 seconds
[0m04:13:45.283268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76108d68a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76108d97fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7610643a6300>]}
[0m04:13:45.284031 [debug] [MainThread]: Flushing usage events
[0m04:15:50.624756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c507b5cf8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c507dd41af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c507b669b50>]}


============================== 04:15:50.631012 | 69c679cc-3fe4-4c11-80e8-dbe711ff2a4c ==============================
[0m04:15:50.631012 [info ] [MainThread]: Running with dbt=1.7.9
[0m04:15:50.632069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:15:51.807239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69c679cc-3fe4-4c11-80e8-dbe711ff2a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c504ed29730>]}
[0m04:15:51.885293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69c679cc-3fe4-4c11-80e8-dbe711ff2a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c504ed55430>]}
[0m04:15:51.886803 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m04:15:51.996278 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m04:15:52.049115 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m04:15:52.050687 [debug] [MainThread]: previous checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, current checksum: da3f3fd19af0b14e2e45b34d8a09fd4695d9e53cdd1b7bca5d37bbdb008d784a
[0m04:15:52.052223 [info ] [MainThread]: Unable to do partial parsing because env vars used in dbt_project.yml have changed
[0m04:15:52.053186 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m04:15:52.053877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '69c679cc-3fe4-4c11-80e8-dbe711ff2a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c504e4180b0>]}
[0m04:15:59.643093 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.retail
[0m04:15:59.648141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69c679cc-3fe4-4c11-80e8-dbe711ff2a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c504c6199a0>]}
[0m04:15:59.693928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69c679cc-3fe4-4c11-80e8-dbe711ff2a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c504c702120>]}
[0m04:15:59.694896 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 838 macros, 0 groups, 0 semantic models
[0m04:15:59.695786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69c679cc-3fe4-4c11-80e8-dbe711ff2a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c504e6ae3f0>]}
[0m04:15:59.704936 [info ] [MainThread]: 
[0m04:15:59.706637 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:15:59.708790 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m04:15:59.709614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:16:00.621374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod_retail_stg)
[0m04:16:00.622341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:16:01.281018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69c679cc-3fe4-4c11-80e8-dbe711ff2a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c504e3102c0>]}
[0m04:16:01.282806 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:16:01.283760 [info ] [MainThread]: 
[0m04:16:01.293715 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m04:16:01.294562 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m04:16:01.295244 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod_retail_stg.bronze__orders ............. [RUN]
[0m04:16:01.296388 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod_retail_stg.bronze__users .............. [RUN]
[0m04:16:01.298067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod_retail_stg, now model.retail.bronze__orders)
[0m04:16:01.299197 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m04:16:01.299932 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m04:16:01.300662 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m04:16:01.307039 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m04:16:01.310238 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m04:16:01.321660 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 04:16:01.301172 => 04:16:01.321129
[0m04:16:01.322610 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m04:16:01.329169 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 04:16:01.307407 => 04:16:01.328728
[0m04:16:01.335382 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m04:16:01.375796 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m04:16:01.377766 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m04:16:01.388879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:16:01.391178 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:16:01.425049 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_stg`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m04:16:01.465295 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_stg`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m04:16:02.242883 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:aea4f4ce-2408-43ea-af61-9a9f54ded2cd&page=queryresults
[0m04:16:02.246930 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_stg`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m04:16:02.247829 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: aea4f4ce-2408-43ea-af61-9a9f54ded2cd

[0m04:16:02.248767 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 04:16:01.341262 => 04:16:02.248510
[0m04:16:02.254341 [debug] [Thread-2 (]: Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: aea4f4ce-2408-43ea-af61-9a9f54ded2cd
  
[0m04:16:02.255356 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69c679cc-3fe4-4c11-80e8-dbe711ff2a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c504c443320>]}
[0m04:16:02.256667 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model retail_prod_retail_stg.bronze__users ..... [[31mERROR[0m in 0.96s]
[0m04:16:02.258122 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m04:16:02.441500 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:20c1d4cb-2828-4cf6-8dc8-fd278b585f73&page=queryresults
[0m04:16:02.443942 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_stg`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m04:16:02.445100 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: 20c1d4cb-2828-4cf6-8dc8-fd278b585f73

[0m04:16:02.446332 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 04:16:01.323219 => 04:16:02.446000
[0m04:16:02.449650 [debug] [Thread-1 (]: Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 20c1d4cb-2828-4cf6-8dc8-fd278b585f73
  
[0m04:16:02.450716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69c679cc-3fe4-4c11-80e8-dbe711ff2a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c504c5d2150>]}
[0m04:16:02.451791 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model retail_prod_retail_stg.bronze__orders .... [[31mERROR[0m in 1.15s]
[0m04:16:02.452694 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m04:16:02.457264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:16:02.458110 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m04:16:02.458937 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m04:16:02.459809 [info ] [MainThread]: 
[0m04:16:02.460675 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.75 seconds (2.75s).
[0m04:16:02.463149 [debug] [MainThread]: Command end result
[0m04:16:02.506133 [info ] [MainThread]: 
[0m04:16:02.507376 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m04:16:02.508679 [info ] [MainThread]: 
[0m04:16:02.510550 [error] [MainThread]:   Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: aea4f4ce-2408-43ea-af61-9a9f54ded2cd
  
[0m04:16:02.512299 [info ] [MainThread]: 
[0m04:16:02.513424 [error] [MainThread]:   Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 20c1d4cb-2828-4cf6-8dc8-fd278b585f73
  
[0m04:16:02.514666 [info ] [MainThread]: 
[0m04:16:02.516437 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m04:16:02.519507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.032043, "process_user_time": 5.472288, "process_kernel_time": 1.538443, "process_mem_max_rss": "262076", "process_out_blocks": "2408", "command_success": false, "process_in_blocks": "0"}
[0m04:16:02.520619 [debug] [MainThread]: Command `dbt run` failed at 04:16:02.520451 after 12.03 seconds
[0m04:16:02.522334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c507b6ed760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c504c5c7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c507c1de6f0>]}
[0m04:16:02.523565 [debug] [MainThread]: Flushing usage events
[0m04:24:37.704855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711b9eb62ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711b9eb62e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711b9eb61a90>]}


============================== 04:24:37.723746 | 189f370d-e31e-4345-9829-0a47020b4cb6 ==============================
[0m04:24:37.723746 [info ] [MainThread]: Running with dbt=1.7.9
[0m04:24:37.724720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'send_anonymous_usage_stats': 'True'}
[0m04:24:37.816288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '189f370d-e31e-4345-9829-0a47020b4cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711b9ebabbf0>]}
[0m04:24:38.922215 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lqflcs73'
[0m04:24:38.923151 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:24:39.307740 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:24:39.309091 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:24:39.464136 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:24:39.467344 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m04:24:39.626124 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m04:24:39.627990 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m04:24:39.629127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '189f370d-e31e-4345-9829-0a47020b4cb6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711b9ea182c0>]}
[0m04:24:39.631854 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m04:24:39.800478 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m04:24:39.803573 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:24:46.246525 [info ] [MainThread]: Installed from version 1.3.1
[0m04:24:46.247561 [info ] [MainThread]: Up to date!
[0m04:24:46.248276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '189f370d-e31e-4345-9829-0a47020b4cb6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711b9ea158b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711b9e976d20>]}
[0m04:24:46.249069 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m04:24:50.793210 [info ] [MainThread]: Installed from version 0.10.4
[0m04:24:50.794154 [info ] [MainThread]: Up to date!
[0m04:24:50.794859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '189f370d-e31e-4345-9829-0a47020b4cb6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711b9e976c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711b9e976c90>]}
[0m04:24:50.795453 [info ] [MainThread]: Installing calogica/dbt_date
[0m04:24:52.833308 [info ] [MainThread]: Installed from version 0.10.1
[0m04:24:52.834159 [info ] [MainThread]: Up to date!
[0m04:24:52.834835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '189f370d-e31e-4345-9829-0a47020b4cb6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711b9e976f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711b9e976cc0>]}
[0m04:24:52.836650 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 15.193173, "process_user_time": 2.625168, "process_kernel_time": 0.638005, "process_mem_max_rss": "163040", "process_out_blocks": "11768", "process_in_blocks": "0"}
[0m04:24:52.837415 [debug] [MainThread]: Command `dbt deps` succeeded at 04:24:52.837252 after 15.19 seconds
[0m04:24:52.837983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ba3345130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711b9ecc72f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711b9ea1b680>]}
[0m04:24:52.838813 [debug] [MainThread]: Flushing usage events
[0m04:24:57.773438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9b7ff63ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9b7ffb5880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9b7ff63c20>]}


============================== 04:24:57.779766 | 031195dc-145a-4143-89ab-21da16e3f3f9 ==============================
[0m04:24:57.779766 [info ] [MainThread]: Running with dbt=1.7.9
[0m04:24:57.780734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'send_anonymous_usage_stats': 'True'}
[0m04:24:59.887479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '031195dc-145a-4143-89ab-21da16e3f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9b58d932f0>]}
[0m04:24:59.959286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '031195dc-145a-4143-89ab-21da16e3f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9b530db1d0>]}
[0m04:24:59.960551 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m04:25:00.078452 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m04:25:00.137382 [info ] [MainThread]: Unable to do partial parsing because env vars used in dbt_project.yml have changed
[0m04:25:00.138362 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:25:00.139065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '031195dc-145a-4143-89ab-21da16e3f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9b52ba0410>]}
[0m04:25:08.583765 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.retail
[0m04:25:08.589946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '031195dc-145a-4143-89ab-21da16e3f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9b50ed0380>]}
[0m04:25:08.641820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '031195dc-145a-4143-89ab-21da16e3f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9b529ba600>]}
[0m04:25:08.642828 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 838 macros, 0 groups, 0 semantic models
[0m04:25:08.643707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '031195dc-145a-4143-89ab-21da16e3f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9b511452e0>]}
[0m04:25:08.653654 [info ] [MainThread]: 
[0m04:25:08.655063 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:25:08.657496 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m04:25:08.658624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:25:09.686353 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now create_retail-data-pipeline-dev_retail_prod_retail_prod)
[0m04:25:09.688118 [debug] [ThreadPool]: Creating schema "database: "retail-data-pipeline-dev"
schema: "retail_prod_retail_prod"
"
[0m04:25:09.696879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:25:09.734889 [debug] [ThreadPool]: On create_retail-data-pipeline-dev_retail_prod_retail_prod: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "connection_name": "create_retail-data-pipeline-dev_retail_prod_retail_prod"} */
create schema if not exists `retail-data-pipeline-dev`.`retail_prod_retail_prod`
  
[0m04:25:10.509130 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:7ae319c2-b077-485e-ad5e-aa78674d7dbd&page=queryresults
[0m04:25:14.784266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_retail-data-pipeline-dev_retail_prod_retail_prod, now list_retail-data-pipeline-dev_retail_prod_retail_prod)
[0m04:25:14.785171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:25:15.450403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '031195dc-145a-4143-89ab-21da16e3f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9b510ced20>]}
[0m04:25:15.451829 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:25:15.452609 [info ] [MainThread]: 
[0m04:25:15.462797 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m04:25:15.463352 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m04:25:15.463900 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod_retail_prod.bronze__orders ............ [RUN]
[0m04:25:15.465092 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod_retail_prod.bronze__users ............. [RUN]
[0m04:25:15.466168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod_retail_prod, now model.retail.bronze__orders)
[0m04:25:15.467140 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m04:25:15.467883 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m04:25:15.468502 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m04:25:15.475554 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m04:25:15.480290 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m04:25:15.489706 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 04:25:15.475982 => 04:25:15.489136
[0m04:25:15.490403 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 04:25:15.469033 => 04:25:15.490189
[0m04:25:15.490899 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m04:25:15.491623 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m04:25:15.536378 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m04:25:15.535869 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m04:25:15.544677 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:25:15.547034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:25:15.614106 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m04:25:15.617594 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m04:25:16.618140 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:405989e0-6cab-497d-b18d-1b02111fc67c&page=queryresults
[0m04:25:16.621935 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m04:25:16.623536 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: 405989e0-6cab-497d-b18d-1b02111fc67c

[0m04:25:16.625352 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 04:25:15.502967 => 04:25:16.624958
[0m04:25:16.633815 [debug] [Thread-1 (]: Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 405989e0-6cab-497d-b18d-1b02111fc67c
  
[0m04:25:16.635493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '031195dc-145a-4143-89ab-21da16e3f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9b52a9cfb0>]}
[0m04:25:16.636796 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model retail_prod_retail_prod.bronze__orders ... [[31mERROR[0m in 1.17s]
[0m04:25:16.638501 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m04:25:16.774810 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:3b488aa3-ebc7-454d-a5a8-b88ce8b7685d&page=queryresults
[0m04:25:16.776446 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m04:25:16.777242 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: 3b488aa3-ebc7-454d-a5a8-b88ce8b7685d

[0m04:25:16.778196 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 04:25:15.492229 => 04:25:16.777960
[0m04:25:16.780630 [debug] [Thread-2 (]: Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 3b488aa3-ebc7-454d-a5a8-b88ce8b7685d
  
[0m04:25:16.781367 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '031195dc-145a-4143-89ab-21da16e3f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9b50ee5ac0>]}
[0m04:25:16.782471 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model retail_prod_retail_prod.bronze__users .... [[31mERROR[0m in 1.31s]
[0m04:25:16.783706 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m04:25:16.786449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:25:16.787122 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m04:25:16.787708 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m04:25:16.788321 [info ] [MainThread]: 
[0m04:25:16.789199 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 8.13 seconds (8.13s).
[0m04:25:16.790204 [debug] [MainThread]: Command end result
[0m04:25:16.834917 [info ] [MainThread]: 
[0m04:25:16.836012 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m04:25:16.836977 [info ] [MainThread]: 
[0m04:25:16.837641 [error] [MainThread]:   Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 405989e0-6cab-497d-b18d-1b02111fc67c
  
[0m04:25:16.838530 [info ] [MainThread]: 
[0m04:25:16.839187 [error] [MainThread]:   Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 3b488aa3-ebc7-454d-a5a8-b88ce8b7685d
  
[0m04:25:16.839859 [info ] [MainThread]: 
[0m04:25:16.840498 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m04:25:16.841864 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 19.136765, "process_user_time": 6.162337, "process_kernel_time": 1.678045, "process_mem_max_rss": "248096", "process_out_blocks": "30624", "command_success": false, "process_in_blocks": "0"}
[0m04:25:16.842739 [debug] [MainThread]: Command `dbt run` failed at 04:25:16.842601 after 19.14 seconds
[0m04:25:16.843389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9b80caf8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9b529106b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9b53113080>]}
[0m04:25:16.843935 [debug] [MainThread]: Flushing usage events
[0m21:10:40.967785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001836C0E9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018369DE0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001836E23D6D0>]}


============================== 21:10:40.972893 | 13521971-71f4-4a86-8c51-e7143a963bc0 ==============================
[0m21:10:40.972893 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:10:40.973638 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'printer_width': '80', 'empty': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m21:10:41.222481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13521971-71f4-4a86-8c51-e7143a963bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001836C5775C0>]}
[0m21:10:41.408653 [debug] [MainThread]: Set downloads directory='C:\Users\CAU~1.TRA\AppData\Local\Temp\dbt-downloads-f8vh5z3d'
[0m21:10:41.409264 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:10:41.928659 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:10:41.931149 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:10:42.405687 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:10:42.409045 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m21:10:42.825351 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m21:10:42.826705 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m21:10:42.827346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '13521971-71f4-4a86-8c51-e7143a963bc0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001836D112CF0>]}
[0m21:10:42.828994 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m21:10:43.226841 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m21:10:43.230506 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:10:44.259038 [info ] [MainThread]: Installed from version 1.3.1
[0m21:10:44.259553 [info ] [MainThread]: Up to date!
[0m21:10:44.259992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '13521971-71f4-4a86-8c51-e7143a963bc0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001836F175950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001836F175E50>]}
[0m21:10:44.260297 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m21:10:46.769937 [info ] [MainThread]: Installed from version 0.10.4
[0m21:10:46.770537 [info ] [MainThread]: Up to date!
[0m21:10:46.770990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '13521971-71f4-4a86-8c51-e7143a963bc0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001836D0EEE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001836F199470>]}
[0m21:10:46.771294 [info ] [MainThread]: Installing calogica/dbt_date
[0m21:10:47.502366 [info ] [MainThread]: Installed from version 0.10.1
[0m21:10:47.502912 [info ] [MainThread]: Up to date!
[0m21:10:47.503397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '13521971-71f4-4a86-8c51-e7143a963bc0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001836F208120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001836D0A3D10>]}
[0m21:10:47.505586 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:10:47.506605 [debug] [MainThread]: Command `dbt deps` succeeded at 21:10:47.506505 after 6.78 seconds
[0m21:10:47.506880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001836D15AFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001836D15AD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001836F1D20D0>]}
[0m21:10:47.507162 [debug] [MainThread]: Flushing usage events
[0m21:10:49.479080 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:11:54.132231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C5729940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C3430190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C78796D0>]}


============================== 21:11:54.136748 | 71d3f96e-b996-40fc-9e46-e2d775fae295 ==============================
[0m21:11:54.136748 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:11:54.137361 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m21:11:54.276992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71d3f96e-b996-40fc-9e46-e2d775fae295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C5BB75C0>]}
[0m21:11:54.410020 [debug] [MainThread]: Command `dbt clean` succeeded at 21:11:54.409915 after 0.46 seconds
[0m21:11:54.410333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C6752580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C6751D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C87B8B50>]}
[0m21:11:54.410624 [debug] [MainThread]: Flushing usage events
[0m21:11:55.768282 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:12:00.407396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E4A19940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E2710190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E6B696D0>]}


============================== 21:12:00.411353 | a0f77b4f-b6e3-4923-8496-49a98e4d95b2 ==============================
[0m21:12:00.411353 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:12:00.412207 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail'}
[0m21:12:00.547045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0f77b4f-b6e3-4923-8496-49a98e4d95b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E4EA75C0>]}
[0m21:12:00.578404 [debug] [MainThread]: Set downloads directory='C:\Users\CAU~1.TRA\AppData\Local\Temp\dbt-downloads-arflu8a3'
[0m21:12:00.578892 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:12:01.014782 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:12:01.015971 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:12:01.322579 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:12:01.327627 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m21:12:01.920123 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m21:12:01.924711 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m21:12:02.221974 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m21:12:02.224623 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m21:12:02.225478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a0f77b4f-b6e3-4923-8496-49a98e4d95b2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E5A42CF0>]}
[0m21:12:02.227014 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m21:12:02.581068 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m21:12:02.590727 [error] [MainThread]: Encountered an error:
Found duplicate project "dbt_date". This occurs when a dependency has the same project name as some other dependency.
[0m21:12:02.641870 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\cli\main.py", line 461, in deps
    results = task.run()
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\task\deps.py", line 223, in run
    self.lock()
    ~~~~~~~~~^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\task\deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\resolver.py", line 136, in resolve_packages
    _check_for_duplicate_project_names(resolved, project, renderer)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cau.tran\retail-data-pipeline\.venv\Lib\site-packages\dbt\deps\resolver.py", line 110, in _check_for_duplicate_project_names
    raise DuplicateProjectDependencyError(project_name)
dbt.exceptions.DuplicateProjectDependencyError: Found duplicate project "dbt_date". This occurs when a dependency has the same project name as some other dependency.

[0m21:12:02.643230 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:12:02.644481 [debug] [MainThread]: Command `dbt deps` failed at 21:12:02.644388 after 2.38 seconds
[0m21:12:02.644747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E7AF5F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E7AF5C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E6C437A0>]}
[0m21:12:02.644993 [debug] [MainThread]: Flushing usage events
[0m21:12:03.937093 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:13:42.763230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4CA9F9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4C86F0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4CCB4D6D0>]}


============================== 21:13:42.767073 | 3ba023c9-fbab-4424-a13a-32b6906552a2 ==============================
[0m21:13:42.767073 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:13:42.767659 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt clean', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m21:13:42.906154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ba023c9-fbab-4424-a13a-32b6906552a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4CAE875C0>]}
[0m21:13:42.928560 [debug] [MainThread]: Command `dbt clean` succeeded at 21:13:42.928460 after 0.41 seconds
[0m21:13:42.928843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4CBA22580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4CBA21D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4CDAC8B50>]}
[0m21:13:42.929116 [debug] [MainThread]: Flushing usage events
[0m21:13:44.260176 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:14:01.534628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8598B9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8575D0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C85BA096D0>]}


============================== 21:14:01.539428 | f0197ce9-fc0a-411f-a2d6-9d119d7042b9 ==============================
[0m21:14:01.539428 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:14:01.540236 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail'}
[0m21:14:01.610452 [info ] [MainThread]: dbt version: 1.10.13
[0m21:14:01.611126 [info ] [MainThread]: python version: 3.13.5
[0m21:14:01.611628 [info ] [MainThread]: python path: C:\Users\cau.tran\retail-data-pipeline\.venv\Scripts\python.exe
[0m21:14:01.612031 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m21:14:01.618042 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_PROJECT_ID'
[0m21:14:01.619518 [debug] [MainThread]: Command `dbt debug` failed at 21:14:01.619381 after 0.22 seconds
[0m21:14:01.619897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C85BAAE060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C85C844EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C85C8547C0>]}
[0m21:14:01.620226 [debug] [MainThread]: Flushing usage events
[0m21:14:02.899031 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:14:11.604720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243DDB49940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243DB850190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243DFC996D0>]}


============================== 21:14:11.609452 | 16230c77-a892-4069-928d-70276262c6d3 ==============================
[0m21:14:11.609452 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:14:11.610143 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m21:14:11.749776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16230c77-a892-4069-928d-70276262c6d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243DDFD75C0>]}
[0m21:14:11.777655 [debug] [MainThread]: Set downloads directory='C:\Users\CAU~1.TRA\AppData\Local\Temp\dbt-downloads-r_wzyruj'
[0m21:14:11.778367 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:14:12.202188 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:14:12.204237 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:14:12.544230 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:14:12.550072 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m21:14:12.902194 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m21:14:12.906714 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m21:14:13.261320 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m21:14:13.272754 [info ] [MainThread]: Updating lock file in file path: C:\Users\cau.tran\retail-data-pipeline\dbt\retail/package-lock.yml
[0m21:14:13.294155 [debug] [MainThread]: Set downloads directory='C:\Users\CAU~1.TRA\AppData\Local\Temp\dbt-downloads-x1vdtenl'
[0m21:14:13.299413 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:14:14.329129 [info ] [MainThread]: Installed from version 1.3.1
[0m21:14:14.329722 [info ] [MainThread]: Up to date!
[0m21:14:14.330207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '16230c77-a892-4069-928d-70276262c6d3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243E0C15260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243E0C15150>]}
[0m21:14:14.330526 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m21:14:16.650261 [info ] [MainThread]: Installed from version 0.10.9
[0m21:14:16.650910 [info ] [MainThread]: Up to date!
[0m21:14:16.651380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '16230c77-a892-4069-928d-70276262c6d3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243E0BF5D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243DEB4EE40>]}
[0m21:14:16.651676 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m21:14:17.458289 [info ] [MainThread]: Installed from version 0.16.1
[0m21:14:17.458875 [info ] [MainThread]: Up to date!
[0m21:14:17.459332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '16230c77-a892-4069-928d-70276262c6d3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243E0C19550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243E0C190F0>]}
[0m21:14:17.462131 [debug] [MainThread]: Command `dbt deps` succeeded at 21:14:17.462000 after 5.99 seconds
[0m21:14:17.462447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243DEB01FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243DEB03F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243DEBBAFC0>]}
[0m21:14:17.462732 [debug] [MainThread]: Flushing usage events
[0m21:14:18.763825 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:14:50.412704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168AF49940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021688C50190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168D0996D0>]}


============================== 21:14:50.417395 | 5d64c514-30e2-4e36-8e29-0d7cad6c24c6 ==============================
[0m21:14:50.417395 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:14:50.418110 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m21:14:50.443328 [info ] [MainThread]: dbt version: 1.10.13
[0m21:14:50.443935 [info ] [MainThread]: python version: 3.13.5
[0m21:14:50.444229 [info ] [MainThread]: python path: C:\Users\cau.tran\retail-data-pipeline\.venv\Scripts\python.exe
[0m21:14:50.444479 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m21:14:50.450722 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_PROJECT_ID'
[0m21:14:50.451715 [debug] [MainThread]: Command `dbt debug` failed at 21:14:50.451608 after 0.22 seconds
[0m21:14:50.451997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168D14D220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168D178DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168DEDC6B0>]}
[0m21:14:50.452406 [debug] [MainThread]: Flushing usage events
[0m21:14:51.857145 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:18:31.406706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA582D9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA55FD0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA5A4296D0>]}


============================== 21:18:31.410701 | ad8ef064-ad1b-4336-9a55-b23ec5758ab6 ==============================
[0m21:18:31.410701 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:18:31.411343 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'printer_width': '80', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m21:18:31.439637 [info ] [MainThread]: dbt version: 1.10.13
[0m21:18:31.440230 [info ] [MainThread]: python version: 3.13.5
[0m21:18:31.440664 [info ] [MainThread]: python path: C:\Users\cau.tran\retail-data-pipeline\.venv\Scripts\python.exe
[0m21:18:31.441011 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m21:18:31.448592 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'GOOGLE_APPLICATION_CREDENTIALS'
[0m21:18:31.449600 [debug] [MainThread]: Command `dbt debug` failed at 21:18:31.449488 after 0.28 seconds
[0m21:18:31.449899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA5A4D9E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA5A509370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA5B28D590>]}
[0m21:18:31.450192 [debug] [MainThread]: Flushing usage events
[0m21:18:32.817588 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:19:43.832953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002109FB09940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002109D800190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A1C596D0>]}


============================== 21:19:43.837013 | 76b4a04c-564b-4ceb-8f2f-d5b3a984ce0d ==============================
[0m21:19:43.837013 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:19:43.837672 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail\\logs', 'profiles_dir': 'C:\\Users\\cau.tran\\retail-data-pipeline\\dbt\\retail', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m21:19:43.856700 [info ] [MainThread]: dbt version: 1.10.13
[0m21:19:43.857139 [info ] [MainThread]: python version: 3.13.5
[0m21:19:43.857452 [info ] [MainThread]: python path: C:\Users\cau.tran\retail-data-pipeline\.venv\Scripts\python.exe
[0m21:19:43.857710 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m21:19:43.869028 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'GOOGLE_APPLICATION_CREDENTIALS'
[0m21:19:43.870171 [debug] [MainThread]: Command `dbt debug` failed at 21:19:43.870051 after 0.21 seconds
[0m21:19:43.870467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A1D0DE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A1D39370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A2AFD590>]}
[0m21:19:43.870761 [debug] [MainThread]: Flushing usage events
[0m21:19:45.209884 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:30:09.692894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f4ddffa510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f4de30f9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f4de30f6e0>]}


============================== 14:30:09.718056 | 039ada8b-5144-4ea0-a6c6-0d42609bac0c ==============================
[0m14:30:09.718056 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:30:09.719394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'send_anonymous_usage_stats': 'True'}
[0m14:30:09.880304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '039ada8b-5144-4ea0-a6c6-0d42609bac0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f4de3ec3b0>]}
[0m14:30:11.161200 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.1', 'unrendered': {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.1'}} is not valid under any of the given schemas
  
[0m14:30:11.162456 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 1.5711157, "process_user_time": 2.416479, "process_kernel_time": 0.312196, "process_mem_max_rss": "163620", "process_in_blocks": "33048", "process_out_blocks": "4208", "command_success": false}
[0m14:30:11.163280 [debug] [MainThread]: Command `dbt deps` failed at 14:30:11.163120 after 1.57 seconds
[0m14:30:11.163934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f4de254800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f4de438e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f4ddfff8c0>]}
[0m14:30:11.164514 [debug] [MainThread]: Flushing usage events
[0m14:32:39.171858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b614e27f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b614f9d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b614e27d10>]}


============================== 14:32:39.178736 | 3826c133-23a2-459a-a4df-224c68fc4b81 ==============================
[0m14:32:39.178736 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:32:39.179693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:32:39.265425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3826c133-23a2-459a-a4df-224c68fc4b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b614ce24b0>]}
[0m14:32:39.280470 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-t90lmt89'
[0m14:32:39.281569 [error] [MainThread]: Encountered an error:
">=1.3.0,<2.0.0" is not a valid semantic version.
[0m14:32:39.282939 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.20129323, "process_user_time": 2.098252, "process_kernel_time": 0.136146, "process_mem_max_rss": "219992", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:32:39.283721 [debug] [MainThread]: Command `dbt deps` failed at 14:32:39.283552 after 0.20 seconds
[0m14:32:39.284506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b614e25220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b615922b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b614e2b920>]}
[0m14:32:39.285426 [debug] [MainThread]: Flushing usage events
[0m14:33:40.661213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0a68298050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0a6829a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0a68298200>]}


============================== 14:33:40.667151 | 78a60253-d516-441b-9443-cda548a2ca4d ==============================
[0m14:33:40.667151 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:33:40.668198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:33:40.754040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78a60253-d516-441b-9443-cda548a2ca4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0a6824bbf0>]}
[0m14:33:40.763790 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-a2n1ayms'
[0m14:33:40.764626 [error] [MainThread]: Encountered an error:
">=1.3.0,<2.0.0" is not a valid semantic version.
[0m14:33:40.765894 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.18054615, "process_user_time": 2.273652, "process_kernel_time": 0.119876, "process_mem_max_rss": "219992", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:33:40.766570 [debug] [MainThread]: Command `dbt deps` failed at 14:33:40.766428 after 0.18 seconds
[0m14:33:40.767285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0a685ca1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0a6812dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0a683c1250>]}
[0m14:33:40.767909 [debug] [MainThread]: Flushing usage events
[0m14:33:50.689512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c66b95a1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c66b95a3ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c66b95a00e0>]}


============================== 14:33:50.695314 | 1c036d45-f51f-449f-bee1-bf2c1e807e30 ==============================
[0m14:33:50.695314 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:33:50.696359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:33:50.786636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c036d45-f51f-449f-bee1-bf2c1e807e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c66b9436d20>]}
[0m14:33:50.799642 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-nskwu6a2'
[0m14:33:50.800384 [error] [MainThread]: Encountered an error:
">=1.3.0,<2.0.0" is not a valid semantic version.
[0m14:33:50.801573 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.17914979, "process_user_time": 2.20747, "process_kernel_time": 0.12397, "process_mem_max_rss": "219992", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:33:50.802220 [debug] [MainThread]: Command `dbt deps` failed at 14:33:50.802082 after 0.18 seconds
[0m14:33:50.802819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c66b9b88bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c66b97b90a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c66b97c5f10>]}
[0m14:33:50.803399 [debug] [MainThread]: Flushing usage events
[0m14:34:19.646442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b05a637c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b05a637fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b05a637f500>]}


============================== 14:34:19.652394 | a6c2ec50-7646-449b-b6f8-ae3de85f06dc ==============================
[0m14:34:19.652394 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:34:19.653213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:34:19.738298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6c2ec50-7646-449b-b6f8-ae3de85f06dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b05a6211a30>]}
[0m14:34:19.749084 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-goacqa7d'
[0m14:34:19.750086 [error] [MainThread]: Encountered an error:
">=1.3.0,<2.0.0" is not a valid semantic version.
[0m14:34:19.751361 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.16895072, "process_user_time": 2.085959, "process_kernel_time": 0.143584, "process_mem_max_rss": "219992", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:34:19.752011 [debug] [MainThread]: Command `dbt deps` failed at 14:34:19.751867 after 0.17 seconds
[0m14:34:19.752629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b05a64a49b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b05a66a7230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b05a66a5a30>]}
[0m14:34:19.753318 [debug] [MainThread]: Flushing usage events
[0m14:36:30.895380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b24cbf87d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b24cd70c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b24cbfa300>]}


============================== 14:36:30.901549 | 1b7c4e8b-7214-475d-9331-542ce18c310e ==============================
[0m14:36:30.901549 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:36:30.902460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:36:30.997714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b7c4e8b-7214-475d-9331-542ce18c310e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b24cbe1040>]}
[0m14:36:31.012238 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-cbn7xgf0'
[0m14:36:31.013138 [error] [MainThread]: Encountered an error:
">=1.3.0,<2.0.0" is not a valid semantic version.
[0m14:36:31.014267 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.18984456, "process_user_time": 2.108987, "process_kernel_time": 0.128059, "process_mem_max_rss": "219992", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:36:31.015137 [debug] [MainThread]: Command `dbt deps` failed at 14:36:31.014973 after 0.19 seconds
[0m14:36:31.015756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b24cd70c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b24cc95970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b24d224110>]}
[0m14:36:31.016402 [debug] [MainThread]: Flushing usage events
[0m14:38:35.716550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adcdedcd850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adcded3d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adcdebd0c20>]}


============================== 14:38:35.723071 | 5ea5b8b1-e6ba-4789-b751-d89df76ad2f5 ==============================
[0m14:38:35.723071 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:38:35.724118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:38:35.757151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775d16a5f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775d17088ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775d1698c560>]}


============================== 14:38:35.763638 | ad01bc7c-2d63-4c96-a92b-cfac6740521b ==============================
[0m14:38:35.763638 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:38:35.764964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'send_anonymous_usage_stats': 'True'}
[0m14:38:35.821083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ea5b8b1-e6ba-4789-b751-d89df76ad2f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adcdebd08f0>]}
[0m14:38:35.856530 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.1', 'unrendered': {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.1'}} is not valid under any of the given schemas
  
[0m14:38:35.857923 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.2110618, "process_user_time": 2.830266, "process_kernel_time": 0.228505, "process_mem_max_rss": "219992", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:38:35.858718 [debug] [MainThread]: Command `dbt deps` failed at 14:38:35.858578 after 0.21 seconds
[0m14:38:35.859565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adcdedcd850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adcdeb5d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adcdeb5cda0>]}
[0m14:38:35.860426 [debug] [MainThread]: Flushing usage events
[0m14:38:35.860520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad01bc7c-2d63-4c96-a92b-cfac6740521b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775d1698c200>]}
[0m14:38:35.890019 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.1', 'unrendered': {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.1'}} is not valid under any of the given schemas
  
[0m14:38:35.891457 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.21543837, "process_user_time": 2.844875, "process_kernel_time": 0.19551, "process_mem_max_rss": "163528", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:38:35.892240 [debug] [MainThread]: Command `dbt deps` failed at 14:38:35.892099 after 0.22 seconds
[0m14:38:35.892964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775d16a63590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775d16a63440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775d16942ba0>]}
[0m14:38:35.893698 [debug] [MainThread]: Flushing usage events
[0m14:38:39.921366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7764e3205e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7764e3088110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7764e308a3f0>]}


============================== 14:38:39.928536 | 62a20b61-047b-4f28-8669-cfff22ef80f8 ==============================
[0m14:38:39.928536 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:38:39.929857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:38:40.023658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62a20b61-047b-4f28-8669-cfff22ef80f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7764e33b13d0>]}
[0m14:38:40.054774 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.1', 'unrendered': {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.1'}} is not valid under any of the given schemas
  
[0m14:38:40.056277 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.20603643, "process_user_time": 2.386773, "process_kernel_time": 0.160186, "process_mem_max_rss": "219992", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:38:40.056912 [debug] [MainThread]: Command `dbt deps` failed at 14:38:40.056773 after 0.21 seconds
[0m14:38:40.057679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7764e33b33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7764e3672390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7764e308a3f0>]}
[0m14:38:40.058386 [debug] [MainThread]: Flushing usage events
[0m14:39:06.111894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ae7c62a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ae6f1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78af4938c0>]}


============================== 14:39:06.120908 | b800ce26-a40c-497e-bc46-0c98d8e1f9b0 ==============================
[0m14:39:06.120908 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:39:06.122121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'send_anonymous_usage_stats': 'True'}
[0m14:39:06.232119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b800ce26-a40c-497e-bc46-0c98d8e1f9b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78aededdf0>]}
[0m14:39:06.246906 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8x1m7709'
[0m14:39:06.248221 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:39:06.743939 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:39:06.745243 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:39:07.350781 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:39:07.354503 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m14:39:07.492306 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m14:39:07.505466 [info ] [MainThread]: Updating lock file in file path: /opt/airflow/dbt/retail/package-lock.yml
[0m14:39:07.528892 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-gj36f5ee'
[0m14:39:07.535180 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:39:14.414535 [info ] [MainThread]: Installed from version 1.3.1
[0m14:39:14.415546 [info ] [MainThread]: Up to date!
[0m14:39:14.416638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b800ce26-a40c-497e-bc46-0c98d8e1f9b0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ae537a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ae537860>]}
[0m14:39:14.417709 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m14:39:16.786111 [info ] [MainThread]: Installed from version 0.15.0
[0m14:39:16.787029 [info ] [MainThread]: Up to date!
[0m14:39:16.787973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b800ce26-a40c-497e-bc46-0c98d8e1f9b0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ae7c4500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ae7c42f0>]}
[0m14:39:16.789346 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 10.749052, "process_user_time": 2.267123, "process_kernel_time": 0.426654, "process_mem_max_rss": "196356", "process_in_blocks": "16", "process_out_blocks": "368"}
[0m14:39:16.790088 [debug] [MainThread]: Command `dbt deps` succeeded at 14:39:16.789952 after 10.75 seconds
[0m14:39:16.790616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ae7edf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ae7ec380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78b2fd7320>]}
[0m14:39:16.791226 [debug] [MainThread]: Flushing usage events
[0m14:39:21.175315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc7dd5755e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc7dd575af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc7dd577d70>]}


============================== 14:39:21.182806 | b521e509-e4df-493f-ac94-86db7371aab0 ==============================
[0m14:39:21.182806 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:39:21.183699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:39:23.378130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b521e509-e4df-493f-ac94-86db7371aab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc7dd527e00>]}
[0m14:39:23.456887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b521e509-e4df-493f-ac94-86db7371aab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc7dd578ef0>]}
[0m14:39:23.477655 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m14:39:23.494679 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 3 package(s) specified in packages.yml, but only 2 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m14:39:23.496033 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.400014, "process_user_time": 4.346904, "process_kernel_time": 1.385101, "process_mem_max_rss": "230428", "process_in_blocks": "944", "process_out_blocks": "30624", "command_success": false}
[0m14:39:23.496912 [debug] [MainThread]: Command `dbt run` failed at 14:39:23.496758 after 2.40 seconds
[0m14:39:23.497610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc7e1fc73e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc7b605f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc7b46ab470>]}
[0m14:39:23.498720 [debug] [MainThread]: Flushing usage events
[0m14:47:46.869310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fa8ba9f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fa8ba9f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fa8ba9dbb0>]}
[0m14:47:46.870128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70120bc6a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70120bb98ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70120bc69d60>]}


============================== 14:47:46.876400 | 3c86905d-7e26-4384-be4e-466ab24a7c02 ==============================
[0m14:47:46.876400 [info ] [MainThread]: Running with dbt=1.7.9


============================== 14:47:46.877055 | b62ea110-f345-4e93-84fd-f31e8fb1e66e ==============================
[0m14:47:46.877055 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:47:46.877261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:47:46.878157 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:47:46.972247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b62ea110-f345-4e93-84fd-f31e8fb1e66e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70120bc69d60>]}
[0m14:47:46.972571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c86905d-7e26-4384-be4e-466ab24a7c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fa8b8a75f0>]}
[0m14:47:46.982177 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-luud5rvt'
[0m14:47:46.982449 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-j504poyh'
[0m14:47:46.983145 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:47:46.983454 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:47:47.258749 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:47:47.259942 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:47:47.260872 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:47:47.262565 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:47:47.349524 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:47:47.353668 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m14:47:47.362182 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:47:47.365627 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m14:47:47.484748 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m14:47:47.485179 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m14:47:47.489305 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m14:47:47.490044 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m14:47:47.619257 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m14:47:47.621814 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m14:47:47.636232 [info ] [MainThread]: Updating lock file in file path: /opt/airflow/dbt/retail/package-lock.yml
[0m14:47:47.637307 [info ] [MainThread]: Updating lock file in file path: /opt/airflow/dbt/retail/package-lock.yml
[0m14:47:47.652895 [error] [MainThread]: Encountered an error:
[Errno 2] No such file or directory: 'dbt_packages/dbt_utils'
[0m14:47:47.658987 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 152, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/main.py", line 492, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/deps.py", line 228, in run
    system.rmtree(self.project.packages_install_path)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/clients/system.py", line 570, in rmtree
    return shutil.rmtree(path, onerror=chmod_and_retry)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/shutil.py", line 759, in rmtree
    _rmtree_safe_fd(stack, onexc)
  File "/usr/local/lib/python3.12/shutil.py", line 703, in _rmtree_safe_fd
    onexc(func, path, err)
  File "/usr/local/lib/python3.12/shutil.py", line 750, in onexc
    return onerror(func, path, exc_info)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/shutil.py", line 700, in _rmtree_safe_fd
    onexc(os.unlink, fullname, err)
  File "/usr/local/lib/python3.12/shutil.py", line 750, in onexc
    return onerror(func, path, exc_info)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/shutil.py", line 698, in _rmtree_safe_fd
    os.unlink(entry.name, dir_fd=topfd)
FileNotFoundError: [Errno 2] No such file or directory: 'dbt_packages/dbt_utils'

[0m14:47:47.660547 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.8542637, "process_user_time": 2.124559, "process_kernel_time": 0.199676, "process_mem_max_rss": "196356", "process_in_blocks": "128", "process_out_blocks": "8", "command_success": false}
[0m14:47:47.661762 [debug] [MainThread]: Command `dbt deps` failed at 14:47:47.661566 after 0.86 seconds
[0m14:47:47.662497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fa8b9add90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fa8b9ccfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fa8bd8ea80>]}
[0m14:47:47.663284 [debug] [MainThread]: Flushing usage events
[0m14:47:48.544976 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-h_7xrvj5'
[0m14:47:48.550320 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:47:56.157047 [info ] [MainThread]: Installed from version 1.3.1
[0m14:47:56.157924 [info ] [MainThread]: Up to date!
[0m14:47:56.158956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b62ea110-f345-4e93-84fd-f31e8fb1e66e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70120bd9fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70120b9bb920>]}
[0m14:47:56.159828 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m14:48:01.886380 [info ] [MainThread]: Installed from version 0.10.9
[0m14:48:01.887210 [info ] [MainThread]: Up to date!
[0m14:48:01.888043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b62ea110-f345-4e93-84fd-f31e8fb1e66e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70120bde0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70120bb7d760>]}
[0m14:48:01.888761 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m14:48:04.422615 [info ] [MainThread]: Installed from version 0.15.0
[0m14:48:04.423485 [info ] [MainThread]: Up to date!
[0m14:48:04.424334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b62ea110-f345-4e93-84fd-f31e8fb1e66e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70120ba01670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70120ba01520>]}
[0m14:48:04.426030 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 17.675173, "process_user_time": 2.500263, "process_kernel_time": 0.633399, "process_mem_max_rss": "219992", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m14:48:04.426748 [debug] [MainThread]: Command `dbt deps` succeeded at 14:48:04.426625 after 17.68 seconds
[0m14:48:04.427357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70120bde0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70120bb98ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70120e3a57f0>]}
[0m14:48:04.427956 [debug] [MainThread]: Flushing usage events
[0m14:48:08.790875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78810dde10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78810dde0cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78810dde1250>]}


============================== 14:48:08.796697 | 741fd517-55d4-4379-9400-ec12137893c0 ==============================
[0m14:48:08.796697 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:48:08.797984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'send_anonymous_usage_stats': 'True'}
[0m14:48:09.670126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '741fd517-55d4-4379-9400-ec12137893c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78810dde2420>]}
[0m14:48:09.777401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '741fd517-55d4-4379-9400-ec12137893c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7880e13ad2e0>]}
[0m14:48:09.778471 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m14:48:09.888266 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:48:09.910750 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:48:09.911561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '741fd517-55d4-4379-9400-ec12137893c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7880e199c4d0>]}
[0m14:48:17.873708 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.retail
[0m14:48:17.878887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '741fd517-55d4-4379-9400-ec12137893c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7880db17bc50>]}
[0m14:48:17.937142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '741fd517-55d4-4379-9400-ec12137893c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7880e0b22a50>]}
[0m14:48:17.938262 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 847 macros, 0 groups, 0 semantic models
[0m14:48:17.939145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '741fd517-55d4-4379-9400-ec12137893c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7880e0b4e900>]}
[0m14:48:17.951189 [info ] [MainThread]: 
[0m14:48:17.952466 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:48:17.954455 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m14:48:17.955275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:18.723090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now create_retail-data-pipeline-dev_retail_prod_retail_prod)
[0m14:48:18.724555 [debug] [ThreadPool]: Creating schema "database: "retail-data-pipeline-dev"
schema: "retail_prod_retail_prod"
"
[0m14:48:18.732643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:18.771557 [debug] [ThreadPool]: On create_retail-data-pipeline-dev_retail_prod_retail_prod: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "connection_name": "create_retail-data-pipeline-dev_retail_prod_retail_prod"} */
create schema if not exists `retail-data-pipeline-dev`.`retail_prod_retail_prod`
  
[0m14:48:19.729809 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:3024dd24-606f-4fbb-ac45-38a46ca92475&page=queryresults
[0m14:48:22.212046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_retail-data-pipeline-dev_retail_prod_retail_prod, now list_retail-data-pipeline-dev_retail_prod_retail_prod)
[0m14:48:22.213519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:22.795387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '741fd517-55d4-4379-9400-ec12137893c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7880db0fe8a0>]}
[0m14:48:22.796883 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:48:22.797772 [info ] [MainThread]: 
[0m14:48:22.808675 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m14:48:22.809393 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m14:48:22.810368 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod_retail_prod.bronze__orders ............ [RUN]
[0m14:48:22.811515 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod_retail_prod.bronze__users ............. [RUN]
[0m14:48:22.813106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod_retail_prod, now model.retail.bronze__orders)
[0m14:48:22.814395 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m14:48:22.815199 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m14:48:22.815907 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m14:48:22.822255 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m14:48:22.825737 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m14:48:22.851231 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 14:48:22.816519 => 14:48:22.850884
[0m14:48:22.852062 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m14:48:22.871906 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 14:48:22.822583 => 14:48:22.871532
[0m14:48:22.878028 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m14:48:22.883061 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m14:48:22.888582 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m14:48:22.915653 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:48:22.919983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:22.956303 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m14:48:23.034689 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m14:48:23.888441 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:296b5144-74f2-4c0a-83c1-f8ff59c9dfe1&page=queryresults
[0m14:48:23.893060 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m14:48:23.895044 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: 296b5144-74f2-4c0a-83c1-f8ff59c9dfe1

[0m14:48:23.897919 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 14:48:22.883570 => 14:48:23.897374
[0m14:48:23.900002 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:76850e1e-17d7-438b-b8dd-ca5e1c12e615&page=queryresults
[0m14:48:23.905605 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m14:48:23.907260 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: 76850e1e-17d7-438b-b8dd-ca5e1c12e615

[0m14:48:23.908805 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 14:48:22.852672 => 14:48:23.908344
[0m14:48:23.928663 [debug] [Thread-2 (]: Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 296b5144-74f2-4c0a-83c1-f8ff59c9dfe1
  
[0m14:48:23.931345 [debug] [Thread-1 (]: Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 76850e1e-17d7-438b-b8dd-ca5e1c12e615
  
[0m14:48:23.932458 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '741fd517-55d4-4379-9400-ec12137893c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7880daeb3b60>]}
[0m14:48:23.934252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '741fd517-55d4-4379-9400-ec12137893c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7880dad15790>]}
[0m14:48:23.936221 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model retail_prod_retail_prod.bronze__users .... [[31mERROR[0m in 1.12s]
[0m14:48:23.939300 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model retail_prod_retail_prod.bronze__orders ... [[31mERROR[0m in 1.12s]
[0m14:48:23.941844 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m14:48:23.945860 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m14:48:23.958004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:23.959453 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m14:48:23.961068 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m14:48:23.962689 [info ] [MainThread]: 
[0m14:48:23.966701 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.01 seconds (6.01s).
[0m14:48:23.973769 [debug] [MainThread]: Command end result
[0m14:48:24.032410 [info ] [MainThread]: 
[0m14:48:24.034511 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:48:24.036254 [info ] [MainThread]: 
[0m14:48:24.037880 [error] [MainThread]:   Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 296b5144-74f2-4c0a-83c1-f8ff59c9dfe1
  
[0m14:48:24.040124 [info ] [MainThread]: 
[0m14:48:24.041720 [error] [MainThread]:   Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 76850e1e-17d7-438b-b8dd-ca5e1c12e615
  
[0m14:48:24.043524 [info ] [MainThread]: 
[0m14:48:24.045149 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m14:48:24.048922 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.310905, "process_user_time": 5.124635, "process_kernel_time": 1.480991, "process_mem_max_rss": "244652", "process_in_blocks": "3352", "command_success": false, "process_out_blocks": "0"}
[0m14:48:24.050819 [debug] [MainThread]: Command `dbt run` failed at 14:48:24.050381 after 15.31 seconds
[0m14:48:24.052416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78810df23e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7880dae84200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78810df61520>]}
[0m14:48:24.053785 [debug] [MainThread]: Flushing usage events
[0m14:49:35.415668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7772531b6bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7772533d40e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7772531b6960>]}


============================== 14:49:35.422044 | d0e73220-9ff1-41bf-a135-9e38c7db8122 ==============================
[0m14:49:35.422044 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:49:35.423240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:49:35.521551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0e73220-9ff1-41bf-a135-9e38c7db8122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7772531bb710>]}
[0m14:49:36.806031 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hbp5ioen'
[0m14:49:36.806976 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:49:37.159236 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:49:37.160586 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:49:37.296182 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:49:37.300054 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m14:49:37.427197 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m14:49:37.431823 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m14:49:37.655319 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m14:49:37.658313 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:49:45.114186 [info ] [MainThread]: Installed from version 1.3.1
[0m14:49:45.115777 [info ] [MainThread]: Up to date!
[0m14:49:45.117705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd0e73220-9ff1-41bf-a135-9e38c7db8122', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7772579bd610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7772531bb740>]}
[0m14:49:45.119173 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m14:49:52.044921 [info ] [MainThread]: Installed from version 0.10.9
[0m14:49:52.045764 [info ] [MainThread]: Up to date!
[0m14:49:52.046483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd0e73220-9ff1-41bf-a135-9e38c7db8122', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77725306f620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77725306e8a0>]}
[0m14:49:52.047108 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m14:49:54.399925 [info ] [MainThread]: Installed from version 0.15.0
[0m14:49:54.400876 [info ] [MainThread]: Up to date!
[0m14:49:54.401605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd0e73220-9ff1-41bf-a135-9e38c7db8122', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77725306d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777252f66060>]}
[0m14:49:54.403736 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 19.06333, "process_user_time": 2.581744, "process_kernel_time": 0.774098, "process_mem_max_rss": "219992", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m14:49:54.404600 [debug] [MainThread]: Command `dbt deps` succeeded at 14:49:54.404394 after 19.06 seconds
[0m14:49:54.405530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777257b73380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7772534e1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7772534160f0>]}
[0m14:49:54.406230 [debug] [MainThread]: Flushing usage events
[0m14:49:58.583391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e17e5b5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e17e7ccbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e17e5b6f60>]}


============================== 14:49:58.590033 | 9d90246a-fcd8-48f0-a951-09fda60e679e ==============================
[0m14:49:58.590033 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:49:58.590820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'send_anonymous_usage_stats': 'True'}
[0m14:49:59.520284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d90246a-fcd8-48f0-a951-09fda60e679e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e1522fe2a0>]}
[0m14:49:59.593893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d90246a-fcd8-48f0-a951-09fda60e679e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e15296d700>]}
[0m14:49:59.595067 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m14:49:59.712679 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:50:06.595782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:50:06.596917 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:50:06.598399 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.retail
[0m14:50:06.604239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d90246a-fcd8-48f0-a951-09fda60e679e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e151f70710>]}
[0m14:50:06.651817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d90246a-fcd8-48f0-a951-09fda60e679e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e151591a00>]}
[0m14:50:06.652863 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 847 macros, 0 groups, 0 semantic models
[0m14:50:06.653819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d90246a-fcd8-48f0-a951-09fda60e679e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e151044fe0>]}
[0m14:50:06.666023 [info ] [MainThread]: 
[0m14:50:06.667470 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:50:06.669609 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m14:50:06.670668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:07.387952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now create_retail-data-pipeline-dev_retail_prod_retail_prod)
[0m14:50:07.389104 [debug] [ThreadPool]: Creating schema "database: "retail-data-pipeline-dev"
schema: "retail_prod_retail_prod"
"
[0m14:50:07.398102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:07.435915 [debug] [ThreadPool]: On create_retail-data-pipeline-dev_retail_prod_retail_prod: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "connection_name": "create_retail-data-pipeline-dev_retail_prod_retail_prod"} */
create schema if not exists `retail-data-pipeline-dev`.`retail_prod_retail_prod`
  
[0m14:50:08.069577 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:60c142f6-7f34-445a-b7eb-ad90b42ce538&page=queryresults
[0m14:50:10.185735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_retail-data-pipeline-dev_retail_prod_retail_prod, now list_retail-data-pipeline-dev_retail_prod_retail_prod)
[0m14:50:10.186775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:10.784777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d90246a-fcd8-48f0-a951-09fda60e679e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e151d2cbc0>]}
[0m14:50:10.786161 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:50:10.786951 [info ] [MainThread]: 
[0m14:50:10.799550 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m14:50:10.800418 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m14:50:10.801699 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod_retail_prod.bronze__orders ............ [RUN]
[0m14:50:10.802770 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod_retail_prod.bronze__users ............. [RUN]
[0m14:50:10.803982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod_retail_prod, now model.retail.bronze__orders)
[0m14:50:10.805277 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m14:50:10.806272 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m14:50:10.807192 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m14:50:10.817501 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m14:50:10.822091 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m14:50:10.834394 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 14:50:10.818509 => 14:50:10.834041
[0m14:50:10.835337 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m14:50:10.842837 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 14:50:10.807873 => 14:50:10.842371
[0m14:50:10.848893 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m14:50:10.881999 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m14:50:10.882670 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m14:50:10.892921 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:50:10.895519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:10.982099 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m14:50:10.987352 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m14:50:11.804511 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:2f0b1d49-ae3b-40b6-afea-ae91713bc083&page=queryresults
[0m14:50:11.807192 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m14:50:11.808366 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: 2f0b1d49-ae3b-40b6-afea-ae91713bc083

[0m14:50:11.809921 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 14:50:10.855061 => 14:50:11.809265
[0m14:50:11.818318 [debug] [Thread-1 (]: Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 2f0b1d49-ae3b-40b6-afea-ae91713bc083
  
[0m14:50:11.819335 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:eca3b44a-671d-42f8-a0b0-43748d98cca4&page=queryresults
[0m14:50:11.820209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d90246a-fcd8-48f0-a951-09fda60e679e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e1510a9d90>]}
[0m14:50:11.822769 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model retail_prod_retail_prod.bronze__orders ... [[31mERROR[0m in 1.02s]
[0m14:50:11.824422 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m14:50:11.825313 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m14:50:11.826567 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: eca3b44a-671d-42f8-a0b0-43748d98cca4

[0m14:50:11.830115 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 14:50:10.836150 => 14:50:11.829622
[0m14:50:11.834795 [debug] [Thread-2 (]: Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: eca3b44a-671d-42f8-a0b0-43748d98cca4
  
[0m14:50:11.836255 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d90246a-fcd8-48f0-a951-09fda60e679e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e1510526f0>]}
[0m14:50:11.837727 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model retail_prod_retail_prod.bronze__users .... [[31mERROR[0m in 1.03s]
[0m14:50:11.839213 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m14:50:11.843205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:11.844439 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m14:50:11.845456 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m14:50:11.846596 [info ] [MainThread]: 
[0m14:50:11.847621 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.18 seconds (5.18s).
[0m14:50:11.849480 [debug] [MainThread]: Command end result
[0m14:50:11.898141 [info ] [MainThread]: 
[0m14:50:11.899471 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:50:11.900605 [info ] [MainThread]: 
[0m14:50:11.901662 [error] [MainThread]:   Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 2f0b1d49-ae3b-40b6-afea-ae91713bc083
  
[0m14:50:11.902925 [info ] [MainThread]: 
[0m14:50:11.903965 [error] [MainThread]:   Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: eca3b44a-671d-42f8-a0b0-43748d98cca4
  
[0m14:50:11.905124 [info ] [MainThread]: 
[0m14:50:11.906292 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m14:50:11.907772 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.444051, "process_user_time": 3.832435, "process_kernel_time": 1.514199, "process_mem_max_rss": "236200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:50:11.908804 [debug] [MainThread]: Command `dbt run` failed at 14:50:11.908475 after 13.45 seconds
[0m14:50:11.909806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e17ed71670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e151636360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e1517c5610>]}
[0m14:50:11.910650 [debug] [MainThread]: Flushing usage events
[0m14:53:48.591944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7b33fec4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7b34045850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7b342e46e0>]}


============================== 14:53:48.598108 | bb22ee94-784e-4ea1-aba8-fa298a4e37c4 ==============================
[0m14:53:48.598108 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:53:48.598956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:53:48.684388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb22ee94-784e-4ea1-aba8-fa298a4e37c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7b34078ef0>]}
[0m14:53:49.857341 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-s76pa1hm'
[0m14:53:49.858361 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:53:50.035139 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:53:50.036247 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:53:50.119674 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:53:50.123016 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m14:53:50.257241 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m14:53:50.261091 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m14:53:50.403949 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m14:53:50.406827 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:53:56.961983 [info ] [MainThread]: Installed from version 1.3.1
[0m14:53:56.962934 [info ] [MainThread]: Up to date!
[0m14:53:56.963559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bb22ee94-784e-4ea1-aba8-fa298a4e37c4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7b33d3bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7b33d3bc50>]}
[0m14:53:56.964165 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m14:54:03.052649 [info ] [MainThread]: Installed from version 0.10.9
[0m14:54:03.053877 [info ] [MainThread]: Up to date!
[0m14:54:03.054973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bb22ee94-784e-4ea1-aba8-fa298a4e37c4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7b33da59a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7b33da5610>]}
[0m14:54:03.055986 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m14:54:05.836335 [info ] [MainThread]: Installed from version 0.15.0
[0m14:54:05.837659 [info ] [MainThread]: Up to date!
[0m14:54:05.839025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bb22ee94-784e-4ea1-aba8-fa298a4e37c4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7b33da5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7b33da5670>]}
[0m14:54:05.842664 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 17.338005, "process_user_time": 2.42593, "process_kernel_time": 0.629408, "process_mem_max_rss": "219992", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m14:54:05.844021 [debug] [MainThread]: Command `dbt deps` succeeded at 14:54:05.843737 after 17.34 seconds
[0m14:54:05.845123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7b33f9fef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7b3486e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7b342e72c0>]}
[0m14:54:05.846246 [debug] [MainThread]: Flushing usage events
[0m14:54:10.098951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fc06c553d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fc06dd13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fc06edcbc0>]}


============================== 14:54:10.105977 | bb87d516-fb3f-48a0-8c14-863856788048 ==============================
[0m14:54:10.105977 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:54:10.107158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:54:11.093456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb87d516-fb3f-48a0-8c14-863856788048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fbd9bac5c0>]}
[0m14:54:11.185503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb87d516-fb3f-48a0-8c14-863856788048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fbdaface00>]}
[0m14:54:11.186969 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m14:54:11.331618 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:54:17.368582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:54:17.369404 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:54:17.370685 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.retail
[0m14:54:17.376510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb87d516-fb3f-48a0-8c14-863856788048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fbd9b7d670>]}
[0m14:54:17.424021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb87d516-fb3f-48a0-8c14-863856788048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fbd9af96a0>]}
[0m14:54:17.425244 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 847 macros, 0 groups, 0 semantic models
[0m14:54:17.426015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb87d516-fb3f-48a0-8c14-863856788048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fbd96ccc50>]}
[0m14:54:17.436018 [info ] [MainThread]: 
[0m14:54:17.437456 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:54:17.439349 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m14:54:17.440350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:18.167786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod_retail_prod)
[0m14:54:18.168837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:18.802304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb87d516-fb3f-48a0-8c14-863856788048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fbda5f8350>]}
[0m14:54:18.803550 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:54:18.804290 [info ] [MainThread]: 
[0m14:54:18.813586 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m14:54:18.814140 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m14:54:18.814721 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod_retail_prod.bronze__orders ............ [RUN]
[0m14:54:18.815881 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod_retail_prod.bronze__users ............. [RUN]
[0m14:54:18.816751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod_retail_prod, now model.retail.bronze__orders)
[0m14:54:18.817877 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m14:54:18.818525 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m14:54:18.819118 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m14:54:18.827752 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m14:54:18.830805 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m14:54:18.847071 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 14:54:18.819519 => 14:54:18.846735
[0m14:54:18.847925 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m14:54:18.854709 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 14:54:18.828147 => 14:54:18.854444
[0m14:54:18.861152 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m14:54:18.890802 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m14:54:18.891567 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m14:54:18.906107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:18.908165 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:54:18.942802 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m14:54:18.980418 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m14:54:19.935664 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:12ba9f6b-22af-40f4-b74f-8db9a076d617&page=queryresults
[0m14:54:19.937655 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m14:54:19.938771 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: 12ba9f6b-22af-40f4-b74f-8db9a076d617

[0m14:54:19.940038 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 14:54:18.867389 => 14:54:19.939739
[0m14:54:19.943621 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:7191e3cc-11b9-47f6-b332-e6fc387eefca&page=queryresults
[0m14:54:19.947012 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m14:54:19.948240 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: 7191e3cc-11b9-47f6-b332-e6fc387eefca

[0m14:54:19.949477 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 14:54:18.848503 => 14:54:19.949218
[0m14:54:19.957162 [debug] [Thread-2 (]: Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 12ba9f6b-22af-40f4-b74f-8db9a076d617
  
[0m14:54:19.958369 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb87d516-fb3f-48a0-8c14-863856788048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fbd9753e90>]}
[0m14:54:19.960092 [debug] [Thread-1 (]: Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 7191e3cc-11b9-47f6-b332-e6fc387eefca
  
[0m14:54:19.961900 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model retail_prod_retail_prod.bronze__users .... [[31mERROR[0m in 1.14s]
[0m14:54:19.965662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb87d516-fb3f-48a0-8c14-863856788048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fbd9718a10>]}
[0m14:54:19.970131 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m14:54:19.972205 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model retail_prod_retail_prod.bronze__orders ... [[31mERROR[0m in 1.15s]
[0m14:54:19.976329 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m14:54:19.979498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:19.980456 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m14:54:19.981242 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m14:54:19.982019 [info ] [MainThread]: 
[0m14:54:19.982860 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.54 seconds (2.54s).
[0m14:54:19.984063 [debug] [MainThread]: Command end result
[0m14:54:20.021052 [info ] [MainThread]: 
[0m14:54:20.022010 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:54:20.022676 [info ] [MainThread]: 
[0m14:54:20.023268 [error] [MainThread]:   Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 12ba9f6b-22af-40f4-b74f-8db9a076d617
  
[0m14:54:20.023904 [info ] [MainThread]: 
[0m14:54:20.024574 [error] [MainThread]:   Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 7191e3cc-11b9-47f6-b332-e6fc387eefca
  
[0m14:54:20.025195 [info ] [MainThread]: 
[0m14:54:20.025942 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m14:54:20.027247 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.011723, "process_user_time": 3.790187, "process_kernel_time": 1.362672, "process_mem_max_rss": "236900", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:54:20.028208 [debug] [MainThread]: Command `dbt run` failed at 14:54:20.028014 after 10.01 seconds
[0m14:54:20.029000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fc07438170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fc07f52c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fbd9fcc530>]}
[0m14:54:20.029619 [debug] [MainThread]: Flushing usage events
[0m14:59:43.772324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae1d18bb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae1cdd112e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae1cd0fd250>]}


============================== 14:59:43.778512 | 54d81eb4-1c9a-48ee-8c35-45280f85e3f3 ==============================
[0m14:59:43.778512 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:59:43.779378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:59:43.865336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54d81eb4-1c9a-48ee-8c35-45280f85e3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae1cd0fc6b0>]}
[0m14:59:45.033472 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0cvhfqv8'
[0m14:59:45.034253 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:59:45.230584 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:59:45.231707 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:59:45.322354 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:59:45.326042 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m14:59:45.470759 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m14:59:45.476094 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m14:59:45.617968 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m14:59:45.621050 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:59:52.366609 [info ] [MainThread]: Installed from version 1.3.1
[0m14:59:52.367489 [info ] [MainThread]: Up to date!
[0m14:59:52.368309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '54d81eb4-1c9a-48ee-8c35-45280f85e3f3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae1cd0fca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae1ccf937d0>]}
[0m14:59:52.369088 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m15:00:01.222382 [info ] [MainThread]: Installed from version 0.10.9
[0m15:00:01.223127 [info ] [MainThread]: Up to date!
[0m15:00:01.223890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '54d81eb4-1c9a-48ee-8c35-45280f85e3f3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae1cd3203b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae1cce95b80>]}
[0m15:00:01.224489 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m15:00:03.655180 [info ] [MainThread]: Installed from version 0.15.0
[0m15:00:03.655990 [info ] [MainThread]: Up to date!
[0m15:00:03.656967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '54d81eb4-1c9a-48ee-8c35-45280f85e3f3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae1ccfe3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae1ccfe39e0>]}
[0m15:00:03.658858 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 19.972775, "process_user_time": 2.482718, "process_kernel_time": 0.685587, "process_mem_max_rss": "219992", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m15:00:03.659829 [debug] [MainThread]: Command `dbt deps` succeeded at 15:00:03.659642 after 19.97 seconds
[0m15:00:03.660597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae1cd6e5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae1cd20b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae1ccfb9bb0>]}
[0m15:00:03.661253 [debug] [MainThread]: Flushing usage events
[0m15:00:08.951426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742c13933710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742c136653a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742c1353cbc0>]}


============================== 15:00:08.958046 | 1fe30281-22dc-4670-878e-b452e6283394 ==============================
[0m15:00:08.958046 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:00:08.958978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:00:08.993140 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error
    Could not render {{ env_var('DBT_DATASET'}}: unexpected '}', expected ')'
      line 1
        {{ env_var('DBT_DATASET'}}
[0m15:00:08.994477 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.11828431, "process_user_time": 2.100008, "process_kernel_time": 0.084321, "process_mem_max_rss": "196364", "process_in_blocks": "16", "process_out_blocks": "16", "command_success": false}
[0m15:00:08.995384 [debug] [MainThread]: Command `dbt run` failed at 15:00:08.995232 after 0.12 seconds
[0m15:00:08.996091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742c18077380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742c138fd670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742c1482a090>]}
[0m15:00:08.996977 [debug] [MainThread]: Flushing usage events
[0m15:01:03.185187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1eebdce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1eeeda5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1eee315e0>]}


============================== 15:01:03.191587 | 91a9e16b-d352-45a6-bf3b-49f016b45e94 ==============================
[0m15:01:03.191587 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:01:03.192549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:01:03.280606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91a9e16b-d352-45a6-bf3b-49f016b45e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1eed0cf20>]}
[0m15:01:04.476145 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qtvotaj2'
[0m15:01:04.476951 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:01:04.669565 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:01:04.670715 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:01:04.770445 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:01:04.774058 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m15:01:04.929603 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m15:01:04.933272 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m15:01:05.074145 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m15:01:05.076844 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:01:12.080412 [info ] [MainThread]: Installed from version 1.3.1
[0m15:01:12.081331 [info ] [MainThread]: Up to date!
[0m15:01:12.082189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '91a9e16b-d352-45a6-bf3b-49f016b45e94', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ee96d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ee96d880>]}
[0m15:01:12.082950 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m15:01:25.835817 [info ] [MainThread]: Installed from version 0.10.9
[0m15:01:25.837693 [info ] [MainThread]: Up to date!
[0m15:01:25.838850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '91a9e16b-d352-45a6-bf3b-49f016b45e94', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ee98d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ee98d550>]}
[0m15:01:25.839975 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m15:01:28.452468 [info ] [MainThread]: Installed from version 0.15.0
[0m15:01:28.453308 [info ] [MainThread]: Up to date!
[0m15:01:28.454313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '91a9e16b-d352-45a6-bf3b-49f016b45e94', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ee98d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ee98da60>]}
[0m15:01:28.458411 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 25.34471, "process_user_time": 2.553948, "process_kernel_time": 1.058124, "process_mem_max_rss": "219992", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m15:01:28.459773 [debug] [MainThread]: Command `dbt deps` succeeded at 15:01:28.459477 after 25.35 seconds
[0m15:01:28.461160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1eee3b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1eef1bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1eeeda5a0>]}
[0m15:01:28.462410 [debug] [MainThread]: Flushing usage events
[0m15:01:32.726936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfbe4c79310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfbe4f69fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfbe4c78890>]}


============================== 15:01:32.733411 | 90d614b7-31ec-44be-8865-cc15e7fd0eac ==============================
[0m15:01:32.733411 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:01:32.734326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/retail', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:01:32.747024 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_DATASET'
[0m15:01:32.748259 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.08740641, "process_user_time": 1.951695, "process_kernel_time": 0.139691, "process_mem_max_rss": "196364", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:01:32.749172 [debug] [MainThread]: Command `dbt run` failed at 15:01:32.748953 after 0.09 seconds
[0m15:01:32.749789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfbe4c2bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfbe4e90a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfbe4f34e00>]}
[0m15:01:32.750407 [debug] [MainThread]: Flushing usage events
[0m15:36:27.640136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb8fbce810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb8fee53a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb900658e0>]}


============================== 15:36:27.649044 | ed137562-52c0-4982-affb-cdfb0fa62155 ==============================
[0m15:36:27.649044 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:36:27.650256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'send_anonymous_usage_stats': 'True'}
[0m15:36:27.810151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed137562-52c0-4982-affb-cdfb0fa62155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb8fbdc1a0>]}
[0m15:36:29.349588 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vt7_gf36'
[0m15:36:29.350898 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:36:29.621195 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:36:29.622692 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:36:29.751654 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:36:29.755955 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m15:36:29.883439 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m15:36:29.887625 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m15:36:30.009609 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m15:36:30.013159 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:36:39.174823 [info ] [MainThread]: Installed from version 1.3.1
[0m15:36:39.176063 [info ] [MainThread]: Up to date!
[0m15:36:39.177256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ed137562-52c0-4982-affb-cdfb0fa62155', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb8fb3aea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb8fb3ad80>]}
[0m15:36:39.178819 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m15:36:46.704997 [info ] [MainThread]: Installed from version 0.10.9
[0m15:36:46.706373 [info ] [MainThread]: Up to date!
[0m15:36:46.707316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ed137562-52c0-4982-affb-cdfb0fa62155', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb8fbcf380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb8fca28a0>]}
[0m15:36:46.708256 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m15:36:49.589530 [info ] [MainThread]: Installed from version 0.15.0
[0m15:36:49.590959 [info ] [MainThread]: Up to date!
[0m15:36:49.592404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ed137562-52c0-4982-affb-cdfb0fa62155', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb8fbde930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb8fbdeba0>]}
[0m15:36:49.596213 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 22.082594, "process_user_time": 4.205405, "process_kernel_time": 1.56974, "process_mem_max_rss": "217932", "process_out_blocks": "9912", "process_in_blocks": "0"}
[0m15:36:49.597600 [debug] [MainThread]: Command `dbt deps` succeeded at 15:36:49.597241 after 22.08 seconds
[0m15:36:49.599225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb8fce5eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb8fe0a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb908a3440>]}
[0m15:36:49.600867 [debug] [MainThread]: Flushing usage events
[0m15:36:57.306952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31e8057710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31e9a43a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31e798b4a0>]}


============================== 15:36:57.320327 | e04cef0f-51c4-4d14-83e0-b0a5ab705a50 ==============================
[0m15:36:57.320327 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:36:57.323046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:36:59.431610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e04cef0f-51c4-4d14-83e0-b0a5ab705a50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31ba917770>]}
[0m15:36:59.542224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e04cef0f-51c4-4d14-83e0-b0a5ab705a50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31badc4110>]}
[0m15:36:59.543871 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m15:36:59.686535 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:36:59.767303 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:36:59.768705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e04cef0f-51c4-4d14-83e0-b0a5ab705a50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31bacb0da0>]}
[0m15:37:11.472961 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.retail
[0m15:37:11.484449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e04cef0f-51c4-4d14-83e0-b0a5ab705a50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31b8ad1b50>]}
[0m15:37:11.552894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e04cef0f-51c4-4d14-83e0-b0a5ab705a50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31b89c09e0>]}
[0m15:37:11.554349 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 847 macros, 0 groups, 0 semantic models
[0m15:37:11.555886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e04cef0f-51c4-4d14-83e0-b0a5ab705a50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31b8acbb90>]}
[0m15:37:11.569206 [info ] [MainThread]: 
[0m15:37:11.571399 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:37:11.574177 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m15:37:11.575467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:12.363392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now create_retail-data-pipeline-dev_retail_raw_retail_prod)
[0m15:37:12.365855 [debug] [ThreadPool]: Creating schema "database: "retail-data-pipeline-dev"
schema: "retail_raw_retail_prod"
"
[0m15:37:12.380005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:12.452475 [debug] [ThreadPool]: On create_retail-data-pipeline-dev_retail_raw_retail_prod: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "connection_name": "create_retail-data-pipeline-dev_retail_raw_retail_prod"} */
create schema if not exists `retail-data-pipeline-dev`.`retail_raw_retail_prod`
  
[0m15:37:13.297830 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:1b2133d2-f7e3-447d-b282-22f252193fa0&page=queryresults
[0m15:37:16.011856 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_retail-data-pipeline-dev_retail_raw_retail_prod, now list_retail-data-pipeline-dev_retail_raw_retail_prod)
[0m15:37:16.013210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:16.593984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e04cef0f-51c4-4d14-83e0-b0a5ab705a50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31ba81cbc0>]}
[0m15:37:16.595835 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:37:16.596978 [info ] [MainThread]: 
[0m15:37:16.610824 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m15:37:16.611777 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m15:37:16.612757 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_raw_retail_prod.bronze__orders ............. [RUN]
[0m15:37:16.613849 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_raw_retail_prod.bronze__users .............. [RUN]
[0m15:37:16.615436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_raw_retail_prod, now model.retail.bronze__orders)
[0m15:37:16.617058 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m15:37:16.618257 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m15:37:16.619464 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m15:37:16.628504 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m15:37:16.633982 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m15:37:16.647909 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 15:37:16.620334 => 15:37:16.647380
[0m15:37:16.649238 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m15:37:16.656487 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 15:37:16.629585 => 15:37:16.655751
[0m15:37:16.663296 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m15:37:16.725564 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m15:37:16.727370 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m15:37:16.741779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:16.744621 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:37:16.813068 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_raw_retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m15:37:16.878884 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_raw_retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m15:37:17.481319 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:cabd181b-c104-40f3-9532-822dc1947695&page=queryresults
[0m15:37:17.484017 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_raw_retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m15:37:17.485213 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: cabd181b-c104-40f3-9532-822dc1947695

[0m15:37:17.486779 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 15:37:16.671100 => 15:37:17.486348
[0m15:37:17.497973 [debug] [Thread-2 (]: Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: cabd181b-c104-40f3-9532-822dc1947695
  
[0m15:37:17.499550 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e04cef0f-51c4-4d14-83e0-b0a5ab705a50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31b8983ad0>]}
[0m15:37:17.500977 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model retail_raw_retail_prod.bronze__users ..... [[31mERROR[0m in 0.88s]
[0m15:37:17.502451 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m15:37:17.505963 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:ec48d51e-b643-4e44-85a9-393837fd9ac6&page=queryresults
[0m15:37:17.508357 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_raw_retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m15:37:17.509567 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: ec48d51e-b643-4e44-85a9-393837fd9ac6

[0m15:37:17.510935 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 15:37:16.650103 => 15:37:17.510482
[0m15:37:17.515812 [debug] [Thread-1 (]: Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: ec48d51e-b643-4e44-85a9-393837fd9ac6
  
[0m15:37:17.516988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e04cef0f-51c4-4d14-83e0-b0a5ab705a50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31b8982000>]}
[0m15:37:17.518359 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model retail_raw_retail_prod.bronze__orders .... [[31mERROR[0m in 0.90s]
[0m15:37:17.519769 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m15:37:17.524992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:17.526222 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m15:37:17.527240 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m15:37:17.528172 [info ] [MainThread]: 
[0m15:37:17.529270 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.96 seconds (5.96s).
[0m15:37:17.530712 [debug] [MainThread]: Command end result
[0m15:37:17.591485 [info ] [MainThread]: 
[0m15:37:17.592981 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:37:17.594289 [info ] [MainThread]: 
[0m15:37:17.595549 [error] [MainThread]:   Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: cabd181b-c104-40f3-9532-822dc1947695
  
[0m15:37:17.597244 [info ] [MainThread]: 
[0m15:37:17.598613 [error] [MainThread]:   Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: ec48d51e-b643-4e44-85a9-393837fd9ac6
  
[0m15:37:17.600003 [info ] [MainThread]: 
[0m15:37:17.601425 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m15:37:17.603487 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 20.433613, "process_user_time": 10.699918, "process_kernel_time": 1.777895, "process_mem_max_rss": "245960", "process_out_blocks": "160", "command_success": false, "process_in_blocks": "0"}
[0m15:37:17.605269 [debug] [MainThread]: Command `dbt run` failed at 15:37:17.604844 after 20.44 seconds
[0m15:37:17.606614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31e7f817c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31b8acbb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31e7c7ac30>]}
[0m15:37:17.608233 [debug] [MainThread]: Flushing usage events
[0m15:55:23.130972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c5c2051c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c5c206480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c5c204170>]}


============================== 15:55:23.141838 | 9943bb01-2785-4c73-a02d-3d002c0118cb ==============================
[0m15:55:23.141838 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:55:23.143302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'send_anonymous_usage_stats': 'True'}
[0m15:55:23.291957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9943bb01-2785-4c73-a02d-3d002c0118cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c5c094410>]}
[0m15:55:24.822310 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8du2qgma'
[0m15:55:24.823531 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:55:25.042510 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:55:25.044001 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:55:25.134578 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:55:25.140867 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m15:55:25.230348 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m15:55:25.237370 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m15:55:25.381548 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m15:55:25.384624 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:55:34.684051 [info ] [MainThread]: Installed from version 1.3.1
[0m15:55:34.685200 [info ] [MainThread]: Up to date!
[0m15:55:34.686136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9943bb01-2785-4c73-a02d-3d002c0118cb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c5c5406b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c5c543d70>]}
[0m15:55:34.687154 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m15:55:41.313133 [info ] [MainThread]: Installed from version 0.10.9
[0m15:55:41.315150 [info ] [MainThread]: Up to date!
[0m15:55:41.316298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9943bb01-2785-4c73-a02d-3d002c0118cb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c5c14bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c5c14baa0>]}
[0m15:55:41.317376 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m15:55:44.520019 [info ] [MainThread]: Installed from version 0.15.0
[0m15:55:44.521047 [info ] [MainThread]: Up to date!
[0m15:55:44.521897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9943bb01-2785-4c73-a02d-3d002c0118cb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c5c14bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c5c14bb00>]}
[0m15:55:44.524845 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 21.520021, "process_user_time": 3.882041, "process_kernel_time": 1.191314, "process_mem_max_rss": "217932", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m15:55:44.525958 [debug] [MainThread]: Command `dbt deps` succeeded at 15:55:44.525705 after 21.52 seconds
[0m15:55:44.527091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c5c4607a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c5c897a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c5bf95790>]}
[0m15:55:44.528123 [debug] [MainThread]: Flushing usage events
[0m15:55:51.686255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c20fb17740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c20fb17140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c20fb17950>]}


============================== 15:55:51.699455 | 6b3b597c-b31b-400d-946f-01a99fa332cc ==============================
[0m15:55:51.699455 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:55:51.701444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:55:53.519848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b3b597c-b31b-400d-946f-01a99fa332cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c1e2bbcc80>]}
[0m15:55:53.673550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b3b597c-b31b-400d-946f-01a99fa332cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c1e35dde80>]}
[0m15:55:53.675698 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m15:55:53.818110 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:56:02.209817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:56:02.210964 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:56:02.212303 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.retail
[0m15:56:02.221353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b3b597c-b31b-400d-946f-01a99fa332cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c1e30e1100>]}
[0m15:56:02.283352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b3b597c-b31b-400d-946f-01a99fa332cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c1e29d54c0>]}
[0m15:56:02.284861 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 847 macros, 0 groups, 0 semantic models
[0m15:56:02.286145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b3b597c-b31b-400d-946f-01a99fa332cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c1e2c56150>]}
[0m15:56:02.299996 [info ] [MainThread]: 
[0m15:56:02.301994 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:56:02.304719 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m15:56:02.306092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:03.051722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now create_retail-data-pipeline-dev_retail_raw_retail_prod)
[0m15:56:03.053815 [debug] [ThreadPool]: Creating schema "database: "retail-data-pipeline-dev"
schema: "retail_raw_retail_prod"
"
[0m15:56:03.070714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:03.128270 [debug] [ThreadPool]: On create_retail-data-pipeline-dev_retail_raw_retail_prod: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "connection_name": "create_retail-data-pipeline-dev_retail_raw_retail_prod"} */
create schema if not exists `retail-data-pipeline-dev`.`retail_raw_retail_prod`
  
[0m15:56:03.969300 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:e98947bb-24bb-4afb-900d-180c58e8077b&page=queryresults
[0m15:56:05.883886 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev_retail_raw_retail_prod'
[0m15:56:05.884882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:06.514069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b3b597c-b31b-400d-946f-01a99fa332cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c1e315c3e0>]}
[0m15:56:06.516186 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:56:06.517619 [info ] [MainThread]: 
[0m15:56:06.535162 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m15:56:06.536427 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m15:56:06.537862 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_raw_retail_prod.bronze__orders ............. [RUN]
[0m15:56:06.539481 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_raw_retail_prod.bronze__users .............. [RUN]
[0m15:56:06.541296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_raw_retail_prod, now model.retail.bronze__orders)
[0m15:56:06.542798 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly create_retail-data-pipeline-dev_retail_raw_retail_prod, now model.retail.bronze__users)
[0m15:56:06.544040 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m15:56:06.545890 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m15:56:06.556537 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m15:56:06.561803 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m15:56:06.577705 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 15:56:06.547049 => 15:56:06.577035
[0m15:56:06.579032 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m15:56:06.586653 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 15:56:06.557114 => 15:56:06.586097
[0m15:56:06.593346 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m15:56:06.623626 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m15:56:06.626668 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m15:56:06.639570 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:56:06.642909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:06.700626 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_raw_retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m15:56:06.804635 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_raw_retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m15:56:07.356827 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:60e86e3d-afb4-4581-95ba-c0cf0a279f2c&page=queryresults
[0m15:56:07.359522 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_raw_retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m15:56:07.360628 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: 60e86e3d-afb4-4581-95ba-c0cf0a279f2c

[0m15:56:07.362443 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 15:56:06.599642 => 15:56:07.361764
[0m15:56:07.373072 [debug] [Thread-2 (]: Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 60e86e3d-afb4-4581-95ba-c0cf0a279f2c
  
[0m15:56:07.374500 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b3b597c-b31b-400d-946f-01a99fa332cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c1e25ed820>]}
[0m15:56:07.375881 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model retail_raw_retail_prod.bronze__users ..... [[31mERROR[0m in 0.83s]
[0m15:56:07.377685 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m15:56:07.422595 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:0383d366-a7a4-403a-b93c-c4bdca267eee&page=queryresults
[0m15:56:07.425424 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_raw_retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m15:56:07.426772 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: 0383d366-a7a4-403a-b93c-c4bdca267eee

[0m15:56:07.428272 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 15:56:06.579810 => 15:56:07.427744
[0m15:56:07.434848 [debug] [Thread-1 (]: Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 0383d366-a7a4-403a-b93c-c4bdca267eee
  
[0m15:56:07.436237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b3b597c-b31b-400d-946f-01a99fa332cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c1e25ef9e0>]}
[0m15:56:07.437852 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model retail_raw_retail_prod.bronze__orders .... [[31mERROR[0m in 0.90s]
[0m15:56:07.439644 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m15:56:07.444095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:07.445296 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m15:56:07.446549 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m15:56:07.448057 [info ] [MainThread]: 
[0m15:56:07.449220 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.15 seconds (5.15s).
[0m15:56:07.450780 [debug] [MainThread]: Command end result
[0m15:56:07.500450 [info ] [MainThread]: 
[0m15:56:07.501966 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:56:07.503312 [info ] [MainThread]: 
[0m15:56:07.504771 [error] [MainThread]:   Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 60e86e3d-afb4-4581-95ba-c0cf0a279f2c
  
[0m15:56:07.505815 [info ] [MainThread]: 
[0m15:56:07.507072 [error] [MainThread]:   Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 0383d366-a7a4-403a-b93c-c4bdca267eee
  
[0m15:56:07.508561 [info ] [MainThread]: 
[0m15:56:07.509897 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m15:56:07.512595 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.960299, "process_user_time": 6.35228, "process_kernel_time": 1.577007, "process_mem_max_rss": "236572", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:56:07.514318 [debug] [MainThread]: Command `dbt run` failed at 15:56:07.513844 after 15.96 seconds
[0m15:56:07.515608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c214657380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c1e32b4b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c2126d5dc0>]}
[0m15:56:07.516882 [debug] [MainThread]: Flushing usage events
[0m15:57:03.708925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751b7dd640e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751b7dd66bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751b7dd654c0>]}


============================== 15:57:03.722595 | 03e30d18-4fef-42a8-9f00-06e514d5c552 ==============================
[0m15:57:03.722595 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:57:03.724390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/retail', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:57:05.564911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03e30d18-4fef-42a8-9f00-06e514d5c552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751b510d4530>]}
[0m15:57:05.708414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03e30d18-4fef-42a8-9f00-06e514d5c552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751b514e1010>]}
[0m15:57:05.710642 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m15:57:05.856223 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:57:14.137047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:57:14.138059 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:57:14.139433 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.retail
[0m15:57:14.151075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03e30d18-4fef-42a8-9f00-06e514d5c552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751b7dd64f20>]}
[0m15:57:14.214206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03e30d18-4fef-42a8-9f00-06e514d5c552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751b50c1cfb0>]}
[0m15:57:14.215553 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 847 macros, 0 groups, 0 semantic models
[0m15:57:14.216919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03e30d18-4fef-42a8-9f00-06e514d5c552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751b53b7d2e0>]}
[0m15:57:14.228557 [info ] [MainThread]: 
[0m15:57:14.230332 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:57:14.232333 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m15:57:14.233171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:14.948720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now create_retail-data-pipeline-dev_retail_raw_retail_prod)
[0m15:57:14.950267 [debug] [ThreadPool]: Creating schema "database: "retail-data-pipeline-dev"
schema: "retail_raw_retail_prod"
"
[0m15:57:14.960295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:15.027382 [debug] [ThreadPool]: On create_retail-data-pipeline-dev_retail_raw_retail_prod: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "connection_name": "create_retail-data-pipeline-dev_retail_raw_retail_prod"} */
create schema if not exists `retail-data-pipeline-dev`.`retail_raw_retail_prod`
  
[0m15:57:15.602563 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:8399eb69-057e-40b7-a1ec-1bc96b138b61&page=queryresults
[0m15:57:19.532793 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev_retail_raw_retail_prod'
[0m15:57:19.534062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:20.124238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03e30d18-4fef-42a8-9f00-06e514d5c552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751b7dfc1430>]}
[0m15:57:20.125848 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:57:20.126946 [info ] [MainThread]: 
[0m15:57:20.137114 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m15:57:20.137793 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m15:57:20.138850 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_raw_retail_prod.bronze__orders ............. [RUN]
[0m15:57:20.140029 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_raw_retail_prod.bronze__users .............. [RUN]
[0m15:57:20.141373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_raw_retail_prod, now model.retail.bronze__orders)
[0m15:57:20.142520 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly create_retail-data-pipeline-dev_retail_raw_retail_prod, now model.retail.bronze__users)
[0m15:57:20.143312 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m15:57:20.144142 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m15:57:20.152154 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m15:57:20.156758 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m15:57:20.170316 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 15:57:20.144819 => 15:57:20.169745
[0m15:57:20.171448 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m15:57:20.179545 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 15:57:20.152523 => 15:57:20.179112
[0m15:57:20.186083 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m15:57:20.220245 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m15:57:20.223916 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m15:57:20.235600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:20.238607 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:57:20.328183 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_raw_retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m15:57:20.333479 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_raw_retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m15:57:20.927216 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:8849e6ea-ec63-4f41-b3d7-7e51ce37fee7&page=queryresults
[0m15:57:20.930751 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_raw_retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m15:57:20.932567 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: 8849e6ea-ec63-4f41-b3d7-7e51ce37fee7

[0m15:57:20.934675 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 15:57:20.192876 => 15:57:20.933972
[0m15:57:20.939949 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:e625bdf9-aa06-4a8e-bbc1-ca3e885c052b&page=queryresults
[0m15:57:20.944092 [debug] [Thread-2 (]: Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 8849e6ea-ec63-4f41-b3d7-7e51ce37fee7
  
[0m15:57:20.946567 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03e30d18-4fef-42a8-9f00-06e514d5c552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751b508628d0>]}
[0m15:57:20.947285 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_raw_retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m15:57:20.948608 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model retail_raw_retail_prod.bronze__users ..... [[31mERROR[0m in 0.80s]
[0m15:57:20.950363 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: e625bdf9-aa06-4a8e-bbc1-ca3e885c052b

[0m15:57:20.952249 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m15:57:20.953873 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 15:57:20.172314 => 15:57:20.953341
[0m15:57:20.960712 [debug] [Thread-1 (]: Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: e625bdf9-aa06-4a8e-bbc1-ca3e885c052b
  
[0m15:57:20.961803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03e30d18-4fef-42a8-9f00-06e514d5c552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751b5082bbf0>]}
[0m15:57:20.963189 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model retail_raw_retail_prod.bronze__orders .... [[31mERROR[0m in 0.82s]
[0m15:57:20.964921 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m15:57:20.969948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:20.971152 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m15:57:20.972223 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m15:57:20.973425 [info ] [MainThread]: 
[0m15:57:20.974495 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.74 seconds (6.74s).
[0m15:57:20.977017 [debug] [MainThread]: Command end result
[0m15:57:21.025926 [info ] [MainThread]: 
[0m15:57:21.027440 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:57:21.028635 [info ] [MainThread]: 
[0m15:57:21.029657 [error] [MainThread]:   Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 8849e6ea-ec63-4f41-b3d7-7e51ce37fee7
  
[0m15:57:21.030675 [info ] [MainThread]: 
[0m15:57:21.032084 [error] [MainThread]:   Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: e625bdf9-aa06-4a8e-bbc1-ca3e885c052b
  
[0m15:57:21.033791 [info ] [MainThread]: 
[0m15:57:21.035034 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m15:57:21.037715 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 17.441164, "process_user_time": 6.309242, "process_kernel_time": 1.590429, "process_mem_max_rss": "242416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:57:21.039399 [debug] [MainThread]: Command `dbt run` failed at 15:57:21.039072 after 17.44 seconds
[0m15:57:21.041012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751b7de09af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751b7dfb8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751b7e0a3a70>]}
[0m15:57:21.042387 [debug] [MainThread]: Flushing usage events
[0m15:59:54.941963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d656b05100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d656c89c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d65739a6f0>]}


============================== 15:59:54.948376 | fa0c347e-2be0-4d54-8c76-cf73cfa08c48 ==============================
[0m15:59:54.948376 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:59:54.949515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:59:55.053732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa0c347e-2be0-4d54-8c76-cf73cfa08c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d656d597c0>]}
[0m15:59:56.528989 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7ecurwhu'
[0m15:59:56.530113 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:59:56.786476 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:59:56.787994 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:59:56.923366 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:59:56.926733 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m15:59:57.059885 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m15:59:57.073428 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m15:59:57.201035 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m15:59:57.204751 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:00:05.237339 [info ] [MainThread]: Installed from version 1.3.1
[0m16:00:05.238488 [info ] [MainThread]: Up to date!
[0m16:00:05.240972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fa0c347e-2be0-4d54-8c76-cf73cfa08c48', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d656aee0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d65b2f90d0>]}
[0m16:00:05.242318 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m16:00:12.953165 [info ] [MainThread]: Installed from version 0.10.9
[0m16:00:12.954068 [info ] [MainThread]: Up to date!
[0m16:00:12.954704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fa0c347e-2be0-4d54-8c76-cf73cfa08c48', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d6569e7590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d6569e7d10>]}
[0m16:00:12.955425 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m16:00:15.644279 [info ] [MainThread]: Installed from version 0.15.0
[0m16:00:15.645118 [info ] [MainThread]: Up to date!
[0m16:00:15.646045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fa0c347e-2be0-4d54-8c76-cf73cfa08c48', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d6569e7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d6569e7a70>]}
[0m16:00:15.649077 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 20.793364, "process_user_time": 3.046242, "process_kernel_time": 0.876432, "process_mem_max_rss": "156844", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m16:00:15.650437 [debug] [MainThread]: Command `dbt deps` succeeded at 16:00:15.650095 after 20.79 seconds
[0m16:00:15.651667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d656c160f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d6569bfa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d656b04e60>]}
[0m16:00:15.652578 [debug] [MainThread]: Flushing usage events
[0m16:00:20.092965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5b89751d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5b89880bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5b89750cb0>]}


============================== 16:00:20.099713 | 6821829a-893a-4003-abb7-89713b998a31 ==============================
[0m16:00:20.099713 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:00:20.100727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:00:21.218207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6821829a-893a-4003-abb7-89713b998a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5b62cc0530>]}
[0m16:00:21.325536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6821829a-893a-4003-abb7-89713b998a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5b607af7d0>]}
[0m16:00:21.326821 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:00:21.466760 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:00:28.197636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:28.198396 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:28.199384 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.retail
[0m16:00:28.205515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6821829a-893a-4003-abb7-89713b998a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5b6087ce00>]}
[0m16:00:28.269722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6821829a-893a-4003-abb7-89713b998a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5b60600da0>]}
[0m16:00:28.270615 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 847 macros, 0 groups, 0 semantic models
[0m16:00:28.271486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6821829a-893a-4003-abb7-89713b998a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5b60b61e80>]}
[0m16:00:28.283567 [info ] [MainThread]: 
[0m16:00:28.284896 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:00:28.286697 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m16:00:28.287625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:29.156619 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_raw_retail_prod)
[0m16:00:29.157548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:29.734860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6821829a-893a-4003-abb7-89713b998a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5b89752600>]}
[0m16:00:29.735968 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:29.736640 [info ] [MainThread]: 
[0m16:00:29.745796 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m16:00:29.747082 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m16:00:29.747749 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_raw_retail_prod.bronze__orders ............. [RUN]
[0m16:00:29.748670 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_raw_retail_prod.bronze__users .............. [RUN]
[0m16:00:29.749877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_raw_retail_prod, now model.retail.bronze__orders)
[0m16:00:29.750988 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m16:00:29.751976 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m16:00:29.752795 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m16:00:29.761862 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m16:00:29.766849 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m16:00:29.778494 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 16:00:29.763499 => 16:00:29.777957
[0m16:00:29.779964 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m16:00:29.793843 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 16:00:29.753705 => 16:00:29.793287
[0m16:00:29.799949 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m16:00:29.841732 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m16:00:29.842474 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m16:00:29.853710 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:00:29.855601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:29.890097 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_raw_retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m16:00:29.926279 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_raw_retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m16:00:30.489670 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:b47a49f1-f64f-4620-aff0-f321678aeeff&page=queryresults
[0m16:00:30.491604 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_raw_retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m16:00:30.492518 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: b47a49f1-f64f-4620-aff0-f321678aeeff

[0m16:00:30.493468 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 16:00:29.806290 => 16:00:30.493266
[0m16:00:30.497945 [debug] [Thread-1 (]: Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: b47a49f1-f64f-4620-aff0-f321678aeeff
  
[0m16:00:30.498771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6821829a-893a-4003-abb7-89713b998a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5b601f7890>]}
[0m16:00:30.499651 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model retail_raw_retail_prod.bronze__orders .... [[31mERROR[0m in 0.75s]
[0m16:00:30.500545 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m16:00:30.762424 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:ef0b9b45-f375-4188-bb9d-21df5faede54&page=queryresults
[0m16:00:30.764522 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_raw_retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m16:00:30.765474 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: ef0b9b45-f375-4188-bb9d-21df5faede54

[0m16:00:30.766534 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 16:00:29.781135 => 16:00:30.766270
[0m16:00:30.769388 [debug] [Thread-2 (]: Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: ef0b9b45-f375-4188-bb9d-21df5faede54
  
[0m16:00:30.770325 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6821829a-893a-4003-abb7-89713b998a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5b60220650>]}
[0m16:00:30.771266 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model retail_raw_retail_prod.bronze__users ..... [[31mERROR[0m in 1.02s]
[0m16:00:30.772197 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m16:00:30.775090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:30.775865 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m16:00:30.776595 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m16:00:30.777298 [info ] [MainThread]: 
[0m16:00:30.778054 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m16:00:30.779429 [debug] [MainThread]: Command end result
[0m16:00:30.817618 [info ] [MainThread]: 
[0m16:00:30.818616 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:00:30.819386 [info ] [MainThread]: 
[0m16:00:30.820085 [error] [MainThread]:   Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: b47a49f1-f64f-4620-aff0-f321678aeeff
  
[0m16:00:30.820802 [info ] [MainThread]: 
[0m16:00:30.821522 [error] [MainThread]:   Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: ef0b9b45-f375-4188-bb9d-21df5faede54
  
[0m16:00:30.822304 [info ] [MainThread]: 
[0m16:00:30.823039 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m16:00:30.824205 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.796183, "process_user_time": 4.035488, "process_kernel_time": 1.30216, "process_mem_max_rss": "237084", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:00:30.825035 [debug] [MainThread]: Command `dbt run` failed at 16:00:30.824896 after 10.80 seconds
[0m16:00:30.825833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5b89880bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5b8967cbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5b60232ba0>]}
[0m16:00:30.826450 [debug] [MainThread]: Flushing usage events
[0m16:01:20.948383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d79ef79b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d7a1e6c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d7a17ca70>]}


============================== 16:01:20.954788 | 9bb5093c-cf85-44f4-830f-ef67d008e9f8 ==============================
[0m16:01:20.954788 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:01:20.955682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:01:21.057466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bb5093c-cf85-44f4-830f-ef67d008e9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d79d8a4e0>]}
[0m16:01:22.554967 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-f42uu7xo'
[0m16:01:22.556155 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:01:22.755764 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:01:22.757142 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:01:22.859588 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:01:22.863305 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m16:01:22.987226 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m16:01:22.991260 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m16:01:23.116936 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m16:01:23.119582 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:01:30.405335 [info ] [MainThread]: Installed from version 1.3.1
[0m16:01:30.406209 [info ] [MainThread]: Up to date!
[0m16:01:30.406895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9bb5093c-cf85-44f4-830f-ef67d008e9f8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d79c54530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d79d895b0>]}
[0m16:01:30.407594 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m16:01:36.394943 [info ] [MainThread]: Installed from version 0.10.9
[0m16:01:36.395798 [info ] [MainThread]: Up to date!
[0m16:01:36.396476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9bb5093c-cf85-44f4-830f-ef67d008e9f8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d79c8da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d79c8db20>]}
[0m16:01:36.397074 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m16:01:38.863256 [info ] [MainThread]: Installed from version 0.15.0
[0m16:01:38.864277 [info ] [MainThread]: Up to date!
[0m16:01:38.865158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9bb5093c-cf85-44f4-830f-ef67d008e9f8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d79c8da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d79ca9a30>]}
[0m16:01:38.866962 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 18.00014, "process_user_time": 2.87898, "process_kernel_time": 0.572404, "process_mem_max_rss": "194160", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m16:01:38.868016 [debug] [MainThread]: Command `dbt deps` succeeded at 16:01:38.867752 after 18.00 seconds
[0m16:01:38.869090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d7a227e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d7a0711c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4d7a070bf0>]}
[0m16:01:38.870143 [debug] [MainThread]: Flushing usage events
[0m16:01:43.514550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794814c9e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794814cbd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794814b93e30>]}


============================== 16:01:43.521537 | 4d8b89ab-8c30-493d-8bd7-a0d0a62d49a0 ==============================
[0m16:01:43.521537 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:01:43.522395 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:01:44.531675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d8b89ab-8c30-493d-8bd7-a0d0a62d49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7947ee3963c0>]}
[0m16:01:44.608975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d8b89ab-8c30-493d-8bd7-a0d0a62d49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7947ec7e18b0>]}
[0m16:01:44.610383 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:01:44.734370 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:01:44.788277 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:01:44.789280 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m16:01:44.790193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4d8b89ab-8c30-493d-8bd7-a0d0a62d49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7947e7b904d0>]}
[0m16:01:53.769982 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.retail
[0m16:01:53.775347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d8b89ab-8c30-493d-8bd7-a0d0a62d49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7947e76b3f50>]}
[0m16:01:53.825136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d8b89ab-8c30-493d-8bd7-a0d0a62d49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7947e7728740>]}
[0m16:01:53.826371 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 847 macros, 0 groups, 0 semantic models
[0m16:01:53.827213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d8b89ab-8c30-493d-8bd7-a0d0a62d49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7947e77f69c0>]}
[0m16:01:53.835480 [info ] [MainThread]: 
[0m16:01:53.836755 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:01:53.838343 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m16:01:53.839147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:54.569776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now create_retail-data-pipeline-dev_retail_prod_retail_prod)
[0m16:01:54.571445 [debug] [ThreadPool]: Creating schema "database: "retail-data-pipeline-dev"
schema: "retail_prod_retail_prod"
"
[0m16:01:54.579650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:54.620250 [debug] [ThreadPool]: On create_retail-data-pipeline-dev_retail_prod_retail_prod: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "connection_name": "create_retail-data-pipeline-dev_retail_prod_retail_prod"} */
create schema if not exists `retail-data-pipeline-dev`.`retail_prod_retail_prod`
  
[0m16:01:55.327333 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:09dd5fc6-3363-4772-adde-77472b196bf3&page=queryresults
[0m16:01:57.185706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_retail-data-pipeline-dev_retail_prod_retail_prod, now list_retail-data-pipeline-dev_retail_prod_retail_prod)
[0m16:01:57.187137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:57.895915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d8b89ab-8c30-493d-8bd7-a0d0a62d49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7947e76a4e30>]}
[0m16:01:57.897365 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:01:57.898088 [info ] [MainThread]: 
[0m16:01:57.909918 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m16:01:57.910583 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m16:01:57.911353 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod_retail_prod.bronze__orders ............ [RUN]
[0m16:01:57.912242 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod_retail_prod.bronze__users ............. [RUN]
[0m16:01:57.913465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod_retail_prod, now model.retail.bronze__orders)
[0m16:01:57.914799 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m16:01:57.915893 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m16:01:57.916997 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m16:01:57.923642 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m16:01:57.927617 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m16:01:57.940604 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 16:01:57.924636 => 16:01:57.940074
[0m16:01:57.941583 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m16:01:57.949044 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 16:01:57.917632 => 16:01:57.948555
[0m16:01:57.955370 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m16:01:57.992110 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m16:01:57.994352 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m16:01:58.005416 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:01:58.007971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:58.042457 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m16:01:58.084455 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m16:01:58.670646 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:dd024fe5-893d-4609-8335-5d59f8270f9e&page=queryresults
[0m16:01:58.671411 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:dac1b29f-7afa-43a7-bff4-2fbee094d902&page=queryresults
[0m16:01:58.674031 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m16:01:58.674960 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod_retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m16:01:58.675511 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: dd024fe5-893d-4609-8335-5d59f8270f9e

[0m16:01:58.676339 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: dac1b29f-7afa-43a7-bff4-2fbee094d902

[0m16:01:58.677437 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 16:01:57.961483 => 16:01:58.677056
[0m16:01:58.678477 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 16:01:57.942207 => 16:01:58.678139
[0m16:01:58.687346 [debug] [Thread-1 (]: Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: dd024fe5-893d-4609-8335-5d59f8270f9e
  
[0m16:01:58.689634 [debug] [Thread-2 (]: Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: dac1b29f-7afa-43a7-bff4-2fbee094d902
  
[0m16:01:58.690228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8b89ab-8c30-493d-8bd7-a0d0a62d49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7947e5c1b800>]}
[0m16:01:58.691075 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8b89ab-8c30-493d-8bd7-a0d0a62d49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7947e5c0a840>]}
[0m16:01:58.691947 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model retail_prod_retail_prod.bronze__orders ... [[31mERROR[0m in 0.78s]
[0m16:01:58.692822 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model retail_prod_retail_prod.bronze__users .... [[31mERROR[0m in 0.78s]
[0m16:01:58.693932 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m16:01:58.695165 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m16:01:58.699588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:58.700598 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m16:01:58.701681 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m16:01:58.702724 [info ] [MainThread]: 
[0m16:01:58.703708 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.87 seconds (4.87s).
[0m16:01:58.705054 [debug] [MainThread]: Command end result
[0m16:01:58.748062 [info ] [MainThread]: 
[0m16:01:58.749235 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:01:58.750241 [info ] [MainThread]: 
[0m16:01:58.751394 [error] [MainThread]:   Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: dd024fe5-893d-4609-8335-5d59f8270f9e
  
[0m16:01:58.752898 [info ] [MainThread]: 
[0m16:01:58.754136 [error] [MainThread]:   Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: dac1b29f-7afa-43a7-bff4-2fbee094d902
  
[0m16:01:58.755179 [info ] [MainThread]: 
[0m16:01:58.756283 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m16:01:58.758181 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.317131, "process_user_time": 5.225903, "process_kernel_time": 1.505768, "process_mem_max_rss": "245444", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:01:58.759162 [debug] [MainThread]: Command `dbt run` failed at 16:01:58.758927 after 15.32 seconds
[0m16:01:58.760121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794814b43b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7947e79cc950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7947e7a64a40>]}
[0m16:01:58.760956 [debug] [MainThread]: Flushing usage events
[0m16:02:18.361471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f48c5ff770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f48ce1cf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f48bf27620>]}


============================== 16:02:18.367270 | 6608aac0-0b8a-47a1-ad93-2becac33ae30 ==============================
[0m16:02:18.367270 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:02:18.368043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:02:18.458340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6608aac0-0b8a-47a1-ad93-2becac33ae30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f48c0508f0>]}
[0m16:02:19.986861 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-eqmlnyod'
[0m16:02:19.987884 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:02:20.087039 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:02:20.088491 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:02:20.179629 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:02:20.184985 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m16:02:20.306982 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m16:02:20.312055 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m16:02:20.513436 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m16:02:20.517070 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:02:28.456543 [info ] [MainThread]: Installed from version 1.3.1
[0m16:02:28.457651 [info ] [MainThread]: Up to date!
[0m16:02:28.458725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6608aac0-0b8a-47a1-ad93-2becac33ae30', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f48be6fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f48be6ff50>]}
[0m16:02:28.459440 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m16:02:34.591581 [info ] [MainThread]: Installed from version 0.10.9
[0m16:02:34.592545 [info ] [MainThread]: Up to date!
[0m16:02:34.593257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6608aac0-0b8a-47a1-ad93-2becac33ae30', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f48bcd1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f48bcd18b0>]}
[0m16:02:34.594082 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m16:02:37.201792 [info ] [MainThread]: Installed from version 0.15.0
[0m16:02:37.202601 [info ] [MainThread]: Up to date!
[0m16:02:37.203324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6608aac0-0b8a-47a1-ad93-2becac33ae30', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f48bcd1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f48bcd1df0>]}
[0m16:02:37.205385 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 18.909138, "process_user_time": 2.850203, "process_kernel_time": 0.781841, "process_mem_max_rss": "194160", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m16:02:37.206496 [debug] [MainThread]: Command `dbt deps` succeeded at 16:02:37.206228 after 18.91 seconds
[0m16:02:37.207278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f48c0360f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f48c1677a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f48bfc6ba0>]}
[0m16:02:37.207981 [debug] [MainThread]: Flushing usage events
[0m16:02:41.990470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd6724f69f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd6724f56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd6724f7e60>]}


============================== 16:02:41.997699 | 10924ad3-26e2-4d1c-9b61-c0e63272a6c5 ==============================
[0m16:02:41.997699 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:02:41.998903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:02:43.276276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10924ad3-26e2-4d1c-9b61-c0e63272a6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd6724f80e0>]}
[0m16:02:43.375211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10924ad3-26e2-4d1c-9b61-c0e63272a6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd6724f88c0>]}
[0m16:02:43.376619 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:02:43.495205 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:02:43.549542 [info ] [MainThread]: Unable to do partial parsing because env vars used in dbt_project.yml have changed
[0m16:02:43.550683 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:02:43.551643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '10924ad3-26e2-4d1c-9b61-c0e63272a6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd6454d3170>]}
[0m16:02:51.900179 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:02:51.910521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10924ad3-26e2-4d1c-9b61-c0e63272a6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd64501cc80>]}
[0m16:02:51.976963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10924ad3-26e2-4d1c-9b61-c0e63272a6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd6451fb680>]}
[0m16:02:51.978457 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 847 macros, 0 groups, 0 semantic models
[0m16:02:51.979837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10924ad3-26e2-4d1c-9b61-c0e63272a6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd64511ecf0>]}
[0m16:02:51.994886 [info ] [MainThread]: 
[0m16:02:51.997208 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:02:51.999582 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m16:02:52.000538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:52.661500 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod)
[0m16:02:52.662406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:53.130560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10924ad3-26e2-4d1c-9b61-c0e63272a6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd64516d3a0>]}
[0m16:02:53.131884 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:02:53.132650 [info ] [MainThread]: 
[0m16:02:53.140886 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m16:02:53.141412 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m16:02:53.141954 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod.bronze__orders ........................ [RUN]
[0m16:02:53.142755 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod.bronze__users ......................... [RUN]
[0m16:02:53.143641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.bronze__orders)
[0m16:02:53.144532 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m16:02:53.145100 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m16:02:53.145645 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m16:02:53.152350 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m16:02:53.155072 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m16:02:53.164214 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 16:02:53.152674 => 16:02:53.163708
[0m16:02:53.165100 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 16:02:53.146161 => 16:02:53.164684
[0m16:02:53.165661 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m16:02:53.166417 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m16:02:53.213227 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m16:02:53.213992 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m16:02:53.227181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:53.230109 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:02:53.299104 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m16:02:53.302289 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m16:02:53.868479 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:ef924d80-bf7e-49d2-b583-de37dbc7709a&page=queryresults
[0m16:02:53.871900 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m16:02:53.872957 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: ef924d80-bf7e-49d2-b583-de37dbc7709a

[0m16:02:53.873714 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 16:02:53.178225 => 16:02:53.873525
[0m16:02:53.878273 [debug] [Thread-1 (]: Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: ef924d80-bf7e-49d2-b583-de37dbc7709a
  
[0m16:02:53.879016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10924ad3-26e2-4d1c-9b61-c0e63272a6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd6275dab70>]}
[0m16:02:53.879802 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model retail_prod.bronze__orders ............... [[31mERROR[0m in 0.74s]
[0m16:02:53.880703 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m16:02:54.096049 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:7462c929-7eee-4518-84cf-deb6ed3164b7&page=queryresults
[0m16:02:54.098179 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m16:02:54.099345 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: 7462c929-7eee-4518-84cf-deb6ed3164b7

[0m16:02:54.100676 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 16:02:53.166989 => 16:02:54.100425
[0m16:02:54.103980 [debug] [Thread-2 (]: Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 7462c929-7eee-4518-84cf-deb6ed3164b7
  
[0m16:02:54.105171 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10924ad3-26e2-4d1c-9b61-c0e63272a6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd6274e8950>]}
[0m16:02:54.106273 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model retail_prod.bronze__users ................ [[31mERROR[0m in 0.96s]
[0m16:02:54.107507 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m16:02:54.110972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:54.111841 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m16:02:54.112739 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m16:02:54.113881 [info ] [MainThread]: 
[0m16:02:54.114849 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m16:02:54.116377 [debug] [MainThread]: Command end result
[0m16:02:54.166158 [info ] [MainThread]: 
[0m16:02:54.167309 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:02:54.168052 [info ] [MainThread]: 
[0m16:02:54.169079 [error] [MainThread]:   Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: ef924d80-bf7e-49d2-b583-de37dbc7709a
  
[0m16:02:54.169986 [info ] [MainThread]: 
[0m16:02:54.170874 [error] [MainThread]:   Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 7462c929-7eee-4518-84cf-deb6ed3164b7
  
[0m16:02:54.171761 [info ] [MainThread]: 
[0m16:02:54.172481 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m16:02:54.174409 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.287201, "process_user_time": 6.032432, "process_kernel_time": 1.616773, "process_mem_max_rss": "245636", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:02:54.175370 [debug] [MainThread]: Command `dbt run` failed at 16:02:54.175174 after 12.29 seconds
[0m16:02:54.176100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd674c28fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd6724fb770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd644f5abd0>]}
[0m16:02:54.176861 [debug] [MainThread]: Flushing usage events
[0m16:04:01.989148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3e4228dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3e433b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3e422a540>]}


============================== 16:04:01.995644 | a561a8c3-abb8-41c4-b53f-74a700a36512 ==============================
[0m16:04:01.995644 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:04:01.996810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:04:02.091965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a561a8c3-abb8-41c4-b53f-74a700a36512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3e40bbfb0>]}
[0m16:04:03.509861 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3dn0q1_m'
[0m16:04:03.510677 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:04:03.720628 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:04:03.722556 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:04:03.863464 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:04:03.867029 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m16:04:04.002967 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m16:04:04.006823 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m16:04:04.141924 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m16:04:04.145023 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:04:11.908246 [info ] [MainThread]: Installed from version 1.3.1
[0m16:04:11.909558 [info ] [MainThread]: Up to date!
[0m16:04:11.910898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a561a8c3-abb8-41c4-b53f-74a700a36512', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3e3fb9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3e3fb9ac0>]}
[0m16:04:11.912098 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m16:04:18.123162 [info ] [MainThread]: Installed from version 0.10.9
[0m16:04:18.124110 [info ] [MainThread]: Up to date!
[0m16:04:18.125150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a561a8c3-abb8-41c4-b53f-74a700a36512', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3e4215b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3e4215850>]}
[0m16:04:18.125964 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m16:04:20.899493 [info ] [MainThread]: Installed from version 0.15.0
[0m16:04:20.900393 [info ] [MainThread]: Up to date!
[0m16:04:20.901236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a561a8c3-abb8-41c4-b53f-74a700a36512', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3e40bb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3e40bafc0>]}
[0m16:04:20.903976 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 19.001068, "process_user_time": 2.674748, "process_kernel_time": 0.738904, "process_mem_max_rss": "194160", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m16:04:20.905016 [debug] [MainThread]: Command `dbt deps` succeeded at 16:04:20.904767 after 19.00 seconds
[0m16:04:20.905717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3e40e39e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3e4567ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3e4354e30>]}
[0m16:04:20.906481 [debug] [MainThread]: Flushing usage events
[0m16:04:26.125766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd52a58410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd52a0bc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd52b8d3a0>]}


============================== 16:04:26.131898 | cab0c2ad-0df9-4830-b8a6-c2f84ca7ea68 ==============================
[0m16:04:26.131898 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:04:26.132767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:04:26.996395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cab0c2ad-0df9-4830-b8a6-c2f84ca7ea68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd25ad9220>]}
[0m16:04:27.072798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cab0c2ad-0df9-4830-b8a6-c2f84ca7ea68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd25dc4350>]}
[0m16:04:27.074195 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:04:27.184193 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:04:34.438831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:04:34.439722 [debug] [MainThread]: Partial parsing: added file: retail://macros/generate_schema_name.sql
[0m16:04:34.441844 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m16:04:35.919832 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:04:35.925511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cab0c2ad-0df9-4830-b8a6-c2f84ca7ea68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd24172b40>]}
[0m16:04:35.976397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cab0c2ad-0df9-4830-b8a6-c2f84ca7ea68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd254c50a0>]}
[0m16:04:35.977510 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:04:35.978666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cab0c2ad-0df9-4830-b8a6-c2f84ca7ea68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd077f9550>]}
[0m16:04:35.988153 [info ] [MainThread]: 
[0m16:04:35.989559 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:04:35.991379 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m16:04:35.992346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:36.692602 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod)
[0m16:04:36.693503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:37.241060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cab0c2ad-0df9-4830-b8a6-c2f84ca7ea68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd078b0080>]}
[0m16:04:37.242521 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:04:37.243414 [info ] [MainThread]: 
[0m16:04:37.253160 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m16:04:37.254465 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m16:04:37.255369 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod.bronze__orders ........................ [RUN]
[0m16:04:37.257203 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod.bronze__users ......................... [RUN]
[0m16:04:37.259106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.bronze__orders)
[0m16:04:37.260237 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m16:04:37.260928 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m16:04:37.261601 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m16:04:37.268144 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m16:04:37.271949 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m16:04:37.284273 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 16:04:37.268582 => 16:04:37.283777
[0m16:04:37.285197 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m16:04:37.296587 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 16:04:37.262217 => 16:04:37.296173
[0m16:04:37.302970 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m16:04:37.332268 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m16:04:37.333754 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m16:04:37.347833 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:04:37.350666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:37.386422 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m16:04:37.426051 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m16:04:37.979226 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:f4786c24-9349-495f-b876-5d690896a9bb&page=queryresults
[0m16:04:37.981323 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m16:04:37.982273 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: f4786c24-9349-495f-b876-5d690896a9bb

[0m16:04:37.983267 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 16:04:37.308913 => 16:04:37.983028
[0m16:04:37.987273 [debug] [Thread-1 (]: Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: f4786c24-9349-495f-b876-5d690896a9bb
  
[0m16:04:37.988254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cab0c2ad-0df9-4830-b8a6-c2f84ca7ea68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd255af560>]}
[0m16:04:37.989129 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model retail_prod.bronze__orders ............... [[31mERROR[0m in 0.73s]
[0m16:04:37.990776 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m16:04:39.026436 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:ccbd752d-f1d8-437b-919f-0d4367ab279f&page=queryresults
[0m16:04:39.028953 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m16:04:39.029963 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: ccbd752d-f1d8-437b-919f-0d4367ab279f

[0m16:04:39.031159 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 16:04:37.285771 => 16:04:39.030897
[0m16:04:39.033895 [debug] [Thread-2 (]: Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: ccbd752d-f1d8-437b-919f-0d4367ab279f
  
[0m16:04:39.035092 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cab0c2ad-0df9-4830-b8a6-c2f84ca7ea68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd255af0e0>]}
[0m16:04:39.036155 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model retail_prod.bronze__users ................ [[31mERROR[0m in 1.78s]
[0m16:04:39.037302 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m16:04:39.040396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:39.041661 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m16:04:39.042460 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m16:04:39.043329 [info ] [MainThread]: 
[0m16:04:39.044232 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.05 seconds (3.05s).
[0m16:04:39.045287 [debug] [MainThread]: Command end result
[0m16:04:39.088678 [info ] [MainThread]: 
[0m16:04:39.090031 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:04:39.091134 [info ] [MainThread]: 
[0m16:04:39.092448 [error] [MainThread]:   Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: f4786c24-9349-495f-b876-5d690896a9bb
  
[0m16:04:39.093639 [info ] [MainThread]: 
[0m16:04:39.094526 [error] [MainThread]:   Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: ccbd752d-f1d8-437b-919f-0d4367ab279f
  
[0m16:04:39.095383 [info ] [MainThread]: 
[0m16:04:39.096359 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m16:04:39.097917 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.056569, "process_user_time": 5.057002, "process_kernel_time": 1.425081, "process_mem_max_rss": "246488", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:04:39.099078 [debug] [MainThread]: Command `dbt run` failed at 16:04:39.098832 after 13.06 seconds
[0m16:04:39.100205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd52b85820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd52ab3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd255003e0>]}
[0m16:04:39.101131 [debug] [MainThread]: Flushing usage events
[0m16:05:19.100019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc3d6e381d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc3d6dd7c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc3d6e3bb90>]}


============================== 16:05:19.107619 | cf53479b-eec9-4b29-8b30-5fa61b8e7776 ==============================
[0m16:05:19.107619 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:05:19.108872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:05:20.382126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf53479b-eec9-4b29-8b30-5fa61b8e7776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc3a9eab230>]}
[0m16:05:20.475223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf53479b-eec9-4b29-8b30-5fa61b8e7776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc3d6e3c680>]}
[0m16:05:20.476902 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:05:20.603494 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:05:28.075323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:05:28.076357 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:05:28.077423 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:05:28.082531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf53479b-eec9-4b29-8b30-5fa61b8e7776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc3a9ea9dc0>]}
[0m16:05:28.129233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf53479b-eec9-4b29-8b30-5fa61b8e7776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc3a9ce1220>]}
[0m16:05:28.130153 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:05:28.131079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf53479b-eec9-4b29-8b30-5fa61b8e7776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc3d6f6dc70>]}
[0m16:05:28.141001 [info ] [MainThread]: 
[0m16:05:28.142355 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:05:28.144283 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m16:05:28.145145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:28.833748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod)
[0m16:05:28.834745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:29.396951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf53479b-eec9-4b29-8b30-5fa61b8e7776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc3aa158980>]}
[0m16:05:29.400275 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:05:29.403690 [info ] [MainThread]: 
[0m16:05:29.430705 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m16:05:29.431666 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m16:05:29.432868 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod.bronze__orders ........................ [RUN]
[0m16:05:29.435002 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod.bronze__users ......................... [RUN]
[0m16:05:29.437068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.bronze__orders)
[0m16:05:29.439189 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m16:05:29.440619 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m16:05:29.442688 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m16:05:29.458872 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m16:05:29.459923 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m16:05:29.477088 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 16:05:29.454596 => 16:05:29.476446
[0m16:05:29.479016 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m16:05:29.492604 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 16:05:29.443752 => 16:05:29.492154
[0m16:05:29.499111 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m16:05:29.543053 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m16:05:29.543752 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m16:05:29.556464 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:05:29.558952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:29.594131 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m16:05:29.629298 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m16:05:30.216812 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:a19cc3e6-767d-4ab1-b8c8-acbc71b8bcfd&page=queryresults
[0m16:05:30.219775 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m16:05:30.220681 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: a19cc3e6-767d-4ab1-b8c8-acbc71b8bcfd

[0m16:05:30.221641 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 16:05:29.480048 => 16:05:30.221429
[0m16:05:30.227841 [debug] [Thread-2 (]: Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: a19cc3e6-767d-4ab1-b8c8-acbc71b8bcfd
  
[0m16:05:30.229027 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf53479b-eec9-4b29-8b30-5fa61b8e7776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc3a9942810>]}
[0m16:05:30.230058 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model retail_prod.bronze__users ................ [[31mERROR[0m in 0.79s]
[0m16:05:30.231046 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m16:05:31.240189 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:6e35c52c-81f1-4d17-b684-eed13b48d0f9&page=queryresults
[0m16:05:31.242922 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m16:05:31.244053 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1

Location: asia-southeast1
Job ID: 6e35c52c-81f1-4d17-b684-eed13b48d0f9

[0m16:05:31.245310 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 16:05:29.505245 => 16:05:31.245056
[0m16:05:31.247909 [debug] [Thread-1 (]: Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 6e35c52c-81f1-4d17-b684-eed13b48d0f9
  
[0m16:05:31.248697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf53479b-eec9-4b29-8b30-5fa61b8e7776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc3a98e3b30>]}
[0m16:05:31.249663 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model retail_prod.bronze__orders ............... [[31mERROR[0m in 1.81s]
[0m16:05:31.250520 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m16:05:31.253238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:31.254087 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m16:05:31.254674 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m16:05:31.255385 [info ] [MainThread]: 
[0m16:05:31.256113 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m16:05:31.257144 [debug] [MainThread]: Command end result
[0m16:05:31.295019 [info ] [MainThread]: 
[0m16:05:31.296295 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:05:31.297605 [info ] [MainThread]: 
[0m16:05:31.299312 [error] [MainThread]:   Runtime Error in model bronze__users (models/bronze/bronze__users.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: a19cc3e6-767d-4ab1-b8c8-acbc71b8bcfd
  
[0m16:05:31.300229 [info ] [MainThread]: 
[0m16:05:31.301365 [error] [MainThread]:   Runtime Error in model bronze__orders (models/bronze/bronze__orders.sql)
  404 Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1; reason: notFound, message: Not found: Dataset retail-data-pipeline-dev:retail_raw was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 6e35c52c-81f1-4d17-b684-eed13b48d0f9
  
[0m16:05:31.302605 [info ] [MainThread]: 
[0m16:05:31.303619 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m16:05:31.305225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.2896385, "process_user_time": 4.024868, "process_kernel_time": 1.457279, "process_mem_max_rss": "242652", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:05:31.306102 [debug] [MainThread]: Command `dbt run` failed at 16:05:31.305947 after 12.29 seconds
[0m16:05:31.306985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc3d6f6fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc3d6e3f5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc3d6e3f4a0>]}
[0m16:05:31.307679 [debug] [MainThread]: Flushing usage events
[0m16:06:02.962055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b3b7e3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b39799b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b39c592e0>]}


============================== 16:06:02.970913 | daa9286d-2c5f-465d-b850-8ba2dd480a55 ==============================
[0m16:06:02.970913 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:06:02.972980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'send_anonymous_usage_stats': 'True'}
[0m16:06:02.976206 [info ] [MainThread]: dbt version: 1.7.9
[0m16:06:02.977248 [info ] [MainThread]: python version: 3.12.10
[0m16:06:02.978222 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m16:06:02.979557 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m16:06:03.834034 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt/retail
[0m16:06:03.835069 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt/retail/profiles.yml
[0m16:06:03.835796 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/retail/dbt_project.yml
[0m16:06:03.836682 [info ] [MainThread]: adapter type: bigquery
[0m16:06:03.837357 [info ] [MainThread]: adapter version: 1.7.5
[0m16:06:03.919210 [info ] [MainThread]: Configuration:
[0m16:06:03.920466 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:06:03.921309 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:06:03.922153 [info ] [MainThread]: Required dependencies:
[0m16:06:03.922788 [debug] [MainThread]: Executing "git --help"
[0m16:06:03.924331 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m16:06:03.924902 [info ] [MainThread]: Connection:
[0m16:06:03.925533 [info ] [MainThread]:   method: service-account
[0m16:06:03.926069 [info ] [MainThread]:   database: retail-data-pipeline-dev
[0m16:06:03.926563 [info ] [MainThread]:   execution_project: retail-data-pipeline-dev
[0m16:06:03.927072 [info ] [MainThread]:   schema: retail_prod
[0m16:06:03.927631 [info ] [MainThread]:   location: asia-southeast1
[0m16:06:03.928207 [info ] [MainThread]:   priority: interactive
[0m16:06:03.928784 [info ] [MainThread]:   maximum_bytes_billed: None
[0m16:06:03.929337 [info ] [MainThread]:   impersonate_service_account: None
[0m16:06:03.929972 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m16:06:03.930499 [info ] [MainThread]:   job_retries: 1
[0m16:06:03.931085 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m16:06:03.931935 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m16:06:03.932836 [info ] [MainThread]:   keyfile: /opt/airflow/keys/airflow-sa.json
[0m16:06:03.933875 [info ] [MainThread]:   timeout_seconds: 300
[0m16:06:03.934535 [info ] [MainThread]:   client_id: None
[0m16:06:03.935138 [info ] [MainThread]:   token_uri: None
[0m16:06:03.935709 [info ] [MainThread]:   dataproc_region: None
[0m16:06:03.936317 [info ] [MainThread]:   dataproc_cluster_name: None
[0m16:06:03.937107 [info ] [MainThread]:   gcs_bucket: None
[0m16:06:03.937797 [info ] [MainThread]:   dataproc_batch: None
[0m16:06:03.938510 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:06:03.939477 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m16:06:03.940057 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:06:03.977106 [debug] [MainThread]: On debug: select 1 as id
[0m16:06:04.540202 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:b2e3ddb4-8289-49cc-a7b8-44925fddbc0a&page=queryresults
[0m16:06:04.990917 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:06:04.991773 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:06:04.992624 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m16:06:04.994049 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 2.1133687, "process_user_time": 2.99786, "process_kernel_time": 1.169604, "process_mem_max_rss": "225244", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:06:04.994934 [debug] [MainThread]: Command `dbt debug` failed at 16:06:04.994705 after 2.11 seconds
[0m16:06:04.995729 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:06:04.996659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b10737140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b10aab5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b39799b80>]}
[0m16:06:04.997622 [debug] [MainThread]: Flushing usage events
[0m16:06:36.996223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792eee1112e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792eee040aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792eee3d0bc0>]}


============================== 16:06:37.003599 | f0161947-8bc0-4b1b-8cf5-d2d1ca299f25 ==============================
[0m16:06:37.003599 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:06:37.004735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile --select bronze__users --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:06:37.929841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0161947-8bc0-4b1b-8cf5-d2d1ca299f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ec13a6ea0>]}
[0m16:06:38.015261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0161947-8bc0-4b1b-8cf5-d2d1ca299f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ec12ebe90>]}
[0m16:06:38.017469 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:06:38.147891 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:06:45.570607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:06:45.571446 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:06:45.572572 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:06:45.577678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0161947-8bc0-4b1b-8cf5-d2d1ca299f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792eee992a20>]}
[0m16:06:45.649436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0161947-8bc0-4b1b-8cf5-d2d1ca299f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ec10238f0>]}
[0m16:06:45.650622 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:06:45.651321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0161947-8bc0-4b1b-8cf5-d2d1ca299f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ec1a2d8b0>]}
[0m16:06:45.653219 [info ] [MainThread]: 
[0m16:06:45.654280 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:06:45.655852 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev_retail_prod'
[0m16:06:45.656638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:46.221752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0161947-8bc0-4b1b-8cf5-d2d1ca299f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792eef483c20>]}
[0m16:06:46.223460 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:06:46.224435 [info ] [MainThread]: 
[0m16:06:46.236561 [debug] [Thread-1 (]: Began running node model.retail.bronze__users
[0m16:06:46.238060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.bronze__users)
[0m16:06:46.239019 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__users
[0m16:06:46.250614 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m16:06:46.270874 [debug] [Thread-1 (]: Timing info for model.retail.bronze__users (compile): 16:06:46.239803 => 16:06:46.270392
[0m16:06:46.271909 [debug] [Thread-1 (]: Began executing node model.retail.bronze__users
[0m16:06:46.272817 [debug] [Thread-1 (]: Timing info for model.retail.bronze__users (execute): 16:06:46.272488 => 16:06:46.272515
[0m16:06:46.274183 [debug] [Thread-1 (]: Finished running node model.retail.bronze__users
[0m16:06:46.276188 [debug] [Thread-3 (]: Began running node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:06:46.276785 [debug] [Thread-4 (]: Began running node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:06:46.277470 [debug] [Thread-2 (]: Began running node test.retail.unique_bronze__users_user_id.129342c645
[0m16:06:46.278441 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__users_email.2bec59e73f'
[0m16:06:46.280250 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__users_user_id.cb91e05164'
[0m16:06:46.282204 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.retail.unique_bronze__users_user_id.129342c645'
[0m16:06:46.283332 [debug] [Thread-3 (]: Began compiling node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:06:46.284173 [debug] [Thread-4 (]: Began compiling node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:06:46.285034 [debug] [Thread-2 (]: Began compiling node test.retail.unique_bronze__users_user_id.129342c645
[0m16:06:46.295380 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.not_null_bronze__users_email.2bec59e73f"
[0m16:06:46.300335 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.not_null_bronze__users_user_id.cb91e05164"
[0m16:06:46.306015 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.unique_bronze__users_user_id.129342c645"
[0m16:06:46.348025 [debug] [Thread-2 (]: Timing info for test.retail.unique_bronze__users_user_id.129342c645 (compile): 16:06:46.301439 => 16:06:46.347466
[0m16:06:46.348891 [debug] [Thread-2 (]: Began executing node test.retail.unique_bronze__users_user_id.129342c645
[0m16:06:46.350035 [debug] [Thread-2 (]: Timing info for test.retail.unique_bronze__users_user_id.129342c645 (execute): 16:06:46.349795 => 16:06:46.349811
[0m16:06:46.351462 [debug] [Thread-2 (]: Finished running node test.retail.unique_bronze__users_user_id.129342c645
[0m16:06:46.352127 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__users_user_id.cb91e05164 (compile): 16:06:46.295914 => 16:06:46.351766
[0m16:06:46.353212 [debug] [Thread-4 (]: Began executing node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:06:46.354359 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__users_user_id.cb91e05164 (execute): 16:06:46.354115 => 16:06:46.354126
[0m16:06:46.355568 [debug] [Thread-4 (]: Finished running node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:06:46.356092 [debug] [Thread-3 (]: Timing info for test.retail.not_null_bronze__users_email.2bec59e73f (compile): 16:06:46.285637 => 16:06:46.355877
[0m16:06:46.356846 [debug] [Thread-3 (]: Began executing node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:06:46.357975 [debug] [Thread-3 (]: Timing info for test.retail.not_null_bronze__users_email.2bec59e73f (execute): 16:06:46.357616 => 16:06:46.357632
[0m16:06:46.359310 [debug] [Thread-3 (]: Finished running node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:06:46.361796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:46.362690 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m16:06:46.363311 [debug] [MainThread]: Connection 'test.retail.not_null_bronze__users_email.2bec59e73f' was properly closed.
[0m16:06:46.364002 [debug] [MainThread]: Connection 'test.retail.not_null_bronze__users_user_id.cb91e05164' was properly closed.
[0m16:06:46.364704 [debug] [MainThread]: Connection 'test.retail.unique_bronze__users_user_id.129342c645' was properly closed.
[0m16:06:46.365818 [debug] [MainThread]: Command end result
[0m16:06:46.400569 [debug] [MainThread]: Excluded node 'unique_bronze__users_user_id' from results
[0m16:06:46.401516 [debug] [MainThread]: Excluded node 'not_null_bronze__users_user_id' from results
[0m16:06:46.402254 [debug] [MainThread]: Excluded node 'not_null_bronze__users_email' from results
[0m16:06:46.402831 [info ] [MainThread]: Compiled node 'bronze__users' is:
with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
[0m16:06:46.404196 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 9.502429, "process_user_time": 3.383486, "process_kernel_time": 1.494271, "process_mem_max_rss": "235376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:06:46.405214 [debug] [MainThread]: Command `dbt compile` succeeded at 16:06:46.404988 after 9.50 seconds
[0m16:06:46.406141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792eee3d0bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792eee28cb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792eee1141d0>]}
[0m16:06:46.406912 [debug] [MainThread]: Flushing usage events
[0m16:22:37.727327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c0ed1a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c0ee23170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c0ed1be60>]}


============================== 16:22:37.733419 | cbc104c7-8e76-4079-9149-dc0571f90d06 ==============================
[0m16:22:37.733419 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:22:37.734443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'send_anonymous_usage_stats': 'True'}
[0m16:22:37.833055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbc104c7-8e76-4079-9149-dc0571f90d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c0f044530>]}
[0m16:22:39.350486 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2s47hwu5'
[0m16:22:39.351457 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:22:39.526027 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:22:39.527421 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:22:39.618234 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:22:39.622197 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m16:22:39.762778 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m16:22:39.766594 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m16:22:40.002784 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m16:22:40.006344 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:22:48.348007 [info ] [MainThread]: Installed from version 1.3.1
[0m16:22:48.350314 [info ] [MainThread]: Up to date!
[0m16:22:48.352378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cbc104c7-8e76-4079-9149-dc0571f90d06', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c0edf5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c0edf7380>]}
[0m16:22:48.354483 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m16:22:54.611086 [info ] [MainThread]: Installed from version 0.10.9
[0m16:22:54.611915 [info ] [MainThread]: Up to date!
[0m16:22:54.612684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cbc104c7-8e76-4079-9149-dc0571f90d06', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c0ec63d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c0ec63ec0>]}
[0m16:22:54.613263 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m16:22:57.385977 [info ] [MainThread]: Installed from version 0.15.0
[0m16:22:57.386925 [info ] [MainThread]: Up to date!
[0m16:22:57.387801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cbc104c7-8e76-4079-9149-dc0571f90d06', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c0ec63ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c0ec63ec0>]}
[0m16:22:57.390006 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 19.735619, "process_user_time": 2.716645, "process_kernel_time": 0.785841, "process_mem_max_rss": "197136", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m16:22:57.391110 [debug] [MainThread]: Command `dbt deps` succeeded at 16:22:57.390915 after 19.74 seconds
[0m16:22:57.391999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c0ed1f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c0f044530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c0f0880e0>]}
[0m16:22:57.392684 [debug] [MainThread]: Flushing usage events
[0m16:23:02.906482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e17d35f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e17f89850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e1806c560>]}


============================== 16:23:02.913879 | 9553df22-dab2-4e51-852e-cea52178886e ==============================
[0m16:23:02.913879 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:23:02.915492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'send_anonymous_usage_stats': 'True'}
[0m16:23:04.030762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9553df22-dab2-4e51-852e-cea52178886e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767df78baea0>]}
[0m16:23:04.103888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9553df22-dab2-4e51-852e-cea52178886e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e17d3b7d0>]}
[0m16:23:04.105304 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:23:04.203405 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:23:11.432610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:23:11.433586 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:23:11.434748 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:23:11.440340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9553df22-dab2-4e51-852e-cea52178886e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767dead3ec00>]}
[0m16:23:11.489400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9553df22-dab2-4e51-852e-cea52178886e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767deafa7c50>]}
[0m16:23:11.490643 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:23:11.491465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9553df22-dab2-4e51-852e-cea52178886e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767deaddc980>]}
[0m16:23:11.501425 [info ] [MainThread]: 
[0m16:23:11.503304 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:23:11.505434 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m16:23:11.506291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:12.133932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod)
[0m16:23:12.135011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:23:12.672712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9553df22-dab2-4e51-852e-cea52178886e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767df1b56c60>]}
[0m16:23:12.674202 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:23:12.675369 [info ] [MainThread]: 
[0m16:23:12.683838 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m16:23:12.684410 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m16:23:12.685472 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod.bronze__orders ........................ [RUN]
[0m16:23:12.686723 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod.bronze__users ......................... [RUN]
[0m16:23:12.687772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.bronze__orders)
[0m16:23:12.688930 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m16:23:12.689863 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m16:23:12.690501 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m16:23:12.697882 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m16:23:12.700715 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m16:23:12.717679 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 16:23:12.698207 => 16:23:12.717074
[0m16:23:12.719519 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m16:23:12.726508 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 16:23:12.691246 => 16:23:12.726005
[0m16:23:12.733127 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m16:23:12.766788 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m16:23:12.767314 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m16:23:12.783219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:12.786441 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:23:12.856331 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m16:23:12.859763 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe_parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe_parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m16:23:13.506075 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:88a1b2f5-ccd0-4759-9946-01b036852636&page=queryresults
[0m16:23:13.507466 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:bce60f2f-91cb-48ca-abcf-c5450bf7be20&page=queryresults
[0m16:23:13.651315 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: user_id; Did you mean users? at [15:5]; reason: invalidQuery, location: query, message: Unrecognized name: user_id; Did you mean users? at [15:5]')
[0m16:23:13.664496 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: safe_parse_timestamp; Did you mean parse_timestamp? at [20:5]; reason: invalidQuery, location: query, message: Function not found: safe_parse_timestamp; Did you mean parse_timestamp? at [20:5]')
[0m16:23:14.385040 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:ccfedb73-6b72-4473-8181-7f5b3ba06d98&page=queryresults
[0m16:23:14.535279 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:ccfedb73-6b72-4473-8181-7f5b3ba06d98&page=queryresults
[0m16:23:14.536574 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 16:23:12.739487 => 16:23:14.536312
[0m16:23:14.540621 [debug] [Thread-1 (]: Database Error in model bronze__orders (models/bronze/bronze__orders.sql)
  Function not found: safe_parse_timestamp; Did you mean parse_timestamp? at [20:5]
  compiled Code at target/run/retail/models/bronze/bronze__orders.sql
[0m16:23:14.541902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9553df22-dab2-4e51-852e-cea52178886e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767dead159a0>]}
[0m16:23:14.543029 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model retail_prod.bronze__orders ............... [[31mERROR[0m in 1.85s]
[0m16:23:14.544024 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m16:23:14.768135 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:27f77bc3-1180-4d98-8fc3-b731baea204c&page=queryresults
[0m16:23:14.885908 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:27f77bc3-1180-4d98-8fc3-b731baea204c&page=queryresults
[0m16:23:14.887514 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 16:23:12.720756 => 16:23:14.887109
[0m16:23:14.890270 [debug] [Thread-2 (]: Database Error in model bronze__users (models/bronze/bronze__users.sql)
  Unrecognized name: user_id; Did you mean users? at [15:5]
  compiled Code at target/run/retail/models/bronze/bronze__users.sql
[0m16:23:14.891051 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9553df22-dab2-4e51-852e-cea52178886e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767dea85e930>]}
[0m16:23:14.891933 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model retail_prod.bronze__users ................ [[31mERROR[0m in 2.20s]
[0m16:23:14.892936 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m16:23:14.896022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:14.897125 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m16:23:14.897832 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m16:23:14.898394 [info ] [MainThread]: 
[0m16:23:14.899480 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m16:23:14.900771 [debug] [MainThread]: Command end result
[0m16:23:14.940062 [info ] [MainThread]: 
[0m16:23:14.941125 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:23:14.941996 [info ] [MainThread]: 
[0m16:23:14.942720 [error] [MainThread]:   Database Error in model bronze__orders (models/bronze/bronze__orders.sql)
  Function not found: safe_parse_timestamp; Did you mean parse_timestamp? at [20:5]
  compiled Code at target/run/retail/models/bronze/bronze__orders.sql
[0m16:23:14.943459 [info ] [MainThread]: 
[0m16:23:14.943994 [error] [MainThread]:   Database Error in model bronze__users (models/bronze/bronze__users.sql)
  Unrecognized name: user_id; Did you mean users? at [15:5]
  compiled Code at target/run/retail/models/bronze/bronze__users.sql
[0m16:23:14.944602 [info ] [MainThread]: 
[0m16:23:14.945162 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m16:23:14.946370 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.124435, "process_user_time": 4.191459, "process_kernel_time": 1.323837, "process_mem_max_rss": "237392", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:23:14.947136 [debug] [MainThread]: Command `dbt run` failed at 16:23:14.946968 after 12.13 seconds
[0m16:23:14.947819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e1806c560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e17fa6000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767deb0729c0>]}
[0m16:23:14.948454 [debug] [MainThread]: Flushing usage events
[0m16:24:41.232937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb9989e77d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb9989e7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb9989e7140>]}


============================== 16:24:41.240339 | 6f7ff4ef-256d-4a7d-ac4a-2000d361c0f9 ==============================
[0m16:24:41.240339 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:24:41.241284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'send_anonymous_usage_stats': 'True'}
[0m16:24:41.375902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f7ff4ef-256d-4a7d-ac4a-2000d361c0f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb99887a8a0>]}
[0m16:24:42.945611 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-b_6ek7v8'
[0m16:24:42.947008 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:24:43.141041 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:24:43.144847 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:24:43.250439 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:24:43.266019 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m16:24:43.418934 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m16:24:43.426011 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m16:24:43.565139 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m16:24:43.568318 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:24:51.930483 [info ] [MainThread]: Installed from version 1.3.1
[0m16:24:51.931301 [info ] [MainThread]: Up to date!
[0m16:24:51.931924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6f7ff4ef-256d-4a7d-ac4a-2000d361c0f9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb9989eb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb9989eb5f0>]}
[0m16:24:51.932474 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m16:24:59.009843 [info ] [MainThread]: Installed from version 0.10.9
[0m16:24:59.010920 [info ] [MainThread]: Up to date!
[0m16:24:59.011764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6f7ff4ef-256d-4a7d-ac4a-2000d361c0f9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb99877dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb99877dc40>]}
[0m16:24:59.012901 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m16:25:01.659345 [info ] [MainThread]: Installed from version 0.15.0
[0m16:25:01.660227 [info ] [MainThread]: Up to date!
[0m16:25:01.661196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6f7ff4ef-256d-4a7d-ac4a-2000d361c0f9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb998744620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb998744110>]}
[0m16:25:01.665557 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 20.517548, "process_user_time": 3.390224, "process_kernel_time": 0.771453, "process_mem_max_rss": "197200", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m16:25:01.666697 [debug] [MainThread]: Command `dbt deps` succeeded at 16:25:01.666499 after 20.52 seconds
[0m16:25:01.667424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb998a81a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb99d1f1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb998997da0>]}
[0m16:25:01.668093 [debug] [MainThread]: Flushing usage events
[0m16:25:06.791490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c38ca4260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c38ca7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c38ca6ab0>]}


============================== 16:25:06.797384 | 960b9c67-31be-40bb-867a-0c3d99993708 ==============================
[0m16:25:06.797384 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:25:06.798322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:25:07.661817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '960b9c67-31be-40bb-867a-0c3d99993708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c12e480b0>]}
[0m16:25:07.741260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '960b9c67-31be-40bb-867a-0c3d99993708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1021b800>]}
[0m16:25:07.742427 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:25:07.835100 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:25:14.423574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:25:14.425389 [debug] [MainThread]: Partial parsing: updated file: retail://macros/time_parsing.sql
[0m16:25:14.758826 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:25:14.765718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '960b9c67-31be-40bb-867a-0c3d99993708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0bbf6e40>]}
[0m16:25:14.827712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '960b9c67-31be-40bb-867a-0c3d99993708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c09eb5040>]}
[0m16:25:14.829211 [info ] [MainThread]: Found 20 tests, 4 models, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:25:14.830871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '960b9c67-31be-40bb-867a-0c3d99993708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c09e20fb0>]}
[0m16:25:14.844884 [info ] [MainThread]: 
[0m16:25:14.846313 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:25:14.850120 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m16:25:14.851419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:15.477580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod)
[0m16:25:15.478767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:16.148808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '960b9c67-31be-40bb-867a-0c3d99993708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c392ce6c0>]}
[0m16:25:16.149849 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:25:16.150535 [info ] [MainThread]: 
[0m16:25:16.160688 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m16:25:16.161467 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m16:25:16.162292 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod.bronze__orders ........................ [RUN]
[0m16:25:16.163651 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod.bronze__users ......................... [RUN]
[0m16:25:16.165006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.bronze__orders)
[0m16:25:16.166388 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m16:25:16.167348 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m16:25:16.168336 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m16:25:16.178393 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m16:25:16.181999 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m16:25:16.193023 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 16:25:16.178958 => 16:25:16.192373
[0m16:25:16.194684 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m16:25:16.201597 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 16:25:16.169236 => 16:25:16.201110
[0m16:25:16.207964 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m16:25:16.259366 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m16:25:16.260391 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m16:25:16.273075 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:25:16.276415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:16.313813 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe.parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m16:25:16.350441 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe.parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m16:25:17.044890 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:1741dc58-a160-4ddd-98a9-a08d145e2ddb&page=queryresults
[0m16:25:17.117487 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:7d4f8adb-de6c-4b2c-b63f-8cad4dc63b2f&page=queryresults
[0m16:25:17.224641 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: user_id; Did you mean users? at [15:5]; reason: invalidQuery, location: query, message: Unrecognized name: user_id; Did you mean users? at [15:5]')
[0m16:25:17.773782 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:085a9a5e-d30b-4699-a61c-1c2454b65bd3&page=queryresults
[0m16:25:17.922130 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:085a9a5e-d30b-4699-a61c-1c2454b65bd3&page=queryresults
[0m16:25:17.923518 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 16:25:16.195655 => 16:25:17.923267
[0m16:25:17.928713 [debug] [Thread-2 (]: Database Error in model bronze__users (models/bronze/bronze__users.sql)
  Unrecognized name: user_id; Did you mean users? at [15:5]
  compiled Code at target/run/retail/models/bronze/bronze__users.sql
[0m16:25:17.930049 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '960b9c67-31be-40bb-867a-0c3d99993708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c38ca61b0>]}
[0m16:25:17.931372 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model retail_prod.bronze__users ................ [[31mERROR[0m in 1.76s]
[0m16:25:17.933614 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m16:25:21.933202 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 16:25:16.213872 => 16:25:21.932865
[0m16:25:21.934655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '960b9c67-31be-40bb-867a-0c3d99993708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c09d86600>]}
[0m16:25:21.935659 [info ] [Thread-1 (]: 1 of 2 OK created sql table model retail_prod.bronze__orders ................... [[32mCREATE TABLE (5.0k rows, 414.1 KiB processed)[0m in 5.77s]
[0m16:25:21.936768 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m16:25:21.939890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:21.940725 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m16:25:21.941349 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m16:25:21.941997 [info ] [MainThread]: 
[0m16:25:21.942801 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 7.10 seconds (7.10s).
[0m16:25:21.943847 [debug] [MainThread]: Command end result
[0m16:25:21.980993 [info ] [MainThread]: 
[0m16:25:21.982037 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:25:21.982789 [info ] [MainThread]: 
[0m16:25:21.983466 [error] [MainThread]:   Database Error in model bronze__users (models/bronze/bronze__users.sql)
  Unrecognized name: user_id; Did you mean users? at [15:5]
  compiled Code at target/run/retail/models/bronze/bronze__users.sql
[0m16:25:21.984216 [info ] [MainThread]: 
[0m16:25:21.984972 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:25:21.986555 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.2533655, "process_user_time": 3.732307, "process_kernel_time": 1.408189, "process_mem_max_rss": "243800", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:25:21.987622 [debug] [MainThread]: Command `dbt run` failed at 16:25:21.987333 after 15.25 seconds
[0m16:25:21.988838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0b6ae630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c38ca61b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0b6ea030>]}
[0m16:25:21.989789 [debug] [MainThread]: Flushing usage events
[0m16:29:05.211061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135d8bc3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135d8d3d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135dac79d60>]}


============================== 16:29:05.217213 | 1f83ef0c-4ed9-4268-9a16-d0076dd7af44 ==============================
[0m16:29:05.217213 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:29:05.218085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:29:05.305976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f83ef0c-4ed9-4268-9a16-d0076dd7af44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135d8a57ec0>]}
[0m16:29:06.597883 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8473e1mt'
[0m16:29:06.598804 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:29:06.783617 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:29:06.785014 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:29:06.882738 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:29:06.886076 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m16:29:07.119254 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m16:29:07.123163 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m16:29:07.256411 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m16:29:07.260512 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:29:15.122865 [info ] [MainThread]: Installed from version 1.3.1
[0m16:29:15.123791 [info ] [MainThread]: Up to date!
[0m16:29:15.124457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1f83ef0c-4ed9-4268-9a16-d0076dd7af44', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135d89cb4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135d89cb410>]}
[0m16:29:15.125110 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m16:29:20.932106 [info ] [MainThread]: Installed from version 0.10.9
[0m16:29:20.933123 [info ] [MainThread]: Up to date!
[0m16:29:20.933913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1f83ef0c-4ed9-4268-9a16-d0076dd7af44', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135d8aa6630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135d8aa6ba0>]}
[0m16:29:20.934927 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m16:29:23.586232 [info ] [MainThread]: Installed from version 0.15.0
[0m16:29:23.587365 [info ] [MainThread]: Up to date!
[0m16:29:23.588304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1f83ef0c-4ed9-4268-9a16-d0076dd7af44', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135d8920590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135d89203e0>]}
[0m16:29:23.591080 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 18.454493, "process_user_time": 2.625819, "process_kernel_time": 0.635141, "process_mem_max_rss": "197188", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m16:29:23.592295 [debug] [MainThread]: Command `dbt deps` succeeded at 16:29:23.592063 after 18.46 seconds
[0m16:29:23.593608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135d8b73f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135d8d395e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135d91aefc0>]}
[0m16:29:23.594694 [debug] [MainThread]: Flushing usage events
[0m16:29:27.149319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62f2dc50a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62f76bd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62f3101bb0>]}


============================== 16:29:27.155239 | 7ffb9048-47df-495b-94a7-e0d9faa70a56 ==============================
[0m16:29:27.155239 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:29:27.156290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'send_anonymous_usage_stats': 'True'}
[0m16:29:28.101228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ffb9048-47df-495b-94a7-e0d9faa70a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62c5f430e0>]}
[0m16:29:28.176390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ffb9048-47df-495b-94a7-e0d9faa70a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62c654d280>]}
[0m16:29:28.177645 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:29:28.304619 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:29:34.921414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:29:34.922293 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:29:34.923461 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:29:34.928601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ffb9048-47df-495b-94a7-e0d9faa70a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62f2dc8680>]}
[0m16:29:34.983381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ffb9048-47df-495b-94a7-e0d9faa70a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62c5864bc0>]}
[0m16:29:34.984560 [info ] [MainThread]: Found 20 tests, 4 models, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:29:34.985594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ffb9048-47df-495b-94a7-e0d9faa70a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62f3ab6000>]}
[0m16:29:34.996146 [info ] [MainThread]: 
[0m16:29:34.997599 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:29:34.999552 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m16:29:35.000599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:35.616543 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod)
[0m16:29:35.617662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:36.232211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ffb9048-47df-495b-94a7-e0d9faa70a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62f3ab6000>]}
[0m16:29:36.233399 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:29:36.234032 [info ] [MainThread]: 
[0m16:29:36.242053 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m16:29:36.242616 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m16:29:36.243120 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod.bronze__orders ........................ [RUN]
[0m16:29:36.243865 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod.bronze__users ......................... [RUN]
[0m16:29:36.244882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.bronze__orders)
[0m16:29:36.246020 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m16:29:36.246689 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m16:29:36.247317 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m16:29:36.254488 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m16:29:36.257216 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m16:29:36.270547 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 16:29:36.254828 => 16:29:36.270064
[0m16:29:36.271650 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m16:29:36.278445 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 16:29:36.247899 => 16:29:36.278143
[0m16:29:36.284747 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m16:29:36.292674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:36.304875 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m16:29:36.369425 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:29:36.406541 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe.parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m16:29:36.825247 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m16:29:36.843542 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe.parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m16:29:37.253789 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:6ae0f0d9-fd84-406a-8894-db4d099cd476&page=queryresults
[0m16:29:37.412223 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:8f242e12-cd04-4c39-a7c6-22805edf74cb&page=queryresults
[0m16:29:39.171885 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 16:29:36.272165 => 16:29:39.171628
[0m16:29:39.173403 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ffb9048-47df-495b-94a7-e0d9faa70a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62c58ec140>]}
[0m16:29:39.174609 [info ] [Thread-2 (]: 2 of 2 OK created sql table model retail_prod.bronze__users .................... [[32mCREATE TABLE (1.0k rows, 107.1 KiB processed)[0m in 2.93s]
[0m16:29:39.175570 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m16:29:39.389620 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 16:29:36.290985 => 16:29:39.389435
[0m16:29:39.390805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ffb9048-47df-495b-94a7-e0d9faa70a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62c58e7fb0>]}
[0m16:29:39.391808 [info ] [Thread-1 (]: 1 of 2 OK created sql table model retail_prod.bronze__orders ................... [[32mCREATE TABLE (5.0k rows, 414.1 KiB processed)[0m in 3.15s]
[0m16:29:39.392821 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m16:29:39.396081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:39.397367 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m16:29:39.398252 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m16:29:39.399177 [info ] [MainThread]: 
[0m16:29:39.399956 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.40 seconds (4.40s).
[0m16:29:39.401084 [debug] [MainThread]: Command end result
[0m16:29:39.444901 [info ] [MainThread]: 
[0m16:29:39.445910 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:29:39.446801 [info ] [MainThread]: 
[0m16:29:39.447867 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:29:39.449193 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.340185, "process_user_time": 3.482554, "process_kernel_time": 1.376729, "process_mem_max_rss": "236672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:29:39.450235 [debug] [MainThread]: Command `dbt run` succeeded at 16:29:39.450048 after 12.34 seconds
[0m16:29:39.451108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62c6721a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62f2d67c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62f2d67a10>]}
[0m16:29:39.452077 [debug] [MainThread]: Flushing usage events
[0m16:29:43.766006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3313539760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a331383b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a331353b770>]}


============================== 16:29:43.773726 | c59fd94a-1502-4fc9-8f09-3ddb00bd1a31 ==============================
[0m16:29:43.773726 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:29:43.775102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:29:44.748552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c59fd94a-1502-4fc9-8f09-3ddb00bd1a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a331353aea0>]}
[0m16:29:44.829519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c59fd94a-1502-4fc9-8f09-3ddb00bd1a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a32e66a8710>]}
[0m16:29:44.831325 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:29:44.945375 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:29:52.086347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:29:52.087312 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:29:52.088393 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:29:52.093643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c59fd94a-1502-4fc9-8f09-3ddb00bd1a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a32e6513f50>]}
[0m16:29:52.141828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c59fd94a-1502-4fc9-8f09-3ddb00bd1a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a32e7a976e0>]}
[0m16:29:52.142825 [info ] [MainThread]: Found 20 tests, 4 models, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:29:52.143763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c59fd94a-1502-4fc9-8f09-3ddb00bd1a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a32e78c4b90>]}
[0m16:29:52.154092 [info ] [MainThread]: 
[0m16:29:52.155341 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:29:52.157342 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev_retail_prod'
[0m16:29:52.158311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:52.665088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c59fd94a-1502-4fc9-8f09-3ddb00bd1a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a32e5fc84d0>]}
[0m16:29:52.666344 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:29:52.667103 [info ] [MainThread]: 
[0m16:29:52.677165 [debug] [Thread-1 (]: Began running node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m16:29:52.677936 [debug] [Thread-2 (]: Began running node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m16:29:52.678514 [debug] [Thread-3 (]: Began running node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:29:52.678975 [info ] [Thread-1 (]: 1 of 15 START test not_null_bronze__orders_order_created_at .................... [RUN]
[0m16:29:52.679595 [debug] [Thread-4 (]: Began running node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:29:52.680260 [info ] [Thread-2 (]: 2 of 15 START test not_null_bronze__orders_order_id ............................ [RUN]
[0m16:29:52.681051 [info ] [Thread-3 (]: 3 of 15 START test not_null_bronze__users_email ................................ [RUN]
[0m16:29:52.682400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now test.retail.not_null_bronze__orders_order_created_at.05e711bf75)
[0m16:29:52.683431 [info ] [Thread-4 (]: 4 of 15 START test not_null_bronze__users_user_id .............................. [RUN]
[0m16:29:52.684827 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__orders_order_id.4b38fb230a'
[0m16:29:52.686269 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__users_email.2bec59e73f'
[0m16:29:52.687412 [debug] [Thread-1 (]: Began compiling node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m16:29:52.690116 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__users_user_id.cb91e05164'
[0m16:29:52.691122 [debug] [Thread-2 (]: Began compiling node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m16:29:52.691830 [debug] [Thread-3 (]: Began compiling node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:29:52.703135 [debug] [Thread-4 (]: Began compiling node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:29:52.706508 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"
[0m16:29:52.710689 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.not_null_bronze__orders_order_id.4b38fb230a"
[0m16:29:52.714618 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.not_null_bronze__users_email.2bec59e73f"
[0m16:29:52.718702 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.not_null_bronze__users_user_id.cb91e05164"
[0m16:29:52.734255 [debug] [Thread-2 (]: Timing info for test.retail.not_null_bronze__orders_order_id.4b38fb230a (compile): 16:29:52.707543 => 16:29:52.733757
[0m16:29:52.735418 [debug] [Thread-2 (]: Began executing node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m16:29:52.753611 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.not_null_bronze__orders_order_id.4b38fb230a"
[0m16:29:52.754240 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__users_user_id.cb91e05164 (compile): 16:29:52.715490 => 16:29:52.753987
[0m16:29:52.754946 [debug] [Thread-3 (]: Timing info for test.retail.not_null_bronze__users_email.2bec59e73f (compile): 16:29:52.711586 => 16:29:52.754673
[0m16:29:52.755638 [debug] [Thread-1 (]: Timing info for test.retail.not_null_bronze__orders_order_created_at.05e711bf75 (compile): 16:29:52.692313 => 16:29:52.755238
[0m16:29:52.756187 [debug] [Thread-4 (]: Began executing node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:29:52.756897 [debug] [Thread-3 (]: Began executing node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:29:52.757571 [debug] [Thread-1 (]: Began executing node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m16:29:52.760266 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.not_null_bronze__users_user_id.cb91e05164"
[0m16:29:52.763074 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.not_null_bronze__users_email.2bec59e73f"
[0m16:29:52.765649 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"
[0m16:29:52.779957 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:29:52.783142 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:29:52.818242 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:29:52.819491 [debug] [Thread-3 (]: On test.retail.not_null_bronze__users_email.2bec59e73f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__users_email.2bec59e73f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
where email is null



      
    ) dbt_internal_test
[0m16:29:52.852046 [debug] [Thread-4 (]: On test.retail.not_null_bronze__users_user_id.cb91e05164: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__users_user_id.cb91e05164"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
where user_id is null



      
    ) dbt_internal_test
[0m16:29:52.855803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:52.890558 [debug] [Thread-2 (]: On test.retail.not_null_bronze__orders_order_id.4b38fb230a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__orders_order_id.4b38fb230a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
where order_id is null



      
    ) dbt_internal_test
[0m16:29:52.929203 [debug] [Thread-1 (]: On test.retail.not_null_bronze__orders_order_created_at.05e711bf75: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_created_at
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
where order_created_at is null



      
    ) dbt_internal_test
[0m16:29:53.636369 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:ac6f9f86-f980-4eb1-9177-8d15aa3e4f47&page=queryresults
[0m16:29:53.641000 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:2e0e9607-f11c-41b9-8094-0a80140a2a51&page=queryresults
[0m16:29:53.651927 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:0c26d220-cd0c-49b2-82be-65336c8ab67d&page=queryresults
[0m16:29:53.676626 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:b1b03637-2eb7-453f-bb13-22bee71daa82&page=queryresults
[0m16:29:54.181760 [debug] [Thread-2 (]: Timing info for test.retail.not_null_bronze__orders_order_id.4b38fb230a (execute): 16:29:52.736246 => 16:29:54.181447
[0m16:29:54.182912 [info ] [Thread-2 (]: 2 of 15 PASS not_null_bronze__orders_order_id .................................. [[32mPASS[0m in 1.50s]
[0m16:29:54.183758 [debug] [Thread-2 (]: Finished running node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m16:29:54.184485 [debug] [Thread-2 (]: Began running node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m16:29:54.185562 [info ] [Thread-2 (]: 5 of 15 START test source_not_null_raw_csv_order_items_order_id ................ [RUN]
[0m16:29:54.186674 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__orders_order_id.4b38fb230a, now test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2)
[0m16:29:54.187273 [debug] [Thread-2 (]: Began compiling node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m16:29:54.191394 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"
[0m16:29:54.212221 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__users_user_id.cb91e05164 (execute): 16:29:52.758261 => 16:29:54.211924
[0m16:29:54.213186 [info ] [Thread-4 (]: 4 of 15 PASS not_null_bronze__users_user_id .................................... [[32mPASS[0m in 1.52s]
[0m16:29:54.214098 [debug] [Thread-4 (]: Finished running node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:29:54.214670 [debug] [Thread-4 (]: Began running node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m16:29:54.215298 [info ] [Thread-4 (]: 6 of 15 START test source_not_null_raw_csv_orders_order_id ..................... [RUN]
[0m16:29:54.216207 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__users_user_id.cb91e05164, now test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336)
[0m16:29:54.216747 [debug] [Thread-4 (]: Began compiling node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m16:29:54.223567 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"
[0m16:29:54.226586 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2 (compile): 16:29:54.187746 => 16:29:54.226287
[0m16:29:54.227494 [debug] [Thread-2 (]: Began executing node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m16:29:54.230271 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"
[0m16:29:54.233867 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336 (compile): 16:29:54.217478 => 16:29:54.233391
[0m16:29:54.235004 [debug] [Thread-4 (]: Began executing node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m16:29:54.239892 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"
[0m16:29:54.253411 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:29:54.258351 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:29:54.293424 [debug] [Thread-3 (]: Timing info for test.retail.not_null_bronze__users_email.2bec59e73f (execute): 16:29:52.761064 => 16:29:54.293097
[0m16:29:54.294523 [debug] [Thread-1 (]: Timing info for test.retail.not_null_bronze__orders_order_created_at.05e711bf75 (execute): 16:29:52.763799 => 16:29:54.294294
[0m16:29:54.295089 [debug] [Thread-2 (]: On test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_raw`.`order_items`
where order_id is null



      
    ) dbt_internal_test
[0m16:29:54.296135 [info ] [Thread-3 (]: 3 of 15 PASS not_null_bronze__users_email ...................................... [[32mPASS[0m in 1.61s]
[0m16:29:54.297952 [error] [Thread-1 (]: 1 of 15 FAIL 987 not_null_bronze__orders_order_created_at ...................... [[31mFAIL 987[0m in 1.62s]
[0m16:29:54.333641 [debug] [Thread-3 (]: Finished running node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:29:54.334668 [debug] [Thread-4 (]: On test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_raw`.`orders`
where order_id is null



      
    ) dbt_internal_test
[0m16:29:54.335710 [debug] [Thread-1 (]: Finished running node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m16:29:54.337152 [debug] [Thread-3 (]: Began running node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m16:29:54.340219 [debug] [Thread-1 (]: Began running node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m16:29:54.341453 [info ] [Thread-3 (]: 7 of 15 START test source_not_null_raw_csv_products_product_id ................. [RUN]
[0m16:29:54.342694 [info ] [Thread-1 (]: 8 of 15 START test source_not_null_raw_csv_sessions_session_id ................. [RUN]
[0m16:29:54.344365 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__users_email.2bec59e73f, now test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6)
[0m16:29:54.345347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__orders_order_created_at.05e711bf75, now test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194)
[0m16:29:54.346004 [debug] [Thread-3 (]: Began compiling node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m16:29:54.346542 [debug] [Thread-1 (]: Began compiling node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m16:29:54.350475 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"
[0m16:29:54.354834 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"
[0m16:29:54.365877 [debug] [Thread-3 (]: Timing info for test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6 (compile): 16:29:54.346977 => 16:29:54.365387
[0m16:29:54.366911 [debug] [Thread-3 (]: Began executing node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m16:29:54.370571 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"
[0m16:29:54.372888 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194 (compile): 16:29:54.351300 => 16:29:54.372563
[0m16:29:54.373599 [debug] [Thread-1 (]: Began executing node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m16:29:54.376242 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"
[0m16:29:54.385079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:54.389122 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:29:54.425400 [debug] [Thread-1 (]: On test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from `retail-data-pipeline-dev`.`retail_raw`.`sessions`
where session_id is null



      
    ) dbt_internal_test
[0m16:29:54.460070 [debug] [Thread-3 (]: On test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `retail-data-pipeline-dev`.`retail_raw`.`products`
where product_id is null



      
    ) dbt_internal_test
[0m16:29:55.043113 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:e0e9d89a-d984-40e8-875b-aeadadde2dac&page=queryresults
[0m16:29:55.062249 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:f7703e0a-61ff-445e-912d-017c862f052d&page=queryresults
[0m16:29:55.159324 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:0dbbb0a0-d478-44cf-9a87-28634a4de16f&page=queryresults
[0m16:29:55.189538 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:c8499359-ea96-4965-bc4d-a8a70f0ff613&page=queryresults
[0m16:29:55.596535 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336 (execute): 16:29:54.235852 => 16:29:55.596181
[0m16:29:55.597874 [info ] [Thread-4 (]: 6 of 15 PASS source_not_null_raw_csv_orders_order_id ........................... [[32mPASS[0m in 1.38s]
[0m16:29:55.598970 [debug] [Thread-4 (]: Finished running node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m16:29:55.599750 [debug] [Thread-4 (]: Began running node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m16:29:55.600657 [info ] [Thread-4 (]: 9 of 15 START test source_not_null_raw_csv_users_user_id ....................... [RUN]
[0m16:29:55.601927 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336, now test.retail.source_not_null_raw_csv_users_user_id.3380c1257d)
[0m16:29:55.602693 [debug] [Thread-4 (]: Began compiling node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m16:29:55.607154 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"
[0m16:29:55.625340 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_users_user_id.3380c1257d (compile): 16:29:55.603191 => 16:29:55.624944
[0m16:29:55.626167 [debug] [Thread-4 (]: Began executing node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m16:29:55.630203 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"
[0m16:29:55.647295 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2 (execute): 16:29:54.228193 => 16:29:55.647021
[0m16:29:55.648424 [info ] [Thread-2 (]: 5 of 15 PASS source_not_null_raw_csv_order_items_order_id ...................... [[32mPASS[0m in 1.46s]
[0m16:29:55.649394 [debug] [Thread-2 (]: Finished running node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m16:29:55.649877 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:29:55.650333 [debug] [Thread-2 (]: Began running node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m16:29:55.651285 [info ] [Thread-2 (]: 10 of 15 START test source_unique_raw_csv_orders_order_id ...................... [RUN]
[0m16:29:55.652266 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2, now test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53)
[0m16:29:55.652905 [debug] [Thread-2 (]: Began compiling node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m16:29:55.658756 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"
[0m16:29:55.692538 [debug] [Thread-4 (]: On test.retail.source_not_null_raw_csv_users_user_id.3380c1257d: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `retail-data-pipeline-dev`.`retail_raw`.`users`
where user_id is null



      
    ) dbt_internal_test
[0m16:29:55.697305 [debug] [Thread-3 (]: Timing info for test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6 (execute): 16:29:54.368225 => 16:29:55.696864
[0m16:29:55.698596 [info ] [Thread-3 (]: 7 of 15 PASS source_not_null_raw_csv_products_product_id ....................... [[32mPASS[0m in 1.35s]
[0m16:29:55.699621 [debug] [Thread-3 (]: Finished running node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m16:29:55.700512 [debug] [Thread-3 (]: Began running node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m16:29:55.701401 [info ] [Thread-3 (]: 11 of 15 START test source_unique_raw_csv_products_product_id .................. [RUN]
[0m16:29:55.702904 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6, now test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1)
[0m16:29:55.703764 [debug] [Thread-3 (]: Began compiling node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m16:29:55.704294 [debug] [Thread-2 (]: Timing info for test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53 (compile): 16:29:55.653450 => 16:29:55.704053
[0m16:29:55.708206 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"
[0m16:29:55.709085 [debug] [Thread-2 (]: Began executing node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m16:29:55.712120 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"
[0m16:29:55.726890 [debug] [Thread-3 (]: Timing info for test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1 (compile): 16:29:55.704521 => 16:29:55.726353
[0m16:29:55.727690 [debug] [Thread-3 (]: Began executing node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m16:29:55.728134 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:29:55.730559 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"
[0m16:29:55.766918 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194 (execute): 16:29:54.374122 => 16:29:55.766643
[0m16:29:55.767823 [debug] [Thread-2 (]: On test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:29:55.768705 [info ] [Thread-1 (]: 8 of 15 PASS source_not_null_raw_csv_sessions_session_id ....................... [[32mPASS[0m in 1.42s]
[0m16:29:55.771732 [debug] [Thread-1 (]: Finished running node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m16:29:55.772534 [debug] [Thread-1 (]: Began running node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m16:29:55.773188 [info ] [Thread-1 (]: 12 of 15 START test source_unique_raw_csv_sessions_session_id .................. [RUN]
[0m16:29:55.774468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194, now test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8)
[0m16:29:55.775256 [debug] [Thread-1 (]: Began compiling node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m16:29:55.779323 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"
[0m16:29:55.782497 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:29:55.819365 [debug] [Thread-3 (]: On test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:29:55.828178 [debug] [Thread-1 (]: Timing info for test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8 (compile): 16:29:55.775766 => 16:29:55.827658
[0m16:29:55.829013 [debug] [Thread-1 (]: Began executing node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m16:29:55.831532 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"
[0m16:29:55.852555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:55.889589 [debug] [Thread-1 (]: On test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select session_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`sessions`
  where session_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:29:56.430721 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:969603f5-9be2-4472-a925-e562ed2b7f84&page=queryresults
[0m16:29:56.533538 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:e107354a-b2e1-4265-b833-b9654b96f3bd&page=queryresults
[0m16:29:56.613740 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:4f665e49-b43d-4e5f-aaa6-779ffd18ce36&page=queryresults
[0m16:29:56.682138 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:dba8eafd-1568-4a69-8dd0-d6e986c7d69c&page=queryresults
[0m16:29:57.012667 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_users_user_id.3380c1257d (execute): 16:29:55.626772 => 16:29:57.012152
[0m16:29:57.014375 [info ] [Thread-4 (]: 9 of 15 PASS source_not_null_raw_csv_users_user_id ............................. [[32mPASS[0m in 1.41s]
[0m16:29:57.015629 [debug] [Thread-4 (]: Finished running node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m16:29:57.016503 [debug] [Thread-4 (]: Began running node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m16:29:57.017348 [info ] [Thread-4 (]: 13 of 15 START test source_unique_raw_csv_users_user_id ........................ [RUN]
[0m16:29:57.018661 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_users_user_id.3380c1257d, now test.retail.source_unique_raw_csv_users_user_id.d8f871acc9)
[0m16:29:57.019516 [debug] [Thread-4 (]: Began compiling node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m16:29:57.024188 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"
[0m16:29:57.051806 [debug] [Thread-4 (]: Timing info for test.retail.source_unique_raw_csv_users_user_id.d8f871acc9 (compile): 16:29:57.020209 => 16:29:57.051301
[0m16:29:57.053183 [debug] [Thread-4 (]: Began executing node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m16:29:57.056456 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"
[0m16:29:57.079865 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:29:57.115477 [debug] [Thread-4 (]: On test.retail.source_unique_raw_csv_users_user_id.d8f871acc9: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:29:57.131828 [debug] [Thread-2 (]: Timing info for test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53 (execute): 16:29:55.710058 => 16:29:57.131574
[0m16:29:57.133394 [error] [Thread-2 (]: 10 of 15 FAIL 25 source_unique_raw_csv_orders_order_id ......................... [[31mFAIL 25[0m in 1.48s]
[0m16:29:57.134638 [debug] [Thread-2 (]: Finished running node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m16:29:57.135552 [debug] [Thread-2 (]: Began running node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m16:29:57.136350 [info ] [Thread-2 (]: 14 of 15 START test unique_bronze__orders_order_id ............................. [RUN]
[0m16:29:57.137488 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53, now test.retail.unique_bronze__orders_order_id.cd2f27ce5f)
[0m16:29:57.138145 [debug] [Thread-2 (]: Began compiling node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m16:29:57.141959 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"
[0m16:29:57.159167 [debug] [Thread-2 (]: Timing info for test.retail.unique_bronze__orders_order_id.cd2f27ce5f (compile): 16:29:57.138721 => 16:29:57.158659
[0m16:29:57.160146 [debug] [Thread-2 (]: Began executing node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m16:29:57.162757 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"
[0m16:29:57.178551 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:29:57.215201 [debug] [Thread-1 (]: Timing info for test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8 (execute): 16:29:55.829616 => 16:29:57.214822
[0m16:29:57.216783 [debug] [Thread-3 (]: Timing info for test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1 (execute): 16:29:55.728382 => 16:29:57.216234
[0m16:29:57.217420 [debug] [Thread-2 (]: On test.retail.unique_bronze__orders_order_id.cd2f27ce5f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:29:57.218527 [info ] [Thread-1 (]: 12 of 15 PASS source_unique_raw_csv_sessions_session_id ........................ [[32mPASS[0m in 1.44s]
[0m16:29:57.219979 [info ] [Thread-3 (]: 11 of 15 PASS source_unique_raw_csv_products_product_id ........................ [[32mPASS[0m in 1.52s]
[0m16:29:57.222712 [debug] [Thread-1 (]: Finished running node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m16:29:57.223555 [debug] [Thread-3 (]: Finished running node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m16:29:57.224278 [debug] [Thread-1 (]: Began running node test.retail.unique_bronze__users_user_id.129342c645
[0m16:29:57.225566 [info ] [Thread-1 (]: 15 of 15 START test unique_bronze__users_user_id ............................... [RUN]
[0m16:29:57.226535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8, now test.retail.unique_bronze__users_user_id.129342c645)
[0m16:29:57.227206 [debug] [Thread-1 (]: Began compiling node test.retail.unique_bronze__users_user_id.129342c645
[0m16:29:57.231411 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.unique_bronze__users_user_id.129342c645"
[0m16:29:57.247823 [debug] [Thread-1 (]: Timing info for test.retail.unique_bronze__users_user_id.129342c645 (compile): 16:29:57.227740 => 16:29:57.247385
[0m16:29:57.248784 [debug] [Thread-1 (]: Began executing node test.retail.unique_bronze__users_user_id.129342c645
[0m16:29:57.251395 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.unique_bronze__users_user_id.129342c645"
[0m16:29:57.271191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:57.307395 [debug] [Thread-1 (]: On test.retail.unique_bronze__users_user_id.129342c645: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_bronze__users_user_id.129342c645"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:29:57.824412 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:1e5bf2a0-b1f1-493e-8071-ecd9a328fd9e&page=queryresults
[0m16:29:57.912890 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:ab2d083d-83e3-435d-803f-89bec0d600bd&page=queryresults
[0m16:29:58.055131 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:1aac8455-54bd-49d3-bf24-3b91b1481f70&page=queryresults
[0m16:29:58.334725 [debug] [Thread-4 (]: Timing info for test.retail.source_unique_raw_csv_users_user_id.d8f871acc9 (execute): 16:29:57.054153 => 16:29:58.334450
[0m16:29:58.335969 [error] [Thread-4 (]: 13 of 15 FAIL 5 source_unique_raw_csv_users_user_id ............................ [[31mFAIL 5[0m in 1.32s]
[0m16:29:58.337038 [debug] [Thread-4 (]: Finished running node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m16:29:58.455183 [debug] [Thread-2 (]: Timing info for test.retail.unique_bronze__orders_order_id.cd2f27ce5f (execute): 16:29:57.160662 => 16:29:58.454859
[0m16:29:58.456344 [error] [Thread-2 (]: 14 of 15 FAIL 25 unique_bronze__orders_order_id ................................ [[31mFAIL 25[0m in 1.32s]
[0m16:29:58.457153 [debug] [Thread-2 (]: Finished running node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m16:29:58.610278 [debug] [Thread-1 (]: Timing info for test.retail.unique_bronze__users_user_id.129342c645 (execute): 16:29:57.249361 => 16:29:58.609945
[0m16:29:58.611655 [error] [Thread-1 (]: 15 of 15 FAIL 5 unique_bronze__users_user_id ................................... [[31mFAIL 5[0m in 1.39s]
[0m16:29:58.612589 [debug] [Thread-1 (]: Finished running node test.retail.unique_bronze__users_user_id.129342c645
[0m16:29:58.614877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:58.615685 [debug] [MainThread]: Connection 'test.retail.unique_bronze__users_user_id.129342c645' was properly closed.
[0m16:29:58.616279 [debug] [MainThread]: Connection 'test.retail.unique_bronze__orders_order_id.cd2f27ce5f' was properly closed.
[0m16:29:58.616897 [debug] [MainThread]: Connection 'test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1' was properly closed.
[0m16:29:58.617524 [debug] [MainThread]: Connection 'test.retail.source_unique_raw_csv_users_user_id.d8f871acc9' was properly closed.
[0m16:29:58.618160 [info ] [MainThread]: 
[0m16:29:58.618826 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 6.46 seconds (6.46s).
[0m16:29:58.621002 [debug] [MainThread]: Command end result
[0m16:29:58.658852 [info ] [MainThread]: 
[0m16:29:58.659779 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m16:29:58.660805 [info ] [MainThread]: 
[0m16:29:58.661853 [error] [MainThread]: [31mFailure in test not_null_bronze__orders_order_created_at (models/bronze/schema.yml)[0m
[0m16:29:58.663172 [error] [MainThread]:   Got 987 results, configured to fail if != 0
[0m16:29:58.664082 [info ] [MainThread]: 
[0m16:29:58.664881 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/schema.yml/not_null_bronze__orders_order_created_at.sql
[0m16:29:58.665825 [info ] [MainThread]: 
[0m16:29:58.666543 [error] [MainThread]: [31mFailure in test source_unique_raw_csv_orders_order_id (models/bronze/sources.yml)[0m
[0m16:29:58.667212 [error] [MainThread]:   Got 25 results, configured to fail if != 0
[0m16:29:58.667874 [info ] [MainThread]: 
[0m16:29:58.668448 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/sources.yml/source_unique_raw_csv_orders_order_id.sql
[0m16:29:58.668982 [info ] [MainThread]: 
[0m16:29:58.669527 [error] [MainThread]: [31mFailure in test source_unique_raw_csv_users_user_id (models/bronze/sources.yml)[0m
[0m16:29:58.670218 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m16:29:58.671231 [info ] [MainThread]: 
[0m16:29:58.671910 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/sources.yml/source_unique_raw_csv_users_user_id.sql
[0m16:29:58.672562 [info ] [MainThread]: 
[0m16:29:58.673176 [error] [MainThread]: [31mFailure in test unique_bronze__orders_order_id (models/bronze/schema.yml)[0m
[0m16:29:58.673818 [error] [MainThread]:   Got 25 results, configured to fail if != 0
[0m16:29:58.674405 [info ] [MainThread]: 
[0m16:29:58.675070 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/schema.yml/unique_bronze__orders_order_id.sql
[0m16:29:58.675673 [info ] [MainThread]: 
[0m16:29:58.676318 [error] [MainThread]: [31mFailure in test unique_bronze__users_user_id (models/bronze/schema.yml)[0m
[0m16:29:58.677326 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m16:29:58.678363 [info ] [MainThread]: 
[0m16:29:58.679500 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/schema.yml/unique_bronze__users_user_id.sql
[0m16:29:58.680604 [info ] [MainThread]: 
[0m16:29:58.681576 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=5 SKIP=0 TOTAL=15
[0m16:29:58.683150 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 14.999696, "process_user_time": 4.533583, "process_kernel_time": 1.532706, "process_mem_max_rss": "239496", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:29:58.684342 [debug] [MainThread]: Command `dbt test` failed at 16:29:58.684082 after 15.00 seconds
[0m16:29:58.685174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a33134ebef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a32e6512d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a33160c1640>]}
[0m16:29:58.686241 [debug] [MainThread]: Flushing usage events
[0m16:33:40.930231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d82264c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d824b9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d823e9c10>]}


============================== 16:33:40.938115 | 21bf8e8f-17c8-42e5-87e9-34c79b0b40b4 ==============================
[0m16:33:40.938115 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:33:40.939178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:33:41.034832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21bf8e8f-17c8-42e5-87e9-34c79b0b40b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d82264f80>]}
[0m16:33:42.352827 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-inqky8a8'
[0m16:33:42.353636 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:33:42.575604 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:33:42.576986 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:33:42.680148 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:33:42.684059 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m16:33:42.827823 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m16:33:42.832058 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m16:33:42.972674 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m16:33:42.978439 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:33:50.213016 [info ] [MainThread]: Installed from version 1.3.1
[0m16:33:50.214021 [info ] [MainThread]: Up to date!
[0m16:33:50.215035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '21bf8e8f-17c8-42e5-87e9-34c79b0b40b4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d8315e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d82879cd0>]}
[0m16:33:50.216145 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m16:33:56.221762 [info ] [MainThread]: Installed from version 0.10.9
[0m16:33:56.222974 [info ] [MainThread]: Up to date!
[0m16:33:56.224055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '21bf8e8f-17c8-42e5-87e9-34c79b0b40b4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d8211ec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d8211d5e0>]}
[0m16:33:56.225166 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m16:33:58.600430 [info ] [MainThread]: Installed from version 0.15.0
[0m16:33:58.601763 [info ] [MainThread]: Up to date!
[0m16:33:58.602595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '21bf8e8f-17c8-42e5-87e9-34c79b0b40b4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d82147290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d82146bd0>]}
[0m16:33:58.606422 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 17.788103, "process_user_time": 2.761866, "process_kernel_time": 0.681122, "process_mem_max_rss": "196476", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m16:33:58.607339 [debug] [MainThread]: Command `dbt deps` succeeded at 16:33:58.607182 after 17.79 seconds
[0m16:33:58.608209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d823e9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d825a3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d820f5d60>]}
[0m16:33:58.609134 [debug] [MainThread]: Flushing usage events
[0m16:34:04.162635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbfacaf7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbfabdd010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbfafacbc0>]}


============================== 16:34:04.170061 | 4317ef69-be85-444b-8504-4f5dd1eb74a4 ==============================
[0m16:34:04.170061 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:34:04.171008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:34:05.123667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4317ef69-be85-444b-8504-4f5dd1eb74a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbda61df70>]}
[0m16:34:05.207421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4317ef69-be85-444b-8504-4f5dd1eb74a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbd4e7da90>]}
[0m16:34:05.208828 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:34:05.317682 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:34:13.162686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:34:13.164028 [debug] [MainThread]: Partial parsing: updated file: retail://models/bronze/sources.yml
[0m16:34:13.164815 [debug] [MainThread]: Partial parsing: updated file: retail://models/bronze/schema.yml
[0m16:34:13.535343 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:34:13.541101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4317ef69-be85-444b-8504-4f5dd1eb74a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbafb77e90>]}
[0m16:34:13.601801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4317ef69-be85-444b-8504-4f5dd1eb74a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbfb52ddf0>]}
[0m16:34:13.602944 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:34:13.603952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4317ef69-be85-444b-8504-4f5dd1eb74a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbcc122b40>]}
[0m16:34:13.614425 [info ] [MainThread]: 
[0m16:34:13.615840 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:34:13.617635 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m16:34:13.618410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:14.299731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod)
[0m16:34:14.300690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:14.834335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4317ef69-be85-444b-8504-4f5dd1eb74a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbfac4ff80>]}
[0m16:34:14.835517 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:34:14.836315 [info ] [MainThread]: 
[0m16:34:14.844819 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m16:34:14.845391 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m16:34:14.845926 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod.bronze__orders ........................ [RUN]
[0m16:34:14.846829 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod.bronze__users ......................... [RUN]
[0m16:34:14.847968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.bronze__orders)
[0m16:34:14.849030 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m16:34:14.849703 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m16:34:14.850304 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m16:34:14.856272 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m16:34:14.859512 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m16:34:14.870553 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 16:34:14.856924 => 16:34:14.870113
[0m16:34:14.871447 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m16:34:14.878278 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 16:34:14.850870 => 16:34:14.877865
[0m16:34:14.885323 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m16:34:14.886534 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:34:14.888817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:15.435735 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m16:34:15.434466 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m16:34:15.449391 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe.parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m16:34:15.451898 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe.parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m16:34:15.862605 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:dbb6e0aa-cce1-45cb-893f-1c3a7cacd6e3&page=queryresults
[0m16:34:15.912296 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:4cd8927d-39b8-46d0-913b-6af081af5f06&page=queryresults
[0m16:34:17.982103 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 16:34:14.886986 => 16:34:17.981812
[0m16:34:17.983125 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 16:34:14.872159 => 16:34:17.982926
[0m16:34:17.983856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4317ef69-be85-444b-8504-4f5dd1eb74a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbcdb647a0>]}
[0m16:34:17.985406 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4317ef69-be85-444b-8504-4f5dd1eb74a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbcdb67980>]}
[0m16:34:17.986595 [info ] [Thread-1 (]: 1 of 2 OK created sql table model retail_prod.bronze__orders ................... [[32mCREATE TABLE (5.0k rows, 414.1 KiB processed)[0m in 3.14s]
[0m16:34:17.987890 [info ] [Thread-2 (]: 2 of 2 OK created sql table model retail_prod.bronze__users .................... [[32mCREATE TABLE (1.0k rows, 107.1 KiB processed)[0m in 3.14s]
[0m16:34:17.988884 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m16:34:17.990198 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m16:34:17.994714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:17.995936 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m16:34:17.996892 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m16:34:17.997591 [info ] [MainThread]: 
[0m16:34:17.998197 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.38 seconds (4.38s).
[0m16:34:17.999076 [debug] [MainThread]: Command end result
[0m16:34:18.038911 [info ] [MainThread]: 
[0m16:34:18.039925 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:34:18.040553 [info ] [MainThread]: 
[0m16:34:18.041198 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:34:18.042636 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.956242, "process_user_time": 4.319457, "process_kernel_time": 1.572911, "process_mem_max_rss": "243948", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:34:18.043762 [debug] [MainThread]: Command `dbt run` succeeded at 16:34:18.043556 after 13.96 seconds
[0m16:34:18.044572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbff7873e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbcd64e3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbfabdcad0>]}
[0m16:34:18.045477 [debug] [MainThread]: Flushing usage events
[0m16:34:22.759661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7997d46444d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7997d54445c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7997d48d8bc0>]}


============================== 16:34:22.765989 | af543812-82b7-49c3-8e58-e5f89228ee8c ==============================
[0m16:34:22.765989 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:34:22.766891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:34:23.601693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af543812-82b7-49c3-8e58-e5f89228ee8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7997a77dc440>]}
[0m16:34:23.673163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af543812-82b7-49c3-8e58-e5f89228ee8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7997accc6240>]}
[0m16:34:23.675043 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:34:23.821404 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:34:30.400881 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:34:30.401860 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:34:30.403071 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:34:30.408276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af543812-82b7-49c3-8e58-e5f89228ee8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7997a78ba180>]}
[0m16:34:30.453053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af543812-82b7-49c3-8e58-e5f89228ee8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7997a72cd9d0>]}
[0m16:34:30.454103 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:34:30.454836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af543812-82b7-49c3-8e58-e5f89228ee8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7997d462d010>]}
[0m16:34:30.463531 [info ] [MainThread]: 
[0m16:34:30.464913 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:34:30.466902 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev_retail_prod'
[0m16:34:30.467802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:31.028831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af543812-82b7-49c3-8e58-e5f89228ee8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7997d46458e0>]}
[0m16:34:31.030118 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:34:31.030867 [info ] [MainThread]: 
[0m16:34:31.039256 [debug] [Thread-1 (]: Began running node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m16:34:31.039903 [debug] [Thread-2 (]: Began running node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m16:34:31.040408 [debug] [Thread-3 (]: Began running node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:34:31.041172 [debug] [Thread-4 (]: Began running node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:34:31.040812 [info ] [Thread-1 (]: 1 of 15 START test not_null_bronze__orders_order_created_at .................... [RUN]
[0m16:34:31.042009 [info ] [Thread-2 (]: 2 of 15 START test not_null_bronze__orders_order_id ............................ [RUN]
[0m16:34:31.042550 [info ] [Thread-3 (]: 3 of 15 START test not_null_bronze__users_email ................................ [RUN]
[0m16:34:31.043203 [info ] [Thread-4 (]: 4 of 15 START test not_null_bronze__users_user_id .............................. [RUN]
[0m16:34:31.044458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now test.retail.not_null_bronze__orders_order_created_at.05e711bf75)
[0m16:34:31.045375 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__orders_order_id.4b38fb230a'
[0m16:34:31.046581 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__users_email.2bec59e73f'
[0m16:34:31.047902 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__users_user_id.cb91e05164'
[0m16:34:31.048594 [debug] [Thread-1 (]: Began compiling node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m16:34:31.049300 [debug] [Thread-2 (]: Began compiling node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m16:34:31.050096 [debug] [Thread-3 (]: Began compiling node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:34:31.050611 [debug] [Thread-4 (]: Began compiling node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:34:31.068610 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.not_null_bronze__orders_order_id.4b38fb230a"
[0m16:34:31.070459 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"
[0m16:34:31.074833 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.not_null_bronze__users_email.2bec59e73f"
[0m16:34:31.078960 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.not_null_bronze__users_user_id.cb91e05164"
[0m16:34:31.090869 [debug] [Thread-2 (]: Timing info for test.retail.not_null_bronze__orders_order_id.4b38fb230a (compile): 16:34:31.062067 => 16:34:31.090458
[0m16:34:31.091993 [debug] [Thread-2 (]: Began executing node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m16:34:31.098944 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__users_user_id.cb91e05164 (compile): 16:34:31.075860 => 16:34:31.098505
[0m16:34:31.099956 [debug] [Thread-3 (]: Timing info for test.retail.not_null_bronze__users_email.2bec59e73f (compile): 16:34:31.070918 => 16:34:31.099697
[0m16:34:31.100647 [debug] [Thread-4 (]: Began executing node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:34:31.111638 [debug] [Thread-1 (]: Timing info for test.retail.not_null_bronze__orders_order_created_at.05e711bf75 (compile): 16:34:31.051136 => 16:34:31.111220
[0m16:34:31.112391 [debug] [Thread-3 (]: Began executing node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:34:31.113952 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.not_null_bronze__orders_order_id.4b38fb230a"
[0m16:34:31.116985 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.not_null_bronze__users_user_id.cb91e05164"
[0m16:34:31.118123 [debug] [Thread-1 (]: Began executing node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m16:34:31.120543 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.not_null_bronze__users_email.2bec59e73f"
[0m16:34:31.124893 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"
[0m16:34:31.134171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:31.135005 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:34:31.137472 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:34:31.139205 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:34:31.202961 [debug] [Thread-2 (]: On test.retail.not_null_bronze__orders_order_id.4b38fb230a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__orders_order_id.4b38fb230a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
where order_id is null



      
    ) dbt_internal_test
[0m16:34:31.203899 [debug] [Thread-1 (]: On test.retail.not_null_bronze__orders_order_created_at.05e711bf75: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_created_at
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
where order_created_at is null



      
    ) dbt_internal_test
[0m16:34:31.241171 [debug] [Thread-3 (]: On test.retail.not_null_bronze__users_email.2bec59e73f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__users_email.2bec59e73f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
where email is null



      
    ) dbt_internal_test
[0m16:34:31.275940 [debug] [Thread-4 (]: On test.retail.not_null_bronze__users_user_id.cb91e05164: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__users_user_id.cb91e05164"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
where user_id is null



      
    ) dbt_internal_test
[0m16:34:31.982744 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:9ee4422c-adaf-450e-b10b-2c8c780f0559&page=queryresults
[0m16:34:31.992555 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:976ecf1b-1770-47b2-af46-d68bd0a684c8&page=queryresults
[0m16:34:31.993331 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:cf0483fd-b70d-4617-99f0-54a6cef907aa&page=queryresults
[0m16:34:31.997113 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:c02416ed-1188-454e-bb6b-0c1103edcd44&page=queryresults
[0m16:34:32.585556 [debug] [Thread-1 (]: Timing info for test.retail.not_null_bronze__orders_order_created_at.05e711bf75 (execute): 16:34:31.122977 => 16:34:32.585205
[0m16:34:32.586914 [warn ] [Thread-1 (]: 1 of 15 WARN 987 not_null_bronze__orders_order_created_at ...................... [[33mWARN 987[0m in 1.54s]
[0m16:34:32.587864 [debug] [Thread-1 (]: Finished running node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m16:34:32.588647 [debug] [Thread-1 (]: Began running node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m16:34:32.589366 [info ] [Thread-1 (]: 5 of 15 START test source_not_null_raw_csv_order_items_order_id ................ [RUN]
[0m16:34:32.590453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__orders_order_created_at.05e711bf75, now test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2)
[0m16:34:32.591084 [debug] [Thread-1 (]: Began compiling node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m16:34:32.595353 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"
[0m16:34:32.597244 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__users_user_id.cb91e05164 (execute): 16:34:31.114801 => 16:34:32.597007
[0m16:34:32.598234 [info ] [Thread-4 (]: 4 of 15 PASS not_null_bronze__users_user_id .................................... [[32mPASS[0m in 1.55s]
[0m16:34:32.599169 [debug] [Thread-4 (]: Finished running node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:34:32.599770 [debug] [Thread-4 (]: Began running node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m16:34:32.600453 [info ] [Thread-4 (]: 6 of 15 START test source_not_null_raw_csv_orders_order_id ..................... [RUN]
[0m16:34:32.601376 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__users_user_id.cb91e05164, now test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336)
[0m16:34:32.601966 [debug] [Thread-4 (]: Began compiling node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m16:34:32.605860 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"
[0m16:34:32.616070 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2 (compile): 16:34:32.591490 => 16:34:32.615592
[0m16:34:32.617917 [debug] [Thread-3 (]: Timing info for test.retail.not_null_bronze__users_email.2bec59e73f (execute): 16:34:31.119008 => 16:34:32.617684
[0m16:34:32.618349 [debug] [Thread-1 (]: Began executing node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m16:34:32.619578 [info ] [Thread-3 (]: 3 of 15 PASS not_null_bronze__users_email ...................................... [[32mPASS[0m in 1.57s]
[0m16:34:32.622574 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"
[0m16:34:32.623186 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336 (compile): 16:34:32.602508 => 16:34:32.622937
[0m16:34:32.623938 [debug] [Thread-3 (]: Finished running node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:34:32.625405 [debug] [Thread-4 (]: Began executing node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m16:34:32.626243 [debug] [Thread-3 (]: Began running node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m16:34:32.630669 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"
[0m16:34:32.631293 [info ] [Thread-3 (]: 7 of 15 START test source_not_null_raw_csv_products_product_id ................. [RUN]
[0m16:34:32.632897 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__users_email.2bec59e73f, now test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6)
[0m16:34:32.633453 [debug] [Thread-3 (]: Began compiling node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m16:34:32.637639 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"
[0m16:34:32.641400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:32.644012 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:34:32.678763 [debug] [Thread-1 (]: On test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_raw`.`order_items`
where order_id is null



      
    ) dbt_internal_test
[0m16:34:32.713884 [debug] [Thread-4 (]: On test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_raw`.`orders`
where order_id is null



      
    ) dbt_internal_test
[0m16:34:32.715264 [debug] [Thread-2 (]: Timing info for test.retail.not_null_bronze__orders_order_id.4b38fb230a (execute): 16:34:31.092965 => 16:34:32.714959
[0m16:34:32.717891 [debug] [Thread-3 (]: Timing info for test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6 (compile): 16:34:32.633846 => 16:34:32.717605
[0m16:34:32.718791 [info ] [Thread-2 (]: 2 of 15 PASS not_null_bronze__orders_order_id .................................. [[32mPASS[0m in 1.67s]
[0m16:34:32.719970 [debug] [Thread-3 (]: Began executing node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m16:34:32.721194 [debug] [Thread-2 (]: Finished running node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m16:34:32.724262 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"
[0m16:34:32.725136 [debug] [Thread-2 (]: Began running node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m16:34:32.726347 [info ] [Thread-2 (]: 8 of 15 START test source_not_null_raw_csv_sessions_session_id ................. [RUN]
[0m16:34:32.727266 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__orders_order_id.4b38fb230a, now test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194)
[0m16:34:32.728077 [debug] [Thread-2 (]: Began compiling node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m16:34:32.732165 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"
[0m16:34:32.743497 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:34:32.778486 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194 (compile): 16:34:32.728787 => 16:34:32.778196
[0m16:34:32.779725 [debug] [Thread-2 (]: Began executing node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m16:34:32.780549 [debug] [Thread-3 (]: On test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `retail-data-pipeline-dev`.`retail_raw`.`products`
where product_id is null



      
    ) dbt_internal_test
[0m16:34:32.782867 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"
[0m16:34:32.806920 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:34:32.849061 [debug] [Thread-2 (]: On test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from `retail-data-pipeline-dev`.`retail_raw`.`sessions`
where session_id is null



      
    ) dbt_internal_test
[0m16:34:33.372536 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:cf8d6f9a-7ea6-4d7c-b5f7-4c78cb9d1c77&page=queryresults
[0m16:34:33.418283 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:667af256-cfbe-4dea-b14f-6015ead5cc24&page=queryresults
[0m16:34:33.439674 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:5c8cb451-fd04-4a8a-8aea-530ee7723c6f&page=queryresults
[0m16:34:33.442904 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:4a2934ac-1281-4969-ae71-1cf1bcea65db&page=queryresults
[0m16:34:33.908956 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336 (execute): 16:34:32.626744 => 16:34:33.908666
[0m16:34:33.910593 [info ] [Thread-4 (]: 6 of 15 PASS source_not_null_raw_csv_orders_order_id ........................... [[32mPASS[0m in 1.31s]
[0m16:34:33.911917 [debug] [Thread-4 (]: Finished running node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m16:34:33.912963 [debug] [Thread-4 (]: Began running node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m16:34:33.915194 [info ] [Thread-4 (]: 9 of 15 START test source_not_null_raw_csv_users_user_id ....................... [RUN]
[0m16:34:33.917263 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336, now test.retail.source_not_null_raw_csv_users_user_id.3380c1257d)
[0m16:34:33.918828 [debug] [Thread-4 (]: Began compiling node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m16:34:33.923654 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"
[0m16:34:33.952903 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_users_user_id.3380c1257d (compile): 16:34:33.919661 => 16:34:33.952525
[0m16:34:33.953845 [debug] [Thread-4 (]: Began executing node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m16:34:33.957792 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"
[0m16:34:33.982185 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:34:34.020453 [debug] [Thread-3 (]: Timing info for test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6 (execute): 16:34:32.722026 => 16:34:34.020143
[0m16:34:34.021832 [info ] [Thread-3 (]: 7 of 15 PASS source_not_null_raw_csv_products_product_id ....................... [[32mPASS[0m in 1.39s]
[0m16:34:34.022426 [debug] [Thread-4 (]: On test.retail.source_not_null_raw_csv_users_user_id.3380c1257d: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `retail-data-pipeline-dev`.`retail_raw`.`users`
where user_id is null



      
    ) dbt_internal_test
[0m16:34:34.023265 [debug] [Thread-3 (]: Finished running node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m16:34:34.024394 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2 (execute): 16:34:32.620244 => 16:34:34.024186
[0m16:34:34.025182 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194 (execute): 16:34:32.780878 => 16:34:34.024967
[0m16:34:34.027897 [debug] [Thread-3 (]: Began running node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m16:34:34.029550 [info ] [Thread-1 (]: 5 of 15 PASS source_not_null_raw_csv_order_items_order_id ...................... [[32mPASS[0m in 1.44s]
[0m16:34:34.031000 [info ] [Thread-2 (]: 8 of 15 PASS source_not_null_raw_csv_sessions_session_id ....................... [[32mPASS[0m in 1.30s]
[0m16:34:34.031865 [info ] [Thread-3 (]: 10 of 15 START test source_unique_raw_csv_orders_order_id ...................... [RUN]
[0m16:34:34.032994 [debug] [Thread-1 (]: Finished running node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m16:34:34.033838 [debug] [Thread-2 (]: Finished running node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m16:34:34.034632 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6, now test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53)
[0m16:34:34.035333 [debug] [Thread-1 (]: Began running node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m16:34:34.036062 [debug] [Thread-2 (]: Began running node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m16:34:34.036590 [debug] [Thread-3 (]: Began compiling node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m16:34:34.037210 [info ] [Thread-1 (]: 11 of 15 START test source_unique_raw_csv_products_product_id .................. [RUN]
[0m16:34:34.038010 [info ] [Thread-2 (]: 12 of 15 START test source_unique_raw_csv_sessions_session_id .................. [RUN]
[0m16:34:34.044642 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"
[0m16:34:34.045648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2, now test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1)
[0m16:34:34.046921 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194, now test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8)
[0m16:34:34.048551 [debug] [Thread-1 (]: Began compiling node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m16:34:34.049670 [debug] [Thread-2 (]: Began compiling node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m16:34:34.054136 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"
[0m16:34:34.058422 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"
[0m16:34:34.071494 [debug] [Thread-3 (]: Timing info for test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53 (compile): 16:34:34.038682 => 16:34:34.070960
[0m16:34:34.072585 [debug] [Thread-2 (]: Timing info for test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8 (compile): 16:34:34.054956 => 16:34:34.072138
[0m16:34:34.073235 [debug] [Thread-3 (]: Began executing node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m16:34:34.074126 [debug] [Thread-2 (]: Began executing node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m16:34:34.077969 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"
[0m16:34:34.078799 [debug] [Thread-1 (]: Timing info for test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1 (compile): 16:34:34.050549 => 16:34:34.078423
[0m16:34:34.081043 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"
[0m16:34:34.082730 [debug] [Thread-1 (]: Began executing node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m16:34:34.085673 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"
[0m16:34:34.094683 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:34:34.096421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:34.097577 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:34:34.131761 [debug] [Thread-2 (]: On test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select session_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`sessions`
  where session_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:34:34.196855 [debug] [Thread-1 (]: On test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:34:34.197562 [debug] [Thread-3 (]: On test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:34:34.752477 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:177c0d70-a812-4376-8928-7c1695dba718&page=queryresults
[0m16:34:34.788328 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:fdb73200-a44b-442e-a0af-01499c01fccb&page=queryresults
[0m16:34:34.806018 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:f4f09af2-0ac3-41ac-98f4-e692d88cdb7f&page=queryresults
[0m16:34:34.917974 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:ef10d312-5ce9-4435-b898-b8e888380642&page=queryresults
[0m16:34:35.335563 [debug] [Thread-2 (]: Timing info for test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8 (execute): 16:34:34.079197 => 16:34:35.335087
[0m16:34:35.337555 [info ] [Thread-2 (]: 12 of 15 PASS source_unique_raw_csv_sessions_session_id ........................ [[32mPASS[0m in 1.29s]
[0m16:34:35.338982 [debug] [Thread-2 (]: Finished running node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m16:34:35.340027 [debug] [Thread-2 (]: Began running node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m16:34:35.340918 [info ] [Thread-2 (]: 13 of 15 START test source_unique_raw_csv_users_user_id ........................ [RUN]
[0m16:34:35.341941 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8, now test.retail.source_unique_raw_csv_users_user_id.d8f871acc9)
[0m16:34:35.342751 [debug] [Thread-2 (]: Began compiling node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m16:34:35.347492 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"
[0m16:34:35.357120 [debug] [Thread-3 (]: Timing info for test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53 (execute): 16:34:34.075209 => 16:34:35.356767
[0m16:34:35.358251 [warn ] [Thread-3 (]: 10 of 15 WARN 25 source_unique_raw_csv_orders_order_id ......................... [[33mWARN 25[0m in 1.32s]
[0m16:34:35.359162 [debug] [Thread-3 (]: Finished running node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m16:34:35.359794 [debug] [Thread-3 (]: Began running node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m16:34:35.360437 [info ] [Thread-3 (]: 14 of 15 START test unique_bronze__orders_order_id ............................. [RUN]
[0m16:34:35.361447 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53, now test.retail.unique_bronze__orders_order_id.cd2f27ce5f)
[0m16:34:35.362205 [debug] [Thread-3 (]: Began compiling node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m16:34:35.366819 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"
[0m16:34:35.368479 [debug] [Thread-2 (]: Timing info for test.retail.source_unique_raw_csv_users_user_id.d8f871acc9 (compile): 16:34:35.343264 => 16:34:35.368151
[0m16:34:35.369315 [debug] [Thread-2 (]: Began executing node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m16:34:35.372065 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"
[0m16:34:35.380621 [debug] [Thread-3 (]: Timing info for test.retail.unique_bronze__orders_order_id.cd2f27ce5f (compile): 16:34:35.362796 => 16:34:35.380112
[0m16:34:35.381479 [debug] [Thread-3 (]: Began executing node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m16:34:35.384225 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"
[0m16:34:35.386414 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_users_user_id.3380c1257d (execute): 16:34:33.954462 => 16:34:35.386010
[0m16:34:35.387828 [info ] [Thread-4 (]: 9 of 15 PASS source_not_null_raw_csv_users_user_id ............................. [[32mPASS[0m in 1.47s]
[0m16:34:35.389270 [debug] [Thread-4 (]: Finished running node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m16:34:35.390242 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:34:35.391670 [debug] [Thread-4 (]: Began running node test.retail.unique_bronze__users_user_id.129342c645
[0m16:34:35.394731 [info ] [Thread-4 (]: 15 of 15 START test unique_bronze__users_user_id ............................... [RUN]
[0m16:34:35.396099 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:34:35.397037 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_users_user_id.3380c1257d, now test.retail.unique_bronze__users_user_id.129342c645)
[0m16:34:35.398505 [debug] [Thread-4 (]: Began compiling node test.retail.unique_bronze__users_user_id.129342c645
[0m16:34:35.433744 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.unique_bronze__users_user_id.129342c645"
[0m16:34:35.435322 [debug] [Thread-2 (]: On test.retail.source_unique_raw_csv_users_user_id.d8f871acc9: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:34:35.470842 [debug] [Thread-3 (]: On test.retail.unique_bronze__orders_order_id.cd2f27ce5f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:34:35.475650 [debug] [Thread-1 (]: Timing info for test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1 (execute): 16:34:34.083704 => 16:34:35.475350
[0m16:34:35.477071 [info ] [Thread-1 (]: 11 of 15 PASS source_unique_raw_csv_products_product_id ........................ [[32mPASS[0m in 1.43s]
[0m16:34:35.478149 [debug] [Thread-1 (]: Finished running node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m16:34:35.482308 [debug] [Thread-4 (]: Timing info for test.retail.unique_bronze__users_user_id.129342c645 (compile): 16:34:35.429947 => 16:34:35.481859
[0m16:34:35.483210 [debug] [Thread-4 (]: Began executing node test.retail.unique_bronze__users_user_id.129342c645
[0m16:34:35.485836 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.unique_bronze__users_user_id.129342c645"
[0m16:34:35.507222 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:34:35.545047 [debug] [Thread-4 (]: On test.retail.unique_bronze__users_user_id.129342c645: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_bronze__users_user_id.129342c645"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:34:36.069712 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:3dc1fa00-ba88-4293-9d07-23d51ce5bf30&page=queryresults
[0m16:34:36.298056 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:f54da2cb-8224-489f-b7bf-b70da8fe5799&page=queryresults
[0m16:34:36.429943 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:8021458d-5ec0-47d9-9ab9-86c2c1950008&page=queryresults
[0m16:34:36.592788 [debug] [Thread-2 (]: Timing info for test.retail.source_unique_raw_csv_users_user_id.d8f871acc9 (execute): 16:34:35.369897 => 16:34:36.592347
[0m16:34:36.594453 [warn ] [Thread-2 (]: 13 of 15 WARN 5 source_unique_raw_csv_users_user_id ............................ [[33mWARN 5[0m in 1.25s]
[0m16:34:36.595700 [debug] [Thread-2 (]: Finished running node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m16:34:36.856653 [debug] [Thread-3 (]: Timing info for test.retail.unique_bronze__orders_order_id.cd2f27ce5f (execute): 16:34:35.381995 => 16:34:36.856169
[0m16:34:36.858125 [warn ] [Thread-3 (]: 14 of 15 WARN 25 unique_bronze__orders_order_id ................................ [[33mWARN 25[0m in 1.50s]
[0m16:34:36.859138 [debug] [Thread-3 (]: Finished running node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m16:34:36.979906 [debug] [Thread-4 (]: Timing info for test.retail.unique_bronze__users_user_id.129342c645 (execute): 16:34:35.483780 => 16:34:36.979629
[0m16:34:36.981444 [warn ] [Thread-4 (]: 15 of 15 WARN 5 unique_bronze__users_user_id ................................... [[33mWARN 5[0m in 1.58s]
[0m16:34:36.982489 [debug] [Thread-4 (]: Finished running node test.retail.unique_bronze__users_user_id.129342c645
[0m16:34:36.986477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:36.987315 [debug] [MainThread]: Connection 'test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1' was properly closed.
[0m16:34:36.988063 [debug] [MainThread]: Connection 'test.retail.source_unique_raw_csv_users_user_id.d8f871acc9' was properly closed.
[0m16:34:36.988758 [debug] [MainThread]: Connection 'test.retail.unique_bronze__orders_order_id.cd2f27ce5f' was properly closed.
[0m16:34:36.989371 [debug] [MainThread]: Connection 'test.retail.unique_bronze__users_user_id.129342c645' was properly closed.
[0m16:34:36.990114 [info ] [MainThread]: 
[0m16:34:36.990911 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 6.53 seconds (6.53s).
[0m16:34:36.992926 [debug] [MainThread]: Command end result
[0m16:34:37.034869 [info ] [MainThread]: 
[0m16:34:37.035662 [info ] [MainThread]: [33mCompleted with 5 warnings:[0m
[0m16:34:37.036406 [info ] [MainThread]: 
[0m16:34:37.037101 [warn ] [MainThread]: [33mWarning in test not_null_bronze__orders_order_created_at (models/bronze/schema.yml)[0m
[0m16:34:37.037657 [warn ] [MainThread]: Got 987 results, configured to warn if != 0
[0m16:34:37.038197 [info ] [MainThread]: 
[0m16:34:37.038752 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/schema.yml/not_null_bronze__orders_order_created_at.sql
[0m16:34:37.039253 [info ] [MainThread]: 
[0m16:34:37.039814 [warn ] [MainThread]: [33mWarning in test source_unique_raw_csv_orders_order_id (models/bronze/sources.yml)[0m
[0m16:34:37.040241 [warn ] [MainThread]: Got 25 results, configured to warn if != 0
[0m16:34:37.040829 [info ] [MainThread]: 
[0m16:34:37.041586 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/sources.yml/source_unique_raw_csv_orders_order_id.sql
[0m16:34:37.042238 [info ] [MainThread]: 
[0m16:34:37.042803 [warn ] [MainThread]: [33mWarning in test source_unique_raw_csv_users_user_id (models/bronze/sources.yml)[0m
[0m16:34:37.043424 [warn ] [MainThread]: Got 5 results, configured to warn if != 0
[0m16:34:37.044144 [info ] [MainThread]: 
[0m16:34:37.044789 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/sources.yml/source_unique_raw_csv_users_user_id.sql
[0m16:34:37.045391 [info ] [MainThread]: 
[0m16:34:37.045948 [warn ] [MainThread]: [33mWarning in test unique_bronze__orders_order_id (models/bronze/schema.yml)[0m
[0m16:34:37.046432 [warn ] [MainThread]: Got 25 results, configured to warn if != 0
[0m16:34:37.046891 [info ] [MainThread]: 
[0m16:34:37.047412 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/schema.yml/unique_bronze__orders_order_id.sql
[0m16:34:37.047871 [info ] [MainThread]: 
[0m16:34:37.048399 [warn ] [MainThread]: [33mWarning in test unique_bronze__users_user_id (models/bronze/schema.yml)[0m
[0m16:34:37.049477 [warn ] [MainThread]: Got 5 results, configured to warn if != 0
[0m16:34:37.050213 [info ] [MainThread]: 
[0m16:34:37.050796 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/schema.yml/unique_bronze__users_user_id.sql
[0m16:34:37.051409 [info ] [MainThread]: 
[0m16:34:37.051950 [info ] [MainThread]: Done. PASS=10 WARN=5 ERROR=0 SKIP=0 TOTAL=15
[0m16:34:37.053346 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 14.342255, "process_user_time": 4.280977, "process_kernel_time": 1.554136, "process_mem_max_rss": "239628", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:34:37.054165 [debug] [MainThread]: Command `dbt test` succeeded at 16:34:37.053991 after 14.34 seconds
[0m16:34:37.055073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7997d54445c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7997d48a0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7997d53bc440>]}
[0m16:34:37.055863 [debug] [MainThread]: Flushing usage events
[0m16:34:41.264648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a723fa05070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a723fa05df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a723fa05040>]}


============================== 16:34:41.271004 | 2e07011c-0f4c-45f4-8945-55888dd1d31d ==============================
[0m16:34:41.271004 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:34:41.271859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/silver path:models/gold', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:34:42.195087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e07011c-0f4c-45f4-8945-55888dd1d31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7212fcc080>]}
[0m16:34:42.274216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e07011c-0f4c-45f4-8945-55888dd1d31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a72132a2390>]}
[0m16:34:42.275471 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:34:42.386282 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:34:48.121728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:34:48.122485 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:34:48.123462 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:34:48.128506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e07011c-0f4c-45f4-8945-55888dd1d31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7213359700>]}
[0m16:34:48.167830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e07011c-0f4c-45f4-8945-55888dd1d31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a72124997f0>]}
[0m16:34:48.168639 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:34:48.169495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e07011c-0f4c-45f4-8945-55888dd1d31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a723fa086b0>]}
[0m16:34:48.183144 [info ] [MainThread]: 
[0m16:34:48.184892 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:34:48.186690 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m16:34:48.187651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:48.810156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod)
[0m16:34:48.811071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:49.290946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e07011c-0f4c-45f4-8945-55888dd1d31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a723fa07c80>]}
[0m16:34:49.292202 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:34:49.293510 [info ] [MainThread]: 
[0m16:34:49.301642 [debug] [Thread-1 (]: Began running node model.retail.silver__orders_enriched
[0m16:34:49.302746 [info ] [Thread-1 (]: 1 of 2 START sql view model retail_prod.silver__orders_enriched ................ [RUN]
[0m16:34:49.303784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.silver__orders_enriched)
[0m16:34:49.304599 [debug] [Thread-1 (]: Began compiling node model.retail.silver__orders_enriched
[0m16:34:49.310545 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.silver__orders_enriched"
[0m16:34:49.339467 [debug] [Thread-1 (]: Timing info for model.retail.silver__orders_enriched (compile): 16:34:49.305165 => 16:34:49.338904
[0m16:34:49.340441 [debug] [Thread-1 (]: Began executing node model.retail.silver__orders_enriched
[0m16:34:49.365396 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.silver__orders_enriched"
[0m16:34:49.391814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:49.429302 [debug] [Thread-1 (]: On model.retail.silver__orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.silver__orders_enriched"} */


  create or replace view `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
  OPTIONS()
  as with orders as (
  select *
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
),
users as (
  select *
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
),
joined as (
  select
    o.order_id,
    o.user_id,
    o.order_created_at,
    o.order_created_at_parse_failed,
    date(o.order_created_at) as order_date,
    o.total_amount,
    o.payment_method,
    o.order_status,
    o.branch,
    u.full_name,
    u.email,
    u.phone,
    u.city as user_city,
    u.created_at as user_created_at,
    u.created_at_parse_failed as user_created_at_parse_failed
  from orders o
  left join users u using (user_id)
)

select *
from joined;


[0m16:34:50.050893 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:e1824501-3b24-46be-b244-dd8a19066709&page=queryresults
[0m16:34:50.403375 [debug] [Thread-1 (]: Timing info for model.retail.silver__orders_enriched (execute): 16:34:49.341114 => 16:34:50.403189
[0m16:34:50.404581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e07011c-0f4c-45f4-8945-55888dd1d31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a72129752e0>]}
[0m16:34:50.405496 [info ] [Thread-1 (]: 1 of 2 OK created sql view model retail_prod.silver__orders_enriched ........... [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m16:34:50.406452 [debug] [Thread-1 (]: Finished running node model.retail.silver__orders_enriched
[0m16:34:50.408154 [debug] [Thread-3 (]: Began running node model.retail.gold__daily_branch_metrics
[0m16:34:50.409467 [info ] [Thread-3 (]: 2 of 2 START sql table model retail_prod.gold__daily_branch_metrics ............ [RUN]
[0m16:34:50.410895 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.retail.gold__daily_branch_metrics'
[0m16:34:50.411868 [debug] [Thread-3 (]: Began compiling node model.retail.gold__daily_branch_metrics
[0m16:34:50.414924 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail.gold__daily_branch_metrics"
[0m16:34:50.441543 [debug] [Thread-3 (]: Timing info for model.retail.gold__daily_branch_metrics (compile): 16:34:50.412605 => 16:34:50.441076
[0m16:34:50.442452 [debug] [Thread-3 (]: Began executing node model.retail.gold__daily_branch_metrics
[0m16:34:50.464079 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail.gold__daily_branch_metrics"
[0m16:34:50.492679 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:34:50.532977 [debug] [Thread-3 (]: On model.retail.gold__daily_branch_metrics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.gold__daily_branch_metrics"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`gold__daily_branch_metrics`
      
    
    

    OPTIONS()
    as (
      with fact_orders as (
  select *
  from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
  where order_created_at is not null
),
aggregated as (
  select
    order_date,
    branch,
    count(distinct order_id) as orders_count,
    count(distinct user_id) as customers_count,
    sum(case when order_status = 'completed' then total_amount else 0 end) as completed_revenue,
    sum(case when order_status != 'completed' then total_amount else 0 end) as non_completed_revenue,
    sum(total_amount) as gross_revenue
  from fact_orders
  group by order_date, branch
)

select *
from aggregated
    );
  
[0m16:34:51.563600 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:4bae18f1-bd60-467b-9e89-fa751b2d4e7a&page=queryresults
[0m16:34:53.827540 [debug] [Thread-3 (]: Timing info for model.retail.gold__daily_branch_metrics (execute): 16:34:50.442998 => 16:34:53.827349
[0m16:34:53.829174 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e07011c-0f4c-45f4-8945-55888dd1d31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7219c00260>]}
[0m16:34:53.830711 [info ] [Thread-3 (]: 2 of 2 OK created sql table model retail_prod.gold__daily_branch_metrics ....... [[32mCREATE TABLE (3.7k rows, 360.2 KiB processed)[0m in 3.42s]
[0m16:34:53.832172 [debug] [Thread-3 (]: Finished running node model.retail.gold__daily_branch_metrics
[0m16:34:53.836167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:53.837557 [debug] [MainThread]: Connection 'model.retail.silver__orders_enriched' was properly closed.
[0m16:34:53.838402 [debug] [MainThread]: Connection 'model.retail.gold__daily_branch_metrics' was properly closed.
[0m16:34:53.839398 [info ] [MainThread]: 
[0m16:34:53.840443 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.65 seconds (5.65s).
[0m16:34:53.841984 [debug] [MainThread]: Command end result
[0m16:34:53.888952 [info ] [MainThread]: 
[0m16:34:53.890449 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:34:53.891554 [info ] [MainThread]: 
[0m16:34:53.892994 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:34:53.894543 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.701527, "process_user_time": 3.586279, "process_kernel_time": 1.319137, "process_mem_max_rss": "236156", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:34:53.895592 [debug] [MainThread]: Command `dbt run` succeeded at 16:34:53.895405 after 12.70 seconds
[0m16:34:53.896560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a723ffe1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7212aacb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7212aaf860>]}
[0m16:34:53.897663 [debug] [MainThread]: Flushing usage events
[0m16:34:58.558408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1ebb4d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1ebb4e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1ebb4d1c0>]}


============================== 16:34:58.564473 | 046f53eb-8eca-42de-a0e7-7e0df25fbb33 ==============================
[0m16:34:58.564473 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:34:58.565826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/silver path:models/gold', 'send_anonymous_usage_stats': 'True'}
[0m16:34:59.447140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '046f53eb-8eca-42de-a0e7-7e0df25fbb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1c5fee210>]}
[0m16:34:59.537109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '046f53eb-8eca-42de-a0e7-7e0df25fbb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1c4674110>]}
[0m16:34:59.538850 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:34:59.678772 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:35:06.688396 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:35:06.689120 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:35:06.690109 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:35:06.695243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '046f53eb-8eca-42de-a0e7-7e0df25fbb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1beb2a480>]}
[0m16:35:06.737675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '046f53eb-8eca-42de-a0e7-7e0df25fbb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1be5f1850>]}
[0m16:35:06.738859 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:35:06.739682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '046f53eb-8eca-42de-a0e7-7e0df25fbb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1bed2baa0>]}
[0m16:35:06.760289 [info ] [MainThread]: 
[0m16:35:06.761882 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:35:06.765057 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev_retail_prod'
[0m16:35:06.766004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:07.299374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '046f53eb-8eca-42de-a0e7-7e0df25fbb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1be5f15b0>]}
[0m16:35:07.300571 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:35:07.301259 [info ] [MainThread]: 
[0m16:35:07.309410 [debug] [Thread-1 (]: Began running node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m16:35:07.309928 [debug] [Thread-2 (]: Began running node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m16:35:07.310339 [debug] [Thread-3 (]: Began running node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m16:35:07.310785 [debug] [Thread-4 (]: Began running node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m16:35:07.311205 [info ] [Thread-1 (]: 1 of 5 START test not_null_gold__daily_branch_metrics_branch ................... [RUN]
[0m16:35:07.311986 [info ] [Thread-2 (]: 2 of 5 START test not_null_gold__daily_branch_metrics_order_date ............... [RUN]
[0m16:35:07.312727 [info ] [Thread-3 (]: 3 of 5 START test not_null_silver__orders_enriched_order_date .................. [RUN]
[0m16:35:07.313601 [info ] [Thread-4 (]: 4 of 5 START test not_null_silver__orders_enriched_order_id .................... [RUN]
[0m16:35:07.314468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761)
[0m16:35:07.315486 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948'
[0m16:35:07.316580 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.retail.not_null_silver__orders_enriched_order_date.658d753d80'
[0m16:35:07.317790 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.retail.not_null_silver__orders_enriched_order_id.782515c964'
[0m16:35:07.318561 [debug] [Thread-1 (]: Began compiling node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m16:35:07.319289 [debug] [Thread-2 (]: Began compiling node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m16:35:07.320150 [debug] [Thread-3 (]: Began compiling node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m16:35:07.320929 [debug] [Thread-4 (]: Began compiling node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m16:35:07.337682 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761"
[0m16:35:07.341404 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948"
[0m16:35:07.345492 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.not_null_silver__orders_enriched_order_date.658d753d80"
[0m16:35:07.349704 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.not_null_silver__orders_enriched_order_id.782515c964"
[0m16:35:07.368755 [debug] [Thread-3 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_date.658d753d80 (compile): 16:35:07.342468 => 16:35:07.368212
[0m16:35:07.369879 [debug] [Thread-3 (]: Began executing node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m16:35:07.376494 [debug] [Thread-2 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948 (compile): 16:35:07.338062 => 16:35:07.376122
[0m16:35:07.388289 [debug] [Thread-2 (]: Began executing node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m16:35:07.389175 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.not_null_silver__orders_enriched_order_date.658d753d80"
[0m16:35:07.390980 [debug] [Thread-1 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761 (compile): 16:35:07.321605 => 16:35:07.390701
[0m16:35:07.392056 [debug] [Thread-4 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_id.782515c964 (compile): 16:35:07.346378 => 16:35:07.391594
[0m16:35:07.395243 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948"
[0m16:35:07.396586 [debug] [Thread-1 (]: Began executing node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m16:35:07.397665 [debug] [Thread-4 (]: Began executing node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m16:35:07.401134 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761"
[0m16:35:07.404398 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.not_null_silver__orders_enriched_order_id.782515c964"
[0m16:35:07.414134 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:35:07.415615 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:35:07.419098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:07.419726 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:35:07.485106 [debug] [Thread-4 (]: On test.retail.not_null_silver__orders_enriched_order_id.782515c964: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_silver__orders_enriched_order_id.782515c964"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
where order_id is null



      
    ) dbt_internal_test
[0m16:35:07.485734 [debug] [Thread-2 (]: On test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from `retail-data-pipeline-dev`.`retail_prod`.`gold__daily_branch_metrics`
where order_date is null



      
    ) dbt_internal_test
[0m16:35:07.554672 [debug] [Thread-1 (]: On test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select branch
from `retail-data-pipeline-dev`.`retail_prod`.`gold__daily_branch_metrics`
where branch is null



      
    ) dbt_internal_test
[0m16:35:07.558078 [debug] [Thread-3 (]: On test.retail.not_null_silver__orders_enriched_order_date.658d753d80: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_silver__orders_enriched_order_date.658d753d80"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
where order_date is null



      
    ) dbt_internal_test
[0m16:35:08.250081 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:929ef82d-ad0b-4e37-b66c-bb6e35a9072c&page=queryresults
[0m16:35:08.254010 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:3fb103a8-2828-4a73-814e-fe3ad92cb000&page=queryresults
[0m16:35:08.726291 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:6bb8f9ea-c0d1-4e73-be14-195c9341a506&page=queryresults
[0m16:35:08.780337 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:655060a8-d2fb-428d-ab43-a6f831c66588&page=queryresults
[0m16:35:08.797474 [debug] [Thread-2 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948 (execute): 16:35:07.389565 => 16:35:08.797154
[0m16:35:08.798922 [info ] [Thread-2 (]: 2 of 5 PASS not_null_gold__daily_branch_metrics_order_date ..................... [[32mPASS[0m in 1.48s]
[0m16:35:08.799890 [debug] [Thread-2 (]: Finished running node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m16:35:08.800720 [debug] [Thread-2 (]: Began running node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m16:35:08.801738 [info ] [Thread-2 (]: 5 of 5 START test unique_silver__orders_enriched_order_id ...................... [RUN]
[0m16:35:08.802802 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948, now test.retail.unique_silver__orders_enriched_order_id.761e0577f3)
[0m16:35:08.803372 [debug] [Thread-2 (]: Began compiling node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m16:35:08.809192 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.unique_silver__orders_enriched_order_id.761e0577f3"
[0m16:35:08.814002 [debug] [Thread-1 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761 (execute): 16:35:07.398851 => 16:35:08.813708
[0m16:35:08.815824 [info ] [Thread-1 (]: 1 of 5 PASS not_null_gold__daily_branch_metrics_branch ......................... [[32mPASS[0m in 1.50s]
[0m16:35:08.817297 [debug] [Thread-1 (]: Finished running node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m16:35:08.829623 [debug] [Thread-2 (]: Timing info for test.retail.unique_silver__orders_enriched_order_id.761e0577f3 (compile): 16:35:08.803872 => 16:35:08.829140
[0m16:35:08.830538 [debug] [Thread-2 (]: Began executing node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m16:35:08.833408 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.unique_silver__orders_enriched_order_id.761e0577f3"
[0m16:35:08.854589 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:35:08.891343 [debug] [Thread-2 (]: On test.retail.unique_silver__orders_enriched_order_id.761e0577f3: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_silver__orders_enriched_order_id.761e0577f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:35:09.238636 [debug] [Thread-3 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_date.658d753d80 (execute): 16:35:07.370537 => 16:35:09.238354
[0m16:35:09.239973 [error] [Thread-3 (]: 3 of 5 FAIL 993 not_null_silver__orders_enriched_order_date .................... [[31mFAIL 993[0m in 1.92s]
[0m16:35:09.241087 [debug] [Thread-3 (]: Finished running node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m16:35:09.322104 [debug] [Thread-4 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_id.782515c964 (execute): 16:35:07.402053 => 16:35:09.321757
[0m16:35:09.323842 [info ] [Thread-4 (]: 4 of 5 PASS not_null_silver__orders_enriched_order_id .......................... [[32mPASS[0m in 2.01s]
[0m16:35:09.325243 [debug] [Thread-4 (]: Finished running node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m16:35:10.006899 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:e42053ed-f0ab-4f67-bd1e-0349369474aa&page=queryresults
[0m16:35:10.526784 [debug] [Thread-2 (]: Timing info for test.retail.unique_silver__orders_enriched_order_id.761e0577f3 (execute): 16:35:08.831182 => 16:35:10.526503
[0m16:35:10.528166 [error] [Thread-2 (]: 5 of 5 FAIL 50 unique_silver__orders_enriched_order_id ......................... [[31mFAIL 50[0m in 1.73s]
[0m16:35:10.529163 [debug] [Thread-2 (]: Finished running node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m16:35:10.532294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:10.533060 [debug] [MainThread]: Connection 'test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761' was properly closed.
[0m16:35:10.533823 [debug] [MainThread]: Connection 'test.retail.unique_silver__orders_enriched_order_id.761e0577f3' was properly closed.
[0m16:35:10.534544 [debug] [MainThread]: Connection 'test.retail.not_null_silver__orders_enriched_order_date.658d753d80' was properly closed.
[0m16:35:10.535038 [debug] [MainThread]: Connection 'test.retail.not_null_silver__orders_enriched_order_id.782515c964' was properly closed.
[0m16:35:10.535586 [info ] [MainThread]: 
[0m16:35:10.536224 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 3.77 seconds (3.77s).
[0m16:35:10.537442 [debug] [MainThread]: Command end result
[0m16:35:10.581378 [info ] [MainThread]: 
[0m16:35:10.582543 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:35:10.583313 [info ] [MainThread]: 
[0m16:35:10.584069 [error] [MainThread]: [31mFailure in test not_null_silver__orders_enriched_order_date (models/silver/schema.yml)[0m
[0m16:35:10.584824 [error] [MainThread]:   Got 993 results, configured to fail if != 0
[0m16:35:10.585735 [info ] [MainThread]: 
[0m16:35:10.586459 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/silver/schema.yml/not_null_silver__orders_enriched_order_date.sql
[0m16:35:10.587095 [info ] [MainThread]: 
[0m16:35:10.587597 [error] [MainThread]: [31mFailure in test unique_silver__orders_enriched_order_id (models/silver/schema.yml)[0m
[0m16:35:10.588050 [error] [MainThread]:   Got 50 results, configured to fail if != 0
[0m16:35:10.588731 [info ] [MainThread]: 
[0m16:35:10.589290 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/silver/schema.yml/unique_silver__orders_enriched_order_id.sql
[0m16:35:10.590002 [info ] [MainThread]: 
[0m16:35:10.590570 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m16:35:10.591676 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 12.1028, "process_user_time": 3.659011, "process_kernel_time": 1.337572, "process_mem_max_rss": "236692", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:35:10.592311 [debug] [MainThread]: Command `dbt test` failed at 16:35:10.592183 after 12.10 seconds
[0m16:35:10.592966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1ebaffd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1bede5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1ec22b4a0>]}
[0m16:35:10.593646 [debug] [MainThread]: Flushing usage events
[0m16:37:42.918133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dfba65340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dfbc606e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dfbd55ee0>]}


============================== 16:37:42.924513 | f66ea9a1-3ce3-4989-ab39-4e117f23f5ab ==============================
[0m16:37:42.924513 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:37:42.925763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:37:43.057051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f66ea9a1-3ce3-4989-ab39-4e117f23f5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dfba6b590>]}
[0m16:37:44.736176 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-nlwl13zf'
[0m16:37:44.737426 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:37:45.020732 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:37:45.021830 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:37:45.108774 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:37:45.112253 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m16:37:45.250927 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m16:37:45.255283 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m16:37:45.390366 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m16:37:45.393310 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:37:52.683644 [info ] [MainThread]: Installed from version 1.3.1
[0m16:37:52.684392 [info ] [MainThread]: Up to date!
[0m16:37:52.685273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f66ea9a1-3ce3-4989-ab39-4e117f23f5ab', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dfba4d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dfba4d760>]}
[0m16:37:52.685892 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m16:37:58.136868 [info ] [MainThread]: Installed from version 0.10.9
[0m16:37:58.137800 [info ] [MainThread]: Up to date!
[0m16:37:58.138553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f66ea9a1-3ce3-4989-ab39-4e117f23f5ab', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dfb990590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5e0030b1a0>]}
[0m16:37:58.139286 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m16:38:00.789752 [info ] [MainThread]: Installed from version 0.15.0
[0m16:38:00.791097 [info ] [MainThread]: Up to date!
[0m16:38:00.792404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f66ea9a1-3ce3-4989-ab39-4e117f23f5ab', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5e0030b200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dfb81d940>]}
[0m16:38:00.797001 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 17.965967, "process_user_time": 2.746597, "process_kernel_time": 0.619934, "process_mem_max_rss": "197924", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m16:38:00.798438 [debug] [MainThread]: Command `dbt deps` succeeded at 16:38:00.797966 after 17.97 seconds
[0m16:38:00.799790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dfc72c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5e00287950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5e0048b3e0>]}
[0m16:38:00.800950 [debug] [MainThread]: Flushing usage events
[0m16:38:04.975502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e930b1adc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e930faa54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e930b4e8800>]}


============================== 16:38:04.988516 | f64b2d8e-1a49-4cc5-9f4b-a0161c2d45bf ==============================
[0m16:38:04.988516 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:38:04.989962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:38:05.964356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f64b2d8e-1a49-4cc5-9f4b-a0161c2d45bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e92de7a8920>]}
[0m16:38:06.042676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f64b2d8e-1a49-4cc5-9f4b-a0161c2d45bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e92deaf93a0>]}
[0m16:38:06.044479 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:38:06.161182 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:38:12.801022 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:38:12.802471 [debug] [MainThread]: Partial parsing: updated file: retail://models/silver/schema.yml
[0m16:38:13.079402 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:38:13.084833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f64b2d8e-1a49-4cc5-9f4b-a0161c2d45bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e92ddcf0500>]}
[0m16:38:13.141466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f64b2d8e-1a49-4cc5-9f4b-a0161c2d45bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e92dde2e090>]}
[0m16:38:13.142507 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:38:13.143403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f64b2d8e-1a49-4cc5-9f4b-a0161c2d45bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e930b1b38c0>]}
[0m16:38:13.154739 [info ] [MainThread]: 
[0m16:38:13.156138 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:38:13.158291 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m16:38:13.159116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:13.829289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod)
[0m16:38:13.830247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:14.353787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f64b2d8e-1a49-4cc5-9f4b-a0161c2d45bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e92ddcb4e00>]}
[0m16:38:14.355095 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:38:14.356157 [info ] [MainThread]: 
[0m16:38:14.368570 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m16:38:14.369609 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m16:38:14.370407 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod.bronze__orders ........................ [RUN]
[0m16:38:14.371505 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod.bronze__users ......................... [RUN]
[0m16:38:14.372884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.bronze__orders)
[0m16:38:14.374493 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m16:38:14.375488 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m16:38:14.376265 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m16:38:14.383721 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m16:38:14.386954 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m16:38:14.399275 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 16:38:14.376860 => 16:38:14.398928
[0m16:38:14.400061 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 16:38:14.384516 => 16:38:14.399786
[0m16:38:14.400528 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m16:38:14.401219 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m16:38:14.414694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:14.417367 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:38:14.968195 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m16:38:14.969028 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m16:38:14.982682 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe.parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m16:38:14.985976 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe.parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m16:38:15.396975 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:c1812836-53d0-41ea-8d90-9dac8076546e&page=queryresults
[0m16:38:15.407039 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:3b010a8f-f9af-452a-bc85-6a9aa43bd93f&page=queryresults
[0m16:38:17.167230 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 16:38:14.401723 => 16:38:17.167036
[0m16:38:17.169460 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 16:38:14.412986 => 16:38:17.169266
[0m16:38:17.170565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f64b2d8e-1a49-4cc5-9f4b-a0161c2d45bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e92de1a3770>]}
[0m16:38:17.171671 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f64b2d8e-1a49-4cc5-9f4b-a0161c2d45bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e92dde5f860>]}
[0m16:38:17.172935 [info ] [Thread-1 (]: 1 of 2 OK created sql table model retail_prod.bronze__orders ................... [[32mCREATE TABLE (5.0k rows, 414.1 KiB processed)[0m in 2.80s]
[0m16:38:17.174200 [info ] [Thread-2 (]: 2 of 2 OK created sql table model retail_prod.bronze__users .................... [[32mCREATE TABLE (1.0k rows, 107.1 KiB processed)[0m in 2.80s]
[0m16:38:17.175869 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m16:38:17.177199 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m16:38:17.181229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:17.182310 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m16:38:17.183023 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m16:38:17.184062 [info ] [MainThread]: 
[0m16:38:17.184810 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m16:38:17.186212 [debug] [MainThread]: Command end result
[0m16:38:17.229244 [info ] [MainThread]: 
[0m16:38:17.230592 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:38:17.231819 [info ] [MainThread]: 
[0m16:38:17.233131 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:38:17.235343 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.341604, "process_user_time": 3.983752, "process_kernel_time": 1.426833, "process_mem_max_rss": "242408", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:38:17.236871 [debug] [MainThread]: Command `dbt run` succeeded at 16:38:17.236515 after 12.34 seconds
[0m16:38:17.238170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e930b40d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e92dc3ce840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e92e4fc8080>]}
[0m16:38:17.239641 [debug] [MainThread]: Flushing usage events
[0m16:38:22.169329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e259347bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e25dc1b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e259345490>]}


============================== 16:38:22.175275 | afbe442c-e53f-4d6c-ba8a-3cd9e44e7cce ==============================
[0m16:38:22.175275 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:38:22.176167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:38:23.131911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afbe442c-e53f-4d6c-ba8a-3cd9e44e7cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e23092d5b0>]}
[0m16:38:23.210671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afbe442c-e53f-4d6c-ba8a-3cd9e44e7cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e23048b9e0>]}
[0m16:38:23.212122 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:38:23.324411 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:38:30.154326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:38:30.155249 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:38:30.156462 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:38:30.161716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afbe442c-e53f-4d6c-ba8a-3cd9e44e7cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e230357a40>]}
[0m16:38:30.213699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afbe442c-e53f-4d6c-ba8a-3cd9e44e7cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e22bd65e50>]}
[0m16:38:30.214944 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:38:30.216100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afbe442c-e53f-4d6c-ba8a-3cd9e44e7cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e259344ad0>]}
[0m16:38:30.227752 [info ] [MainThread]: 
[0m16:38:30.229010 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:38:30.231197 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev_retail_prod'
[0m16:38:30.232053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:30.734540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afbe442c-e53f-4d6c-ba8a-3cd9e44e7cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2303f1910>]}
[0m16:38:30.735781 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:38:30.736625 [info ] [MainThread]: 
[0m16:38:30.744777 [debug] [Thread-1 (]: Began running node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m16:38:30.745282 [debug] [Thread-2 (]: Began running node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m16:38:30.745782 [debug] [Thread-3 (]: Began running node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:38:30.746435 [info ] [Thread-1 (]: 1 of 15 START test not_null_bronze__orders_order_created_at .................... [RUN]
[0m16:38:30.747006 [debug] [Thread-4 (]: Began running node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:38:30.747642 [info ] [Thread-2 (]: 2 of 15 START test not_null_bronze__orders_order_id ............................ [RUN]
[0m16:38:30.748435 [info ] [Thread-3 (]: 3 of 15 START test not_null_bronze__users_email ................................ [RUN]
[0m16:38:30.749476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now test.retail.not_null_bronze__orders_order_created_at.05e711bf75)
[0m16:38:30.750108 [info ] [Thread-4 (]: 4 of 15 START test not_null_bronze__users_user_id .............................. [RUN]
[0m16:38:30.751066 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__orders_order_id.4b38fb230a'
[0m16:38:30.752097 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__users_email.2bec59e73f'
[0m16:38:30.752682 [debug] [Thread-1 (]: Began compiling node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m16:38:30.753751 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__users_user_id.cb91e05164'
[0m16:38:30.754453 [debug] [Thread-2 (]: Began compiling node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m16:38:30.755004 [debug] [Thread-3 (]: Began compiling node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:38:30.766643 [debug] [Thread-4 (]: Began compiling node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:38:30.768523 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"
[0m16:38:30.772743 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.not_null_bronze__orders_order_id.4b38fb230a"
[0m16:38:30.776875 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.not_null_bronze__users_email.2bec59e73f"
[0m16:38:30.781330 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.not_null_bronze__users_user_id.cb91e05164"
[0m16:38:30.791934 [debug] [Thread-3 (]: Timing info for test.retail.not_null_bronze__users_email.2bec59e73f (compile): 16:38:30.773788 => 16:38:30.791419
[0m16:38:30.793076 [debug] [Thread-3 (]: Began executing node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:38:30.794201 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__users_user_id.cb91e05164 (compile): 16:38:30.777747 => 16:38:30.793650
[0m16:38:30.808386 [debug] [Thread-4 (]: Began executing node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:38:30.816276 [debug] [Thread-2 (]: Timing info for test.retail.not_null_bronze__orders_order_id.4b38fb230a (compile): 16:38:30.769662 => 16:38:30.815848
[0m16:38:30.817169 [debug] [Thread-1 (]: Timing info for test.retail.not_null_bronze__orders_order_created_at.05e711bf75 (compile): 16:38:30.755369 => 16:38:30.816701
[0m16:38:30.826585 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.not_null_bronze__users_user_id.cb91e05164"
[0m16:38:30.827261 [debug] [Thread-2 (]: Began executing node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m16:38:30.823049 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.not_null_bronze__users_email.2bec59e73f"
[0m16:38:30.828997 [debug] [Thread-1 (]: Began executing node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m16:38:30.833211 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.not_null_bronze__orders_order_id.4b38fb230a"
[0m16:38:30.837889 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"
[0m16:38:30.850052 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:38:30.852622 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:38:30.853776 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:38:30.856781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:30.942805 [debug] [Thread-3 (]: On test.retail.not_null_bronze__users_email.2bec59e73f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__users_email.2bec59e73f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
where email is null



      
    ) dbt_internal_test
[0m16:38:30.943953 [debug] [Thread-4 (]: On test.retail.not_null_bronze__users_user_id.cb91e05164: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__users_user_id.cb91e05164"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
where user_id is null



      
    ) dbt_internal_test
[0m16:38:31.000860 [debug] [Thread-2 (]: On test.retail.not_null_bronze__orders_order_id.4b38fb230a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__orders_order_id.4b38fb230a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
where order_id is null



      
    ) dbt_internal_test
[0m16:38:31.038483 [debug] [Thread-1 (]: On test.retail.not_null_bronze__orders_order_created_at.05e711bf75: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_created_at
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
where order_created_at is null



      
    ) dbt_internal_test
[0m16:38:31.704610 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:9f09e903-6d91-4455-9335-2ab06306f5b0&page=queryresults
[0m16:38:31.738011 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:e98fee7d-c57e-4727-841d-b85489399718&page=queryresults
[0m16:38:31.753868 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:8da7e4de-b4d9-4f5b-a33a-487cc246e345&page=queryresults
[0m16:38:31.757536 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:4a7914c3-5b99-4772-b06c-d41c32db1da7&page=queryresults
[0m16:38:32.266351 [debug] [Thread-3 (]: Timing info for test.retail.not_null_bronze__users_email.2bec59e73f (execute): 16:38:30.794822 => 16:38:32.265869
[0m16:38:32.267781 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__users_user_id.cb91e05164 (execute): 16:38:30.814666 => 16:38:32.267424
[0m16:38:32.268989 [info ] [Thread-3 (]: 3 of 15 PASS not_null_bronze__users_email ...................................... [[32mPASS[0m in 1.52s]
[0m16:38:32.270644 [info ] [Thread-4 (]: 4 of 15 PASS not_null_bronze__users_user_id .................................... [[32mPASS[0m in 1.52s]
[0m16:38:32.271956 [debug] [Thread-3 (]: Finished running node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:38:32.273261 [debug] [Thread-4 (]: Finished running node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:38:32.274828 [debug] [Thread-3 (]: Began running node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m16:38:32.276348 [debug] [Thread-2 (]: Timing info for test.retail.not_null_bronze__orders_order_id.4b38fb230a (execute): 16:38:30.830314 => 16:38:32.276049
[0m16:38:32.277152 [debug] [Thread-4 (]: Began running node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m16:38:32.278422 [info ] [Thread-3 (]: 5 of 15 START test source_not_null_raw_csv_order_items_order_id ................ [RUN]
[0m16:38:32.280172 [info ] [Thread-2 (]: 2 of 15 PASS not_null_bronze__orders_order_id .................................. [[32mPASS[0m in 1.53s]
[0m16:38:32.281373 [info ] [Thread-4 (]: 6 of 15 START test source_not_null_raw_csv_orders_order_id ..................... [RUN]
[0m16:38:32.282834 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__users_email.2bec59e73f, now test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2)
[0m16:38:32.284511 [debug] [Thread-2 (]: Finished running node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m16:38:32.285747 [debug] [Thread-1 (]: Timing info for test.retail.not_null_bronze__orders_order_created_at.05e711bf75 (execute): 16:38:30.834611 => 16:38:32.285408
[0m16:38:32.287195 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__users_user_id.cb91e05164, now test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336)
[0m16:38:32.288337 [debug] [Thread-3 (]: Began compiling node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m16:38:32.289618 [debug] [Thread-2 (]: Began running node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m16:38:32.290906 [warn ] [Thread-1 (]: 1 of 15 WARN 987 not_null_bronze__orders_order_created_at ...................... [[33mWARN 987[0m in 1.54s]
[0m16:38:32.291959 [debug] [Thread-4 (]: Began compiling node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m16:38:32.297557 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"
[0m16:38:32.298567 [info ] [Thread-2 (]: 7 of 15 START test source_not_null_raw_csv_products_product_id ................. [RUN]
[0m16:38:32.299940 [debug] [Thread-1 (]: Finished running node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m16:38:32.306575 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"
[0m16:38:32.308244 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__orders_order_id.4b38fb230a, now test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6)
[0m16:38:32.309519 [debug] [Thread-1 (]: Began running node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m16:38:32.311490 [debug] [Thread-2 (]: Began compiling node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m16:38:32.312626 [info ] [Thread-1 (]: 8 of 15 START test source_not_null_raw_csv_sessions_session_id ................. [RUN]
[0m16:38:32.317384 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"
[0m16:38:32.318640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__orders_order_created_at.05e711bf75, now test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194)
[0m16:38:32.320534 [debug] [Thread-1 (]: Began compiling node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m16:38:32.323059 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336 (compile): 16:38:32.300746 => 16:38:32.322477
[0m16:38:32.324214 [debug] [Thread-3 (]: Timing info for test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2 (compile): 16:38:32.292836 => 16:38:32.323807
[0m16:38:32.324908 [debug] [Thread-4 (]: Began executing node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m16:38:32.330252 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"
[0m16:38:32.330934 [debug] [Thread-3 (]: Began executing node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m16:38:32.335010 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"
[0m16:38:32.335962 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6 (compile): 16:38:32.313403 => 16:38:32.335606
[0m16:38:32.339779 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"
[0m16:38:32.341539 [debug] [Thread-2 (]: Began executing node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m16:38:32.346295 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"
[0m16:38:32.358124 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:38:32.359221 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194 (compile): 16:38:32.321284 => 16:38:32.358806
[0m16:38:32.360759 [debug] [Thread-1 (]: Began executing node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m16:38:32.361568 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:38:32.365130 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"
[0m16:38:32.365985 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:32.400857 [debug] [Thread-3 (]: On test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_raw`.`order_items`
where order_id is null



      
    ) dbt_internal_test
[0m16:38:32.447964 [debug] [Thread-4 (]: On test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_raw`.`orders`
where order_id is null



      
    ) dbt_internal_test
[0m16:38:32.484328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:32.486237 [debug] [Thread-2 (]: On test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `retail-data-pipeline-dev`.`retail_raw`.`products`
where product_id is null



      
    ) dbt_internal_test
[0m16:38:32.526951 [debug] [Thread-1 (]: On test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from `retail-data-pipeline-dev`.`retail_raw`.`sessions`
where session_id is null



      
    ) dbt_internal_test
[0m16:38:33.137328 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:c7097d93-9870-42ec-9b60-e503fd59f3e0&page=queryresults
[0m16:38:33.146630 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:069cd168-01d1-4881-b325-296133385cf0&page=queryresults
[0m16:38:33.153997 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:62fd1af1-aacf-48e7-bbd2-14bb092c6e37&page=queryresults
[0m16:38:33.169220 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:71eafa69-15e6-4594-9759-dd5e29a26cec&page=queryresults
[0m16:38:33.657904 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194 (execute): 16:38:32.362084 => 16:38:33.657598
[0m16:38:33.659516 [info ] [Thread-1 (]: 8 of 15 PASS source_not_null_raw_csv_sessions_session_id ....................... [[32mPASS[0m in 1.34s]
[0m16:38:33.660632 [debug] [Thread-1 (]: Finished running node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m16:38:33.661656 [debug] [Thread-1 (]: Began running node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m16:38:33.662775 [info ] [Thread-1 (]: 9 of 15 START test source_not_null_raw_csv_users_user_id ....................... [RUN]
[0m16:38:33.664300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194, now test.retail.source_not_null_raw_csv_users_user_id.3380c1257d)
[0m16:38:33.665209 [debug] [Thread-1 (]: Began compiling node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m16:38:33.670130 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"
[0m16:38:33.691804 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_users_user_id.3380c1257d (compile): 16:38:33.665867 => 16:38:33.691464
[0m16:38:33.692843 [debug] [Thread-1 (]: Began executing node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m16:38:33.696883 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"
[0m16:38:33.711448 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336 (execute): 16:38:32.331961 => 16:38:33.711151
[0m16:38:33.712642 [info ] [Thread-4 (]: 6 of 15 PASS source_not_null_raw_csv_orders_order_id ........................... [[32mPASS[0m in 1.43s]
[0m16:38:33.714551 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6 (execute): 16:38:32.343018 => 16:38:33.714273
[0m16:38:33.715148 [debug] [Thread-4 (]: Finished running node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m16:38:33.717313 [info ] [Thread-2 (]: 7 of 15 PASS source_not_null_raw_csv_products_product_id ....................... [[32mPASS[0m in 1.41s]
[0m16:38:33.718638 [debug] [Thread-3 (]: Timing info for test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2 (execute): 16:38:32.336883 => 16:38:33.718360
[0m16:38:33.719299 [debug] [Thread-4 (]: Began running node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m16:38:33.719853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:33.721120 [debug] [Thread-2 (]: Finished running node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m16:38:33.722597 [info ] [Thread-3 (]: 5 of 15 PASS source_not_null_raw_csv_order_items_order_id ...................... [[32mPASS[0m in 1.44s]
[0m16:38:33.724082 [info ] [Thread-4 (]: 10 of 15 START test source_unique_raw_csv_orders_order_id ...................... [RUN]
[0m16:38:33.726012 [debug] [Thread-2 (]: Began running node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m16:38:33.727133 [debug] [Thread-3 (]: Finished running node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m16:38:33.728253 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336, now test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53)
[0m16:38:33.729185 [info ] [Thread-2 (]: 11 of 15 START test source_unique_raw_csv_products_product_id .................. [RUN]
[0m16:38:33.730258 [debug] [Thread-3 (]: Began running node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m16:38:33.731328 [debug] [Thread-4 (]: Began compiling node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m16:38:33.763869 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6, now test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1)
[0m16:38:33.765441 [info ] [Thread-3 (]: 12 of 15 START test source_unique_raw_csv_sessions_session_id .................. [RUN]
[0m16:38:33.766305 [debug] [Thread-1 (]: On test.retail.source_not_null_raw_csv_users_user_id.3380c1257d: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `retail-data-pipeline-dev`.`retail_raw`.`users`
where user_id is null



      
    ) dbt_internal_test
[0m16:38:33.773902 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"
[0m16:38:33.774424 [debug] [Thread-2 (]: Began compiling node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m16:38:33.775744 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2, now test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8)
[0m16:38:33.783682 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"
[0m16:38:33.784714 [debug] [Thread-3 (]: Began compiling node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m16:38:33.790081 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"
[0m16:38:33.802061 [debug] [Thread-4 (]: Timing info for test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53 (compile): 16:38:33.766629 => 16:38:33.801725
[0m16:38:33.803106 [debug] [Thread-4 (]: Began executing node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m16:38:33.806338 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"
[0m16:38:33.807153 [debug] [Thread-2 (]: Timing info for test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1 (compile): 16:38:33.779843 => 16:38:33.806731
[0m16:38:33.807813 [debug] [Thread-3 (]: Timing info for test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8 (compile): 16:38:33.786022 => 16:38:33.807622
[0m16:38:33.808772 [debug] [Thread-2 (]: Began executing node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m16:38:33.809683 [debug] [Thread-3 (]: Began executing node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m16:38:33.812474 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"
[0m16:38:33.815672 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"
[0m16:38:33.827842 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:38:33.830441 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:38:33.832054 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:33.905515 [debug] [Thread-4 (]: On test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:38:33.941375 [debug] [Thread-3 (]: On test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select session_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`sessions`
  where session_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:38:33.945142 [debug] [Thread-2 (]: On test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:38:34.522756 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:1242d514-cc70-45a9-ae2a-6e95b1d7705f&page=queryresults
[0m16:38:34.529893 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:4ae48660-9edd-4814-a861-fcd90f7af217&page=queryresults
[0m16:38:34.551092 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:87afeffa-4f93-41ba-b009-fee46174216f&page=queryresults
[0m16:38:34.563429 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:f210ba0d-ade7-4d0e-a42b-f29b67782efa&page=queryresults
[0m16:38:35.057852 [debug] [Thread-4 (]: Timing info for test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53 (execute): 16:38:33.803991 => 16:38:35.057457
[0m16:38:35.060038 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_users_user_id.3380c1257d (execute): 16:38:33.693424 => 16:38:35.059805
[0m16:38:35.059236 [warn ] [Thread-4 (]: 10 of 15 WARN 25 source_unique_raw_csv_orders_order_id ......................... [[33mWARN 25[0m in 1.33s]
[0m16:38:35.061114 [info ] [Thread-1 (]: 9 of 15 PASS source_not_null_raw_csv_users_user_id ............................. [[32mPASS[0m in 1.40s]
[0m16:38:35.062027 [debug] [Thread-4 (]: Finished running node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m16:38:35.062746 [debug] [Thread-1 (]: Finished running node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m16:38:35.063313 [debug] [Thread-4 (]: Began running node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m16:38:35.063882 [debug] [Thread-1 (]: Began running node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m16:38:35.064714 [info ] [Thread-4 (]: 13 of 15 START test source_unique_raw_csv_users_user_id ........................ [RUN]
[0m16:38:35.065613 [info ] [Thread-1 (]: 14 of 15 START test unique_bronze__orders_order_id ............................. [RUN]
[0m16:38:35.066875 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53, now test.retail.source_unique_raw_csv_users_user_id.d8f871acc9)
[0m16:38:35.067858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_users_user_id.3380c1257d, now test.retail.unique_bronze__orders_order_id.cd2f27ce5f)
[0m16:38:35.068525 [debug] [Thread-4 (]: Began compiling node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m16:38:35.069074 [debug] [Thread-1 (]: Began compiling node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m16:38:35.073106 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"
[0m16:38:35.077224 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"
[0m16:38:35.078056 [debug] [Thread-3 (]: Timing info for test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8 (execute): 16:38:33.813186 => 16:38:35.077830
[0m16:38:35.080406 [info ] [Thread-3 (]: 12 of 15 PASS source_unique_raw_csv_sessions_session_id ........................ [[32mPASS[0m in 1.30s]
[0m16:38:35.081232 [debug] [Thread-3 (]: Finished running node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m16:38:35.082117 [debug] [Thread-3 (]: Began running node test.retail.unique_bronze__users_user_id.129342c645
[0m16:38:35.082894 [info ] [Thread-3 (]: 15 of 15 START test unique_bronze__users_user_id ............................... [RUN]
[0m16:38:35.083849 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8, now test.retail.unique_bronze__users_user_id.129342c645)
[0m16:38:35.084510 [debug] [Thread-3 (]: Began compiling node test.retail.unique_bronze__users_user_id.129342c645
[0m16:38:35.088597 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.unique_bronze__users_user_id.129342c645"
[0m16:38:35.098778 [debug] [Thread-1 (]: Timing info for test.retail.unique_bronze__orders_order_id.cd2f27ce5f (compile): 16:38:35.073842 => 16:38:35.098402
[0m16:38:35.099535 [debug] [Thread-4 (]: Timing info for test.retail.source_unique_raw_csv_users_user_id.d8f871acc9 (compile): 16:38:35.069469 => 16:38:35.099111
[0m16:38:35.100143 [debug] [Thread-1 (]: Began executing node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m16:38:35.100902 [debug] [Thread-4 (]: Began executing node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m16:38:35.103542 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"
[0m16:38:35.104111 [debug] [Thread-3 (]: Timing info for test.retail.unique_bronze__users_user_id.129342c645 (compile): 16:38:35.085074 => 16:38:35.103903
[0m16:38:35.106082 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"
[0m16:38:35.107144 [debug] [Thread-3 (]: Began executing node test.retail.unique_bronze__users_user_id.129342c645
[0m16:38:35.109634 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.unique_bronze__users_user_id.129342c645"
[0m16:38:35.117246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:35.118710 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:38:35.119576 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:38:35.154077 [debug] [Thread-2 (]: Timing info for test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1 (execute): 16:38:33.810360 => 16:38:35.153783
[0m16:38:35.213457 [debug] [Thread-1 (]: On test.retail.unique_bronze__orders_order_id.cd2f27ce5f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:38:35.215009 [debug] [Thread-4 (]: On test.retail.source_unique_raw_csv_users_user_id.d8f871acc9: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:38:35.216295 [debug] [Thread-3 (]: On test.retail.unique_bronze__users_user_id.129342c645: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_bronze__users_user_id.129342c645"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:38:35.214535 [info ] [Thread-2 (]: 11 of 15 PASS source_unique_raw_csv_products_product_id ........................ [[32mPASS[0m in 1.45s]
[0m16:38:35.226978 [debug] [Thread-2 (]: Finished running node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m16:38:35.804449 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:d253167f-2f5d-494b-b0b9-5f11c62102fa&page=queryresults
[0m16:38:35.903325 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:c9240d1c-ef16-4714-a5a0-cdf564bd3616&page=queryresults
[0m16:38:36.044474 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:ae93fb54-beee-4897-a0bb-eadb3ffc7716&page=queryresults
[0m16:38:36.286264 [debug] [Thread-4 (]: Timing info for test.retail.source_unique_raw_csv_users_user_id.d8f871acc9 (execute): 16:38:35.104349 => 16:38:36.285960
[0m16:38:36.287747 [warn ] [Thread-4 (]: 13 of 15 WARN 5 source_unique_raw_csv_users_user_id ............................ [[33mWARN 5[0m in 1.22s]
[0m16:38:36.288948 [debug] [Thread-4 (]: Finished running node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m16:38:36.388979 [debug] [Thread-1 (]: Timing info for test.retail.unique_bronze__orders_order_id.cd2f27ce5f (execute): 16:38:35.101430 => 16:38:36.388667
[0m16:38:36.390351 [warn ] [Thread-1 (]: 14 of 15 WARN 25 unique_bronze__orders_order_id ................................ [[33mWARN 25[0m in 1.32s]
[0m16:38:36.391238 [debug] [Thread-1 (]: Finished running node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m16:38:36.565238 [debug] [Thread-3 (]: Timing info for test.retail.unique_bronze__users_user_id.129342c645 (execute): 16:38:35.107801 => 16:38:36.564949
[0m16:38:36.566614 [warn ] [Thread-3 (]: 15 of 15 WARN 5 unique_bronze__users_user_id ................................... [[33mWARN 5[0m in 1.48s]
[0m16:38:36.567741 [debug] [Thread-3 (]: Finished running node test.retail.unique_bronze__users_user_id.129342c645
[0m16:38:36.571134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:36.572072 [debug] [MainThread]: Connection 'test.retail.unique_bronze__orders_order_id.cd2f27ce5f' was properly closed.
[0m16:38:36.572784 [debug] [MainThread]: Connection 'test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1' was properly closed.
[0m16:38:36.573393 [debug] [MainThread]: Connection 'test.retail.unique_bronze__users_user_id.129342c645' was properly closed.
[0m16:38:36.573959 [debug] [MainThread]: Connection 'test.retail.source_unique_raw_csv_users_user_id.d8f871acc9' was properly closed.
[0m16:38:36.574596 [info ] [MainThread]: 
[0m16:38:36.575240 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 6.35 seconds (6.35s).
[0m16:38:36.577220 [debug] [MainThread]: Command end result
[0m16:38:36.618227 [info ] [MainThread]: 
[0m16:38:36.619669 [info ] [MainThread]: [33mCompleted with 5 warnings:[0m
[0m16:38:36.621099 [info ] [MainThread]: 
[0m16:38:36.622237 [warn ] [MainThread]: [33mWarning in test not_null_bronze__orders_order_created_at (models/bronze/schema.yml)[0m
[0m16:38:36.623340 [warn ] [MainThread]: Got 987 results, configured to warn if != 0
[0m16:38:36.624262 [info ] [MainThread]: 
[0m16:38:36.625023 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/schema.yml/not_null_bronze__orders_order_created_at.sql
[0m16:38:36.625710 [info ] [MainThread]: 
[0m16:38:36.626530 [warn ] [MainThread]: [33mWarning in test source_unique_raw_csv_orders_order_id (models/bronze/sources.yml)[0m
[0m16:38:36.627223 [warn ] [MainThread]: Got 25 results, configured to warn if != 0
[0m16:38:36.628076 [info ] [MainThread]: 
[0m16:38:36.628877 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/sources.yml/source_unique_raw_csv_orders_order_id.sql
[0m16:38:36.629749 [info ] [MainThread]: 
[0m16:38:36.630426 [warn ] [MainThread]: [33mWarning in test source_unique_raw_csv_users_user_id (models/bronze/sources.yml)[0m
[0m16:38:36.631023 [warn ] [MainThread]: Got 5 results, configured to warn if != 0
[0m16:38:36.631821 [info ] [MainThread]: 
[0m16:38:36.632592 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/sources.yml/source_unique_raw_csv_users_user_id.sql
[0m16:38:36.633753 [info ] [MainThread]: 
[0m16:38:36.634912 [warn ] [MainThread]: [33mWarning in test unique_bronze__orders_order_id (models/bronze/schema.yml)[0m
[0m16:38:36.635819 [warn ] [MainThread]: Got 25 results, configured to warn if != 0
[0m16:38:36.636642 [info ] [MainThread]: 
[0m16:38:36.637470 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/schema.yml/unique_bronze__orders_order_id.sql
[0m16:38:36.638182 [info ] [MainThread]: 
[0m16:38:36.639162 [warn ] [MainThread]: [33mWarning in test unique_bronze__users_user_id (models/bronze/schema.yml)[0m
[0m16:38:36.639870 [warn ] [MainThread]: Got 5 results, configured to warn if != 0
[0m16:38:36.640587 [info ] [MainThread]: 
[0m16:38:36.641355 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/schema.yml/unique_bronze__users_user_id.sql
[0m16:38:36.642007 [info ] [MainThread]: 
[0m16:38:36.642690 [info ] [MainThread]: Done. PASS=10 WARN=5 ERROR=0 SKIP=0 TOTAL=15
[0m16:38:36.644271 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 14.521876, "process_user_time": 4.592035, "process_kernel_time": 1.353268, "process_mem_max_rss": "239032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:38:36.645124 [debug] [MainThread]: Command `dbt test` succeeded at 16:38:36.644967 after 14.52 seconds
[0m16:38:36.645846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2306b9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e22bd97c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2302bc7d0>]}
[0m16:38:36.646486 [debug] [MainThread]: Flushing usage events
[0m16:38:40.581468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cac15770230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cac158f12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cac15770620>]}


============================== 16:38:40.587729 | 680e39c2-4149-4c2b-8aa4-1f9f512e9a5b ==============================
[0m16:38:40.587729 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:38:40.588753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/silver path:models/gold', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:38:41.480259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '680e39c2-4149-4c2b-8aa4-1f9f512e9a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cabecb202f0>]}
[0m16:38:41.551572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '680e39c2-4149-4c2b-8aa4-1f9f512e9a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cac1575cd40>]}
[0m16:38:41.552958 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:38:41.612707 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:38:47.841498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:38:47.842422 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:38:47.843675 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:38:47.848887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '680e39c2-4149-4c2b-8aa4-1f9f512e9a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cac15776150>]}
[0m16:38:47.897447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '680e39c2-4149-4c2b-8aa4-1f9f512e9a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cabec3fd880>]}
[0m16:38:47.898684 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:38:47.900187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '680e39c2-4149-4c2b-8aa4-1f9f512e9a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cabee0c3590>]}
[0m16:38:47.918394 [info ] [MainThread]: 
[0m16:38:47.919802 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:38:47.921528 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m16:38:47.922360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:48.543600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod)
[0m16:38:48.544650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:49.029456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '680e39c2-4149-4c2b-8aa4-1f9f512e9a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cabecda7e90>]}
[0m16:38:49.030680 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:38:49.031877 [info ] [MainThread]: 
[0m16:38:49.041516 [debug] [Thread-1 (]: Began running node model.retail.silver__orders_enriched
[0m16:38:49.042556 [info ] [Thread-1 (]: 1 of 2 START sql view model retail_prod.silver__orders_enriched ................ [RUN]
[0m16:38:49.043573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.silver__orders_enriched)
[0m16:38:49.044282 [debug] [Thread-1 (]: Began compiling node model.retail.silver__orders_enriched
[0m16:38:49.050398 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.silver__orders_enriched"
[0m16:38:49.065959 [debug] [Thread-1 (]: Timing info for model.retail.silver__orders_enriched (compile): 16:38:49.044799 => 16:38:49.065607
[0m16:38:49.067197 [debug] [Thread-1 (]: Began executing node model.retail.silver__orders_enriched
[0m16:38:49.092264 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.silver__orders_enriched"
[0m16:38:49.107618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:49.142534 [debug] [Thread-1 (]: On model.retail.silver__orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.silver__orders_enriched"} */


  create or replace view `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
  OPTIONS()
  as with orders as (
  select *
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
),
users as (
  select *
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
),
joined as (
  select
    o.order_id,
    o.user_id,
    o.order_created_at,
    o.order_created_at_parse_failed,
    date(o.order_created_at) as order_date,
    o.total_amount,
    o.payment_method,
    o.order_status,
    o.branch,
    u.full_name,
    u.email,
    u.phone,
    u.city as user_city,
    u.created_at as user_created_at,
    u.created_at_parse_failed as user_created_at_parse_failed
  from orders o
  left join users u using (user_id)
)

select *
from joined;


[0m16:38:49.791201 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:fbea856d-8b78-40fd-b557-e8b16c6cce88&page=queryresults
[0m16:38:50.191172 [debug] [Thread-1 (]: Timing info for model.retail.silver__orders_enriched (execute): 16:38:49.067866 => 16:38:50.190919
[0m16:38:50.192523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680e39c2-4149-4c2b-8aa4-1f9f512e9a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cabec604f50>]}
[0m16:38:50.193571 [info ] [Thread-1 (]: 1 of 2 OK created sql view model retail_prod.silver__orders_enriched ........... [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m16:38:50.194704 [debug] [Thread-1 (]: Finished running node model.retail.silver__orders_enriched
[0m16:38:50.196976 [debug] [Thread-3 (]: Began running node model.retail.gold__daily_branch_metrics
[0m16:38:50.198095 [info ] [Thread-3 (]: 2 of 2 START sql table model retail_prod.gold__daily_branch_metrics ............ [RUN]
[0m16:38:50.199196 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.retail.gold__daily_branch_metrics'
[0m16:38:50.199907 [debug] [Thread-3 (]: Began compiling node model.retail.gold__daily_branch_metrics
[0m16:38:50.203644 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail.gold__daily_branch_metrics"
[0m16:38:50.222500 [debug] [Thread-3 (]: Timing info for model.retail.gold__daily_branch_metrics (compile): 16:38:50.200492 => 16:38:50.222185
[0m16:38:50.223245 [debug] [Thread-3 (]: Began executing node model.retail.gold__daily_branch_metrics
[0m16:38:50.233109 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:38:50.761871 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail.gold__daily_branch_metrics"
[0m16:38:50.779980 [debug] [Thread-3 (]: On model.retail.gold__daily_branch_metrics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.gold__daily_branch_metrics"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`gold__daily_branch_metrics`
      
    
    

    OPTIONS()
    as (
      with fact_orders as (
  select *
  from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
  where order_created_at is not null
),
aggregated as (
  select
    order_date,
    branch,
    count(distinct order_id) as orders_count,
    count(distinct user_id) as customers_count,
    sum(case when order_status = 'completed' then total_amount else 0 end) as completed_revenue,
    sum(case when order_status != 'completed' then total_amount else 0 end) as non_completed_revenue,
    sum(total_amount) as gross_revenue
  from fact_orders
  group by order_date, branch
)

select *
from aggregated
    );
  
[0m16:38:51.537135 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:e8eb03cd-e61c-4e97-8ed4-594896d414ad&page=queryresults
[0m16:38:53.279483 [debug] [Thread-3 (]: Timing info for model.retail.gold__daily_branch_metrics (execute): 16:38:50.223764 => 16:38:53.279216
[0m16:38:53.280767 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680e39c2-4149-4c2b-8aa4-1f9f512e9a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cabec2909b0>]}
[0m16:38:53.281688 [info ] [Thread-3 (]: 2 of 2 OK created sql table model retail_prod.gold__daily_branch_metrics ....... [[32mCREATE TABLE (3.7k rows, 360.2 KiB processed)[0m in 3.08s]
[0m16:38:53.282838 [debug] [Thread-3 (]: Finished running node model.retail.gold__daily_branch_metrics
[0m16:38:53.286742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:53.287686 [debug] [MainThread]: Connection 'model.retail.silver__orders_enriched' was properly closed.
[0m16:38:53.288619 [debug] [MainThread]: Connection 'model.retail.gold__daily_branch_metrics' was properly closed.
[0m16:38:53.289411 [info ] [MainThread]: 
[0m16:38:53.290181 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.37 seconds (5.37s).
[0m16:38:53.291226 [debug] [MainThread]: Command end result
[0m16:38:53.333432 [info ] [MainThread]: 
[0m16:38:53.334507 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:38:53.335174 [info ] [MainThread]: 
[0m16:38:53.335951 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:38:53.337393 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.806498, "process_user_time": 3.45475, "process_kernel_time": 1.29805, "process_mem_max_rss": "235920", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:38:53.338266 [debug] [MainThread]: Command `dbt run` succeeded at 16:38:53.338131 after 12.81 seconds
[0m16:38:53.339032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cac1589d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cabecd8fe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cabed326b70>]}
[0m16:38:53.339870 [debug] [MainThread]: Flushing usage events
[0m16:38:57.464430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ec5d1f1010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ec5f931550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ec5d1f0e30>]}


============================== 16:38:57.470701 | 462f1d46-26ae-48b7-8f54-a5d1f789365e ==============================
[0m16:38:57.470701 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:38:57.471569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/silver path:models/gold', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:38:58.309812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '462f1d46-26ae-48b7-8f54-a5d1f789365e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ec34b942c0>]}
[0m16:38:58.385832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '462f1d46-26ae-48b7-8f54-a5d1f789365e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ec3cb0e3c0>]}
[0m16:38:58.387142 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:38:58.498639 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:39:05.576590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:05.577323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:05.578672 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:39:05.584782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '462f1d46-26ae-48b7-8f54-a5d1f789365e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ec37352270>]}
[0m16:39:05.634345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '462f1d46-26ae-48b7-8f54-a5d1f789365e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ec2fc61430>]}
[0m16:39:05.635725 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:39:05.637113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '462f1d46-26ae-48b7-8f54-a5d1f789365e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ec3427d9d0>]}
[0m16:39:05.655986 [info ] [MainThread]: 
[0m16:39:05.657505 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:39:05.659509 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev_retail_prod'
[0m16:39:05.660299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:06.184249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '462f1d46-26ae-48b7-8f54-a5d1f789365e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ec357042c0>]}
[0m16:39:06.185624 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:39:06.186537 [info ] [MainThread]: 
[0m16:39:06.196784 [debug] [Thread-1 (]: Began running node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m16:39:06.197514 [debug] [Thread-2 (]: Began running node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m16:39:06.198116 [debug] [Thread-3 (]: Began running node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m16:39:06.198545 [info ] [Thread-1 (]: 1 of 5 START test not_null_gold__daily_branch_metrics_branch ................... [RUN]
[0m16:39:06.199048 [debug] [Thread-4 (]: Began running node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m16:39:06.199578 [info ] [Thread-2 (]: 2 of 5 START test not_null_gold__daily_branch_metrics_order_date ............... [RUN]
[0m16:39:06.200610 [info ] [Thread-3 (]: 3 of 5 START test not_null_silver__orders_enriched_order_date .................. [RUN]
[0m16:39:06.201837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761)
[0m16:39:06.202892 [info ] [Thread-4 (]: 4 of 5 START test not_null_silver__orders_enriched_order_id .................... [RUN]
[0m16:39:06.204239 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948'
[0m16:39:06.205874 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.retail.not_null_silver__orders_enriched_order_date.658d753d80'
[0m16:39:06.206845 [debug] [Thread-1 (]: Began compiling node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m16:39:06.208433 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.retail.not_null_silver__orders_enriched_order_id.782515c964'
[0m16:39:06.209240 [debug] [Thread-2 (]: Began compiling node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m16:39:06.210026 [debug] [Thread-3 (]: Began compiling node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m16:39:06.226144 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761"
[0m16:39:06.226857 [debug] [Thread-4 (]: Began compiling node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m16:39:06.232551 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948"
[0m16:39:06.237688 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.not_null_silver__orders_enriched_order_date.658d753d80"
[0m16:39:06.244102 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.not_null_silver__orders_enriched_order_id.782515c964"
[0m16:39:06.252947 [debug] [Thread-1 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761 (compile): 16:39:06.210781 => 16:39:06.252277
[0m16:39:06.254375 [debug] [Thread-1 (]: Began executing node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m16:39:06.255255 [debug] [Thread-2 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948 (compile): 16:39:06.228115 => 16:39:06.254986
[0m16:39:06.261394 [debug] [Thread-4 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_id.782515c964 (compile): 16:39:06.239969 => 16:39:06.260868
[0m16:39:06.269395 [debug] [Thread-3 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_date.658d753d80 (compile): 16:39:06.233767 => 16:39:06.268906
[0m16:39:06.273578 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761"
[0m16:39:06.274231 [debug] [Thread-2 (]: Began executing node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m16:39:06.275400 [debug] [Thread-4 (]: Began executing node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m16:39:06.276571 [debug] [Thread-3 (]: Began executing node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m16:39:06.281492 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948"
[0m16:39:06.284321 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.not_null_silver__orders_enriched_order_id.782515c964"
[0m16:39:06.286834 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.not_null_silver__orders_enriched_order_date.658d753d80"
[0m16:39:06.299149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:06.301161 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:39:06.301932 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:39:06.302816 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:39:06.370771 [debug] [Thread-1 (]: On test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select branch
from `retail-data-pipeline-dev`.`retail_prod`.`gold__daily_branch_metrics`
where branch is null



      
    ) dbt_internal_test
[0m16:39:06.402766 [debug] [Thread-2 (]: On test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from `retail-data-pipeline-dev`.`retail_prod`.`gold__daily_branch_metrics`
where order_date is null



      
    ) dbt_internal_test
[0m16:39:06.406265 [debug] [Thread-4 (]: On test.retail.not_null_silver__orders_enriched_order_id.782515c964: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_silver__orders_enriched_order_id.782515c964"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
where order_id is null



      
    ) dbt_internal_test
[0m16:39:06.446341 [debug] [Thread-3 (]: On test.retail.not_null_silver__orders_enriched_order_date.658d753d80: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_silver__orders_enriched_order_date.658d753d80"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
where order_date is null



      
    ) dbt_internal_test
[0m16:39:07.121758 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:b21adf61-34e8-49fc-9bb1-2cad84265844&page=queryresults
[0m16:39:07.142065 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:4f6cff5a-c07c-4c2d-843c-09cdb013bbbd&page=queryresults
[0m16:39:07.535244 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:22caba51-496d-4d52-9ccc-85227b5b688a&page=queryresults
[0m16:39:07.622633 [debug] [Thread-1 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761 (execute): 16:39:06.255560 => 16:39:07.622324
[0m16:39:07.624387 [info ] [Thread-1 (]: 1 of 5 PASS not_null_gold__daily_branch_metrics_branch ......................... [[32mPASS[0m in 1.42s]
[0m16:39:07.626064 [debug] [Thread-1 (]: Finished running node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m16:39:07.627621 [debug] [Thread-1 (]: Began running node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m16:39:07.629151 [info ] [Thread-1 (]: 5 of 5 START test unique_silver__orders_enriched_order_id ...................... [RUN]
[0m16:39:07.630146 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:18a4eb22-4938-4b6c-b7cf-2e2bf49ff67d&page=queryresults
[0m16:39:07.630980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761, now test.retail.unique_silver__orders_enriched_order_id.761e0577f3)
[0m16:39:07.632774 [debug] [Thread-1 (]: Began compiling node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m16:39:07.640773 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.unique_silver__orders_enriched_order_id.761e0577f3"
[0m16:39:07.649767 [debug] [Thread-2 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948 (execute): 16:39:06.278122 => 16:39:07.649426
[0m16:39:07.651063 [info ] [Thread-2 (]: 2 of 5 PASS not_null_gold__daily_branch_metrics_order_date ..................... [[32mPASS[0m in 1.45s]
[0m16:39:07.652066 [debug] [Thread-2 (]: Finished running node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m16:39:07.662993 [debug] [Thread-1 (]: Timing info for test.retail.unique_silver__orders_enriched_order_id.761e0577f3 (compile): 16:39:07.634250 => 16:39:07.662484
[0m16:39:07.664049 [debug] [Thread-1 (]: Began executing node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m16:39:07.668481 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.unique_silver__orders_enriched_order_id.761e0577f3"
[0m16:39:07.689478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:07.729735 [debug] [Thread-1 (]: On test.retail.unique_silver__orders_enriched_order_id.761e0577f3: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_silver__orders_enriched_order_id.761e0577f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:39:08.095248 [debug] [Thread-3 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_date.658d753d80 (execute): 16:39:06.284953 => 16:39:08.094749
[0m16:39:08.096802 [warn ] [Thread-3 (]: 3 of 5 WARN 993 not_null_silver__orders_enriched_order_date .................... [[33mWARN 993[0m in 1.89s]
[0m16:39:08.100895 [debug] [Thread-3 (]: Finished running node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m16:39:08.165057 [debug] [Thread-4 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_id.782515c964 (execute): 16:39:06.281860 => 16:39:08.164724
[0m16:39:08.166408 [info ] [Thread-4 (]: 4 of 5 PASS not_null_silver__orders_enriched_order_id .......................... [[32mPASS[0m in 1.96s]
[0m16:39:08.167574 [debug] [Thread-4 (]: Finished running node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m16:39:08.895365 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:257dd6b1-6d19-4fc4-a460-edc723d56d0b&page=queryresults
[0m16:39:09.409051 [debug] [Thread-1 (]: Timing info for test.retail.unique_silver__orders_enriched_order_id.761e0577f3 (execute): 16:39:07.664857 => 16:39:09.408745
[0m16:39:09.410389 [warn ] [Thread-1 (]: 5 of 5 WARN 50 unique_silver__orders_enriched_order_id ......................... [[33mWARN 50[0m in 1.78s]
[0m16:39:09.411678 [debug] [Thread-1 (]: Finished running node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m16:39:09.415216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:09.416254 [debug] [MainThread]: Connection 'test.retail.unique_silver__orders_enriched_order_id.761e0577f3' was properly closed.
[0m16:39:09.417148 [debug] [MainThread]: Connection 'test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948' was properly closed.
[0m16:39:09.418146 [debug] [MainThread]: Connection 'test.retail.not_null_silver__orders_enriched_order_date.658d753d80' was properly closed.
[0m16:39:09.419170 [debug] [MainThread]: Connection 'test.retail.not_null_silver__orders_enriched_order_id.782515c964' was properly closed.
[0m16:39:09.420345 [info ] [MainThread]: 
[0m16:39:09.421460 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m16:39:09.423644 [debug] [MainThread]: Command end result
[0m16:39:09.472222 [info ] [MainThread]: 
[0m16:39:09.473518 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m16:39:09.474422 [info ] [MainThread]: 
[0m16:39:09.475547 [warn ] [MainThread]: [33mWarning in test not_null_silver__orders_enriched_order_date (models/silver/schema.yml)[0m
[0m16:39:09.476510 [warn ] [MainThread]: Got 993 results, configured to warn if != 0
[0m16:39:09.477431 [info ] [MainThread]: 
[0m16:39:09.478485 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/silver/schema.yml/not_null_silver__orders_enriched_order_date.sql
[0m16:39:09.479488 [info ] [MainThread]: 
[0m16:39:09.480655 [warn ] [MainThread]: [33mWarning in test unique_silver__orders_enriched_order_id (models/silver/schema.yml)[0m
[0m16:39:09.481378 [warn ] [MainThread]: Got 50 results, configured to warn if != 0
[0m16:39:09.482111 [info ] [MainThread]: 
[0m16:39:09.482974 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/silver/schema.yml/unique_silver__orders_enriched_order_id.sql
[0m16:39:09.483848 [info ] [MainThread]: 
[0m16:39:09.484744 [info ] [MainThread]: Done. PASS=3 WARN=2 ERROR=0 SKIP=0 TOTAL=5
[0m16:39:09.486314 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.070002, "process_user_time": 3.538292, "process_kernel_time": 1.440331, "process_mem_max_rss": "236496", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:39:09.487202 [debug] [MainThread]: Command `dbt test` succeeded at 16:39:09.487030 after 12.07 seconds
[0m16:39:09.487989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ec5d120b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ec5d36e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ec5d912ae0>]}
[0m16:39:09.488881 [debug] [MainThread]: Flushing usage events
[0m16:50:10.582187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730c24d88ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730c24d89e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730c24d89e80>]}


============================== 16:50:10.589492 | 9b06e48c-71a4-4749-bc85-aaac6f69091a ==============================
[0m16:50:10.589492 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:50:10.590625 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:50:10.689228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b06e48c-71a4-4749-bc85-aaac6f69091a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730c2556c290>]}
[0m16:50:12.193121 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wat6f8ol'
[0m16:50:12.193876 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:50:12.391107 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:50:12.392413 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:50:12.490489 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:50:12.494462 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m16:50:12.635207 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m16:50:12.639843 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m16:50:12.780131 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m16:50:12.783343 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:50:20.379227 [info ] [MainThread]: Installed from version 1.3.1
[0m16:50:20.380217 [info ] [MainThread]: Up to date!
[0m16:50:20.381052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9b06e48c-71a4-4749-bc85-aaac6f69091a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730c24b217f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730c24adbdd0>]}
[0m16:50:20.381743 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m16:50:26.636202 [info ] [MainThread]: Installed from version 0.10.9
[0m16:50:26.637314 [info ] [MainThread]: Up to date!
[0m16:50:26.638291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9b06e48c-71a4-4749-bc85-aaac6f69091a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730c24c6fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730c24c6f800>]}
[0m16:50:26.639236 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m16:50:29.288851 [info ] [MainThread]: Installed from version 0.15.0
[0m16:50:29.289820 [info ] [MainThread]: Up to date!
[0m16:50:29.290801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9b06e48c-71a4-4749-bc85-aaac6f69091a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730c24c6dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730c24c6f470>]}
[0m16:50:29.293152 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 18.794891, "process_user_time": 2.565726, "process_kernel_time": 0.796401, "process_mem_max_rss": "197952", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m16:50:29.294004 [debug] [MainThread]: Command `dbt deps` succeeded at 16:50:29.293840 after 18.80 seconds
[0m16:50:29.294631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730c297333e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730c24d3bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730c24ddf0e0>]}
[0m16:50:29.295439 [debug] [MainThread]: Flushing usage events
[0m16:50:34.569881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cf2ee394f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cf2ee3b830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cf2ee3be00>]}


============================== 16:50:34.576879 | 01935b42-6655-424c-a35c-d404440f28ac ==============================
[0m16:50:34.576879 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:50:34.577869 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:50:35.498710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01935b42-6655-424c-a35c-d404440f28ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cf0907d5b0>]}
[0m16:50:35.568695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01935b42-6655-424c-a35c-d404440f28ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cf2ee3f770>]}
[0m16:50:35.570197 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:50:35.683245 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:50:42.964451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:50:42.965725 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:50:42.967114 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:50:42.973363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01935b42-6655-424c-a35c-d404440f28ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cf01c75a00>]}
[0m16:50:43.037939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01935b42-6655-424c-a35c-d404440f28ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cf018d2090>]}
[0m16:50:43.039201 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:50:43.040309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01935b42-6655-424c-a35c-d404440f28ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cf0209b050>]}
[0m16:50:43.051946 [info ] [MainThread]: 
[0m16:50:43.053478 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:50:43.055255 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m16:50:43.056125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:43.759414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod)
[0m16:50:43.760453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:44.252519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01935b42-6655-424c-a35c-d404440f28ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cf0e71f410>]}
[0m16:50:44.253668 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:50:44.254448 [info ] [MainThread]: 
[0m16:50:44.264622 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m16:50:44.265436 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m16:50:44.266065 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod.bronze__orders ........................ [RUN]
[0m16:50:44.266973 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod.bronze__users ......................... [RUN]
[0m16:50:44.268190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.bronze__orders)
[0m16:50:44.269788 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m16:50:44.271191 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m16:50:44.272886 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m16:50:44.282398 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m16:50:44.286620 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m16:50:44.298928 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 16:50:44.273811 => 16:50:44.298401
[0m16:50:44.299994 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m16:50:44.307297 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 16:50:44.283196 => 16:50:44.306829
[0m16:50:44.313793 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m16:50:44.317182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:44.319808 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:50:44.873178 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m16:50:44.874531 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m16:50:44.887074 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe.parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m16:50:44.889245 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe.parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m16:50:45.311420 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:c0e5af3b-a79e-4f7b-a86c-8ea86f57c159&page=queryresults
[0m16:50:45.319979 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:295a9b8d-92d3-45e7-b7ab-2c7da3f66d26&page=queryresults
[0m16:50:45.482126 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: user_id; Did you mean users? at [15:5]; reason: invalidQuery, location: query, message: Unrecognized name: user_id; Did you mean users? at [15:5]')
[0m16:50:46.379974 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:57d454ec-a500-4e32-80c7-f1b227ac0d12&page=queryresults
[0m16:50:46.527836 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:57d454ec-a500-4e32-80c7-f1b227ac0d12&page=queryresults
[0m16:50:46.529027 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 16:50:44.317711 => 16:50:46.528779
[0m16:50:46.535021 [debug] [Thread-2 (]: Database Error in model bronze__users (models/bronze/bronze__users.sql)
  Unrecognized name: user_id; Did you mean users? at [15:5]
  compiled Code at target/run/retail/models/bronze/bronze__users.sql
[0m16:50:46.536234 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01935b42-6655-424c-a35c-d404440f28ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cf018fcec0>]}
[0m16:50:46.537283 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model retail_prod.bronze__users ................ [[31mERROR[0m in 2.27s]
[0m16:50:46.538342 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m16:50:47.054835 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 16:50:44.300986 => 16:50:47.054631
[0m16:50:47.057329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01935b42-6655-424c-a35c-d404440f28ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cf01959340>]}
[0m16:50:47.058909 [info ] [Thread-1 (]: 1 of 2 OK created sql table model retail_prod.bronze__orders ................... [[32mCREATE TABLE (5.0k rows, 414.1 KiB processed)[0m in 2.79s]
[0m16:50:47.060311 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m16:50:47.064218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:47.065214 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m16:50:47.065972 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m16:50:47.066984 [info ] [MainThread]: 
[0m16:50:47.067914 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.01 seconds (4.01s).
[0m16:50:47.069160 [debug] [MainThread]: Command end result
[0m16:50:47.111304 [info ] [MainThread]: 
[0m16:50:47.112529 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:50:47.113426 [info ] [MainThread]: 
[0m16:50:47.114174 [error] [MainThread]:   Database Error in model bronze__users (models/bronze/bronze__users.sql)
  Unrecognized name: user_id; Did you mean users? at [15:5]
  compiled Code at target/run/retail/models/bronze/bronze__users.sql
[0m16:50:47.114906 [info ] [MainThread]: 
[0m16:50:47.115727 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:50:47.116961 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.6382065, "process_user_time": 3.516956, "process_kernel_time": 1.455572, "process_mem_max_rss": "236248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:50:47.117825 [debug] [MainThread]: Command `dbt run` failed at 16:50:47.117661 after 12.64 seconds
[0m16:50:47.118653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cf2efb1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cf3377b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cf2f6ba600>]}
[0m16:50:47.119366 [debug] [MainThread]: Flushing usage events
[0m16:53:39.352867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fb9e6b7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fb9e6b56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fb9e6a0c20>]}


============================== 16:53:39.359778 | 8da1e695-6e04-49f5-9453-a645a2fffcf2 ==============================
[0m16:53:39.359778 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:53:39.362683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'send_anonymous_usage_stats': 'True'}
[0m16:53:39.468044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8da1e695-6e04-49f5-9453-a645a2fffcf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fb9e6b4cb0>]}
[0m16:53:40.931955 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2crrgmy_'
[0m16:53:40.933384 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:53:41.185152 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:53:41.186613 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:53:41.321058 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:53:41.325426 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m16:53:41.467403 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m16:53:41.471540 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m16:53:41.607290 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m16:53:41.611808 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:53:49.190456 [info ] [MainThread]: Installed from version 1.3.1
[0m16:53:49.191465 [info ] [MainThread]: Up to date!
[0m16:53:49.192359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8da1e695-6e04-49f5-9453-a645a2fffcf2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fb9e205970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fb9e205910>]}
[0m16:53:49.193015 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m16:53:55.728539 [info ] [MainThread]: Installed from version 0.10.9
[0m16:53:55.729912 [info ] [MainThread]: Up to date!
[0m16:53:55.731144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8da1e695-6e04-49f5-9453-a645a2fffcf2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fb9e3bfcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fb9e3bfef0>]}
[0m16:53:55.732417 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m16:53:58.468228 [info ] [MainThread]: Installed from version 0.15.0
[0m16:53:58.469607 [info ] [MainThread]: Up to date!
[0m16:53:58.470891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8da1e695-6e04-49f5-9453-a645a2fffcf2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fb9e3561b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fb9e357ec0>]}
[0m16:53:58.476677 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 19.211542, "process_user_time": 2.626697, "process_kernel_time": 0.893748, "process_mem_max_rss": "196484", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m16:53:58.478737 [debug] [MainThread]: Command `dbt deps` succeeded at 16:53:58.478418 after 19.21 seconds
[0m16:53:58.486889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fb9e6d3b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fb9e6b4cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fb9e427fe0>]}
[0m16:53:58.489038 [debug] [MainThread]: Flushing usage events
[0m16:54:03.004999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af8c85e89b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af8c8cb7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af8c8717230>]}


============================== 16:54:03.011776 | dd21e629-714c-4544-a21b-33b431c95962 ==============================
[0m16:54:03.011776 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:54:03.013057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/retail', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:54:03.922615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd21e629-714c-4544-a21b-33b431c95962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af89bb3f470>]}
[0m16:54:03.993230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd21e629-714c-4544-a21b-33b431c95962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af8a0970bf0>]}
[0m16:54:03.994637 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:54:04.097561 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:54:11.028531 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:54:11.029299 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:54:11.030422 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:54:11.035408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd21e629-714c-4544-a21b-33b431c95962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af89b6d06b0>]}
[0m16:54:11.080454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd21e629-714c-4544-a21b-33b431c95962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af89b0728d0>]}
[0m16:54:11.081312 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:54:11.082113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd21e629-714c-4544-a21b-33b431c95962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af89b072990>]}
[0m16:54:11.087503 [info ] [MainThread]: 
[0m16:54:11.088834 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:54:11.091423 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m16:54:11.092570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:11.721226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod)
[0m16:54:11.722591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:12.290950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd21e629-714c-4544-a21b-33b431c95962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af89b072810>]}
[0m16:54:12.292196 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:54:12.293382 [info ] [MainThread]: 
[0m16:54:12.302866 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m16:54:12.303409 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m16:54:12.304021 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod.bronze__orders ........................ [RUN]
[0m16:54:12.305153 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod.bronze__users ......................... [RUN]
[0m16:54:12.306591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.bronze__orders)
[0m16:54:12.307904 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m16:54:12.308802 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m16:54:12.309930 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m16:54:12.317828 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m16:54:12.320572 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m16:54:12.334296 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 16:54:12.310926 => 16:54:12.333778
[0m16:54:12.335244 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m16:54:12.342639 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 16:54:12.318191 => 16:54:12.342195
[0m16:54:12.349299 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m16:54:12.349891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:12.352174 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:54:12.900187 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m16:54:12.903316 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m16:54:12.912753 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe.parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m16:54:12.915553 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe.parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m16:54:13.332208 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:b68a9d81-c2d2-46a3-8cf5-746f65fd9f4f&page=queryresults
[0m16:54:13.384476 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:7e034045-658b-46fc-824d-78acc5013640&page=queryresults
[0m16:54:15.385114 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 16:54:12.350332 => 16:54:15.384873
[0m16:54:15.391592 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd21e629-714c-4544-a21b-33b431c95962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af89b0fa360>]}
[0m16:54:15.392469 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 16:54:12.335956 => 16:54:15.392198
[0m16:54:15.393066 [info ] [Thread-2 (]: 2 of 2 OK created sql table model retail_prod.bronze__users .................... [[32mCREATE TABLE (1.0k rows, 107.1 KiB processed)[0m in 3.08s]
[0m16:54:15.394416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd21e629-714c-4544-a21b-33b431c95962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af89b0fb4a0>]}
[0m16:54:15.395522 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m16:54:15.396586 [info ] [Thread-1 (]: 1 of 2 OK created sql table model retail_prod.bronze__orders ................... [[32mCREATE TABLE (5.0k rows, 414.1 KiB processed)[0m in 3.09s]
[0m16:54:15.398599 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m16:54:15.401826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:15.402873 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m16:54:15.403477 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m16:54:15.404075 [info ] [MainThread]: 
[0m16:54:15.404759 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m16:54:15.406218 [debug] [MainThread]: Command end result
[0m16:54:15.445414 [info ] [MainThread]: 
[0m16:54:15.446522 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:54:15.447261 [info ] [MainThread]: 
[0m16:54:15.447874 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:54:15.449265 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.471289, "process_user_time": 3.771759, "process_kernel_time": 1.5599, "process_mem_max_rss": "236208", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:54:15.450005 [debug] [MainThread]: Command `dbt run` succeeded at 16:54:15.449859 after 12.47 seconds
[0m16:54:15.450662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af8c8515460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af89b9f1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af8c9516480>]}
[0m16:54:15.451290 [debug] [MainThread]: Flushing usage events
[0m16:54:19.865077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e91fd18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e920fc6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e91fd1790>]}


============================== 16:54:19.871538 | 7cb4d7a5-8b3e-4427-9379-4ea01f24d23c ==============================
[0m16:54:19.871538 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:54:19.872693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:54:21.041932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cb4d7a5-8b3e-4427-9379-4ea01f24d23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e652cd6d0>]}
[0m16:54:21.141300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cb4d7a5-8b3e-4427-9379-4ea01f24d23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e672d2240>]}
[0m16:54:21.143029 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:54:21.267330 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:54:28.931478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:54:28.932386 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:54:28.933352 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:54:28.939203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cb4d7a5-8b3e-4427-9379-4ea01f24d23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e664442c0>]}
[0m16:54:28.986844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cb4d7a5-8b3e-4427-9379-4ea01f24d23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e64a6a240>]}
[0m16:54:28.988172 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:54:28.989395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cb4d7a5-8b3e-4427-9379-4ea01f24d23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e64a6a180>]}
[0m16:54:29.000740 [info ] [MainThread]: 
[0m16:54:29.001984 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:54:29.004288 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev_retail_prod'
[0m16:54:29.005284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:29.515256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cb4d7a5-8b3e-4427-9379-4ea01f24d23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e64e7ea20>]}
[0m16:54:29.516391 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:54:29.517137 [info ] [MainThread]: 
[0m16:54:29.525032 [debug] [Thread-1 (]: Began running node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m16:54:29.525573 [debug] [Thread-2 (]: Began running node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m16:54:29.526077 [info ] [Thread-1 (]: 1 of 15 START test not_null_bronze__orders_order_created_at .................... [RUN]
[0m16:54:29.526647 [debug] [Thread-3 (]: Began running node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:54:29.527152 [debug] [Thread-4 (]: Began running node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:54:29.527951 [info ] [Thread-2 (]: 2 of 15 START test not_null_bronze__orders_order_id ............................ [RUN]
[0m16:54:29.529119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now test.retail.not_null_bronze__orders_order_created_at.05e711bf75)
[0m16:54:29.529848 [info ] [Thread-3 (]: 3 of 15 START test not_null_bronze__users_email ................................ [RUN]
[0m16:54:29.530690 [info ] [Thread-4 (]: 4 of 15 START test not_null_bronze__users_user_id .............................. [RUN]
[0m16:54:29.531943 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__orders_order_id.4b38fb230a'
[0m16:54:29.532835 [debug] [Thread-1 (]: Began compiling node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m16:54:29.533922 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__users_email.2bec59e73f'
[0m16:54:29.534921 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__users_user_id.cb91e05164'
[0m16:54:29.535571 [debug] [Thread-2 (]: Began compiling node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m16:54:29.547181 [debug] [Thread-3 (]: Began compiling node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:54:29.550430 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"
[0m16:54:29.551765 [debug] [Thread-4 (]: Began compiling node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:54:29.556054 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.not_null_bronze__orders_order_id.4b38fb230a"
[0m16:54:29.560488 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.not_null_bronze__users_email.2bec59e73f"
[0m16:54:29.565509 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.not_null_bronze__users_user_id.cb91e05164"
[0m16:54:29.574513 [debug] [Thread-1 (]: Timing info for test.retail.not_null_bronze__orders_order_created_at.05e711bf75 (compile): 16:54:29.536077 => 16:54:29.574201
[0m16:54:29.575354 [debug] [Thread-1 (]: Began executing node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m16:54:29.587586 [debug] [Thread-2 (]: Timing info for test.retail.not_null_bronze__orders_order_id.4b38fb230a (compile): 16:54:29.552708 => 16:54:29.587284
[0m16:54:29.593049 [debug] [Thread-2 (]: Began executing node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m16:54:29.596413 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"
[0m16:54:29.597008 [debug] [Thread-3 (]: Timing info for test.retail.not_null_bronze__users_email.2bec59e73f (compile): 16:54:29.557254 => 16:54:29.596777
[0m16:54:29.599330 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.not_null_bronze__orders_order_id.4b38fb230a"
[0m16:54:29.599861 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__users_user_id.cb91e05164 (compile): 16:54:29.561909 => 16:54:29.599653
[0m16:54:29.600552 [debug] [Thread-3 (]: Began executing node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:54:29.601329 [debug] [Thread-4 (]: Began executing node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:54:29.603901 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.not_null_bronze__users_email.2bec59e73f"
[0m16:54:29.606373 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.not_null_bronze__users_user_id.cb91e05164"
[0m16:54:29.615048 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:54:29.616790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:29.618413 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:54:29.650793 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:54:29.652071 [debug] [Thread-2 (]: On test.retail.not_null_bronze__orders_order_id.4b38fb230a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__orders_order_id.4b38fb230a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
where order_id is null



      
    ) dbt_internal_test
[0m16:54:29.684191 [debug] [Thread-1 (]: On test.retail.not_null_bronze__orders_order_created_at.05e711bf75: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_created_at
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
where order_created_at is null



      
    ) dbt_internal_test
[0m16:54:29.752271 [debug] [Thread-4 (]: On test.retail.not_null_bronze__users_user_id.cb91e05164: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__users_user_id.cb91e05164"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
where user_id is null



      
    ) dbt_internal_test
[0m16:54:29.756043 [debug] [Thread-3 (]: On test.retail.not_null_bronze__users_email.2bec59e73f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__users_email.2bec59e73f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
where email is null



      
    ) dbt_internal_test
[0m16:54:30.443193 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:387eb125-d02d-44fd-a24b-a2f6e67c285d&page=queryresults
[0m16:54:30.474221 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:f4c5d905-8c9d-4f5c-b6f4-68047e149e15&page=queryresults
[0m16:54:30.483423 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:df0bc8ae-1214-4111-911a-90080d0b0d6c&page=queryresults
[0m16:54:30.511578 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:f22004df-f8e3-48b7-8d32-6a3586541edc&page=queryresults
[0m16:54:31.019015 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__users_user_id.cb91e05164 (execute): 16:54:29.604477 => 16:54:31.018716
[0m16:54:31.020493 [info ] [Thread-4 (]: 4 of 15 PASS not_null_bronze__users_user_id .................................... [[32mPASS[0m in 1.49s]
[0m16:54:31.021967 [debug] [Thread-4 (]: Finished running node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:54:31.022886 [debug] [Thread-4 (]: Began running node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m16:54:31.023732 [info ] [Thread-4 (]: 5 of 15 START test source_not_null_raw_csv_order_items_order_id ................ [RUN]
[0m16:54:31.024739 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__users_user_id.cb91e05164, now test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2)
[0m16:54:31.025251 [debug] [Thread-4 (]: Began compiling node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m16:54:31.029258 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"
[0m16:54:31.044924 [debug] [Thread-2 (]: Timing info for test.retail.not_null_bronze__orders_order_id.4b38fb230a (execute): 16:54:29.597351 => 16:54:31.044629
[0m16:54:31.046096 [info ] [Thread-2 (]: 2 of 15 PASS not_null_bronze__orders_order_id .................................. [[32mPASS[0m in 1.51s]
[0m16:54:31.047093 [debug] [Thread-2 (]: Finished running node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m16:54:31.047950 [debug] [Thread-2 (]: Began running node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m16:54:31.049114 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2 (compile): 16:54:31.025726 => 16:54:31.048865
[0m16:54:31.048654 [info ] [Thread-2 (]: 6 of 15 START test source_not_null_raw_csv_orders_order_id ..................... [RUN]
[0m16:54:31.049813 [debug] [Thread-4 (]: Began executing node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m16:54:31.050746 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__orders_order_id.4b38fb230a, now test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336)
[0m16:54:31.053432 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"
[0m16:54:31.054660 [debug] [Thread-2 (]: Began compiling node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m16:54:31.059234 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"
[0m16:54:31.064583 [debug] [Thread-1 (]: Timing info for test.retail.not_null_bronze__orders_order_created_at.05e711bf75 (execute): 16:54:29.576135 => 16:54:31.064273
[0m16:54:31.065679 [warn ] [Thread-1 (]: 1 of 15 WARN 987 not_null_bronze__orders_order_created_at ...................... [[33mWARN 987[0m in 1.54s]
[0m16:54:31.066646 [debug] [Thread-1 (]: Finished running node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m16:54:31.067366 [debug] [Thread-1 (]: Began running node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m16:54:31.068039 [info ] [Thread-1 (]: 7 of 15 START test source_not_null_raw_csv_products_product_id ................. [RUN]
[0m16:54:31.069199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__orders_order_created_at.05e711bf75, now test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6)
[0m16:54:31.070045 [debug] [Thread-1 (]: Began compiling node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m16:54:31.072914 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:54:31.079011 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"
[0m16:54:31.081882 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336 (compile): 16:54:31.055684 => 16:54:31.081528
[0m16:54:31.082833 [debug] [Thread-2 (]: Began executing node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m16:54:31.122389 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"
[0m16:54:31.125741 [debug] [Thread-3 (]: Timing info for test.retail.not_null_bronze__users_email.2bec59e73f (execute): 16:54:29.601848 => 16:54:31.125417
[0m16:54:31.126435 [debug] [Thread-4 (]: On test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_raw`.`order_items`
where order_id is null



      
    ) dbt_internal_test
[0m16:54:31.128543 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6 (compile): 16:54:31.070975 => 16:54:31.128267
[0m16:54:31.127806 [info ] [Thread-3 (]: 3 of 15 PASS not_null_bronze__users_email ...................................... [[32mPASS[0m in 1.59s]
[0m16:54:31.132520 [debug] [Thread-1 (]: Began executing node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m16:54:31.134003 [debug] [Thread-3 (]: Finished running node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:54:31.138691 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"
[0m16:54:31.139833 [debug] [Thread-3 (]: Began running node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m16:54:31.141735 [info ] [Thread-3 (]: 8 of 15 START test source_not_null_raw_csv_sessions_session_id ................. [RUN]
[0m16:54:31.142878 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__users_email.2bec59e73f, now test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194)
[0m16:54:31.143372 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:54:31.143786 [debug] [Thread-3 (]: Began compiling node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m16:54:31.148578 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"
[0m16:54:31.151424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:31.183365 [debug] [Thread-2 (]: On test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_raw`.`orders`
where order_id is null



      
    ) dbt_internal_test
[0m16:54:31.218889 [debug] [Thread-1 (]: On test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `retail-data-pipeline-dev`.`retail_raw`.`products`
where product_id is null



      
    ) dbt_internal_test
[0m16:54:31.222375 [debug] [Thread-3 (]: Timing info for test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194 (compile): 16:54:31.144922 => 16:54:31.221904
[0m16:54:31.223323 [debug] [Thread-3 (]: Began executing node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m16:54:31.226342 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"
[0m16:54:31.242302 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:54:31.280627 [debug] [Thread-3 (]: On test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from `retail-data-pipeline-dev`.`retail_raw`.`sessions`
where session_id is null



      
    ) dbt_internal_test
[0m16:54:31.823446 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:7e9f6a32-34a0-4fa5-9f44-a47870c53952&page=queryresults
[0m16:54:31.896829 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:9ce13ff3-afbc-48df-bd32-123d99ba64d2&page=queryresults
[0m16:54:32.011192 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:5e39783c-9919-492e-9a2a-b43ac810654e&page=queryresults
[0m16:54:32.043489 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:fcdc09d9-764b-4898-ac4a-fff4dc616204&page=queryresults
[0m16:54:32.325606 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2 (execute): 16:54:31.051335 => 16:54:32.325326
[0m16:54:32.326844 [info ] [Thread-4 (]: 5 of 15 PASS source_not_null_raw_csv_order_items_order_id ...................... [[32mPASS[0m in 1.30s]
[0m16:54:32.328094 [debug] [Thread-4 (]: Finished running node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m16:54:32.328904 [debug] [Thread-4 (]: Began running node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m16:54:32.329936 [info ] [Thread-4 (]: 9 of 15 START test source_not_null_raw_csv_users_user_id ....................... [RUN]
[0m16:54:32.332220 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2, now test.retail.source_not_null_raw_csv_users_user_id.3380c1257d)
[0m16:54:32.333450 [debug] [Thread-4 (]: Began compiling node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m16:54:32.337969 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"
[0m16:54:32.357199 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_users_user_id.3380c1257d (compile): 16:54:32.334330 => 16:54:32.356739
[0m16:54:32.358217 [debug] [Thread-4 (]: Began executing node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m16:54:32.362310 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"
[0m16:54:32.380594 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:54:32.417161 [debug] [Thread-4 (]: On test.retail.source_not_null_raw_csv_users_user_id.3380c1257d: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `retail-data-pipeline-dev`.`retail_raw`.`users`
where user_id is null



      
    ) dbt_internal_test
[0m16:54:32.423486 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336 (execute): 16:54:31.118324 => 16:54:32.423199
[0m16:54:32.424752 [info ] [Thread-2 (]: 6 of 15 PASS source_not_null_raw_csv_orders_order_id ........................... [[32mPASS[0m in 1.37s]
[0m16:54:32.425851 [debug] [Thread-2 (]: Finished running node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m16:54:32.426572 [debug] [Thread-2 (]: Began running node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m16:54:32.427213 [info ] [Thread-2 (]: 10 of 15 START test source_unique_raw_csv_orders_order_id ...................... [RUN]
[0m16:54:32.428173 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336, now test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53)
[0m16:54:32.428948 [debug] [Thread-2 (]: Began compiling node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m16:54:32.436591 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"
[0m16:54:32.453894 [debug] [Thread-2 (]: Timing info for test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53 (compile): 16:54:32.429488 => 16:54:32.453560
[0m16:54:32.454790 [debug] [Thread-2 (]: Began executing node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m16:54:32.457335 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"
[0m16:54:32.474099 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:54:32.510602 [debug] [Thread-2 (]: On test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:54:32.551436 [debug] [Thread-3 (]: Timing info for test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194 (execute): 16:54:31.224037 => 16:54:32.551139
[0m16:54:32.552699 [info ] [Thread-3 (]: 8 of 15 PASS source_not_null_raw_csv_sessions_session_id ....................... [[32mPASS[0m in 1.41s]
[0m16:54:32.553667 [debug] [Thread-3 (]: Finished running node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m16:54:32.554358 [debug] [Thread-3 (]: Began running node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m16:54:32.555015 [info ] [Thread-3 (]: 11 of 15 START test source_unique_raw_csv_products_product_id .................. [RUN]
[0m16:54:32.555928 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194, now test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1)
[0m16:54:32.556751 [debug] [Thread-3 (]: Began compiling node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m16:54:32.561592 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"
[0m16:54:32.578703 [debug] [Thread-3 (]: Timing info for test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1 (compile): 16:54:32.557690 => 16:54:32.578393
[0m16:54:32.579484 [debug] [Thread-3 (]: Began executing node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m16:54:32.582406 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"
[0m16:54:32.600860 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:54:32.644270 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6 (execute): 16:54:31.134831 => 16:54:32.643755
[0m16:54:32.645294 [debug] [Thread-3 (]: On test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:54:32.647651 [info ] [Thread-1 (]: 7 of 15 PASS source_not_null_raw_csv_products_product_id ....................... [[32mPASS[0m in 1.58s]
[0m16:54:32.654017 [debug] [Thread-1 (]: Finished running node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m16:54:32.655648 [debug] [Thread-1 (]: Began running node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m16:54:32.657141 [info ] [Thread-1 (]: 12 of 15 START test source_unique_raw_csv_sessions_session_id .................. [RUN]
[0m16:54:32.658905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6, now test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8)
[0m16:54:32.660325 [debug] [Thread-1 (]: Began compiling node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m16:54:32.666731 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"
[0m16:54:32.690384 [debug] [Thread-1 (]: Timing info for test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8 (compile): 16:54:32.661352 => 16:54:32.689884
[0m16:54:32.691635 [debug] [Thread-1 (]: Began executing node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m16:54:32.694691 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"
[0m16:54:32.720452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:32.757701 [debug] [Thread-1 (]: On test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select session_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`sessions`
  where session_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:54:33.121698 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:da5f8f14-4029-40b6-b05c-ed02ccc07eb2&page=queryresults
[0m16:54:33.299943 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:602c376e-1c09-41ab-94eb-2eb7edb449c3&page=queryresults
[0m16:54:33.414978 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:aac24e1f-bc73-4dbb-8bc8-0342fcb48f68&page=queryresults
[0m16:54:33.492432 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:8c7a73b9-d717-4496-b9a3-1897f1abb53d&page=queryresults
[0m16:54:33.661336 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_users_user_id.3380c1257d (execute): 16:54:32.358857 => 16:54:33.661035
[0m16:54:33.662652 [info ] [Thread-4 (]: 9 of 15 PASS source_not_null_raw_csv_users_user_id ............................. [[32mPASS[0m in 1.33s]
[0m16:54:33.663671 [debug] [Thread-4 (]: Finished running node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m16:54:33.664471 [debug] [Thread-4 (]: Began running node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m16:54:33.665241 [info ] [Thread-4 (]: 13 of 15 START test source_unique_raw_csv_users_user_id ........................ [RUN]
[0m16:54:33.666505 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_users_user_id.3380c1257d, now test.retail.source_unique_raw_csv_users_user_id.d8f871acc9)
[0m16:54:33.667439 [debug] [Thread-4 (]: Began compiling node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m16:54:33.673523 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"
[0m16:54:33.694739 [debug] [Thread-4 (]: Timing info for test.retail.source_unique_raw_csv_users_user_id.d8f871acc9 (compile): 16:54:33.668163 => 16:54:33.694216
[0m16:54:33.695919 [debug] [Thread-4 (]: Began executing node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m16:54:33.699525 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"
[0m16:54:33.718461 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:54:33.760621 [debug] [Thread-4 (]: On test.retail.source_unique_raw_csv_users_user_id.d8f871acc9: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:54:33.907840 [debug] [Thread-2 (]: Timing info for test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53 (execute): 16:54:32.455344 => 16:54:33.907391
[0m16:54:33.909376 [warn ] [Thread-2 (]: 10 of 15 WARN 25 source_unique_raw_csv_orders_order_id ......................... [[33mWARN 25[0m in 1.48s]
[0m16:54:33.910951 [debug] [Thread-2 (]: Finished running node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m16:54:33.912024 [debug] [Thread-2 (]: Began running node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m16:54:33.913079 [info ] [Thread-2 (]: 14 of 15 START test unique_bronze__orders_order_id ............................. [RUN]
[0m16:54:33.915612 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53, now test.retail.unique_bronze__orders_order_id.cd2f27ce5f)
[0m16:54:33.917061 [debug] [Thread-2 (]: Began compiling node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m16:54:33.921841 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"
[0m16:54:33.941557 [debug] [Thread-2 (]: Timing info for test.retail.unique_bronze__orders_order_id.cd2f27ce5f (compile): 16:54:33.917994 => 16:54:33.941087
[0m16:54:33.942550 [debug] [Thread-2 (]: Began executing node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m16:54:33.945534 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"
[0m16:54:33.969047 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:54:34.005721 [debug] [Thread-2 (]: On test.retail.unique_bronze__orders_order_id.cd2f27ce5f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:54:34.011345 [debug] [Thread-3 (]: Timing info for test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1 (execute): 16:54:32.580139 => 16:54:34.010894
[0m16:54:34.012916 [info ] [Thread-3 (]: 11 of 15 PASS source_unique_raw_csv_products_product_id ........................ [[32mPASS[0m in 1.46s]
[0m16:54:34.014244 [debug] [Thread-3 (]: Finished running node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m16:54:34.015576 [debug] [Thread-3 (]: Began running node test.retail.unique_bronze__users_user_id.129342c645
[0m16:54:34.016904 [info ] [Thread-3 (]: 15 of 15 START test unique_bronze__users_user_id ............................... [RUN]
[0m16:54:34.018617 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1, now test.retail.unique_bronze__users_user_id.129342c645)
[0m16:54:34.019618 [debug] [Thread-3 (]: Began compiling node test.retail.unique_bronze__users_user_id.129342c645
[0m16:54:34.024342 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.unique_bronze__users_user_id.129342c645"
[0m16:54:34.045629 [debug] [Thread-3 (]: Timing info for test.retail.unique_bronze__users_user_id.129342c645 (compile): 16:54:34.020321 => 16:54:34.045099
[0m16:54:34.046618 [debug] [Thread-3 (]: Began executing node test.retail.unique_bronze__users_user_id.129342c645
[0m16:54:34.050168 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.unique_bronze__users_user_id.129342c645"
[0m16:54:34.068423 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:54:34.107297 [debug] [Thread-1 (]: Timing info for test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8 (execute): 16:54:32.692519 => 16:54:34.106963
[0m16:54:34.107865 [debug] [Thread-3 (]: On test.retail.unique_bronze__users_user_id.129342c645: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_bronze__users_user_id.129342c645"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:54:34.108711 [info ] [Thread-1 (]: 12 of 15 PASS source_unique_raw_csv_sessions_session_id ........................ [[32mPASS[0m in 1.45s]
[0m16:54:34.113539 [debug] [Thread-1 (]: Finished running node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m16:54:34.605050 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:09a42fec-0586-48f7-8fdf-91b1d2b56673&page=queryresults
[0m16:54:34.766781 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:7892a5a2-46b9-4a39-b419-b65c51549273&page=queryresults
[0m16:54:34.833811 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:78cfac57-0238-44a8-9714-f5a337234b53&page=queryresults
[0m16:54:35.165479 [debug] [Thread-4 (]: Timing info for test.retail.source_unique_raw_csv_users_user_id.d8f871acc9 (execute): 16:54:33.696519 => 16:54:35.165201
[0m16:54:35.167116 [warn ] [Thread-4 (]: 13 of 15 WARN 5 source_unique_raw_csv_users_user_id ............................ [[33mWARN 5[0m in 1.50s]
[0m16:54:35.168694 [debug] [Thread-4 (]: Finished running node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m16:54:35.300753 [debug] [Thread-2 (]: Timing info for test.retail.unique_bronze__orders_order_id.cd2f27ce5f (execute): 16:54:33.943236 => 16:54:35.300448
[0m16:54:35.302521 [warn ] [Thread-2 (]: 14 of 15 WARN 25 unique_bronze__orders_order_id ................................ [[33mWARN 25[0m in 1.39s]
[0m16:54:35.303665 [debug] [Thread-2 (]: Finished running node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m16:54:35.363227 [debug] [Thread-3 (]: Timing info for test.retail.unique_bronze__users_user_id.129342c645 (execute): 16:54:34.047270 => 16:54:35.362899
[0m16:54:35.364620 [warn ] [Thread-3 (]: 15 of 15 WARN 5 unique_bronze__users_user_id ................................... [[33mWARN 5[0m in 1.35s]
[0m16:54:35.365766 [debug] [Thread-3 (]: Finished running node test.retail.unique_bronze__users_user_id.129342c645
[0m16:54:35.368886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:35.370038 [debug] [MainThread]: Connection 'test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8' was properly closed.
[0m16:54:35.371031 [debug] [MainThread]: Connection 'test.retail.unique_bronze__orders_order_id.cd2f27ce5f' was properly closed.
[0m16:54:35.371881 [debug] [MainThread]: Connection 'test.retail.unique_bronze__users_user_id.129342c645' was properly closed.
[0m16:54:35.372590 [debug] [MainThread]: Connection 'test.retail.source_unique_raw_csv_users_user_id.d8f871acc9' was properly closed.
[0m16:54:35.373289 [info ] [MainThread]: 
[0m16:54:35.374083 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 6.37 seconds (6.37s).
[0m16:54:35.376321 [debug] [MainThread]: Command end result
[0m16:54:35.422756 [info ] [MainThread]: 
[0m16:54:35.423895 [info ] [MainThread]: [33mCompleted with 5 warnings:[0m
[0m16:54:35.424701 [info ] [MainThread]: 
[0m16:54:35.425421 [warn ] [MainThread]: [33mWarning in test not_null_bronze__orders_order_created_at (models/bronze/schema.yml)[0m
[0m16:54:35.426041 [warn ] [MainThread]: Got 987 results, configured to warn if != 0
[0m16:54:35.426631 [info ] [MainThread]: 
[0m16:54:35.427190 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/schema.yml/not_null_bronze__orders_order_created_at.sql
[0m16:54:35.427765 [info ] [MainThread]: 
[0m16:54:35.428372 [warn ] [MainThread]: [33mWarning in test source_unique_raw_csv_orders_order_id (models/bronze/sources.yml)[0m
[0m16:54:35.428960 [warn ] [MainThread]: Got 25 results, configured to warn if != 0
[0m16:54:35.429789 [info ] [MainThread]: 
[0m16:54:35.430515 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/sources.yml/source_unique_raw_csv_orders_order_id.sql
[0m16:54:35.431283 [info ] [MainThread]: 
[0m16:54:35.432039 [warn ] [MainThread]: [33mWarning in test source_unique_raw_csv_users_user_id (models/bronze/sources.yml)[0m
[0m16:54:35.432861 [warn ] [MainThread]: Got 5 results, configured to warn if != 0
[0m16:54:35.433622 [info ] [MainThread]: 
[0m16:54:35.434197 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/sources.yml/source_unique_raw_csv_users_user_id.sql
[0m16:54:35.434840 [info ] [MainThread]: 
[0m16:54:35.435407 [warn ] [MainThread]: [33mWarning in test unique_bronze__orders_order_id (models/bronze/schema.yml)[0m
[0m16:54:35.435948 [warn ] [MainThread]: Got 25 results, configured to warn if != 0
[0m16:54:35.436536 [info ] [MainThread]: 
[0m16:54:35.437001 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/schema.yml/unique_bronze__orders_order_id.sql
[0m16:54:35.437533 [info ] [MainThread]: 
[0m16:54:35.437976 [warn ] [MainThread]: [33mWarning in test unique_bronze__users_user_id (models/bronze/schema.yml)[0m
[0m16:54:35.438592 [warn ] [MainThread]: Got 5 results, configured to warn if != 0
[0m16:54:35.439304 [info ] [MainThread]: 
[0m16:54:35.439921 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/schema.yml/unique_bronze__users_user_id.sql
[0m16:54:35.440511 [info ] [MainThread]: 
[0m16:54:35.441110 [info ] [MainThread]: Done. PASS=10 WARN=5 ERROR=0 SKIP=0 TOTAL=15
[0m16:54:35.442213 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 15.632754, "process_user_time": 4.756411, "process_kernel_time": 1.586823, "process_mem_max_rss": "239292", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:54:35.443034 [debug] [MainThread]: Command `dbt test` succeeded at 16:54:35.442902 after 15.63 seconds
[0m16:54:35.443612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e92327290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e64c99c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e67d9ee70>]}
[0m16:54:35.444253 [debug] [MainThread]: Flushing usage events
[0m16:54:39.897626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d67e0661160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d67e07d93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d67e0878b60>]}


============================== 16:54:39.904175 | 8a8f15f4-29d2-47f1-b310-d7cb750aa7ed ==============================
[0m16:54:39.904175 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:54:39.905127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/silver path:models/gold', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:54:40.785925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a8f15f4-29d2-47f1-b310-d7cb750aa7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d67e09595b0>]}
[0m16:54:40.859101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a8f15f4-29d2-47f1-b310-d7cb750aa7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d67b3ce0f20>]}
[0m16:54:40.860700 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:54:40.964042 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:54:48.227048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:54:48.228069 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:54:48.229039 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:54:48.236195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a8f15f4-29d2-47f1-b310-d7cb750aa7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d67b34bfa40>]}
[0m16:54:48.296114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a8f15f4-29d2-47f1-b310-d7cb750aa7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d67b30ee540>]}
[0m16:54:48.297734 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:54:48.299289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a8f15f4-29d2-47f1-b310-d7cb750aa7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d67b378ff80>]}
[0m16:54:48.322641 [info ] [MainThread]: 
[0m16:54:48.323944 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:54:48.325823 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m16:54:48.326572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:48.936071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod)
[0m16:54:48.937003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:49.463470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a8f15f4-29d2-47f1-b310-d7cb750aa7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d67b3b3f530>]}
[0m16:54:49.464894 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:54:49.466031 [info ] [MainThread]: 
[0m16:54:49.475097 [debug] [Thread-1 (]: Began running node model.retail.silver__orders_enriched
[0m16:54:49.476204 [info ] [Thread-1 (]: 1 of 2 START sql view model retail_prod.silver__orders_enriched ................ [RUN]
[0m16:54:49.477365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.silver__orders_enriched)
[0m16:54:49.478135 [debug] [Thread-1 (]: Began compiling node model.retail.silver__orders_enriched
[0m16:54:49.488097 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.silver__orders_enriched"
[0m16:54:49.507494 [debug] [Thread-1 (]: Timing info for model.retail.silver__orders_enriched (compile): 16:54:49.478806 => 16:54:49.507128
[0m16:54:49.508644 [debug] [Thread-1 (]: Began executing node model.retail.silver__orders_enriched
[0m16:54:49.533402 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.silver__orders_enriched"
[0m16:54:49.557415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:49.595942 [debug] [Thread-1 (]: On model.retail.silver__orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.silver__orders_enriched"} */


  create or replace view `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
  OPTIONS()
  as with orders as (
  select *
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
),
users as (
  select *
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
),
joined as (
  select
    o.order_id,
    o.user_id,
    o.order_created_at,
    o.order_created_at_parse_failed,
    date(o.order_created_at) as order_date,
    o.total_amount,
    o.payment_method,
    o.order_status,
    o.branch,
    u.full_name,
    u.email,
    u.phone,
    u.city as user_city,
    u.created_at as user_created_at,
    u.created_at_parse_failed as user_created_at_parse_failed
  from orders o
  left join users u using (user_id)
)

select *
from joined;


[0m16:54:50.213392 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:c973ad5c-08ef-4385-8a0c-1df4b53cdb3d&page=queryresults
[0m16:54:50.546842 [debug] [Thread-1 (]: Timing info for model.retail.silver__orders_enriched (execute): 16:54:49.509558 => 16:54:50.546583
[0m16:54:50.548164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8f15f4-29d2-47f1-b310-d7cb750aa7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d67b34bc440>]}
[0m16:54:50.549481 [info ] [Thread-1 (]: 1 of 2 OK created sql view model retail_prod.silver__orders_enriched ........... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m16:54:50.550681 [debug] [Thread-1 (]: Finished running node model.retail.silver__orders_enriched
[0m16:54:50.552130 [debug] [Thread-3 (]: Began running node model.retail.gold__daily_branch_metrics
[0m16:54:50.553073 [info ] [Thread-3 (]: 2 of 2 START sql table model retail_prod.gold__daily_branch_metrics ............ [RUN]
[0m16:54:50.554357 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.retail.gold__daily_branch_metrics'
[0m16:54:50.555076 [debug] [Thread-3 (]: Began compiling node model.retail.gold__daily_branch_metrics
[0m16:54:50.558055 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail.gold__daily_branch_metrics"
[0m16:54:50.576427 [debug] [Thread-3 (]: Timing info for model.retail.gold__daily_branch_metrics (compile): 16:54:50.555742 => 16:54:50.576076
[0m16:54:50.577261 [debug] [Thread-3 (]: Began executing node model.retail.gold__daily_branch_metrics
[0m16:54:50.586030 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:54:51.103360 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail.gold__daily_branch_metrics"
[0m16:54:51.122917 [debug] [Thread-3 (]: On model.retail.gold__daily_branch_metrics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.gold__daily_branch_metrics"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`gold__daily_branch_metrics`
      
    
    

    OPTIONS()
    as (
      with fact_orders as (
  select *
  from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
  where order_created_at is not null
),
aggregated as (
  select
    order_date,
    branch,
    count(distinct order_id) as orders_count,
    count(distinct user_id) as customers_count,
    sum(case when order_status = 'completed' then total_amount else 0 end) as completed_revenue,
    sum(case when order_status != 'completed' then total_amount else 0 end) as non_completed_revenue,
    sum(total_amount) as gross_revenue
  from fact_orders
  group by order_date, branch
)

select *
from aggregated
    );
  
[0m16:54:51.894617 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:8b14cba7-caa2-4cfa-a3aa-16ffcea87232&page=queryresults
[0m16:54:54.163637 [debug] [Thread-3 (]: Timing info for model.retail.gold__daily_branch_metrics (execute): 16:54:50.577957 => 16:54:54.163398
[0m16:54:54.165099 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8f15f4-29d2-47f1-b310-d7cb750aa7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d67b31812e0>]}
[0m16:54:54.166575 [info ] [Thread-3 (]: 2 of 2 OK created sql table model retail_prod.gold__daily_branch_metrics ....... [[32mCREATE TABLE (3.7k rows, 360.2 KiB processed)[0m in 3.61s]
[0m16:54:54.168237 [debug] [Thread-3 (]: Finished running node model.retail.gold__daily_branch_metrics
[0m16:54:54.172432 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:54.173401 [debug] [MainThread]: Connection 'model.retail.silver__orders_enriched' was properly closed.
[0m16:54:54.174123 [debug] [MainThread]: Connection 'model.retail.gold__daily_branch_metrics' was properly closed.
[0m16:54:54.175104 [info ] [MainThread]: 
[0m16:54:54.176092 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.85 seconds (5.85s).
[0m16:54:54.179652 [debug] [MainThread]: Command end result
[0m16:54:54.226669 [info ] [MainThread]: 
[0m16:54:54.228120 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:54:54.229299 [info ] [MainThread]: 
[0m16:54:54.230438 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:54:54.232380 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.410453, "process_user_time": 3.667019, "process_kernel_time": 1.426063, "process_mem_max_rss": "236696", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:54:54.233587 [debug] [MainThread]: Command `dbt run` succeeded at 16:54:54.233347 after 14.41 seconds
[0m16:54:54.234644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d67e058d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d67b3750080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d67b3753c80>]}
[0m16:54:54.235586 [debug] [MainThread]: Flushing usage events
[0m16:54:59.666700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756a49fdcda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756a4a319b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756a4a208bc0>]}


============================== 16:54:59.672902 | 38a6a545-922f-4a8b-b81e-4501e71a1de2 ==============================
[0m16:54:59.672902 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:54:59.673908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/silver path:models/gold', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:55:00.718360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38a6a545-922f-4a8b-b81e-4501e71a1de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756a1d114a10>]}
[0m16:55:00.817450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38a6a545-922f-4a8b-b81e-4501e71a1de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756a49fc91c0>]}
[0m16:55:00.819058 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:55:00.942895 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:55:08.013151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:08.013807 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:08.014899 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:55:08.020425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38a6a545-922f-4a8b-b81e-4501e71a1de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756a1d015fa0>]}
[0m16:55:08.072677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38a6a545-922f-4a8b-b81e-4501e71a1de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756a1ca79f40>]}
[0m16:55:08.073865 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:55:08.074778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38a6a545-922f-4a8b-b81e-4501e71a1de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756a1d24e9f0>]}
[0m16:55:08.089086 [info ] [MainThread]: 
[0m16:55:08.090562 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:55:08.092722 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev_retail_prod'
[0m16:55:08.093614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:08.589865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38a6a545-922f-4a8b-b81e-4501e71a1de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756a1d24e570>]}
[0m16:55:08.591179 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:55:08.592428 [info ] [MainThread]: 
[0m16:55:08.601611 [debug] [Thread-1 (]: Began running node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m16:55:08.602393 [debug] [Thread-2 (]: Began running node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m16:55:08.603451 [debug] [Thread-3 (]: Began running node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m16:55:08.604284 [info ] [Thread-1 (]: 1 of 5 START test not_null_gold__daily_branch_metrics_branch ................... [RUN]
[0m16:55:08.605346 [debug] [Thread-4 (]: Began running node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m16:55:08.606011 [info ] [Thread-2 (]: 2 of 5 START test not_null_gold__daily_branch_metrics_order_date ............... [RUN]
[0m16:55:08.606824 [info ] [Thread-3 (]: 3 of 5 START test not_null_silver__orders_enriched_order_date .................. [RUN]
[0m16:55:08.607713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761)
[0m16:55:08.608386 [info ] [Thread-4 (]: 4 of 5 START test not_null_silver__orders_enriched_order_id .................... [RUN]
[0m16:55:08.609363 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948'
[0m16:55:08.610323 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.retail.not_null_silver__orders_enriched_order_date.658d753d80'
[0m16:55:08.610959 [debug] [Thread-1 (]: Began compiling node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m16:55:08.611815 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.retail.not_null_silver__orders_enriched_order_id.782515c964'
[0m16:55:08.612411 [debug] [Thread-2 (]: Began compiling node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m16:55:08.612970 [debug] [Thread-3 (]: Began compiling node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m16:55:08.624419 [debug] [Thread-4 (]: Began compiling node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m16:55:08.628710 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761"
[0m16:55:08.633195 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948"
[0m16:55:08.638899 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.not_null_silver__orders_enriched_order_date.658d753d80"
[0m16:55:08.644307 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.not_null_silver__orders_enriched_order_id.782515c964"
[0m16:55:08.659050 [debug] [Thread-1 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761 (compile): 16:55:08.613411 => 16:55:08.658595
[0m16:55:08.660572 [debug] [Thread-1 (]: Began executing node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m16:55:08.673582 [debug] [Thread-3 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_date.658d753d80 (compile): 16:55:08.634370 => 16:55:08.673116
[0m16:55:08.679953 [debug] [Thread-3 (]: Began executing node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m16:55:08.680904 [debug] [Thread-2 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948 (compile): 16:55:08.630089 => 16:55:08.680622
[0m16:55:08.684323 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761"
[0m16:55:08.689388 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.not_null_silver__orders_enriched_order_date.658d753d80"
[0m16:55:08.690154 [debug] [Thread-2 (]: Began executing node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m16:55:08.690973 [debug] [Thread-4 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_id.782515c964 (compile): 16:55:08.640165 => 16:55:08.690620
[0m16:55:08.695725 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948"
[0m16:55:08.696903 [debug] [Thread-4 (]: Began executing node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m16:55:08.701288 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.not_null_silver__orders_enriched_order_id.782515c964"
[0m16:55:08.707951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:08.709242 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:55:08.711372 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:55:08.712875 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:55:08.812862 [debug] [Thread-3 (]: On test.retail.not_null_silver__orders_enriched_order_date.658d753d80: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_silver__orders_enriched_order_date.658d753d80"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
where order_date is null



      
    ) dbt_internal_test
[0m16:55:08.814038 [debug] [Thread-1 (]: On test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select branch
from `retail-data-pipeline-dev`.`retail_prod`.`gold__daily_branch_metrics`
where branch is null



      
    ) dbt_internal_test
[0m16:55:08.817366 [debug] [Thread-2 (]: On test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from `retail-data-pipeline-dev`.`retail_prod`.`gold__daily_branch_metrics`
where order_date is null



      
    ) dbt_internal_test
[0m16:55:08.860687 [debug] [Thread-4 (]: On test.retail.not_null_silver__orders_enriched_order_id.782515c964: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_silver__orders_enriched_order_id.782515c964"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
where order_id is null



      
    ) dbt_internal_test
[0m16:55:09.542797 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:95439a1e-f1fc-4313-8ef4-e967b5dd51d5&page=queryresults
[0m16:55:09.597513 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:8e0f3e3d-7bff-4dd2-8f2b-de67d6bba292&page=queryresults
[0m16:55:10.014764 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:f32e8850-0817-4597-aed2-533e4288a19e&page=queryresults
[0m16:55:10.018592 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:87d6d02a-f378-4133-94da-6e080fd40914&page=queryresults
[0m16:55:10.211923 [debug] [Thread-2 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948 (execute): 16:55:08.692895 => 16:55:10.211587
[0m16:55:10.212884 [debug] [Thread-1 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761 (execute): 16:55:08.661496 => 16:55:10.212635
[0m16:55:10.214057 [info ] [Thread-2 (]: 2 of 5 PASS not_null_gold__daily_branch_metrics_order_date ..................... [[32mPASS[0m in 1.60s]
[0m16:55:10.215832 [info ] [Thread-1 (]: 1 of 5 PASS not_null_gold__daily_branch_metrics_branch ......................... [[32mPASS[0m in 1.61s]
[0m16:55:10.216775 [debug] [Thread-2 (]: Finished running node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m16:55:10.217547 [debug] [Thread-1 (]: Finished running node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m16:55:10.218653 [debug] [Thread-2 (]: Began running node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m16:55:10.220288 [info ] [Thread-2 (]: 5 of 5 START test unique_silver__orders_enriched_order_id ...................... [RUN]
[0m16:55:10.221552 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948, now test.retail.unique_silver__orders_enriched_order_id.761e0577f3)
[0m16:55:10.222522 [debug] [Thread-2 (]: Began compiling node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m16:55:10.230298 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.unique_silver__orders_enriched_order_id.761e0577f3"
[0m16:55:10.249023 [debug] [Thread-2 (]: Timing info for test.retail.unique_silver__orders_enriched_order_id.761e0577f3 (compile): 16:55:10.223025 => 16:55:10.248655
[0m16:55:10.249926 [debug] [Thread-2 (]: Began executing node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m16:55:10.252563 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.unique_silver__orders_enriched_order_id.761e0577f3"
[0m16:55:10.273782 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:55:10.308608 [debug] [Thread-2 (]: On test.retail.unique_silver__orders_enriched_order_id.761e0577f3: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_silver__orders_enriched_order_id.761e0577f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:55:10.640438 [debug] [Thread-3 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_date.658d753d80 (execute): 16:55:08.684846 => 16:55:10.640166
[0m16:55:10.642033 [warn ] [Thread-3 (]: 3 of 5 WARN 993 not_null_silver__orders_enriched_order_date .................... [[33mWARN 993[0m in 2.03s]
[0m16:55:10.643556 [debug] [Thread-3 (]: Finished running node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m16:55:10.688252 [debug] [Thread-4 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_id.782515c964 (execute): 16:55:08.698391 => 16:55:10.687935
[0m16:55:10.689622 [info ] [Thread-4 (]: 4 of 5 PASS not_null_silver__orders_enriched_order_id .......................... [[32mPASS[0m in 2.08s]
[0m16:55:10.690805 [debug] [Thread-4 (]: Finished running node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m16:55:11.947945 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:8fa9e63a-ebc2-4bd4-b6fb-52c711e81fdd&page=queryresults
[0m16:55:12.498327 [debug] [Thread-2 (]: Timing info for test.retail.unique_silver__orders_enriched_order_id.761e0577f3 (execute): 16:55:10.250595 => 16:55:12.498020
[0m16:55:12.499593 [warn ] [Thread-2 (]: 5 of 5 WARN 50 unique_silver__orders_enriched_order_id ......................... [[33mWARN 50[0m in 2.28s]
[0m16:55:12.500554 [debug] [Thread-2 (]: Finished running node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m16:55:12.503661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:12.504591 [debug] [MainThread]: Connection 'test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761' was properly closed.
[0m16:55:12.505271 [debug] [MainThread]: Connection 'test.retail.unique_silver__orders_enriched_order_id.761e0577f3' was properly closed.
[0m16:55:12.505864 [debug] [MainThread]: Connection 'test.retail.not_null_silver__orders_enriched_order_date.658d753d80' was properly closed.
[0m16:55:12.506419 [debug] [MainThread]: Connection 'test.retail.not_null_silver__orders_enriched_order_id.782515c964' was properly closed.
[0m16:55:12.507187 [info ] [MainThread]: 
[0m16:55:12.507933 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 4.42 seconds (4.42s).
[0m16:55:12.509164 [debug] [MainThread]: Command end result
[0m16:55:12.550574 [info ] [MainThread]: 
[0m16:55:12.551932 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m16:55:12.552854 [info ] [MainThread]: 
[0m16:55:12.553500 [warn ] [MainThread]: [33mWarning in test not_null_silver__orders_enriched_order_date (models/silver/schema.yml)[0m
[0m16:55:12.554137 [warn ] [MainThread]: Got 993 results, configured to warn if != 0
[0m16:55:12.554728 [info ] [MainThread]: 
[0m16:55:12.555230 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/silver/schema.yml/not_null_silver__orders_enriched_order_date.sql
[0m16:55:12.555774 [info ] [MainThread]: 
[0m16:55:12.556336 [warn ] [MainThread]: [33mWarning in test unique_silver__orders_enriched_order_id (models/silver/schema.yml)[0m
[0m16:55:12.556939 [warn ] [MainThread]: Got 50 results, configured to warn if != 0
[0m16:55:12.557651 [info ] [MainThread]: 
[0m16:55:12.558326 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/silver/schema.yml/unique_silver__orders_enriched_order_id.sql
[0m16:55:12.558874 [info ] [MainThread]: 
[0m16:55:12.559507 [info ] [MainThread]: Done. PASS=3 WARN=2 ERROR=0 SKIP=0 TOTAL=5
[0m16:55:12.560623 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.947063, "process_user_time": 4.3131, "process_kernel_time": 1.526111, "process_mem_max_rss": "236592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:55:12.561310 [debug] [MainThread]: Command `dbt test` succeeded at 16:55:12.561176 after 12.95 seconds
[0m16:55:12.562266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756a4a109340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756a1d340b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756a4addc440>]}
[0m16:55:12.563761 [debug] [MainThread]: Flushing usage events
[0m16:56:37.952651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c726e2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c7293d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c7290dfa0>]}


============================== 16:56:37.959645 | 36b6c28f-77b8-40cd-8f47-d37a3f8c3571 ==============================
[0m16:56:37.959645 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:56:37.960739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:56:38.066488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36b6c28f-77b8-40cd-8f47-d37a3f8c3571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c738ac800>]}
[0m16:56:39.391159 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-9n_1y3mi'
[0m16:56:39.392289 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:56:39.597806 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:56:39.599159 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:56:39.687567 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:56:39.691424 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m16:56:39.824954 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m16:56:39.831378 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m16:56:40.428368 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m16:56:40.431642 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:56:47.926377 [info ] [MainThread]: Installed from version 1.3.1
[0m16:56:47.927345 [info ] [MainThread]: Up to date!
[0m16:56:47.928200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '36b6c28f-77b8-40cd-8f47-d37a3f8c3571', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c72471910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c72471880>]}
[0m16:56:47.928843 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m16:56:53.909761 [info ] [MainThread]: Installed from version 0.10.9
[0m16:56:53.910583 [info ] [MainThread]: Up to date!
[0m16:56:53.911339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '36b6c28f-77b8-40cd-8f47-d37a3f8c3571', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c7248d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c7248d700>]}
[0m16:56:53.911884 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m16:56:56.490224 [info ] [MainThread]: Installed from version 0.15.0
[0m16:56:56.491086 [info ] [MainThread]: Up to date!
[0m16:56:56.491751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '36b6c28f-77b8-40cd-8f47-d37a3f8c3571', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c7248dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c7248db80>]}
[0m16:56:56.493663 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 18.63693, "process_user_time": 2.795922, "process_kernel_time": 0.709052, "process_mem_max_rss": "208924", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m16:56:56.494613 [debug] [MainThread]: Command `dbt deps` succeeded at 16:56:56.494438 after 18.64 seconds
[0m16:56:56.495356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c7293f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c76ee5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c72570b90>]}
[0m16:56:56.496063 [debug] [MainThread]: Flushing usage events
[0m16:57:01.348902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710b15b6d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710b15c64bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710b15aea960>]}


============================== 16:57:01.355401 | fe74f95f-40c5-41f0-acf0-dff2cde3a9f9 ==============================
[0m16:57:01.355401 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:57:01.356757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'send_anonymous_usage_stats': 'True'}
[0m16:57:02.408621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe74f95f-40c5-41f0-acf0-dff2cde3a9f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710aeca18800>]}
[0m16:57:02.477471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe74f95f-40c5-41f0-acf0-dff2cde3a9f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710aed0274a0>]}
[0m16:57:02.479268 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:57:02.572940 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:57:10.521011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:57:10.521989 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:57:10.523551 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:57:10.529602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe74f95f-40c5-41f0-acf0-dff2cde3a9f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710aecae3c80>]}
[0m16:57:10.585632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe74f95f-40c5-41f0-acf0-dff2cde3a9f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710aec575af0>]}
[0m16:57:10.586820 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:57:10.587831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe74f95f-40c5-41f0-acf0-dff2cde3a9f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710aeca72330>]}
[0m16:57:10.596626 [info ] [MainThread]: 
[0m16:57:10.598693 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:57:10.601263 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m16:57:10.602357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:11.255706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod)
[0m16:57:11.256847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:11.793346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe74f95f-40c5-41f0-acf0-dff2cde3a9f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710aece0a870>]}
[0m16:57:11.795701 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:57:11.797107 [info ] [MainThread]: 
[0m16:57:11.813521 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m16:57:11.814612 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m16:57:11.816324 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod.bronze__orders ........................ [RUN]
[0m16:57:11.818724 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod.bronze__users ......................... [RUN]
[0m16:57:11.821089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.bronze__orders)
[0m16:57:11.823615 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m16:57:11.825402 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m16:57:11.827245 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m16:57:11.855842 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m16:57:11.863455 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m16:57:11.881487 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 16:57:11.828557 => 16:57:11.880826
[0m16:57:11.883997 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m16:57:11.892766 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 16:57:11.847904 => 16:57:11.892145
[0m16:57:11.899138 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m16:57:11.926203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:11.928132 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:57:12.517256 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m16:57:12.518657 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m16:57:12.530814 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe.parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m16:57:12.533749 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe.parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m16:57:12.937354 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:f78ae377-49be-42d3-b6c5-c14617d5d9eb&page=queryresults
[0m16:57:12.959823 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:05f96491-8ecc-495d-9c68-baf2d7f971ef&page=queryresults
[0m16:57:14.991370 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 16:57:11.886584 => 16:57:14.991138
[0m16:57:14.993010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe74f95f-40c5-41f0-acf0-dff2cde3a9f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710aec5fd1f0>]}
[0m16:57:14.994210 [info ] [Thread-1 (]: 1 of 2 OK created sql table model retail_prod.bronze__orders ................... [[32mCREATE TABLE (5.0k rows, 414.1 KiB processed)[0m in 3.17s]
[0m16:57:14.995611 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m16:57:16.372083 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 16:57:11.906361 => 16:57:16.371835
[0m16:57:16.373401 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe74f95f-40c5-41f0-acf0-dff2cde3a9f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710aec5f4bc0>]}
[0m16:57:16.374411 [info ] [Thread-2 (]: 2 of 2 OK created sql table model retail_prod.bronze__users .................... [[32mCREATE TABLE (1.0k rows, 107.1 KiB processed)[0m in 4.55s]
[0m16:57:16.375438 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m16:57:16.378502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:16.379292 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m16:57:16.380048 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m16:57:16.380701 [info ] [MainThread]: 
[0m16:57:16.381386 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.78 seconds (5.78s).
[0m16:57:16.382383 [debug] [MainThread]: Command end result
[0m16:57:16.422326 [info ] [MainThread]: 
[0m16:57:16.423532 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:57:16.424201 [info ] [MainThread]: 
[0m16:57:16.424909 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:57:16.426228 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.110262, "process_user_time": 4.229486, "process_kernel_time": 1.587584, "process_mem_max_rss": "236516", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:57:16.426996 [debug] [MainThread]: Command `dbt run` succeeded at 16:57:16.426844 after 15.11 seconds
[0m16:57:16.427637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710b15b85b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710aecc44b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710b16206a50>]}
[0m16:57:16.428222 [debug] [MainThread]: Flushing usage events
[0m16:57:21.262706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c442029670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c4422ad5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c442029370>]}


============================== 16:57:21.268689 | 3dd4bfb3-9c1a-467e-a17e-79ddd0593bbc ==============================
[0m16:57:21.268689 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:57:21.270295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/retail', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:57:22.320496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3dd4bfb3-9c1a-467e-a17e-79ddd0593bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c415a726c0>]}
[0m16:57:22.405345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3dd4bfb3-9c1a-467e-a17e-79ddd0593bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c415582330>]}
[0m16:57:22.407036 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:57:22.531713 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:57:30.218856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:57:30.220004 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:57:30.221300 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:57:30.226602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3dd4bfb3-9c1a-467e-a17e-79ddd0593bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c415020440>]}
[0m16:57:30.294072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3dd4bfb3-9c1a-467e-a17e-79ddd0593bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c414ab9790>]}
[0m16:57:30.295289 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:57:30.296235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dd4bfb3-9c1a-467e-a17e-79ddd0593bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c414ab96a0>]}
[0m16:57:30.307494 [info ] [MainThread]: 
[0m16:57:30.309011 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:57:30.310944 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev_retail_prod'
[0m16:57:30.311760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:30.814922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dd4bfb3-9c1a-467e-a17e-79ddd0593bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c414ab9250>]}
[0m16:57:30.816335 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:57:30.817093 [info ] [MainThread]: 
[0m16:57:30.826240 [debug] [Thread-1 (]: Began running node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m16:57:30.826931 [debug] [Thread-2 (]: Began running node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m16:57:30.827776 [debug] [Thread-3 (]: Began running node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:57:30.828387 [debug] [Thread-4 (]: Began running node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:57:30.827408 [info ] [Thread-1 (]: 1 of 15 START test not_null_bronze__orders_order_created_at .................... [RUN]
[0m16:57:30.828963 [info ] [Thread-2 (]: 2 of 15 START test not_null_bronze__orders_order_id ............................ [RUN]
[0m16:57:30.829857 [info ] [Thread-3 (]: 3 of 15 START test not_null_bronze__users_email ................................ [RUN]
[0m16:57:30.831089 [info ] [Thread-4 (]: 4 of 15 START test not_null_bronze__users_user_id .............................. [RUN]
[0m16:57:30.832441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now test.retail.not_null_bronze__orders_order_created_at.05e711bf75)
[0m16:57:30.833574 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__orders_order_id.4b38fb230a'
[0m16:57:30.834948 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__users_email.2bec59e73f'
[0m16:57:30.835956 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__users_user_id.cb91e05164'
[0m16:57:30.836673 [debug] [Thread-1 (]: Began compiling node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m16:57:30.837368 [debug] [Thread-2 (]: Began compiling node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m16:57:30.838001 [debug] [Thread-3 (]: Began compiling node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:57:30.838792 [debug] [Thread-4 (]: Began compiling node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:57:30.852583 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"
[0m16:57:30.856171 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.not_null_bronze__orders_order_id.4b38fb230a"
[0m16:57:30.860406 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.not_null_bronze__users_email.2bec59e73f"
[0m16:57:30.866194 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.not_null_bronze__users_user_id.cb91e05164"
[0m16:57:30.877616 [debug] [Thread-1 (]: Timing info for test.retail.not_null_bronze__orders_order_created_at.05e711bf75 (compile): 16:57:30.839322 => 16:57:30.877058
[0m16:57:30.878819 [debug] [Thread-1 (]: Began executing node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m16:57:30.879924 [debug] [Thread-3 (]: Timing info for test.retail.not_null_bronze__users_email.2bec59e73f (compile): 16:57:30.857014 => 16:57:30.879514
[0m16:57:30.892107 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__users_user_id.cb91e05164 (compile): 16:57:30.861342 => 16:57:30.891788
[0m16:57:30.892623 [debug] [Thread-2 (]: Timing info for test.retail.not_null_bronze__orders_order_id.4b38fb230a (compile): 16:57:30.852957 => 16:57:30.892391
[0m16:57:30.893004 [debug] [Thread-3 (]: Began executing node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:57:30.901025 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"
[0m16:57:30.901553 [debug] [Thread-4 (]: Began executing node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:57:30.902654 [debug] [Thread-2 (]: Began executing node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m16:57:30.905359 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.not_null_bronze__users_email.2bec59e73f"
[0m16:57:30.908673 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.not_null_bronze__users_user_id.cb91e05164"
[0m16:57:30.911902 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.not_null_bronze__orders_order_id.4b38fb230a"
[0m16:57:30.923344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:30.926152 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:57:30.927257 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:57:30.927746 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:57:30.961632 [debug] [Thread-1 (]: On test.retail.not_null_bronze__orders_order_created_at.05e711bf75: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_created_at
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
where order_created_at is null



      
    ) dbt_internal_test
[0m16:57:30.998227 [debug] [Thread-4 (]: On test.retail.not_null_bronze__users_user_id.cb91e05164: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__users_user_id.cb91e05164"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
where user_id is null



      
    ) dbt_internal_test
[0m16:57:31.034118 [debug] [Thread-3 (]: On test.retail.not_null_bronze__users_email.2bec59e73f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__users_email.2bec59e73f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
where email is null



      
    ) dbt_internal_test
[0m16:57:31.069940 [debug] [Thread-2 (]: On test.retail.not_null_bronze__orders_order_id.4b38fb230a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__orders_order_id.4b38fb230a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
where order_id is null



      
    ) dbt_internal_test
[0m16:57:31.754212 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:98a4c50d-398f-4b1c-8be4-29bf55c77440&page=queryresults
[0m16:57:31.787421 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:d79ee675-3061-4e89-8cd3-1bca4442644b&page=queryresults
[0m16:57:31.804428 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:d21a5324-de65-4f31-8e6c-86f5832b082d&page=queryresults
[0m16:57:31.821069 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:803b2f05-0ff2-4667-b7e1-c8eb15533ff5&page=queryresults
[0m16:57:32.294427 [debug] [Thread-2 (]: Timing info for test.retail.not_null_bronze__orders_order_id.4b38fb230a (execute): 16:57:30.909414 => 16:57:32.294139
[0m16:57:32.295860 [info ] [Thread-2 (]: 2 of 15 PASS not_null_bronze__orders_order_id .................................. [[32mPASS[0m in 1.46s]
[0m16:57:32.297591 [debug] [Thread-2 (]: Finished running node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m16:57:32.298664 [debug] [Thread-1 (]: Timing info for test.retail.not_null_bronze__orders_order_created_at.05e711bf75 (execute): 16:57:30.880649 => 16:57:32.298440
[0m16:57:32.299191 [debug] [Thread-2 (]: Began running node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m16:57:32.300593 [warn ] [Thread-1 (]: 1 of 15 WARN 987 not_null_bronze__orders_order_created_at ...................... [[33mWARN 987[0m in 1.47s]
[0m16:57:32.301549 [info ] [Thread-2 (]: 5 of 15 START test source_not_null_raw_csv_order_items_order_id ................ [RUN]
[0m16:57:32.302636 [debug] [Thread-1 (]: Finished running node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m16:57:32.304247 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__orders_order_id.4b38fb230a, now test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2)
[0m16:57:32.305612 [debug] [Thread-1 (]: Began running node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m16:57:32.306733 [debug] [Thread-2 (]: Began compiling node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m16:57:32.307806 [info ] [Thread-1 (]: 6 of 15 START test source_not_null_raw_csv_orders_order_id ..................... [RUN]
[0m16:57:32.312715 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"
[0m16:57:32.314332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__orders_order_created_at.05e711bf75, now test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336)
[0m16:57:32.316215 [debug] [Thread-1 (]: Began compiling node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m16:57:32.321068 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"
[0m16:57:32.329413 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2 (compile): 16:57:32.308741 => 16:57:32.328876
[0m16:57:32.330463 [debug] [Thread-2 (]: Began executing node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m16:57:32.331411 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336 (compile): 16:57:32.317207 => 16:57:32.330940
[0m16:57:32.334746 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"
[0m16:57:32.336153 [debug] [Thread-1 (]: Began executing node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m16:57:32.342302 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"
[0m16:57:32.349192 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:57:32.350869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:32.385371 [debug] [Thread-3 (]: Timing info for test.retail.not_null_bronze__users_email.2bec59e73f (execute): 16:57:30.903431 => 16:57:32.385050
[0m16:57:32.387700 [debug] [Thread-2 (]: On test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_raw`.`order_items`
where order_id is null



      
    ) dbt_internal_test
[0m16:57:32.387200 [info ] [Thread-3 (]: 3 of 15 PASS not_null_bronze__users_email ...................................... [[32mPASS[0m in 1.55s]
[0m16:57:32.423736 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__users_user_id.cb91e05164 (execute): 16:57:30.906533 => 16:57:32.423276
[0m16:57:32.427461 [debug] [Thread-1 (]: On test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_raw`.`orders`
where order_id is null



      
    ) dbt_internal_test
[0m16:57:32.428443 [debug] [Thread-3 (]: Finished running node test.retail.not_null_bronze__users_email.2bec59e73f
[0m16:57:32.429928 [info ] [Thread-4 (]: 4 of 15 PASS not_null_bronze__users_user_id .................................... [[32mPASS[0m in 1.59s]
[0m16:57:32.434487 [debug] [Thread-3 (]: Began running node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m16:57:32.435906 [debug] [Thread-4 (]: Finished running node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m16:57:32.436863 [info ] [Thread-3 (]: 7 of 15 START test source_not_null_raw_csv_products_product_id ................. [RUN]
[0m16:57:32.437818 [debug] [Thread-4 (]: Began running node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m16:57:32.439367 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__users_email.2bec59e73f, now test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6)
[0m16:57:32.440988 [info ] [Thread-4 (]: 8 of 15 START test source_not_null_raw_csv_sessions_session_id ................. [RUN]
[0m16:57:32.442142 [debug] [Thread-3 (]: Began compiling node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m16:57:32.443329 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__users_user_id.cb91e05164, now test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194)
[0m16:57:32.451669 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"
[0m16:57:32.453790 [debug] [Thread-4 (]: Began compiling node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m16:57:32.464384 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"
[0m16:57:32.482252 [debug] [Thread-3 (]: Timing info for test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6 (compile): 16:57:32.444044 => 16:57:32.481646
[0m16:57:32.483737 [debug] [Thread-3 (]: Began executing node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m16:57:32.485241 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194 (compile): 16:57:32.456954 => 16:57:32.484711
[0m16:57:32.488527 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"
[0m16:57:32.490390 [debug] [Thread-4 (]: Began executing node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m16:57:32.494321 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"
[0m16:57:32.507468 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:57:32.511971 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:57:32.549305 [debug] [Thread-3 (]: On test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `retail-data-pipeline-dev`.`retail_raw`.`products`
where product_id is null



      
    ) dbt_internal_test
[0m16:57:32.588627 [debug] [Thread-4 (]: On test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from `retail-data-pipeline-dev`.`retail_raw`.`sessions`
where session_id is null



      
    ) dbt_internal_test
[0m16:57:33.167334 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:a4370ac0-7566-433b-9b26-25ce8949e910&page=queryresults
[0m16:57:33.183903 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:a63e2f54-ba6c-4a2b-a896-42cace50f803&page=queryresults
[0m16:57:33.269233 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:ee1341de-7c14-4184-ac06-d08f27024080&page=queryresults
[0m16:57:33.288414 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:a5badd70-e024-41e0-9af6-999c297b0eb1&page=queryresults
[0m16:57:33.702840 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2 (execute): 16:57:32.331806 => 16:57:33.702494
[0m16:57:33.704367 [info ] [Thread-2 (]: 5 of 15 PASS source_not_null_raw_csv_order_items_order_id ...................... [[32mPASS[0m in 1.40s]
[0m16:57:33.705573 [debug] [Thread-2 (]: Finished running node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m16:57:33.706628 [debug] [Thread-2 (]: Began running node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m16:57:33.707448 [info ] [Thread-2 (]: 9 of 15 START test source_not_null_raw_csv_users_user_id ....................... [RUN]
[0m16:57:33.708595 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2, now test.retail.source_not_null_raw_csv_users_user_id.3380c1257d)
[0m16:57:33.709372 [debug] [Thread-2 (]: Began compiling node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m16:57:33.713892 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"
[0m16:57:33.720261 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336 (execute): 16:57:32.337553 => 16:57:33.719956
[0m16:57:33.721427 [info ] [Thread-1 (]: 6 of 15 PASS source_not_null_raw_csv_orders_order_id ........................... [[32mPASS[0m in 1.41s]
[0m16:57:33.722435 [debug] [Thread-1 (]: Finished running node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m16:57:33.723244 [debug] [Thread-1 (]: Began running node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m16:57:33.724148 [info ] [Thread-1 (]: 10 of 15 START test source_unique_raw_csv_orders_order_id ...................... [RUN]
[0m16:57:33.725592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336, now test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53)
[0m16:57:33.726314 [debug] [Thread-1 (]: Began compiling node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m16:57:33.735410 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"
[0m16:57:33.738134 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_users_user_id.3380c1257d (compile): 16:57:33.709980 => 16:57:33.737686
[0m16:57:33.739263 [debug] [Thread-2 (]: Began executing node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m16:57:33.741842 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"
[0m16:57:33.745132 [debug] [Thread-1 (]: Timing info for test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53 (compile): 16:57:33.726918 => 16:57:33.744642
[0m16:57:33.746101 [debug] [Thread-1 (]: Began executing node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m16:57:33.748997 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"
[0m16:57:33.759432 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:57:33.762333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:33.803740 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194 (execute): 16:57:32.491773 => 16:57:33.803404
[0m16:57:33.804383 [debug] [Thread-2 (]: On test.retail.source_not_null_raw_csv_users_user_id.3380c1257d: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `retail-data-pipeline-dev`.`retail_raw`.`users`
where user_id is null



      
    ) dbt_internal_test
[0m16:57:33.805884 [info ] [Thread-4 (]: 8 of 15 PASS source_not_null_raw_csv_sessions_session_id ....................... [[32mPASS[0m in 1.36s]
[0m16:57:33.807243 [debug] [Thread-3 (]: Timing info for test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6 (execute): 16:57:32.485891 => 16:57:33.806917
[0m16:57:33.810715 [debug] [Thread-4 (]: Finished running node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m16:57:33.850506 [debug] [Thread-1 (]: On test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:57:33.849354 [info ] [Thread-3 (]: 7 of 15 PASS source_not_null_raw_csv_products_product_id ....................... [[32mPASS[0m in 1.41s]
[0m16:57:33.851545 [debug] [Thread-4 (]: Began running node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m16:57:33.855634 [debug] [Thread-3 (]: Finished running node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m16:57:33.856978 [info ] [Thread-4 (]: 11 of 15 START test source_unique_raw_csv_products_product_id .................. [RUN]
[0m16:57:33.858743 [debug] [Thread-3 (]: Began running node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m16:57:33.860230 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194, now test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1)
[0m16:57:33.861416 [info ] [Thread-3 (]: 12 of 15 START test source_unique_raw_csv_sessions_session_id .................. [RUN]
[0m16:57:33.862756 [debug] [Thread-4 (]: Began compiling node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m16:57:33.864673 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6, now test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8)
[0m16:57:33.871552 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"
[0m16:57:33.872356 [debug] [Thread-3 (]: Began compiling node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m16:57:33.880509 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"
[0m16:57:33.901696 [debug] [Thread-4 (]: Timing info for test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1 (compile): 16:57:33.866262 => 16:57:33.900915
[0m16:57:33.902955 [debug] [Thread-4 (]: Began executing node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m16:57:33.906472 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"
[0m16:57:33.907375 [debug] [Thread-3 (]: Timing info for test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8 (compile): 16:57:33.873709 => 16:57:33.906871
[0m16:57:33.908444 [debug] [Thread-3 (]: Began executing node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m16:57:33.912147 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"
[0m16:57:33.922645 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:57:33.926915 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:57:33.988749 [debug] [Thread-4 (]: On test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:57:34.062358 [debug] [Thread-3 (]: On test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select session_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`sessions`
  where session_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:57:34.635824 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:0f7a3cdb-dfec-4ec5-a3d2-3ed221ad1d9f&page=queryresults
[0m16:57:34.676331 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:26e32ab1-cef2-43b6-81d1-71bc407bbc11&page=queryresults
[0m16:57:34.790841 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:4ea5d416-dac0-4ccb-a6df-f135f734d839&page=queryresults
[0m16:57:34.808589 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:a416b65e-9a5f-4796-95c7-f088d51f1f35&page=queryresults
[0m16:57:35.162620 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_users_user_id.3380c1257d (execute): 16:57:33.739754 => 16:57:35.162247
[0m16:57:35.164233 [info ] [Thread-2 (]: 9 of 15 PASS source_not_null_raw_csv_users_user_id ............................. [[32mPASS[0m in 1.46s]
[0m16:57:35.165555 [debug] [Thread-2 (]: Finished running node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m16:57:35.166660 [debug] [Thread-2 (]: Began running node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m16:57:35.167564 [info ] [Thread-2 (]: 13 of 15 START test source_unique_raw_csv_users_user_id ........................ [RUN]
[0m16:57:35.168977 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_users_user_id.3380c1257d, now test.retail.source_unique_raw_csv_users_user_id.d8f871acc9)
[0m16:57:35.170087 [debug] [Thread-2 (]: Began compiling node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m16:57:35.174909 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"
[0m16:57:35.193462 [debug] [Thread-2 (]: Timing info for test.retail.source_unique_raw_csv_users_user_id.d8f871acc9 (compile): 16:57:35.170829 => 16:57:35.193020
[0m16:57:35.194426 [debug] [Thread-2 (]: Began executing node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m16:57:35.198202 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"
[0m16:57:35.199726 [debug] [Thread-1 (]: Timing info for test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53 (execute): 16:57:33.746780 => 16:57:35.199466
[0m16:57:35.201230 [warn ] [Thread-1 (]: 10 of 15 WARN 25 source_unique_raw_csv_orders_order_id ......................... [[33mWARN 25[0m in 1.48s]
[0m16:57:35.202540 [debug] [Thread-1 (]: Finished running node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m16:57:35.203377 [debug] [Thread-1 (]: Began running node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m16:57:35.204304 [info ] [Thread-1 (]: 14 of 15 START test unique_bronze__orders_order_id ............................. [RUN]
[0m16:57:35.205507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53, now test.retail.unique_bronze__orders_order_id.cd2f27ce5f)
[0m16:57:35.206287 [debug] [Thread-1 (]: Began compiling node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m16:57:35.211260 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"
[0m16:57:35.225741 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:57:35.264022 [debug] [Thread-1 (]: Timing info for test.retail.unique_bronze__orders_order_id.cd2f27ce5f (compile): 16:57:35.206879 => 16:57:35.263679
[0m16:57:35.265523 [debug] [Thread-1 (]: Began executing node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m16:57:35.266511 [debug] [Thread-2 (]: On test.retail.source_unique_raw_csv_users_user_id.d8f871acc9: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:57:35.268981 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"
[0m16:57:35.293799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:35.330363 [debug] [Thread-3 (]: Timing info for test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8 (execute): 16:57:33.909325 => 16:57:35.330070
[0m16:57:35.331056 [debug] [Thread-1 (]: On test.retail.unique_bronze__orders_order_id.cd2f27ce5f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:57:35.331925 [info ] [Thread-3 (]: 12 of 15 PASS source_unique_raw_csv_sessions_session_id ........................ [[32mPASS[0m in 1.47s]
[0m16:57:35.335795 [debug] [Thread-3 (]: Finished running node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m16:57:35.337218 [debug] [Thread-3 (]: Began running node test.retail.unique_bronze__users_user_id.129342c645
[0m16:57:35.338742 [debug] [Thread-4 (]: Timing info for test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1 (execute): 16:57:33.904007 => 16:57:35.338486
[0m16:57:35.339202 [info ] [Thread-3 (]: 15 of 15 START test unique_bronze__users_user_id ............................... [RUN]
[0m16:57:35.340318 [info ] [Thread-4 (]: 11 of 15 PASS source_unique_raw_csv_products_product_id ........................ [[32mPASS[0m in 1.48s]
[0m16:57:35.341315 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8, now test.retail.unique_bronze__users_user_id.129342c645)
[0m16:57:35.342117 [debug] [Thread-4 (]: Finished running node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m16:57:35.342880 [debug] [Thread-3 (]: Began compiling node test.retail.unique_bronze__users_user_id.129342c645
[0m16:57:35.347840 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.unique_bronze__users_user_id.129342c645"
[0m16:57:35.362686 [debug] [Thread-3 (]: Timing info for test.retail.unique_bronze__users_user_id.129342c645 (compile): 16:57:35.343996 => 16:57:35.362345
[0m16:57:35.363657 [debug] [Thread-3 (]: Began executing node test.retail.unique_bronze__users_user_id.129342c645
[0m16:57:35.366253 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.unique_bronze__users_user_id.129342c645"
[0m16:57:35.383367 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:57:35.419428 [debug] [Thread-3 (]: On test.retail.unique_bronze__users_user_id.129342c645: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_bronze__users_user_id.129342c645"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:57:35.971914 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:ddb19854-f531-4083-aafd-45a883063f9f&page=queryresults
[0m16:57:36.076471 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:6d9f34f4-5e9b-4863-88ab-48b3642276f9&page=queryresults
[0m16:57:36.147648 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:0d5a0502-d358-4237-9621-d5b283b5cc94&page=queryresults
[0m16:57:36.556453 [debug] [Thread-2 (]: Timing info for test.retail.source_unique_raw_csv_users_user_id.d8f871acc9 (execute): 16:57:35.195032 => 16:57:36.556122
[0m16:57:36.558040 [warn ] [Thread-2 (]: 13 of 15 WARN 5 source_unique_raw_csv_users_user_id ............................ [[33mWARN 5[0m in 1.39s]
[0m16:57:36.559217 [debug] [Thread-2 (]: Finished running node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m16:57:36.627923 [debug] [Thread-1 (]: Timing info for test.retail.unique_bronze__orders_order_id.cd2f27ce5f (execute): 16:57:35.266968 => 16:57:36.627630
[0m16:57:36.629189 [warn ] [Thread-1 (]: 14 of 15 WARN 25 unique_bronze__orders_order_id ................................ [[33mWARN 25[0m in 1.42s]
[0m16:57:36.630335 [debug] [Thread-1 (]: Finished running node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m16:57:36.698465 [debug] [Thread-3 (]: Timing info for test.retail.unique_bronze__users_user_id.129342c645 (execute): 16:57:35.364177 => 16:57:36.698111
[0m16:57:36.700204 [warn ] [Thread-3 (]: 15 of 15 WARN 5 unique_bronze__users_user_id ................................... [[33mWARN 5[0m in 1.36s]
[0m16:57:36.701346 [debug] [Thread-3 (]: Finished running node test.retail.unique_bronze__users_user_id.129342c645
[0m16:57:36.705493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:36.706647 [debug] [MainThread]: Connection 'test.retail.unique_bronze__orders_order_id.cd2f27ce5f' was properly closed.
[0m16:57:36.707429 [debug] [MainThread]: Connection 'test.retail.source_unique_raw_csv_users_user_id.d8f871acc9' was properly closed.
[0m16:57:36.708220 [debug] [MainThread]: Connection 'test.retail.unique_bronze__users_user_id.129342c645' was properly closed.
[0m16:57:36.708984 [debug] [MainThread]: Connection 'test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1' was properly closed.
[0m16:57:36.710197 [info ] [MainThread]: 
[0m16:57:36.711011 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 6.40 seconds (6.40s).
[0m16:57:36.713459 [debug] [MainThread]: Command end result
[0m16:57:36.761036 [info ] [MainThread]: 
[0m16:57:36.762282 [info ] [MainThread]: [33mCompleted with 5 warnings:[0m
[0m16:57:36.763094 [info ] [MainThread]: 
[0m16:57:36.763858 [warn ] [MainThread]: [33mWarning in test not_null_bronze__orders_order_created_at (models/bronze/schema.yml)[0m
[0m16:57:36.764659 [warn ] [MainThread]: Got 987 results, configured to warn if != 0
[0m16:57:36.765361 [info ] [MainThread]: 
[0m16:57:36.766011 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/schema.yml/not_null_bronze__orders_order_created_at.sql
[0m16:57:36.766547 [info ] [MainThread]: 
[0m16:57:36.767159 [warn ] [MainThread]: [33mWarning in test source_unique_raw_csv_orders_order_id (models/bronze/sources.yml)[0m
[0m16:57:36.767804 [warn ] [MainThread]: Got 25 results, configured to warn if != 0
[0m16:57:36.768319 [info ] [MainThread]: 
[0m16:57:36.768894 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/sources.yml/source_unique_raw_csv_orders_order_id.sql
[0m16:57:36.769382 [info ] [MainThread]: 
[0m16:57:36.769873 [warn ] [MainThread]: [33mWarning in test source_unique_raw_csv_users_user_id (models/bronze/sources.yml)[0m
[0m16:57:36.770354 [warn ] [MainThread]: Got 5 results, configured to warn if != 0
[0m16:57:36.770956 [info ] [MainThread]: 
[0m16:57:36.771508 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/sources.yml/source_unique_raw_csv_users_user_id.sql
[0m16:57:36.772775 [info ] [MainThread]: 
[0m16:57:36.773751 [warn ] [MainThread]: [33mWarning in test unique_bronze__orders_order_id (models/bronze/schema.yml)[0m
[0m16:57:36.774624 [warn ] [MainThread]: Got 25 results, configured to warn if != 0
[0m16:57:36.776302 [info ] [MainThread]: 
[0m16:57:36.777198 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/schema.yml/unique_bronze__orders_order_id.sql
[0m16:57:36.777871 [info ] [MainThread]: 
[0m16:57:36.778542 [warn ] [MainThread]: [33mWarning in test unique_bronze__users_user_id (models/bronze/schema.yml)[0m
[0m16:57:36.779177 [warn ] [MainThread]: Got 5 results, configured to warn if != 0
[0m16:57:36.779802 [info ] [MainThread]: 
[0m16:57:36.780335 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/schema.yml/unique_bronze__users_user_id.sql
[0m16:57:36.780820 [info ] [MainThread]: 
[0m16:57:36.781372 [info ] [MainThread]: Done. PASS=10 WARN=5 ERROR=0 SKIP=0 TOTAL=15
[0m16:57:36.782585 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 15.571527, "process_user_time": 4.816989, "process_kernel_time": 1.652455, "process_mem_max_rss": "239316", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:57:36.783297 [debug] [MainThread]: Command `dbt test` succeeded at 16:57:36.783165 after 15.57 seconds
[0m16:57:36.784012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c44219d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c442028aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c44215a2a0>]}
[0m16:57:36.784642 [debug] [MainThread]: Flushing usage events
[0m16:57:41.281382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7961974e9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7961975899a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796197729e20>]}


============================== 16:57:41.287458 | 63fd4180-28b3-445d-8302-ea350277a53d ==============================
[0m16:57:41.287458 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:57:41.288559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/silver path:models/gold', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:57:42.356405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63fd4180-28b3-445d-8302-ea350277a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79616a62ce00>]}
[0m16:57:42.440810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63fd4180-28b3-445d-8302-ea350277a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79616a7b6930>]}
[0m16:57:42.442511 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:57:42.571094 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:57:50.176805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:57:50.177506 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:57:50.178477 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:57:50.184084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63fd4180-28b3-445d-8302-ea350277a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79616a5f05c0>]}
[0m16:57:50.236922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63fd4180-28b3-445d-8302-ea350277a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79616a766810>]}
[0m16:57:50.238922 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:57:50.240748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63fd4180-28b3-445d-8302-ea350277a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79617137dfa0>]}
[0m16:57:50.262031 [info ] [MainThread]: 
[0m16:57:50.264402 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:57:50.267604 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m16:57:50.268758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:50.894222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod)
[0m16:57:50.895317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:51.406636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63fd4180-28b3-445d-8302-ea350277a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79616ab58320>]}
[0m16:57:51.407815 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:57:51.408634 [info ] [MainThread]: 
[0m16:57:51.420336 [debug] [Thread-1 (]: Began running node model.retail.silver__orders_enriched
[0m16:57:51.421579 [info ] [Thread-1 (]: 1 of 2 START sql view model retail_prod.silver__orders_enriched ................ [RUN]
[0m16:57:51.422907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.silver__orders_enriched)
[0m16:57:51.423869 [debug] [Thread-1 (]: Began compiling node model.retail.silver__orders_enriched
[0m16:57:51.432754 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.silver__orders_enriched"
[0m16:57:51.450345 [debug] [Thread-1 (]: Timing info for model.retail.silver__orders_enriched (compile): 16:57:51.424567 => 16:57:51.449877
[0m16:57:51.451475 [debug] [Thread-1 (]: Began executing node model.retail.silver__orders_enriched
[0m16:57:51.478805 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.silver__orders_enriched"
[0m16:57:51.495874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:51.534899 [debug] [Thread-1 (]: On model.retail.silver__orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.silver__orders_enriched"} */


  create or replace view `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
  OPTIONS()
  as with orders as (
  select *
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
),
users as (
  select *
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
),
joined as (
  select
    o.order_id,
    o.user_id,
    o.order_created_at,
    o.order_created_at_parse_failed,
    date(o.order_created_at) as order_date,
    o.total_amount,
    o.payment_method,
    o.order_status,
    o.branch,
    u.full_name,
    u.email,
    u.phone,
    u.city as user_city,
    u.created_at as user_created_at,
    u.created_at_parse_failed as user_created_at_parse_failed
  from orders o
  left join users u using (user_id)
)

select *
from joined;


[0m16:57:52.067026 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:0505d9c9-01cd-4ee8-8258-cb4f1096e7d6&page=queryresults
[0m16:57:52.397313 [debug] [Thread-1 (]: Timing info for model.retail.silver__orders_enriched (execute): 16:57:51.452205 => 16:57:52.397009
[0m16:57:52.398489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63fd4180-28b3-445d-8302-ea350277a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79616a551ee0>]}
[0m16:57:52.399547 [info ] [Thread-1 (]: 1 of 2 OK created sql view model retail_prod.silver__orders_enriched ........... [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m16:57:52.400712 [debug] [Thread-1 (]: Finished running node model.retail.silver__orders_enriched
[0m16:57:52.402175 [debug] [Thread-3 (]: Began running node model.retail.gold__daily_branch_metrics
[0m16:57:52.403193 [info ] [Thread-3 (]: 2 of 2 START sql table model retail_prod.gold__daily_branch_metrics ............ [RUN]
[0m16:57:52.404199 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.retail.gold__daily_branch_metrics'
[0m16:57:52.404809 [debug] [Thread-3 (]: Began compiling node model.retail.gold__daily_branch_metrics
[0m16:57:52.407958 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail.gold__daily_branch_metrics"
[0m16:57:52.425187 [debug] [Thread-3 (]: Timing info for model.retail.gold__daily_branch_metrics (compile): 16:57:52.405314 => 16:57:52.424674
[0m16:57:52.426076 [debug] [Thread-3 (]: Began executing node model.retail.gold__daily_branch_metrics
[0m16:57:52.434738 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:57:52.993278 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail.gold__daily_branch_metrics"
[0m16:57:53.012850 [debug] [Thread-3 (]: On model.retail.gold__daily_branch_metrics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.gold__daily_branch_metrics"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`gold__daily_branch_metrics`
      
    
    

    OPTIONS()
    as (
      with fact_orders as (
  select *
  from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
  where order_created_at is not null
),
aggregated as (
  select
    order_date,
    branch,
    count(distinct order_id) as orders_count,
    count(distinct user_id) as customers_count,
    sum(case when order_status = 'completed' then total_amount else 0 end) as completed_revenue,
    sum(case when order_status != 'completed' then total_amount else 0 end) as non_completed_revenue,
    sum(total_amount) as gross_revenue
  from fact_orders
  group by order_date, branch
)

select *
from aggregated
    );
  
[0m16:57:53.893987 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:b447ff60-08b3-449d-8a84-15e04b17e19d&page=queryresults
[0m16:57:55.890048 [debug] [Thread-3 (]: Timing info for model.retail.gold__daily_branch_metrics (execute): 16:57:52.426486 => 16:57:55.889850
[0m16:57:55.891311 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63fd4180-28b3-445d-8302-ea350277a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79616a014e00>]}
[0m16:57:55.892248 [info ] [Thread-3 (]: 2 of 2 OK created sql table model retail_prod.gold__daily_branch_metrics ....... [[32mCREATE TABLE (3.7k rows, 360.2 KiB processed)[0m in 3.49s]
[0m16:57:55.893242 [debug] [Thread-3 (]: Finished running node model.retail.gold__daily_branch_metrics
[0m16:57:55.898050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:55.899044 [debug] [MainThread]: Connection 'model.retail.silver__orders_enriched' was properly closed.
[0m16:57:55.899855 [debug] [MainThread]: Connection 'model.retail.gold__daily_branch_metrics' was properly closed.
[0m16:57:55.900646 [info ] [MainThread]: 
[0m16:57:55.901604 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.64 seconds (5.64s).
[0m16:57:55.902752 [debug] [MainThread]: Command end result
[0m16:57:55.947217 [info ] [MainThread]: 
[0m16:57:55.948282 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:57:55.949181 [info ] [MainThread]: 
[0m16:57:55.950553 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:57:55.952656 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.746457, "process_user_time": 3.87743, "process_kernel_time": 1.337326, "process_mem_max_rss": "236432", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:57:55.953717 [debug] [MainThread]: Command `dbt run` succeeded at 16:57:55.953478 after 14.75 seconds
[0m16:57:55.954602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796197729e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79616a828e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79616a767dd0>]}
[0m16:57:55.955284 [debug] [MainThread]: Flushing usage events
[0m16:58:01.374788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a001e26d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a001e37af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a001e26d8b0>]}


============================== 16:58:01.381224 | 334a9239-728f-44b9-bc9b-856daf18de1b ==============================
[0m16:58:01.381224 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:58:01.382222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/silver path:models/gold', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:58:02.293353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '334a9239-728f-44b9-bc9b-856daf18de1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fff11ce030>]}
[0m16:58:02.375265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '334a9239-728f-44b9-bc9b-856daf18de1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fff17dfb60>]}
[0m16:58:02.376655 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m16:58:02.487495 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:58:09.612646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:58:09.613547 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:58:09.614694 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:58:09.620801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '334a9239-728f-44b9-bc9b-856daf18de1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fff10f8f50>]}
[0m16:58:09.673116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '334a9239-728f-44b9-bc9b-856daf18de1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fff0cf9ac0>]}
[0m16:58:09.674230 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m16:58:09.675190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '334a9239-728f-44b9-bc9b-856daf18de1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a001e3a3bf0>]}
[0m16:58:09.696508 [info ] [MainThread]: 
[0m16:58:09.697890 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:58:09.699998 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev_retail_prod'
[0m16:58:09.701010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:10.185667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '334a9239-728f-44b9-bc9b-856daf18de1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fff0cf9b50>]}
[0m16:58:10.187144 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:58:10.188136 [info ] [MainThread]: 
[0m16:58:10.196966 [debug] [Thread-1 (]: Began running node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m16:58:10.197601 [debug] [Thread-2 (]: Began running node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m16:58:10.198090 [debug] [Thread-3 (]: Began running node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m16:58:10.198931 [debug] [Thread-4 (]: Began running node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m16:58:10.198531 [info ] [Thread-1 (]: 1 of 5 START test not_null_gold__daily_branch_metrics_branch ................... [RUN]
[0m16:58:10.199897 [info ] [Thread-2 (]: 2 of 5 START test not_null_gold__daily_branch_metrics_order_date ............... [RUN]
[0m16:58:10.200664 [info ] [Thread-3 (]: 3 of 5 START test not_null_silver__orders_enriched_order_date .................. [RUN]
[0m16:58:10.201366 [info ] [Thread-4 (]: 4 of 5 START test not_null_silver__orders_enriched_order_id .................... [RUN]
[0m16:58:10.202567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761)
[0m16:58:10.204091 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948'
[0m16:58:10.205478 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.retail.not_null_silver__orders_enriched_order_date.658d753d80'
[0m16:58:10.206907 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.retail.not_null_silver__orders_enriched_order_id.782515c964'
[0m16:58:10.207854 [debug] [Thread-1 (]: Began compiling node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m16:58:10.208734 [debug] [Thread-2 (]: Began compiling node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m16:58:10.209544 [debug] [Thread-3 (]: Began compiling node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m16:58:10.210429 [debug] [Thread-4 (]: Began compiling node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m16:58:10.226513 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761"
[0m16:58:10.230726 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948"
[0m16:58:10.236434 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.not_null_silver__orders_enriched_order_date.658d753d80"
[0m16:58:10.241801 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.not_null_silver__orders_enriched_order_id.782515c964"
[0m16:58:10.261278 [debug] [Thread-2 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948 (compile): 16:58:10.226949 => 16:58:10.260652
[0m16:58:10.262427 [debug] [Thread-4 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_id.782515c964 (compile): 16:58:10.237766 => 16:58:10.261953
[0m16:58:10.263098 [debug] [Thread-3 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_date.658d753d80 (compile): 16:58:10.231828 => 16:58:10.262849
[0m16:58:10.263641 [debug] [Thread-1 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761 (compile): 16:58:10.211260 => 16:58:10.263378
[0m16:58:10.264064 [debug] [Thread-2 (]: Began executing node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m16:58:10.264982 [debug] [Thread-4 (]: Began executing node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m16:58:10.265822 [debug] [Thread-3 (]: Began executing node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m16:58:10.266814 [debug] [Thread-1 (]: Began executing node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m16:58:10.288761 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.not_null_silver__orders_enriched_order_id.782515c964"
[0m16:58:10.289446 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948"
[0m16:58:10.291765 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.not_null_silver__orders_enriched_order_date.658d753d80"
[0m16:58:10.294914 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761"
[0m16:58:10.311057 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:58:10.312115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:10.313969 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:58:10.314807 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:58:10.385265 [debug] [Thread-1 (]: On test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select branch
from `retail-data-pipeline-dev`.`retail_prod`.`gold__daily_branch_metrics`
where branch is null



      
    ) dbt_internal_test
[0m16:58:10.418195 [debug] [Thread-3 (]: On test.retail.not_null_silver__orders_enriched_order_date.658d753d80: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_silver__orders_enriched_order_date.658d753d80"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
where order_date is null



      
    ) dbt_internal_test
[0m16:58:10.454231 [debug] [Thread-2 (]: On test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from `retail-data-pipeline-dev`.`retail_prod`.`gold__daily_branch_metrics`
where order_date is null



      
    ) dbt_internal_test
[0m16:58:10.457761 [debug] [Thread-4 (]: On test.retail.not_null_silver__orders_enriched_order_id.782515c964: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_silver__orders_enriched_order_id.782515c964"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
where order_id is null



      
    ) dbt_internal_test
[0m16:58:11.145948 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:ae9ba483-553b-4d1d-8e64-a14131b8e220&page=queryresults
[0m16:58:11.162875 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:9198f54c-068f-4e5b-83fa-97635187e340&page=queryresults
[0m16:58:11.479156 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:5b0daf6f-57df-4721-bd4a-df6aafd3b491&page=queryresults
[0m16:58:11.532686 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:e6778c9b-b5eb-4161-8f28-aa0f0838d203&page=queryresults
[0m16:58:11.683443 [debug] [Thread-2 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948 (execute): 16:58:10.267714 => 16:58:11.682901
[0m16:58:11.684791 [info ] [Thread-2 (]: 2 of 5 PASS not_null_gold__daily_branch_metrics_order_date ..................... [[32mPASS[0m in 1.48s]
[0m16:58:11.685830 [debug] [Thread-2 (]: Finished running node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m16:58:11.686683 [debug] [Thread-2 (]: Began running node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m16:58:11.687422 [info ] [Thread-2 (]: 5 of 5 START test unique_silver__orders_enriched_order_id ...................... [RUN]
[0m16:58:11.688475 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948, now test.retail.unique_silver__orders_enriched_order_id.761e0577f3)
[0m16:58:11.689572 [debug] [Thread-2 (]: Began compiling node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m16:58:11.696208 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.unique_silver__orders_enriched_order_id.761e0577f3"
[0m16:58:11.704132 [debug] [Thread-1 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761 (execute): 16:58:10.292835 => 16:58:11.703819
[0m16:58:11.705856 [info ] [Thread-1 (]: 1 of 5 PASS not_null_gold__daily_branch_metrics_branch ......................... [[32mPASS[0m in 1.50s]
[0m16:58:11.708729 [debug] [Thread-1 (]: Finished running node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m16:58:11.718150 [debug] [Thread-2 (]: Timing info for test.retail.unique_silver__orders_enriched_order_id.761e0577f3 (compile): 16:58:11.690251 => 16:58:11.717805
[0m16:58:11.718906 [debug] [Thread-2 (]: Began executing node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m16:58:11.721664 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.unique_silver__orders_enriched_order_id.761e0577f3"
[0m16:58:11.742328 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:58:11.782799 [debug] [Thread-2 (]: On test.retail.unique_silver__orders_enriched_order_id.761e0577f3: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_silver__orders_enriched_order_id.761e0577f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:58:12.057943 [debug] [Thread-4 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_id.782515c964 (execute): 16:58:10.278583 => 16:58:12.057609
[0m16:58:12.059483 [info ] [Thread-4 (]: 4 of 5 PASS not_null_silver__orders_enriched_order_id .......................... [[32mPASS[0m in 1.85s]
[0m16:58:12.060692 [debug] [Thread-4 (]: Finished running node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m16:58:12.094313 [debug] [Thread-3 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_date.658d753d80 (execute): 16:58:10.289784 => 16:58:12.093735
[0m16:58:12.096032 [warn ] [Thread-3 (]: 3 of 5 WARN 993 not_null_silver__orders_enriched_order_date .................... [[33mWARN 993[0m in 1.89s]
[0m16:58:12.097555 [debug] [Thread-3 (]: Finished running node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m16:58:12.957826 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:55e00fdd-73b2-4d44-8e93-5ebb1939ce43&page=queryresults
[0m16:58:13.545777 [debug] [Thread-2 (]: Timing info for test.retail.unique_silver__orders_enriched_order_id.761e0577f3 (execute): 16:58:11.719372 => 16:58:13.545479
[0m16:58:13.547108 [warn ] [Thread-2 (]: 5 of 5 WARN 50 unique_silver__orders_enriched_order_id ......................... [[33mWARN 50[0m in 1.86s]
[0m16:58:13.548087 [debug] [Thread-2 (]: Finished running node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m16:58:13.551177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:13.552022 [debug] [MainThread]: Connection 'test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761' was properly closed.
[0m16:58:13.552717 [debug] [MainThread]: Connection 'test.retail.unique_silver__orders_enriched_order_id.761e0577f3' was properly closed.
[0m16:58:13.553242 [debug] [MainThread]: Connection 'test.retail.not_null_silver__orders_enriched_order_date.658d753d80' was properly closed.
[0m16:58:13.553774 [debug] [MainThread]: Connection 'test.retail.not_null_silver__orders_enriched_order_id.782515c964' was properly closed.
[0m16:58:13.554422 [info ] [MainThread]: 
[0m16:58:13.555049 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m16:58:13.557182 [debug] [MainThread]: Command end result
[0m16:58:13.596918 [info ] [MainThread]: 
[0m16:58:13.598305 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m16:58:13.599434 [info ] [MainThread]: 
[0m16:58:13.600423 [warn ] [MainThread]: [33mWarning in test not_null_silver__orders_enriched_order_date (models/silver/schema.yml)[0m
[0m16:58:13.601116 [warn ] [MainThread]: Got 993 results, configured to warn if != 0
[0m16:58:13.601735 [info ] [MainThread]: 
[0m16:58:13.602433 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/silver/schema.yml/not_null_silver__orders_enriched_order_date.sql
[0m16:58:13.603158 [info ] [MainThread]: 
[0m16:58:13.603791 [warn ] [MainThread]: [33mWarning in test unique_silver__orders_enriched_order_id (models/silver/schema.yml)[0m
[0m16:58:13.604491 [warn ] [MainThread]: Got 50 results, configured to warn if != 0
[0m16:58:13.605081 [info ] [MainThread]: 
[0m16:58:13.605827 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/silver/schema.yml/unique_silver__orders_enriched_order_id.sql
[0m16:58:13.606776 [info ] [MainThread]: 
[0m16:58:13.607462 [info ] [MainThread]: Done. PASS=3 WARN=2 ERROR=0 SKIP=0 TOTAL=5
[0m16:58:13.609113 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.267247, "process_user_time": 3.827635, "process_kernel_time": 1.384463, "process_mem_max_rss": "236560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:58:13.610200 [debug] [MainThread]: Command `dbt test` succeeded at 16:58:13.609986 after 12.27 seconds
[0m16:58:13.611249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a001e379fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a001e98e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a001e2553a0>]}
[0m16:58:13.612130 [debug] [MainThread]: Flushing usage events
[0m17:02:51.292314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7722b28f3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7722b2fc8ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7722b2945640>]}


============================== 17:02:51.304261 | 5979765c-770c-4fdc-9625-e6a5bbd61dea ==============================
[0m17:02:51.304261 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:02:51.306939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'send_anonymous_usage_stats': 'True'}
[0m17:02:51.440934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5979765c-770c-4fdc-9625-e6a5bbd61dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7722b292c680>]}
[0m17:02:52.982381 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5cvtdrlt'
[0m17:02:52.983891 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:02:53.221349 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:02:53.222999 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:02:53.382712 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:02:53.392451 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m17:02:54.037659 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m17:02:54.042738 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m17:02:54.178546 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m17:02:54.181623 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:03:01.829523 [info ] [MainThread]: Installed from version 1.3.1
[0m17:03:01.830464 [info ] [MainThread]: Up to date!
[0m17:03:01.831538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5979765c-770c-4fdc-9625-e6a5bbd61dea', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7722b28da960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7722b29fff80>]}
[0m17:03:01.832437 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m17:03:08.691264 [info ] [MainThread]: Installed from version 0.10.9
[0m17:03:08.692699 [info ] [MainThread]: Up to date!
[0m17:03:08.693496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5979765c-770c-4fdc-9625-e6a5bbd61dea', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7722b27ae7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7722b27ae000>]}
[0m17:03:08.694198 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m17:03:11.469644 [info ] [MainThread]: Installed from version 0.15.0
[0m17:03:11.470450 [info ] [MainThread]: Up to date!
[0m17:03:11.471157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5979765c-770c-4fdc-9625-e6a5bbd61dea', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7722b27ac650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7722b27af590>]}
[0m17:03:11.473523 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 20.214417, "process_user_time": 2.871355, "process_kernel_time": 0.92264, "process_mem_max_rss": "207000", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m17:03:11.474596 [debug] [MainThread]: Command `dbt deps` succeeded at 17:03:11.474377 after 20.22 seconds
[0m17:03:11.475405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7722b2a69340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7722b292c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7722b30870e0>]}
[0m17:03:11.476073 [debug] [MainThread]: Flushing usage events
[0m17:03:16.338154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb27fc29190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb27ff65bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb27febcbc0>]}


============================== 17:03:16.345183 | dc9065d9-c12b-4713-93d5-a6f6248597dd ==============================
[0m17:03:16.345183 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:03:16.346096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:03:17.253013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc9065d9-c12b-4713-93d5-a6f6248597dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb253029400>]}
[0m17:03:17.327660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc9065d9-c12b-4713-93d5-a6f6248597dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb253087aa0>]}
[0m17:03:17.329081 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m17:03:17.445738 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:03:25.874104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:03:25.875324 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:03:25.876728 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m17:03:25.882258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc9065d9-c12b-4713-93d5-a6f6248597dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb25326bf50>]}
[0m17:03:25.931658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc9065d9-c12b-4713-93d5-a6f6248597dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2526c54f0>]}
[0m17:03:25.932598 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m17:03:25.933320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc9065d9-c12b-4713-93d5-a6f6248597dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb27fc287a0>]}
[0m17:03:25.945051 [info ] [MainThread]: 
[0m17:03:25.946355 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:03:25.948370 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m17:03:25.949328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:26.583703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod)
[0m17:03:26.584803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:27.119701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc9065d9-c12b-4713-93d5-a6f6248597dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb252d61910>]}
[0m17:03:27.121397 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:03:27.122682 [info ] [MainThread]: 
[0m17:03:27.136223 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m17:03:27.137532 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m17:03:27.138657 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod.bronze__orders ........................ [RUN]
[0m17:03:27.139872 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod.bronze__users ......................... [RUN]
[0m17:03:27.141399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.bronze__orders)
[0m17:03:27.143314 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m17:03:27.144707 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m17:03:27.145689 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m17:03:27.154838 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m17:03:27.159160 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m17:03:27.173420 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 17:03:27.146375 => 17:03:27.172810
[0m17:03:27.174965 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m17:03:27.183279 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 17:03:27.155277 => 17:03:27.182903
[0m17:03:27.189745 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m17:03:27.210009 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:03:27.211045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:27.776002 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m17:03:27.776808 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m17:03:27.788189 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe.parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m17:03:27.793471 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe.parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m17:03:28.171835 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:488cd04a-6e07-43b2-a3f4-0088793db2d2&page=queryresults
[0m17:03:28.182443 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:2bfe01a9-7786-4e75-8feb-2ba7acc88d93&page=queryresults
[0m17:03:30.181648 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 17:03:27.176286 => 17:03:30.181454
[0m17:03:30.183017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc9065d9-c12b-4713-93d5-a6f6248597dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb252754410>]}
[0m17:03:30.184776 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 17:03:27.196137 => 17:03:30.184539
[0m17:03:30.185356 [info ] [Thread-1 (]: 1 of 2 OK created sql table model retail_prod.bronze__orders ................... [[32mCREATE TABLE (10.1k rows, 828.2 KiB processed)[0m in 3.04s]
[0m17:03:30.186773 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc9065d9-c12b-4713-93d5-a6f6248597dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb252755340>]}
[0m17:03:30.188372 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m17:03:30.190011 [info ] [Thread-2 (]: 2 of 2 OK created sql table model retail_prod.bronze__users .................... [[32mCREATE TABLE (2.0k rows, 214.2 KiB processed)[0m in 3.04s]
[0m17:03:30.192113 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m17:03:30.196288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:30.197388 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m17:03:30.198228 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m17:03:30.199244 [info ] [MainThread]: 
[0m17:03:30.200090 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.25 seconds (4.25s).
[0m17:03:30.201198 [debug] [MainThread]: Command end result
[0m17:03:30.250694 [info ] [MainThread]: 
[0m17:03:30.252354 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:03:30.253497 [info ] [MainThread]: 
[0m17:03:30.254802 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:03:30.256720 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.007165, "process_user_time": 3.632262, "process_kernel_time": 1.612048, "process_mem_max_rss": "236272", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:03:30.257986 [debug] [MainThread]: Command `dbt run` succeeded at 17:03:30.257790 after 14.01 seconds
[0m17:03:30.258904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb25b0e8500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb252f907d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb252756960>]}
[0m17:03:30.259964 [debug] [MainThread]: Flushing usage events
[0m17:03:35.439931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72080682d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72080682cce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72080682d5b0>]}


============================== 17:03:35.446914 | 976765c6-bd5f-46fa-8ec8-8843dd130260 ==============================
[0m17:03:35.446914 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:03:35.447724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:03:36.353561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '976765c6-bd5f-46fa-8ec8-8843dd130260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207d9968920>]}
[0m17:03:36.426996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '976765c6-bd5f-46fa-8ec8-8843dd130260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7208070c2960>]}
[0m17:03:36.428515 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m17:03:36.551180 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:03:44.490494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:03:44.491325 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:03:44.492478 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m17:03:44.497713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '976765c6-bd5f-46fa-8ec8-8843dd130260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207d94f1d00>]}
[0m17:03:44.546443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '976765c6-bd5f-46fa-8ec8-8843dd130260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207d92c2120>]}
[0m17:03:44.548018 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m17:03:44.549268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '976765c6-bd5f-46fa-8ec8-8843dd130260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7208070c2960>]}
[0m17:03:44.560423 [info ] [MainThread]: 
[0m17:03:44.562287 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:03:44.564633 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev_retail_prod'
[0m17:03:44.565548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:45.094023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '976765c6-bd5f-46fa-8ec8-8843dd130260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720807704770>]}
[0m17:03:45.095285 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:03:45.096273 [info ] [MainThread]: 
[0m17:03:45.106031 [debug] [Thread-1 (]: Began running node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m17:03:45.106883 [debug] [Thread-2 (]: Began running node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m17:03:45.107528 [info ] [Thread-1 (]: 1 of 15 START test not_null_bronze__orders_order_created_at .................... [RUN]
[0m17:03:45.108066 [debug] [Thread-3 (]: Began running node test.retail.not_null_bronze__users_email.2bec59e73f
[0m17:03:45.108800 [debug] [Thread-4 (]: Began running node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m17:03:45.109317 [info ] [Thread-2 (]: 2 of 15 START test not_null_bronze__orders_order_id ............................ [RUN]
[0m17:03:45.110889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now test.retail.not_null_bronze__orders_order_created_at.05e711bf75)
[0m17:03:45.112241 [info ] [Thread-3 (]: 3 of 15 START test not_null_bronze__users_email ................................ [RUN]
[0m17:03:45.113649 [info ] [Thread-4 (]: 4 of 15 START test not_null_bronze__users_user_id .............................. [RUN]
[0m17:03:45.115844 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__orders_order_id.4b38fb230a'
[0m17:03:45.117410 [debug] [Thread-1 (]: Began compiling node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m17:03:45.119686 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__users_email.2bec59e73f'
[0m17:03:45.121916 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__users_user_id.cb91e05164'
[0m17:03:45.124030 [debug] [Thread-2 (]: Began compiling node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m17:03:45.136746 [debug] [Thread-3 (]: Began compiling node test.retail.not_null_bronze__users_email.2bec59e73f
[0m17:03:45.142475 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"
[0m17:03:45.143671 [debug] [Thread-4 (]: Began compiling node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m17:03:45.148507 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.not_null_bronze__orders_order_id.4b38fb230a"
[0m17:03:45.153137 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.not_null_bronze__users_email.2bec59e73f"
[0m17:03:45.160062 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.not_null_bronze__users_user_id.cb91e05164"
[0m17:03:45.173228 [debug] [Thread-1 (]: Timing info for test.retail.not_null_bronze__orders_order_created_at.05e711bf75 (compile): 17:03:45.125160 => 17:03:45.172775
[0m17:03:45.174218 [debug] [Thread-1 (]: Began executing node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m17:03:45.174930 [debug] [Thread-3 (]: Timing info for test.retail.not_null_bronze__users_email.2bec59e73f (compile): 17:03:45.149525 => 17:03:45.174604
[0m17:03:45.192609 [debug] [Thread-3 (]: Began executing node test.retail.not_null_bronze__users_email.2bec59e73f
[0m17:03:45.198695 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"
[0m17:03:45.201515 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.not_null_bronze__users_email.2bec59e73f"
[0m17:03:45.202340 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__users_user_id.cb91e05164 (compile): 17:03:45.155569 => 17:03:45.202054
[0m17:03:45.204624 [debug] [Thread-4 (]: Began executing node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m17:03:45.205474 [debug] [Thread-2 (]: Timing info for test.retail.not_null_bronze__orders_order_id.4b38fb230a (compile): 17:03:45.144893 => 17:03:45.205212
[0m17:03:45.207947 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.not_null_bronze__users_user_id.cb91e05164"
[0m17:03:45.209072 [debug] [Thread-2 (]: Began executing node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m17:03:45.213543 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.not_null_bronze__orders_order_id.4b38fb230a"
[0m17:03:45.216526 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:03:45.217503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:45.220321 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:03:45.221836 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:03:45.286620 [debug] [Thread-3 (]: On test.retail.not_null_bronze__users_email.2bec59e73f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__users_email.2bec59e73f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
where email is null



      
    ) dbt_internal_test
[0m17:03:45.359817 [debug] [Thread-4 (]: On test.retail.not_null_bronze__users_user_id.cb91e05164: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__users_user_id.cb91e05164"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
where user_id is null



      
    ) dbt_internal_test
[0m17:03:45.360638 [debug] [Thread-1 (]: On test.retail.not_null_bronze__orders_order_created_at.05e711bf75: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_created_at
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
where order_created_at is null



      
    ) dbt_internal_test
[0m17:03:45.363265 [debug] [Thread-2 (]: On test.retail.not_null_bronze__orders_order_id.4b38fb230a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__orders_order_id.4b38fb230a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
where order_id is null



      
    ) dbt_internal_test
[0m17:03:46.045795 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:3cbdf994-4515-44ad-98cb-7819db590789&page=queryresults
[0m17:03:46.187270 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:2b5b5491-4bd6-44ad-86c3-1b7d00565863&page=queryresults
[0m17:03:46.200298 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:33c6ea12-7b0e-4162-b5be-f9c5234ba548&page=queryresults
[0m17:03:46.249225 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:f9c7a520-b2d9-452b-be2e-c59c81d41210&page=queryresults
[0m17:03:46.602651 [debug] [Thread-2 (]: Timing info for test.retail.not_null_bronze__orders_order_id.4b38fb230a (execute): 17:03:45.210799 => 17:03:46.602276
[0m17:03:46.604158 [info ] [Thread-2 (]: 2 of 15 PASS not_null_bronze__orders_order_id .................................. [[32mPASS[0m in 1.49s]
[0m17:03:46.605213 [debug] [Thread-2 (]: Finished running node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m17:03:46.606272 [debug] [Thread-2 (]: Began running node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m17:03:46.607601 [info ] [Thread-2 (]: 5 of 15 START test source_not_null_raw_csv_order_items_order_id ................ [RUN]
[0m17:03:46.609177 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__orders_order_id.4b38fb230a, now test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2)
[0m17:03:46.610578 [debug] [Thread-2 (]: Began compiling node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m17:03:46.616685 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"
[0m17:03:46.636285 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2 (compile): 17:03:46.611643 => 17:03:46.635642
[0m17:03:46.637358 [debug] [Thread-2 (]: Began executing node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m17:03:46.642263 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"
[0m17:03:46.663263 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:03:46.700183 [debug] [Thread-2 (]: On test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_raw`.`order_items`
where order_id is null



      
    ) dbt_internal_test
[0m17:03:46.706137 [debug] [Thread-3 (]: Timing info for test.retail.not_null_bronze__users_email.2bec59e73f (execute): 17:03:45.199295 => 17:03:46.705543
[0m17:03:46.708976 [info ] [Thread-3 (]: 3 of 15 PASS not_null_bronze__users_email ...................................... [[32mPASS[0m in 1.59s]
[0m17:03:46.710292 [debug] [Thread-3 (]: Finished running node test.retail.not_null_bronze__users_email.2bec59e73f
[0m17:03:46.711279 [debug] [Thread-3 (]: Began running node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m17:03:46.712272 [info ] [Thread-3 (]: 6 of 15 START test source_not_null_raw_csv_orders_order_id ..................... [RUN]
[0m17:03:46.713565 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__users_email.2bec59e73f, now test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336)
[0m17:03:46.714545 [debug] [Thread-3 (]: Began compiling node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m17:03:46.721140 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"
[0m17:03:46.731059 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__users_user_id.cb91e05164 (execute): 17:03:45.205751 => 17:03:46.730778
[0m17:03:46.732165 [info ] [Thread-4 (]: 4 of 15 PASS not_null_bronze__users_user_id .................................... [[32mPASS[0m in 1.61s]
[0m17:03:46.733139 [debug] [Thread-4 (]: Finished running node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m17:03:46.733838 [debug] [Thread-4 (]: Began running node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m17:03:46.734657 [info ] [Thread-4 (]: 7 of 15 START test source_not_null_raw_csv_products_product_id ................. [RUN]
[0m17:03:46.735930 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__users_user_id.cb91e05164, now test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6)
[0m17:03:46.736574 [debug] [Thread-4 (]: Began compiling node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m17:03:46.740712 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"
[0m17:03:46.747253 [debug] [Thread-3 (]: Timing info for test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336 (compile): 17:03:46.715297 => 17:03:46.746796
[0m17:03:46.748532 [debug] [Thread-3 (]: Began executing node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m17:03:46.752156 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"
[0m17:03:46.752901 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6 (compile): 17:03:46.737182 => 17:03:46.752642
[0m17:03:46.754463 [debug] [Thread-4 (]: Began executing node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m17:03:46.759862 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"
[0m17:03:46.770516 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:03:46.772476 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:03:46.836455 [debug] [Thread-3 (]: On test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_raw`.`orders`
where order_id is null



      
    ) dbt_internal_test
[0m17:03:46.840427 [debug] [Thread-4 (]: On test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `retail-data-pipeline-dev`.`retail_raw`.`products`
where product_id is null



      
    ) dbt_internal_test
[0m17:03:46.847193 [debug] [Thread-1 (]: Timing info for test.retail.not_null_bronze__orders_order_created_at.05e711bf75 (execute): 17:03:45.175452 => 17:03:46.846619
[0m17:03:46.849847 [warn ] [Thread-1 (]: 1 of 15 WARN 1974 not_null_bronze__orders_order_created_at ..................... [[33mWARN 1974[0m in 1.74s]
[0m17:03:46.851316 [debug] [Thread-1 (]: Finished running node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m17:03:46.852299 [debug] [Thread-1 (]: Began running node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m17:03:46.853089 [info ] [Thread-1 (]: 8 of 15 START test source_not_null_raw_csv_sessions_session_id ................. [RUN]
[0m17:03:46.854141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__orders_order_created_at.05e711bf75, now test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194)
[0m17:03:46.854910 [debug] [Thread-1 (]: Began compiling node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m17:03:46.859434 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"
[0m17:03:46.884030 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194 (compile): 17:03:46.855502 => 17:03:46.883696
[0m17:03:46.884869 [debug] [Thread-1 (]: Began executing node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m17:03:46.887462 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"
[0m17:03:46.910329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:46.946529 [debug] [Thread-1 (]: On test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from `retail-data-pipeline-dev`.`retail_raw`.`sessions`
where session_id is null



      
    ) dbt_internal_test
[0m17:03:47.455863 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:b021c7da-e0a1-4b8b-a51a-449b3e3f52a8&page=queryresults
[0m17:03:47.522648 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:7bf82220-b28f-4e43-9836-3dc0b7d90e64&page=queryresults
[0m17:03:47.540388 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:cfdd67e7-b7ae-41f1-863e-b1ebe12771a1&page=queryresults
[0m17:03:47.684653 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:03b2f2e5-82f1-4bb2-9195-f6edd1fdf08a&page=queryresults
[0m17:03:47.991239 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2 (execute): 17:03:46.639438 => 17:03:47.990902
[0m17:03:47.992652 [info ] [Thread-2 (]: 5 of 15 PASS source_not_null_raw_csv_order_items_order_id ...................... [[32mPASS[0m in 1.38s]
[0m17:03:47.993838 [debug] [Thread-2 (]: Finished running node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m17:03:47.994987 [debug] [Thread-2 (]: Began running node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m17:03:47.995979 [info ] [Thread-2 (]: 9 of 15 START test source_not_null_raw_csv_users_user_id ....................... [RUN]
[0m17:03:47.997296 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2, now test.retail.source_not_null_raw_csv_users_user_id.3380c1257d)
[0m17:03:47.998099 [debug] [Thread-2 (]: Began compiling node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m17:03:48.002348 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"
[0m17:03:48.028060 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_users_user_id.3380c1257d (compile): 17:03:47.998758 => 17:03:48.027414
[0m17:03:48.028987 [debug] [Thread-2 (]: Began executing node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m17:03:48.032562 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"
[0m17:03:48.050999 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:03:48.087000 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6 (execute): 17:03:46.755734 => 17:03:48.086639
[0m17:03:48.087530 [debug] [Thread-2 (]: On test.retail.source_not_null_raw_csv_users_user_id.3380c1257d: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `retail-data-pipeline-dev`.`retail_raw`.`users`
where user_id is null



      
    ) dbt_internal_test
[0m17:03:48.088354 [info ] [Thread-4 (]: 7 of 15 PASS source_not_null_raw_csv_products_product_id ....................... [[32mPASS[0m in 1.35s]
[0m17:03:48.091232 [debug] [Thread-4 (]: Finished running node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m17:03:48.091981 [debug] [Thread-4 (]: Began running node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m17:03:48.092759 [info ] [Thread-4 (]: 10 of 15 START test source_unique_raw_csv_orders_order_id ...................... [RUN]
[0m17:03:48.094228 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6, now test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53)
[0m17:03:48.095212 [debug] [Thread-4 (]: Began compiling node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m17:03:48.101543 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"
[0m17:03:48.119257 [debug] [Thread-4 (]: Timing info for test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53 (compile): 17:03:48.095868 => 17:03:48.118874
[0m17:03:48.120275 [debug] [Thread-4 (]: Began executing node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m17:03:48.123234 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"
[0m17:03:48.143235 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:03:48.182104 [debug] [Thread-4 (]: On test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:03:48.216253 [debug] [Thread-3 (]: Timing info for test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336 (execute): 17:03:46.749663 => 17:03:48.215982
[0m17:03:48.217426 [info ] [Thread-3 (]: 6 of 15 PASS source_not_null_raw_csv_orders_order_id ........................... [[32mPASS[0m in 1.50s]
[0m17:03:48.218503 [debug] [Thread-3 (]: Finished running node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m17:03:48.219521 [debug] [Thread-3 (]: Began running node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m17:03:48.220320 [info ] [Thread-3 (]: 11 of 15 START test source_unique_raw_csv_products_product_id .................. [RUN]
[0m17:03:48.221430 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336, now test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1)
[0m17:03:48.222122 [debug] [Thread-3 (]: Began compiling node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m17:03:48.226111 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"
[0m17:03:48.236623 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194 (execute): 17:03:46.885439 => 17:03:48.236344
[0m17:03:48.237701 [info ] [Thread-1 (]: 8 of 15 PASS source_not_null_raw_csv_sessions_session_id ....................... [[32mPASS[0m in 1.38s]
[0m17:03:48.238591 [debug] [Thread-1 (]: Finished running node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m17:03:48.239597 [debug] [Thread-1 (]: Began running node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m17:03:48.240204 [info ] [Thread-1 (]: 12 of 15 START test source_unique_raw_csv_sessions_session_id .................. [RUN]
[0m17:03:48.241061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194, now test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8)
[0m17:03:48.241751 [debug] [Thread-1 (]: Began compiling node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m17:03:48.245780 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"
[0m17:03:48.248059 [debug] [Thread-3 (]: Timing info for test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1 (compile): 17:03:48.222622 => 17:03:48.247747
[0m17:03:48.248859 [debug] [Thread-3 (]: Began executing node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m17:03:48.251732 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"
[0m17:03:48.255187 [debug] [Thread-1 (]: Timing info for test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8 (compile): 17:03:48.242187 => 17:03:48.254882
[0m17:03:48.256163 [debug] [Thread-1 (]: Began executing node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m17:03:48.259524 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"
[0m17:03:48.273969 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:03:48.277523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:48.342717 [debug] [Thread-3 (]: On test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:03:48.344014 [debug] [Thread-1 (]: On test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select session_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`sessions`
  where session_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:03:48.802595 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:40f63b56-0f4d-4323-b323-abd0716398e6&page=queryresults
[0m17:03:48.925986 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:741802a5-c80e-4435-aeae-2bad066c4d43&page=queryresults
[0m17:03:49.016521 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:c4593bde-08c0-4f19-b67d-65fe17c0c602&page=queryresults
[0m17:03:49.121212 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:76e08f80-ed0a-4291-95d8-ba20f4079ee6&page=queryresults
[0m17:03:49.378387 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_users_user_id.3380c1257d (execute): 17:03:48.029539 => 17:03:49.378109
[0m17:03:49.379600 [info ] [Thread-2 (]: 9 of 15 PASS source_not_null_raw_csv_users_user_id ............................. [[32mPASS[0m in 1.38s]
[0m17:03:49.380710 [debug] [Thread-2 (]: Finished running node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m17:03:49.381556 [debug] [Thread-2 (]: Began running node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m17:03:49.382894 [info ] [Thread-2 (]: 13 of 15 START test source_unique_raw_csv_users_user_id ........................ [RUN]
[0m17:03:49.384395 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_users_user_id.3380c1257d, now test.retail.source_unique_raw_csv_users_user_id.d8f871acc9)
[0m17:03:49.385338 [debug] [Thread-2 (]: Began compiling node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m17:03:49.389775 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"
[0m17:03:49.415613 [debug] [Thread-2 (]: Timing info for test.retail.source_unique_raw_csv_users_user_id.d8f871acc9 (compile): 17:03:49.386084 => 17:03:49.415223
[0m17:03:49.416636 [debug] [Thread-2 (]: Began executing node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m17:03:49.419405 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"
[0m17:03:49.441802 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:03:49.444506 [debug] [Thread-4 (]: Timing info for test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53 (execute): 17:03:48.121207 => 17:03:49.444237
[0m17:03:49.445639 [warn ] [Thread-4 (]: 10 of 15 WARN 5000 source_unique_raw_csv_orders_order_id ....................... [[33mWARN 5000[0m in 1.35s]
[0m17:03:49.446662 [debug] [Thread-4 (]: Finished running node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m17:03:49.447664 [debug] [Thread-4 (]: Began running node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m17:03:49.448553 [info ] [Thread-4 (]: 14 of 15 START test unique_bronze__orders_order_id ............................. [RUN]
[0m17:03:49.482410 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53, now test.retail.unique_bronze__orders_order_id.cd2f27ce5f)
[0m17:03:49.483145 [debug] [Thread-2 (]: On test.retail.source_unique_raw_csv_users_user_id.d8f871acc9: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:03:49.483734 [debug] [Thread-4 (]: Began compiling node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m17:03:49.490657 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"
[0m17:03:49.511221 [debug] [Thread-4 (]: Timing info for test.retail.unique_bronze__orders_order_id.cd2f27ce5f (compile): 17:03:49.486585 => 17:03:49.510891
[0m17:03:49.512132 [debug] [Thread-4 (]: Began executing node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m17:03:49.514653 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"
[0m17:03:49.532479 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:03:49.534650 [debug] [Thread-1 (]: Timing info for test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8 (execute): 17:03:48.256956 => 17:03:49.534242
[0m17:03:49.535862 [error] [Thread-1 (]: 12 of 15 FAIL 8000 source_unique_raw_csv_sessions_session_id ................... [[31mFAIL 8000[0m in 1.29s]
[0m17:03:49.537052 [debug] [Thread-1 (]: Finished running node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m17:03:49.537924 [debug] [Thread-1 (]: Began running node test.retail.unique_bronze__users_user_id.129342c645
[0m17:03:49.569343 [info ] [Thread-1 (]: 15 of 15 START test unique_bronze__users_user_id ............................... [RUN]
[0m17:03:49.570734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8, now test.retail.unique_bronze__users_user_id.129342c645)
[0m17:03:49.571322 [debug] [Thread-4 (]: On test.retail.unique_bronze__orders_order_id.cd2f27ce5f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:03:49.571766 [debug] [Thread-1 (]: Began compiling node test.retail.unique_bronze__users_user_id.129342c645
[0m17:03:49.578979 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.unique_bronze__users_user_id.129342c645"
[0m17:03:49.598232 [debug] [Thread-1 (]: Timing info for test.retail.unique_bronze__users_user_id.129342c645 (compile): 17:03:49.574401 => 17:03:49.597667
[0m17:03:49.599629 [debug] [Thread-1 (]: Began executing node test.retail.unique_bronze__users_user_id.129342c645
[0m17:03:49.603076 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.unique_bronze__users_user_id.129342c645"
[0m17:03:49.624716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:49.665332 [debug] [Thread-3 (]: Timing info for test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1 (execute): 17:03:48.249548 => 17:03:49.665053
[0m17:03:49.666410 [debug] [Thread-1 (]: On test.retail.unique_bronze__users_user_id.129342c645: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_bronze__users_user_id.129342c645"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:03:49.667788 [error] [Thread-3 (]: 11 of 15 FAIL 200 source_unique_raw_csv_products_product_id .................... [[31mFAIL 200[0m in 1.45s]
[0m17:03:49.671575 [debug] [Thread-3 (]: Finished running node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m17:03:50.215274 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:d329cde5-8177-41be-b143-525451baaaee&page=queryresults
[0m17:03:50.293491 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:79e20e99-ebcc-4034-928b-fa18edcd5ba5&page=queryresults
[0m17:03:50.342515 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:695ec1f2-b7d0-483b-8fbc-4dd7c4ece975&page=queryresults
[0m17:03:50.724858 [debug] [Thread-2 (]: Timing info for test.retail.source_unique_raw_csv_users_user_id.d8f871acc9 (execute): 17:03:49.417370 => 17:03:50.724558
[0m17:03:50.726615 [warn ] [Thread-2 (]: 13 of 15 WARN 1000 source_unique_raw_csv_users_user_id ......................... [[33mWARN 1000[0m in 1.34s]
[0m17:03:50.728228 [debug] [Thread-2 (]: Finished running node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m17:03:50.786549 [debug] [Thread-4 (]: Timing info for test.retail.unique_bronze__orders_order_id.cd2f27ce5f (execute): 17:03:49.512691 => 17:03:50.786161
[0m17:03:50.788033 [warn ] [Thread-4 (]: 14 of 15 WARN 5000 unique_bronze__orders_order_id .............................. [[33mWARN 5000[0m in 1.31s]
[0m17:03:50.789134 [debug] [Thread-4 (]: Finished running node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m17:03:50.852289 [debug] [Thread-1 (]: Timing info for test.retail.unique_bronze__users_user_id.129342c645 (execute): 17:03:49.600638 => 17:03:50.851981
[0m17:03:50.853538 [warn ] [Thread-1 (]: 15 of 15 WARN 1000 unique_bronze__users_user_id ................................ [[33mWARN 1000[0m in 1.28s]
[0m17:03:50.854701 [debug] [Thread-1 (]: Finished running node test.retail.unique_bronze__users_user_id.129342c645
[0m17:03:50.858217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:50.859222 [debug] [MainThread]: Connection 'test.retail.unique_bronze__users_user_id.129342c645' was properly closed.
[0m17:03:50.860087 [debug] [MainThread]: Connection 'test.retail.source_unique_raw_csv_users_user_id.d8f871acc9' was properly closed.
[0m17:03:50.861233 [debug] [MainThread]: Connection 'test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1' was properly closed.
[0m17:03:50.862232 [debug] [MainThread]: Connection 'test.retail.unique_bronze__orders_order_id.cd2f27ce5f' was properly closed.
[0m17:03:50.863044 [info ] [MainThread]: 
[0m17:03:50.863806 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 6.30 seconds (6.30s).
[0m17:03:50.867884 [debug] [MainThread]: Command end result
[0m17:03:50.913396 [info ] [MainThread]: 
[0m17:03:50.914484 [info ] [MainThread]: [31mCompleted with 2 errors and 5 warnings:[0m
[0m17:03:50.915354 [info ] [MainThread]: 
[0m17:03:50.916317 [error] [MainThread]: [31mFailure in test source_unique_raw_csv_sessions_session_id (models/bronze/sources.yml)[0m
[0m17:03:50.917291 [error] [MainThread]:   Got 8000 results, configured to fail if != 0
[0m17:03:50.918244 [info ] [MainThread]: 
[0m17:03:50.919288 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/sources.yml/source_unique_raw_csv_sessions_session_id.sql
[0m17:03:50.920136 [info ] [MainThread]: 
[0m17:03:50.920914 [error] [MainThread]: [31mFailure in test source_unique_raw_csv_products_product_id (models/bronze/sources.yml)[0m
[0m17:03:50.921692 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m17:03:50.922428 [info ] [MainThread]: 
[0m17:03:50.923407 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/sources.yml/source_unique_raw_csv_products_product_id.sql
[0m17:03:50.924518 [info ] [MainThread]: 
[0m17:03:50.925371 [warn ] [MainThread]: [33mWarning in test not_null_bronze__orders_order_created_at (models/bronze/schema.yml)[0m
[0m17:03:50.926244 [warn ] [MainThread]: Got 1974 results, configured to warn if != 0
[0m17:03:50.927567 [info ] [MainThread]: 
[0m17:03:50.928548 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/schema.yml/not_null_bronze__orders_order_created_at.sql
[0m17:03:50.929539 [info ] [MainThread]: 
[0m17:03:50.930454 [warn ] [MainThread]: [33mWarning in test source_unique_raw_csv_orders_order_id (models/bronze/sources.yml)[0m
[0m17:03:50.931241 [warn ] [MainThread]: Got 5000 results, configured to warn if != 0
[0m17:03:50.932035 [info ] [MainThread]: 
[0m17:03:50.932799 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/sources.yml/source_unique_raw_csv_orders_order_id.sql
[0m17:03:50.933534 [info ] [MainThread]: 
[0m17:03:50.934399 [warn ] [MainThread]: [33mWarning in test source_unique_raw_csv_users_user_id (models/bronze/sources.yml)[0m
[0m17:03:50.935355 [warn ] [MainThread]: Got 1000 results, configured to warn if != 0
[0m17:03:50.936308 [info ] [MainThread]: 
[0m17:03:50.937151 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/sources.yml/source_unique_raw_csv_users_user_id.sql
[0m17:03:50.938026 [info ] [MainThread]: 
[0m17:03:50.938819 [warn ] [MainThread]: [33mWarning in test unique_bronze__orders_order_id (models/bronze/schema.yml)[0m
[0m17:03:50.939560 [warn ] [MainThread]: Got 5000 results, configured to warn if != 0
[0m17:03:50.940338 [info ] [MainThread]: 
[0m17:03:50.941137 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/schema.yml/unique_bronze__orders_order_id.sql
[0m17:03:50.941853 [info ] [MainThread]: 
[0m17:03:50.942578 [warn ] [MainThread]: [33mWarning in test unique_bronze__users_user_id (models/bronze/schema.yml)[0m
[0m17:03:50.943395 [warn ] [MainThread]: Got 1000 results, configured to warn if != 0
[0m17:03:50.944541 [info ] [MainThread]: 
[0m17:03:50.945679 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/schema.yml/unique_bronze__users_user_id.sql
[0m17:03:50.946555 [info ] [MainThread]: 
[0m17:03:50.947421 [info ] [MainThread]: Done. PASS=8 WARN=5 ERROR=2 SKIP=0 TOTAL=15
[0m17:03:50.949204 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 15.589603, "process_user_time": 4.265202, "process_kernel_time": 1.649, "process_mem_max_rss": "238928", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:03:50.950501 [debug] [MainThread]: Command `dbt test` failed at 17:03:50.950230 after 15.59 seconds
[0m17:03:50.952038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720806e68110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207d9831820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207d93281a0>]}
[0m17:03:50.953607 [debug] [MainThread]: Flushing usage events
[0m17:05:58.779901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746567fd38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746567f00fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7465680fd640>]}


============================== 17:05:58.786543 | bacc5d4f-fcef-4041-8165-41d055959a88 ==============================
[0m17:05:58.786543 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:05:58.787454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:05:58.870995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bacc5d4f-fcef-4041-8165-41d055959a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746567fd76e0>]}
[0m17:06:00.362691 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1mj1v85k'
[0m17:06:00.363514 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:06:00.602830 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:06:00.603915 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:06:00.726342 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:06:00.729815 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m17:06:00.854018 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m17:06:00.857798 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m17:06:00.981371 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m17:06:00.984457 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:06:08.901156 [info ] [MainThread]: Installed from version 1.3.1
[0m17:06:08.902087 [info ] [MainThread]: Up to date!
[0m17:06:08.902964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bacc5d4f-fcef-4041-8165-41d055959a88', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746567e8c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7465682ca240>]}
[0m17:06:08.903984 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m17:06:15.339510 [info ] [MainThread]: Installed from version 0.10.9
[0m17:06:15.340687 [info ] [MainThread]: Up to date!
[0m17:06:15.341679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bacc5d4f-fcef-4041-8165-41d055959a88', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746567fd05f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746567d69b80>]}
[0m17:06:15.342614 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m17:06:18.233969 [info ] [MainThread]: Installed from version 0.15.0
[0m17:06:18.234854 [info ] [MainThread]: Up to date!
[0m17:06:18.235674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bacc5d4f-fcef-4041-8165-41d055959a88', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746567eb7d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746567eb7b90>]}
[0m17:06:18.237791 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 19.484556, "process_user_time": 2.60839, "process_kernel_time": 0.671339, "process_mem_max_rss": "207152", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m17:06:18.238767 [debug] [MainThread]: Command `dbt deps` succeeded at 17:06:18.238588 after 19.49 seconds
[0m17:06:18.239499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7465685b5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746568782870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74656885d940>]}
[0m17:06:18.240317 [debug] [MainThread]: Flushing usage events
[0m17:06:23.078163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704edd284f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704edd1b10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704edd284fe0>]}


============================== 17:06:23.084871 | 2ecb432c-49f9-4ecd-ae16-831ea816c88a ==============================
[0m17:06:23.084871 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:06:23.086333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:06:23.967046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ecb432c-49f9-4ecd-ae16-831ea816c88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704eb4ca5a30>]}
[0m17:06:24.038245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ecb432c-49f9-4ecd-ae16-831ea816c88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704eb44e9e20>]}
[0m17:06:24.039782 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m17:06:24.179383 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:06:32.214580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:06:32.216073 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:06:32.218403 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m17:06:32.237807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ecb432c-49f9-4ecd-ae16-831ea816c88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704eb4124950>]}
[0m17:06:32.333999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ecb432c-49f9-4ecd-ae16-831ea816c88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704eafc71940>]}
[0m17:06:32.335670 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m17:06:32.337432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ecb432c-49f9-4ecd-ae16-831ea816c88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704eb4ca5670>]}
[0m17:06:32.347630 [info ] [MainThread]: 
[0m17:06:32.349173 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:06:32.351490 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m17:06:32.352435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:32.958193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod)
[0m17:06:32.959193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:33.436023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ecb432c-49f9-4ecd-ae16-831ea816c88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704eb43818b0>]}
[0m17:06:33.437065 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:06:33.437852 [info ] [MainThread]: 
[0m17:06:33.446429 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m17:06:33.446944 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m17:06:33.447544 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod.bronze__orders ........................ [RUN]
[0m17:06:33.448532 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod.bronze__users ......................... [RUN]
[0m17:06:33.449476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.bronze__orders)
[0m17:06:33.450507 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m17:06:33.451107 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m17:06:33.451758 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m17:06:33.458512 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m17:06:33.461071 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m17:06:33.471412 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 17:06:33.452254 => 17:06:33.471110
[0m17:06:33.472362 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m17:06:33.481029 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 17:06:33.458767 => 17:06:33.480565
[0m17:06:33.484831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:33.485370 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m17:06:33.489029 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:06:34.035939 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m17:06:34.037565 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m17:06:34.047358 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe.parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m17:06:34.051465 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe.parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m17:06:34.394922 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:c3a9c1b1-a81b-4906-add5-9c24c857bbbe&page=queryresults
[0m17:06:34.403569 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:7a660361-2ea4-4860-bf76-419924a16944&page=queryresults
[0m17:06:36.438809 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 17:06:33.472906 => 17:06:36.438415
[0m17:06:36.441149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ecb432c-49f9-4ecd-ae16-831ea816c88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704eb4195e20>]}
[0m17:06:36.443108 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 17:06:33.487246 => 17:06:36.442922
[0m17:06:36.443905 [info ] [Thread-1 (]: 1 of 2 OK created sql table model retail_prod.bronze__orders ................... [[32mCREATE TABLE (5.0k rows, 412.1 KiB processed)[0m in 2.99s]
[0m17:06:36.445245 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ecb432c-49f9-4ecd-ae16-831ea816c88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704eb4195880>]}
[0m17:06:36.446454 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m17:06:36.447781 [info ] [Thread-2 (]: 2 of 2 OK created sql table model retail_prod.bronze__users .................... [[32mCREATE TABLE (1.0k rows, 106.6 KiB processed)[0m in 3.00s]
[0m17:06:36.449557 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m17:06:36.452971 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:36.454595 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m17:06:36.455288 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m17:06:36.455941 [info ] [MainThread]: 
[0m17:06:36.456714 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.11 seconds (4.11s).
[0m17:06:36.457959 [debug] [MainThread]: Command end result
[0m17:06:36.507803 [info ] [MainThread]: 
[0m17:06:36.509075 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:06:36.509965 [info ] [MainThread]: 
[0m17:06:36.510789 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:06:36.512130 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.470408, "process_user_time": 3.715835, "process_kernel_time": 1.492789, "process_mem_max_rss": "235968", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:06:36.513256 [debug] [MainThread]: Command `dbt run` succeeded at 17:06:36.512920 after 13.47 seconds
[0m17:06:36.514330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704edd233e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704ee115db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704ee1b290d0>]}
[0m17:06:36.515152 [debug] [MainThread]: Flushing usage events
[0m17:06:41.279810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732b755891c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732b754b90a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732b75879ca0>]}


============================== 17:06:41.286046 | 252dfd80-5176-46a2-bd37-0c73c6c40a1e ==============================
[0m17:06:41.286046 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:06:41.287141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:06:42.364128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '252dfd80-5176-46a2-bd37-0c73c6c40a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732b54f2df70>]}
[0m17:06:42.496017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '252dfd80-5176-46a2-bd37-0c73c6c40a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732b4cb7c3e0>]}
[0m17:06:42.497615 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m17:06:42.636176 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:06:51.123091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:06:51.124252 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:06:51.125704 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m17:06:51.131616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '252dfd80-5176-46a2-bd37-0c73c6c40a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732b4c52b2f0>]}
[0m17:06:51.182246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '252dfd80-5176-46a2-bd37-0c73c6c40a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732b47f5e060>]}
[0m17:06:51.183659 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m17:06:51.184670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '252dfd80-5176-46a2-bd37-0c73c6c40a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732b4c20da30>]}
[0m17:06:51.196322 [info ] [MainThread]: 
[0m17:06:51.197968 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:06:51.200292 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev_retail_prod'
[0m17:06:51.201289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:51.718246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '252dfd80-5176-46a2-bd37-0c73c6c40a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732b4c56fb90>]}
[0m17:06:51.719474 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:06:51.720335 [info ] [MainThread]: 
[0m17:06:51.730680 [debug] [Thread-1 (]: Began running node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m17:06:51.731806 [debug] [Thread-2 (]: Began running node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m17:06:51.732571 [debug] [Thread-3 (]: Began running node test.retail.not_null_bronze__users_email.2bec59e73f
[0m17:06:51.733314 [info ] [Thread-1 (]: 1 of 15 START test not_null_bronze__orders_order_created_at .................... [RUN]
[0m17:06:51.734302 [debug] [Thread-4 (]: Began running node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m17:06:51.735396 [info ] [Thread-2 (]: 2 of 15 START test not_null_bronze__orders_order_id ............................ [RUN]
[0m17:06:51.736362 [info ] [Thread-3 (]: 3 of 15 START test not_null_bronze__users_email ................................ [RUN]
[0m17:06:51.737674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now test.retail.not_null_bronze__orders_order_created_at.05e711bf75)
[0m17:06:51.738728 [info ] [Thread-4 (]: 4 of 15 START test not_null_bronze__users_user_id .............................. [RUN]
[0m17:06:51.740383 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__orders_order_id.4b38fb230a'
[0m17:06:51.741956 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__users_email.2bec59e73f'
[0m17:06:51.743047 [debug] [Thread-1 (]: Began compiling node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m17:06:51.744141 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__users_user_id.cb91e05164'
[0m17:06:51.744966 [debug] [Thread-2 (]: Began compiling node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m17:06:51.746361 [debug] [Thread-3 (]: Began compiling node test.retail.not_null_bronze__users_email.2bec59e73f
[0m17:06:51.758750 [debug] [Thread-4 (]: Began compiling node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m17:06:51.763498 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"
[0m17:06:51.768488 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.not_null_bronze__orders_order_id.4b38fb230a"
[0m17:06:51.773983 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.not_null_bronze__users_email.2bec59e73f"
[0m17:06:51.780046 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.not_null_bronze__users_user_id.cb91e05164"
[0m17:06:51.796182 [debug] [Thread-1 (]: Timing info for test.retail.not_null_bronze__orders_order_created_at.05e711bf75 (compile): 17:06:51.747339 => 17:06:51.795494
[0m17:06:51.797423 [debug] [Thread-1 (]: Began executing node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m17:06:51.798164 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__users_user_id.cb91e05164 (compile): 17:06:51.775099 => 17:06:51.797836
[0m17:06:51.799188 [debug] [Thread-2 (]: Timing info for test.retail.not_null_bronze__orders_order_id.4b38fb230a (compile): 17:06:51.764805 => 17:06:51.798712
[0m17:06:51.811090 [debug] [Thread-4 (]: Began executing node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m17:06:51.811952 [debug] [Thread-3 (]: Timing info for test.retail.not_null_bronze__users_email.2bec59e73f (compile): 17:06:51.769587 => 17:06:51.811637
[0m17:06:51.820510 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"
[0m17:06:51.821264 [debug] [Thread-2 (]: Began executing node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m17:06:51.824523 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.not_null_bronze__users_user_id.cb91e05164"
[0m17:06:51.825782 [debug] [Thread-3 (]: Began executing node test.retail.not_null_bronze__users_email.2bec59e73f
[0m17:06:51.829884 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.not_null_bronze__orders_order_id.4b38fb230a"
[0m17:06:51.832795 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.not_null_bronze__users_email.2bec59e73f"
[0m17:06:51.839190 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:06:51.841591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:51.843447 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:06:51.876977 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:06:51.912825 [debug] [Thread-4 (]: On test.retail.not_null_bronze__users_user_id.cb91e05164: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__users_user_id.cb91e05164"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
where user_id is null



      
    ) dbt_internal_test
[0m17:06:51.914594 [debug] [Thread-1 (]: On test.retail.not_null_bronze__orders_order_created_at.05e711bf75: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_created_at
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
where order_created_at is null



      
    ) dbt_internal_test
[0m17:06:51.962063 [debug] [Thread-2 (]: On test.retail.not_null_bronze__orders_order_id.4b38fb230a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__orders_order_id.4b38fb230a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
where order_id is null



      
    ) dbt_internal_test
[0m17:06:51.998313 [debug] [Thread-3 (]: On test.retail.not_null_bronze__users_email.2bec59e73f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__users_email.2bec59e73f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
where email is null



      
    ) dbt_internal_test
[0m17:06:52.627330 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:ab229a02-3f1e-488b-b8fd-90a0079ba75f&page=queryresults
[0m17:06:52.661294 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:8f7833f1-377d-4340-aa43-f5a9ea4cd2c4&page=queryresults
[0m17:06:52.680327 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:ba475989-ec98-4613-96c6-cfd934dc617c&page=queryresults
[0m17:06:52.702579 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:a71eaa4c-84b6-4624-9995-757ef5a986db&page=queryresults
[0m17:06:53.170090 [debug] [Thread-1 (]: Timing info for test.retail.not_null_bronze__orders_order_created_at.05e711bf75 (execute): 17:06:51.799803 => 17:06:53.169806
[0m17:06:53.171362 [warn ] [Thread-1 (]: 1 of 15 WARN 982 not_null_bronze__orders_order_created_at ...................... [[33mWARN 982[0m in 1.43s]
[0m17:06:53.172583 [debug] [Thread-1 (]: Finished running node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m17:06:53.173975 [debug] [Thread-1 (]: Began running node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m17:06:53.175376 [info ] [Thread-1 (]: 5 of 15 START test source_not_null_raw_csv_order_items_order_id ................ [RUN]
[0m17:06:53.176729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__orders_order_created_at.05e711bf75, now test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2)
[0m17:06:53.177543 [debug] [Thread-1 (]: Began compiling node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m17:06:53.182973 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"
[0m17:06:53.184532 [debug] [Thread-3 (]: Timing info for test.retail.not_null_bronze__users_email.2bec59e73f (execute): 17:06:51.830973 => 17:06:53.184183
[0m17:06:53.186430 [info ] [Thread-3 (]: 3 of 15 PASS not_null_bronze__users_email ...................................... [[32mPASS[0m in 1.44s]
[0m17:06:53.187733 [debug] [Thread-3 (]: Finished running node test.retail.not_null_bronze__users_email.2bec59e73f
[0m17:06:53.188849 [debug] [Thread-3 (]: Began running node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m17:06:53.190456 [info ] [Thread-3 (]: 6 of 15 START test source_not_null_raw_csv_orders_order_id ..................... [RUN]
[0m17:06:53.192567 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__users_email.2bec59e73f, now test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336)
[0m17:06:53.194127 [debug] [Thread-3 (]: Began compiling node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m17:06:53.200245 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"
[0m17:06:53.202491 [debug] [Thread-2 (]: Timing info for test.retail.not_null_bronze__orders_order_id.4b38fb230a (execute): 17:06:51.827213 => 17:06:53.202150
[0m17:06:53.204336 [info ] [Thread-2 (]: 2 of 15 PASS not_null_bronze__orders_order_id .................................. [[32mPASS[0m in 1.46s]
[0m17:06:53.206012 [debug] [Thread-2 (]: Finished running node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m17:06:53.207774 [debug] [Thread-2 (]: Began running node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m17:06:53.209262 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2 (compile): 17:06:53.178338 => 17:06:53.208553
[0m17:06:53.209971 [info ] [Thread-2 (]: 7 of 15 START test source_not_null_raw_csv_products_product_id ................. [RUN]
[0m17:06:53.211327 [debug] [Thread-1 (]: Began executing node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m17:06:53.213246 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__orders_order_id.4b38fb230a, now test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6)
[0m17:06:53.214626 [debug] [Thread-3 (]: Timing info for test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336 (compile): 17:06:53.195007 => 17:06:53.214092
[0m17:06:53.218270 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"
[0m17:06:53.219751 [debug] [Thread-2 (]: Began compiling node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m17:06:53.221437 [debug] [Thread-3 (]: Began executing node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m17:06:53.236281 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"
[0m17:06:53.237282 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"
[0m17:06:53.245042 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__users_user_id.cb91e05164 (execute): 17:06:51.822068 => 17:06:53.244537
[0m17:06:53.246934 [info ] [Thread-4 (]: 4 of 15 PASS not_null_bronze__users_user_id .................................... [[32mPASS[0m in 1.50s]
[0m17:06:53.248700 [debug] [Thread-4 (]: Finished running node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m17:06:53.249913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:53.251533 [debug] [Thread-4 (]: Began running node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m17:06:53.253768 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:06:53.255550 [info ] [Thread-4 (]: 8 of 15 START test source_not_null_raw_csv_sessions_session_id ................. [RUN]
[0m17:06:53.258577 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__users_user_id.cb91e05164, now test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194)
[0m17:06:53.260119 [debug] [Thread-4 (]: Began compiling node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m17:06:53.354360 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6 (compile): 17:06:53.224058 => 17:06:53.353786
[0m17:06:53.355384 [debug] [Thread-1 (]: On test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_raw`.`order_items`
where order_id is null



      
    ) dbt_internal_test
[0m17:06:53.353316 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"
[0m17:06:53.357335 [debug] [Thread-2 (]: Began executing node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m17:06:53.405264 [debug] [Thread-3 (]: On test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_raw`.`orders`
where order_id is null



      
    ) dbt_internal_test
[0m17:06:53.414154 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"
[0m17:06:53.435246 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194 (compile): 17:06:53.345310 => 17:06:53.434672
[0m17:06:53.436369 [debug] [Thread-4 (]: Began executing node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m17:06:53.440390 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"
[0m17:06:53.443009 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:06:53.493585 [debug] [Thread-2 (]: On test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `retail-data-pipeline-dev`.`retail_raw`.`products`
where product_id is null



      
    ) dbt_internal_test
[0m17:06:53.498266 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:06:53.544425 [debug] [Thread-4 (]: On test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from `retail-data-pipeline-dev`.`retail_raw`.`sessions`
where session_id is null



      
    ) dbt_internal_test
[0m17:06:54.140632 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:de77fcba-7cd3-4754-9e3d-07226d591e51&page=queryresults
[0m17:06:54.143714 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:b8cfba61-fbb2-4814-a048-d13cb27cf2cd&page=queryresults
[0m17:06:54.162883 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:097aad7e-95eb-45b0-ad54-71e72a9a76b9&page=queryresults
[0m17:06:54.278333 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:99467099-64e8-41f3-b5ad-f3a9348dcc58&page=queryresults
[0m17:06:54.670843 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6 (execute): 17:06:53.409862 => 17:06:54.670548
[0m17:06:54.672279 [info ] [Thread-2 (]: 7 of 15 PASS source_not_null_raw_csv_products_product_id ....................... [[32mPASS[0m in 1.46s]
[0m17:06:54.675212 [debug] [Thread-2 (]: Finished running node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m17:06:54.676659 [debug] [Thread-3 (]: Timing info for test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336 (execute): 17:06:53.232307 => 17:06:54.676386
[0m17:06:54.677646 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2 (execute): 17:06:53.215021 => 17:06:54.677319
[0m17:06:54.678132 [debug] [Thread-2 (]: Began running node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m17:06:54.679435 [info ] [Thread-3 (]: 6 of 15 PASS source_not_null_raw_csv_orders_order_id ........................... [[32mPASS[0m in 1.49s]
[0m17:06:54.680990 [info ] [Thread-1 (]: 5 of 15 PASS source_not_null_raw_csv_order_items_order_id ...................... [[32mPASS[0m in 1.50s]
[0m17:06:54.682433 [info ] [Thread-2 (]: 9 of 15 START test source_not_null_raw_csv_users_user_id ....................... [RUN]
[0m17:06:54.684210 [debug] [Thread-3 (]: Finished running node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m17:06:54.685758 [debug] [Thread-1 (]: Finished running node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m17:06:54.687115 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6, now test.retail.source_not_null_raw_csv_users_user_id.3380c1257d)
[0m17:06:54.688112 [debug] [Thread-3 (]: Began running node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m17:06:54.688948 [debug] [Thread-1 (]: Began running node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m17:06:54.689831 [debug] [Thread-2 (]: Began compiling node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m17:06:54.690774 [info ] [Thread-3 (]: 10 of 15 START test source_unique_raw_csv_orders_order_id ...................... [RUN]
[0m17:06:54.691727 [info ] [Thread-1 (]: 11 of 15 START test source_unique_raw_csv_products_product_id .................. [RUN]
[0m17:06:54.697114 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"
[0m17:06:54.698463 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336, now test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53)
[0m17:06:54.699704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2, now test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1)
[0m17:06:54.701859 [debug] [Thread-3 (]: Began compiling node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m17:06:54.703457 [debug] [Thread-1 (]: Began compiling node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m17:06:54.716758 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"
[0m17:06:54.718625 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"
[0m17:06:54.731972 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_users_user_id.3380c1257d (compile): 17:06:54.692401 => 17:06:54.731337
[0m17:06:54.733281 [debug] [Thread-2 (]: Began executing node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m17:06:54.734395 [debug] [Thread-1 (]: Timing info for test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1 (compile): 17:06:54.712364 => 17:06:54.733944
[0m17:06:54.736745 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"
[0m17:06:54.737781 [debug] [Thread-1 (]: Began executing node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m17:06:54.739202 [debug] [Thread-3 (]: Timing info for test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53 (compile): 17:06:54.704511 => 17:06:54.738783
[0m17:06:54.741727 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"
[0m17:06:54.742898 [debug] [Thread-3 (]: Began executing node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m17:06:54.747078 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"
[0m17:06:54.757837 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:06:54.759754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:54.762223 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:06:54.796496 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194 (execute): 17:06:53.437306 => 17:06:54.796222
[0m17:06:54.797013 [debug] [Thread-1 (]: On test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:06:54.828939 [info ] [Thread-4 (]: 8 of 15 PASS source_not_null_raw_csv_sessions_session_id ....................... [[32mPASS[0m in 1.57s]
[0m17:06:54.832920 [debug] [Thread-2 (]: On test.retail.source_not_null_raw_csv_users_user_id.3380c1257d: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `retail-data-pipeline-dev`.`retail_raw`.`users`
where user_id is null



      
    ) dbt_internal_test
[0m17:06:54.834264 [debug] [Thread-4 (]: Finished running node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m17:06:54.870029 [debug] [Thread-4 (]: Began running node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m17:06:54.871547 [info ] [Thread-4 (]: 12 of 15 START test source_unique_raw_csv_sessions_session_id .................. [RUN]
[0m17:06:54.872595 [debug] [Thread-3 (]: On test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:06:54.873498 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194, now test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8)
[0m17:06:54.876708 [debug] [Thread-4 (]: Began compiling node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m17:06:54.882054 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"
[0m17:06:54.905069 [debug] [Thread-4 (]: Timing info for test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8 (compile): 17:06:54.877480 => 17:06:54.904459
[0m17:06:54.906378 [debug] [Thread-4 (]: Began executing node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m17:06:54.911603 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"
[0m17:06:54.939274 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:06:54.979890 [debug] [Thread-4 (]: On test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select session_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`sessions`
  where session_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:06:55.561284 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:b2490231-12ed-45e1-b47c-0033e869751a&page=queryresults
[0m17:06:55.607021 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:6ef65d5f-0113-4f5f-9d2d-694f9b669433&page=queryresults
[0m17:06:55.620356 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:1ec44985-b728-4e14-a638-70da235eeeb4&page=queryresults
[0m17:06:55.717225 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:5e91612d-852c-4789-a0db-abce69f3e4ac&page=queryresults
[0m17:06:56.055129 [debug] [Thread-1 (]: Timing info for test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1 (execute): 17:06:54.739611 => 17:06:56.054843
[0m17:06:56.056767 [info ] [Thread-1 (]: 11 of 15 PASS source_unique_raw_csv_products_product_id ........................ [[32mPASS[0m in 1.36s]
[0m17:06:56.057954 [debug] [Thread-1 (]: Finished running node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m17:06:56.058998 [debug] [Thread-1 (]: Began running node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m17:06:56.059984 [info ] [Thread-1 (]: 13 of 15 START test source_unique_raw_csv_users_user_id ........................ [RUN]
[0m17:06:56.061286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1, now test.retail.source_unique_raw_csv_users_user_id.d8f871acc9)
[0m17:06:56.062187 [debug] [Thread-1 (]: Began compiling node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m17:06:56.066943 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"
[0m17:06:56.091162 [debug] [Thread-1 (]: Timing info for test.retail.source_unique_raw_csv_users_user_id.d8f871acc9 (compile): 17:06:56.062834 => 17:06:56.090722
[0m17:06:56.092429 [debug] [Thread-1 (]: Began executing node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m17:06:56.097095 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"
[0m17:06:56.099492 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_users_user_id.3380c1257d (execute): 17:06:54.734822 => 17:06:56.099131
[0m17:06:56.101591 [debug] [Thread-3 (]: Timing info for test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53 (execute): 17:06:54.744513 => 17:06:56.101096
[0m17:06:56.102768 [info ] [Thread-2 (]: 9 of 15 PASS source_not_null_raw_csv_users_user_id ............................. [[32mPASS[0m in 1.42s]
[0m17:06:56.104039 [info ] [Thread-3 (]: 10 of 15 PASS source_unique_raw_csv_orders_order_id ............................ [[32mPASS[0m in 1.41s]
[0m17:06:56.105233 [debug] [Thread-2 (]: Finished running node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m17:06:56.106414 [debug] [Thread-3 (]: Finished running node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m17:06:56.107462 [debug] [Thread-2 (]: Began running node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m17:06:56.108627 [debug] [Thread-3 (]: Began running node test.retail.unique_bronze__users_user_id.129342c645
[0m17:06:56.109592 [info ] [Thread-2 (]: 14 of 15 START test unique_bronze__orders_order_id ............................. [RUN]
[0m17:06:56.110826 [info ] [Thread-3 (]: 15 of 15 START test unique_bronze__users_user_id ............................... [RUN]
[0m17:06:56.112354 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_users_user_id.3380c1257d, now test.retail.unique_bronze__orders_order_id.cd2f27ce5f)
[0m17:06:56.113782 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53, now test.retail.unique_bronze__users_user_id.129342c645)
[0m17:06:56.114907 [debug] [Thread-2 (]: Began compiling node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m17:06:56.116136 [debug] [Thread-3 (]: Began compiling node test.retail.unique_bronze__users_user_id.129342c645
[0m17:06:56.120830 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"
[0m17:06:56.126094 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.unique_bronze__users_user_id.129342c645"
[0m17:06:56.128558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:56.173111 [debug] [Thread-1 (]: On test.retail.source_unique_raw_csv_users_user_id.d8f871acc9: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:06:56.177257 [debug] [Thread-2 (]: Timing info for test.retail.unique_bronze__orders_order_id.cd2f27ce5f (compile): 17:06:56.116943 => 17:06:56.176619
[0m17:06:56.178788 [debug] [Thread-2 (]: Began executing node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m17:06:56.179953 [debug] [Thread-3 (]: Timing info for test.retail.unique_bronze__users_user_id.129342c645 (compile): 17:06:56.121840 => 17:06:56.179443
[0m17:06:56.183144 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"
[0m17:06:56.184216 [debug] [Thread-3 (]: Began executing node test.retail.unique_bronze__users_user_id.129342c645
[0m17:06:56.188286 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.unique_bronze__users_user_id.129342c645"
[0m17:06:56.197652 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:06:56.200016 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:06:56.239599 [debug] [Thread-2 (]: On test.retail.unique_bronze__orders_order_id.cd2f27ce5f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:06:56.241125 [debug] [Thread-4 (]: Timing info for test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8 (execute): 17:06:54.907286 => 17:06:56.240824
[0m17:06:56.282310 [info ] [Thread-4 (]: 12 of 15 PASS source_unique_raw_csv_sessions_session_id ........................ [[32mPASS[0m in 1.41s]
[0m17:06:56.283564 [debug] [Thread-3 (]: On test.retail.unique_bronze__users_user_id.129342c645: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_bronze__users_user_id.129342c645"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:06:56.284518 [debug] [Thread-4 (]: Finished running node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m17:06:56.906658 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:9510fcdb-1121-4381-b642-318cce6aeaff&page=queryresults
[0m17:06:56.986066 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:36aebbe8-6638-4599-aedc-b3577a3da98e&page=queryresults
[0m17:06:57.011044 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:b00296ce-851d-4e79-a4c9-550348ca44e7&page=queryresults
[0m17:06:57.422920 [debug] [Thread-1 (]: Timing info for test.retail.source_unique_raw_csv_users_user_id.d8f871acc9 (execute): 17:06:56.093487 => 17:06:57.422511
[0m17:06:57.424174 [info ] [Thread-1 (]: 13 of 15 PASS source_unique_raw_csv_users_user_id .............................. [[32mPASS[0m in 1.36s]
[0m17:06:57.425322 [debug] [Thread-1 (]: Finished running node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m17:06:57.527080 [debug] [Thread-3 (]: Timing info for test.retail.unique_bronze__users_user_id.129342c645 (execute): 17:06:56.185641 => 17:06:57.526777
[0m17:06:57.528449 [info ] [Thread-3 (]: 15 of 15 PASS unique_bronze__users_user_id ..................................... [[32mPASS[0m in 1.42s]
[0m17:06:57.529471 [debug] [Thread-3 (]: Finished running node test.retail.unique_bronze__users_user_id.129342c645
[0m17:06:57.533779 [debug] [Thread-2 (]: Timing info for test.retail.unique_bronze__orders_order_id.cd2f27ce5f (execute): 17:06:56.180577 => 17:06:57.533505
[0m17:06:57.535178 [info ] [Thread-2 (]: 14 of 15 PASS unique_bronze__orders_order_id ................................... [[32mPASS[0m in 1.42s]
[0m17:06:57.536340 [debug] [Thread-2 (]: Finished running node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m17:06:57.539743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:57.540997 [debug] [MainThread]: Connection 'test.retail.source_unique_raw_csv_users_user_id.d8f871acc9' was properly closed.
[0m17:06:57.541844 [debug] [MainThread]: Connection 'test.retail.unique_bronze__orders_order_id.cd2f27ce5f' was properly closed.
[0m17:06:57.542610 [debug] [MainThread]: Connection 'test.retail.unique_bronze__users_user_id.129342c645' was properly closed.
[0m17:06:57.543276 [debug] [MainThread]: Connection 'test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8' was properly closed.
[0m17:06:57.544047 [info ] [MainThread]: 
[0m17:06:57.544940 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 6.35 seconds (6.35s).
[0m17:06:57.547251 [debug] [MainThread]: Command end result
[0m17:06:57.594570 [info ] [MainThread]: 
[0m17:06:57.595513 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m17:06:57.596362 [info ] [MainThread]: 
[0m17:06:57.597094 [warn ] [MainThread]: [33mWarning in test not_null_bronze__orders_order_created_at (models/bronze/schema.yml)[0m
[0m17:06:57.598067 [warn ] [MainThread]: Got 982 results, configured to warn if != 0
[0m17:06:57.598730 [info ] [MainThread]: 
[0m17:06:57.599392 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/schema.yml/not_null_bronze__orders_order_created_at.sql
[0m17:06:57.600006 [info ] [MainThread]: 
[0m17:06:57.600610 [info ] [MainThread]: Done. PASS=14 WARN=1 ERROR=0 SKIP=0 TOTAL=15
[0m17:06:57.601928 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 16.402248, "process_user_time": 5.000527, "process_kernel_time": 1.613732, "process_mem_max_rss": "238712", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:06:57.602822 [debug] [MainThread]: Command `dbt test` succeeded at 17:06:57.602638 after 16.40 seconds
[0m17:06:57.603701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732b754b90a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732b4c4286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732b4c56e810>]}
[0m17:06:57.604396 [debug] [MainThread]: Flushing usage events
[0m17:07:03.087640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c09b56cfbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c09b5921fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c09b56cdd30>]}


============================== 17:07:03.093848 | fff7ea18-5e14-410a-8189-c71b8d8d04c0 ==============================
[0m17:07:03.093848 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:07:03.094745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/silver path:models/gold', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:07:04.174334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fff7ea18-5e14-410a-8189-c71b8d8d04c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c098c753e90>]}
[0m17:07:04.254929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fff7ea18-5e14-410a-8189-c71b8d8d04c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c098c80cd70>]}
[0m17:07:04.256489 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m17:07:04.382626 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:07:12.958481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:07:12.959458 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:07:12.960746 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m17:07:12.967796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fff7ea18-5e14-410a-8189-c71b8d8d04c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c098cd145f0>]}
[0m17:07:13.031838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fff7ea18-5e14-410a-8189-c71b8d8d04c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c098c165cd0>]}
[0m17:07:13.033382 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m17:07:13.034606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fff7ea18-5e14-410a-8189-c71b8d8d04c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c09b56cc080>]}
[0m17:07:13.054571 [info ] [MainThread]: 
[0m17:07:13.056200 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:07:13.058897 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m17:07:13.059871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:13.677579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod)
[0m17:07:13.679176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:14.148644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fff7ea18-5e14-410a-8189-c71b8d8d04c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c098d32aae0>]}
[0m17:07:14.150011 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:07:14.151011 [info ] [MainThread]: 
[0m17:07:14.160161 [debug] [Thread-1 (]: Began running node model.retail.silver__orders_enriched
[0m17:07:14.161423 [info ] [Thread-1 (]: 1 of 2 START sql view model retail_prod.silver__orders_enriched ................ [RUN]
[0m17:07:14.162441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.silver__orders_enriched)
[0m17:07:14.163110 [debug] [Thread-1 (]: Began compiling node model.retail.silver__orders_enriched
[0m17:07:14.169533 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.silver__orders_enriched"
[0m17:07:14.190720 [debug] [Thread-1 (]: Timing info for model.retail.silver__orders_enriched (compile): 17:07:14.163582 => 17:07:14.190085
[0m17:07:14.192127 [debug] [Thread-1 (]: Began executing node model.retail.silver__orders_enriched
[0m17:07:14.225552 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.silver__orders_enriched"
[0m17:07:14.247349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:14.290916 [debug] [Thread-1 (]: On model.retail.silver__orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.silver__orders_enriched"} */


  create or replace view `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
  OPTIONS()
  as with orders as (
  select *
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
),
users as (
  select *
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
),
joined as (
  select
    o.order_id,
    o.user_id,
    o.order_created_at,
    o.order_created_at_parse_failed,
    date(o.order_created_at) as order_date,
    o.total_amount,
    o.payment_method,
    o.order_status,
    o.branch,
    u.full_name,
    u.email,
    u.phone,
    u.city as user_city,
    u.created_at as user_created_at,
    u.created_at_parse_failed as user_created_at_parse_failed
  from orders o
  left join users u using (user_id)
)

select *
from joined;


[0m17:07:14.874792 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:e7d5b2f5-2ce0-4037-8b86-7de8c9162374&page=queryresults
[0m17:07:15.225412 [debug] [Thread-1 (]: Timing info for model.retail.silver__orders_enriched (execute): 17:07:14.193915 => 17:07:15.225215
[0m17:07:15.227086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fff7ea18-5e14-410a-8189-c71b8d8d04c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c098c5e5eb0>]}
[0m17:07:15.228845 [info ] [Thread-1 (]: 1 of 2 OK created sql view model retail_prod.silver__orders_enriched ........... [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m17:07:15.230461 [debug] [Thread-1 (]: Finished running node model.retail.silver__orders_enriched
[0m17:07:15.233110 [debug] [Thread-3 (]: Began running node model.retail.gold__daily_branch_metrics
[0m17:07:15.234680 [info ] [Thread-3 (]: 2 of 2 START sql table model retail_prod.gold__daily_branch_metrics ............ [RUN]
[0m17:07:15.236225 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.retail.gold__daily_branch_metrics'
[0m17:07:15.237304 [debug] [Thread-3 (]: Began compiling node model.retail.gold__daily_branch_metrics
[0m17:07:15.240699 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail.gold__daily_branch_metrics"
[0m17:07:15.262874 [debug] [Thread-3 (]: Timing info for model.retail.gold__daily_branch_metrics (compile): 17:07:15.238126 => 17:07:15.262556
[0m17:07:15.263810 [debug] [Thread-3 (]: Began executing node model.retail.gold__daily_branch_metrics
[0m17:07:15.273489 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:07:15.791487 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail.gold__daily_branch_metrics"
[0m17:07:15.814292 [debug] [Thread-3 (]: On model.retail.gold__daily_branch_metrics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.gold__daily_branch_metrics"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`gold__daily_branch_metrics`
      
    
    

    OPTIONS()
    as (
      with fact_orders as (
  select *
  from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
  where order_created_at is not null
),
aggregated as (
  select
    order_date,
    branch,
    count(distinct order_id) as orders_count,
    count(distinct user_id) as customers_count,
    sum(case when order_status = 'completed' then total_amount else 0 end) as completed_revenue,
    sum(case when order_status != 'completed' then total_amount else 0 end) as non_completed_revenue,
    sum(total_amount) as gross_revenue
  from fact_orders
  group by order_date, branch
)

select *
from aggregated
    );
  
[0m17:07:16.578160 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:0de222ad-a060-43f5-a50c-89b8e3c51dbe&page=queryresults
[0m17:07:18.835251 [debug] [Thread-3 (]: Timing info for model.retail.gold__daily_branch_metrics (execute): 17:07:15.264494 => 17:07:18.835058
[0m17:07:18.836497 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fff7ea18-5e14-410a-8189-c71b8d8d04c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c098c1f8aa0>]}
[0m17:07:18.837592 [info ] [Thread-3 (]: 2 of 2 OK created sql table model retail_prod.gold__daily_branch_metrics ....... [[32mCREATE TABLE (3.7k rows, 358.4 KiB processed)[0m in 3.60s]
[0m17:07:18.838663 [debug] [Thread-3 (]: Finished running node model.retail.gold__daily_branch_metrics
[0m17:07:18.841525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:18.842699 [debug] [MainThread]: Connection 'model.retail.silver__orders_enriched' was properly closed.
[0m17:07:18.843701 [debug] [MainThread]: Connection 'model.retail.gold__daily_branch_metrics' was properly closed.
[0m17:07:18.845030 [info ] [MainThread]: 
[0m17:07:18.846007 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.79 seconds (5.79s).
[0m17:07:18.847539 [debug] [MainThread]: Command end result
[0m17:07:18.889363 [info ] [MainThread]: 
[0m17:07:18.890552 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:07:18.891522 [info ] [MainThread]: 
[0m17:07:18.892857 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:07:18.895047 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.846379, "process_user_time": 4.079246, "process_kernel_time": 1.609058, "process_mem_max_rss": "236568", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:07:18.896145 [debug] [MainThread]: Command `dbt run` succeeded at 17:07:18.895988 after 15.85 seconds
[0m17:07:18.896964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c09b580bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c09951ec1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c098d328aa0>]}
[0m17:07:18.897744 [debug] [MainThread]: Flushing usage events
[0m17:07:23.968738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed95e46d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed95e39caa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed95e40fbf0>]}


============================== 17:07:23.975801 | b7b9bd14-9aa3-4852-bf9d-034185295691 ==============================
[0m17:07:23.975801 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:07:23.976905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/silver path:models/gold', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:07:25.030927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7b9bd14-9aa3-4852-bf9d-034185295691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed9313cb260>]}
[0m17:07:25.116817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7b9bd14-9aa3-4852-bf9d-034185295691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed93187ae40>]}
[0m17:07:25.118573 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m17:07:25.248825 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:07:33.463610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:07:33.464892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:07:33.466614 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m17:07:33.472942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7b9bd14-9aa3-4852-bf9d-034185295691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed931bd4bf0>]}
[0m17:07:33.527304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7b9bd14-9aa3-4852-bf9d-034185295691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed95e46ff20>]}
[0m17:07:33.528454 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m17:07:33.529289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7b9bd14-9aa3-4852-bf9d-034185295691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed93180d850>]}
[0m17:07:33.550800 [info ] [MainThread]: 
[0m17:07:33.552365 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:07:33.554793 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev_retail_prod'
[0m17:07:33.555801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:34.057585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7b9bd14-9aa3-4852-bf9d-034185295691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed931398a70>]}
[0m17:07:34.058785 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:07:34.059500 [info ] [MainThread]: 
[0m17:07:34.069467 [debug] [Thread-1 (]: Began running node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m17:07:34.070009 [debug] [Thread-2 (]: Began running node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m17:07:34.070634 [debug] [Thread-3 (]: Began running node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m17:07:34.071297 [info ] [Thread-1 (]: 1 of 5 START test not_null_gold__daily_branch_metrics_branch ................... [RUN]
[0m17:07:34.071896 [debug] [Thread-4 (]: Began running node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m17:07:34.072433 [info ] [Thread-2 (]: 2 of 5 START test not_null_gold__daily_branch_metrics_order_date ............... [RUN]
[0m17:07:34.073497 [info ] [Thread-3 (]: 3 of 5 START test not_null_silver__orders_enriched_order_date .................. [RUN]
[0m17:07:34.074490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761)
[0m17:07:34.075194 [info ] [Thread-4 (]: 4 of 5 START test not_null_silver__orders_enriched_order_id .................... [RUN]
[0m17:07:34.076140 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948'
[0m17:07:34.077059 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.retail.not_null_silver__orders_enriched_order_date.658d753d80'
[0m17:07:34.077826 [debug] [Thread-1 (]: Began compiling node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m17:07:34.078919 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.retail.not_null_silver__orders_enriched_order_id.782515c964'
[0m17:07:34.079612 [debug] [Thread-2 (]: Began compiling node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m17:07:34.080273 [debug] [Thread-3 (]: Began compiling node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m17:07:34.094336 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761"
[0m17:07:34.095027 [debug] [Thread-4 (]: Began compiling node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m17:07:34.099883 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948"
[0m17:07:34.104324 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.not_null_silver__orders_enriched_order_date.658d753d80"
[0m17:07:34.109129 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.not_null_silver__orders_enriched_order_id.782515c964"
[0m17:07:34.116087 [debug] [Thread-1 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761 (compile): 17:07:34.080794 => 17:07:34.115523
[0m17:07:34.117012 [debug] [Thread-2 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948 (compile): 17:07:34.096492 => 17:07:34.116614
[0m17:07:34.117575 [debug] [Thread-1 (]: Began executing node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m17:07:34.118382 [debug] [Thread-2 (]: Began executing node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m17:07:34.130272 [debug] [Thread-3 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_date.658d753d80 (compile): 17:07:34.100861 => 17:07:34.129978
[0m17:07:34.130736 [debug] [Thread-4 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_id.782515c964 (compile): 17:07:34.105583 => 17:07:34.130521
[0m17:07:34.135495 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761"
[0m17:07:34.140082 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948"
[0m17:07:34.141205 [debug] [Thread-3 (]: Began executing node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m17:07:34.141875 [debug] [Thread-4 (]: Began executing node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m17:07:34.145199 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.not_null_silver__orders_enriched_order_date.658d753d80"
[0m17:07:34.147450 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.not_null_silver__orders_enriched_order_id.782515c964"
[0m17:07:34.152933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:34.155304 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:07:34.157085 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:07:34.192189 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:07:34.192910 [debug] [Thread-1 (]: On test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select branch
from `retail-data-pipeline-dev`.`retail_prod`.`gold__daily_branch_metrics`
where branch is null



      
    ) dbt_internal_test
[0m17:07:34.223799 [debug] [Thread-2 (]: On test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from `retail-data-pipeline-dev`.`retail_prod`.`gold__daily_branch_metrics`
where order_date is null



      
    ) dbt_internal_test
[0m17:07:34.260570 [debug] [Thread-4 (]: On test.retail.not_null_silver__orders_enriched_order_id.782515c964: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_silver__orders_enriched_order_id.782515c964"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
where order_id is null



      
    ) dbt_internal_test
[0m17:07:34.295178 [debug] [Thread-3 (]: On test.retail.not_null_silver__orders_enriched_order_date.658d753d80: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_silver__orders_enriched_order_date.658d753d80"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
where order_date is null



      
    ) dbt_internal_test
[0m17:07:35.048641 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:b1ed25b7-f153-441e-8539-2d3ea89cce1d&page=queryresults
[0m17:07:35.055142 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:79eaefb5-fd49-4c36-a8cc-1eb823b6d254&page=queryresults
[0m17:07:35.489902 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:9c64625b-d405-40b9-bcad-4100686902e7&page=queryresults
[0m17:07:35.523763 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:6e23b85b-4edc-47f1-8cfe-726cc9b92570&page=queryresults
[0m17:07:35.551764 [debug] [Thread-1 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761 (execute): 17:07:34.119312 => 17:07:35.551471
[0m17:07:35.553202 [info ] [Thread-1 (]: 1 of 5 PASS not_null_gold__daily_branch_metrics_branch ......................... [[32mPASS[0m in 1.48s]
[0m17:07:35.554450 [debug] [Thread-1 (]: Finished running node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m17:07:35.555481 [debug] [Thread-1 (]: Began running node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m17:07:35.556349 [info ] [Thread-1 (]: 5 of 5 START test unique_silver__orders_enriched_order_id ...................... [RUN]
[0m17:07:35.557843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761, now test.retail.unique_silver__orders_enriched_order_id.761e0577f3)
[0m17:07:35.558768 [debug] [Thread-1 (]: Began compiling node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m17:07:35.567004 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.unique_silver__orders_enriched_order_id.761e0577f3"
[0m17:07:35.568424 [debug] [Thread-2 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948 (execute): 17:07:34.135783 => 17:07:35.568153
[0m17:07:35.570070 [info ] [Thread-2 (]: 2 of 5 PASS not_null_gold__daily_branch_metrics_order_date ..................... [[32mPASS[0m in 1.49s]
[0m17:07:35.571132 [debug] [Thread-2 (]: Finished running node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m17:07:35.589579 [debug] [Thread-1 (]: Timing info for test.retail.unique_silver__orders_enriched_order_id.761e0577f3 (compile): 17:07:35.559455 => 17:07:35.588769
[0m17:07:35.591857 [debug] [Thread-1 (]: Began executing node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m17:07:35.596156 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.unique_silver__orders_enriched_order_id.761e0577f3"
[0m17:07:35.620846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:35.658891 [debug] [Thread-1 (]: On test.retail.unique_silver__orders_enriched_order_id.761e0577f3: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_silver__orders_enriched_order_id.761e0577f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:07:35.998153 [debug] [Thread-4 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_id.782515c964 (execute): 17:07:34.145737 => 17:07:35.997870
[0m17:07:35.999404 [info ] [Thread-4 (]: 4 of 5 PASS not_null_silver__orders_enriched_order_id .......................... [[32mPASS[0m in 1.92s]
[0m17:07:36.000552 [debug] [Thread-4 (]: Finished running node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m17:07:36.048101 [debug] [Thread-3 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_date.658d753d80 (execute): 17:07:34.143449 => 17:07:36.047810
[0m17:07:36.049323 [warn ] [Thread-3 (]: 3 of 5 WARN 982 not_null_silver__orders_enriched_order_date .................... [[33mWARN 982[0m in 1.97s]
[0m17:07:36.050422 [debug] [Thread-3 (]: Finished running node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m17:07:36.815874 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:a22411d7-4e12-4567-bdcb-4158979a5c75&page=queryresults
[0m17:07:37.337737 [debug] [Thread-1 (]: Timing info for test.retail.unique_silver__orders_enriched_order_id.761e0577f3 (execute): 17:07:35.593223 => 17:07:37.337462
[0m17:07:37.338999 [info ] [Thread-1 (]: 5 of 5 PASS unique_silver__orders_enriched_order_id ............................ [[32mPASS[0m in 1.78s]
[0m17:07:37.339976 [debug] [Thread-1 (]: Finished running node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m17:07:37.343079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:37.344094 [debug] [MainThread]: Connection 'test.retail.unique_silver__orders_enriched_order_id.761e0577f3' was properly closed.
[0m17:07:37.344890 [debug] [MainThread]: Connection 'test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948' was properly closed.
[0m17:07:37.345742 [debug] [MainThread]: Connection 'test.retail.not_null_silver__orders_enriched_order_date.658d753d80' was properly closed.
[0m17:07:37.346574 [debug] [MainThread]: Connection 'test.retail.not_null_silver__orders_enriched_order_id.782515c964' was properly closed.
[0m17:07:37.347435 [info ] [MainThread]: 
[0m17:07:37.348211 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 3.80 seconds (3.80s).
[0m17:07:37.349566 [debug] [MainThread]: Command end result
[0m17:07:37.394979 [info ] [MainThread]: 
[0m17:07:37.396263 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m17:07:37.397395 [info ] [MainThread]: 
[0m17:07:37.398442 [warn ] [MainThread]: [33mWarning in test not_null_silver__orders_enriched_order_date (models/silver/schema.yml)[0m
[0m17:07:37.399248 [warn ] [MainThread]: Got 982 results, configured to warn if != 0
[0m17:07:37.399990 [info ] [MainThread]: 
[0m17:07:37.400604 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/silver/schema.yml/not_null_silver__orders_enriched_order_date.sql
[0m17:07:37.401329 [info ] [MainThread]: 
[0m17:07:37.402032 [info ] [MainThread]: Done. PASS=4 WARN=1 ERROR=0 SKIP=0 TOTAL=5
[0m17:07:37.403619 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 13.470682, "process_user_time": 4.19, "process_kernel_time": 1.546309, "process_mem_max_rss": "236752", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:07:37.404757 [debug] [MainThread]: Command `dbt test` succeeded at 17:07:37.404563 after 13.47 seconds
[0m17:07:37.405592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed95e46ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed930f22450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed95e39caa0>]}
[0m17:07:37.406468 [debug] [MainThread]: Flushing usage events
[0m17:08:42.773507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba40a414920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba40a686ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba40a671c10>]}


============================== 17:08:42.779800 | 15063345-40b4-4db3-bf33-ca806e599ecd ==============================
[0m17:08:42.779800 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:08:42.780808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/retail', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail', 'send_anonymous_usage_stats': 'True'}
[0m17:08:42.872007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15063345-40b4-4db3-bf33-ca806e599ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba40a401fd0>]}
[0m17:08:44.640536 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zc1y3fzl'
[0m17:08:44.641491 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:08:44.842557 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:08:44.843857 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:08:44.932665 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:08:44.936245 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m17:08:45.150239 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m17:08:45.154677 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m17:08:45.278736 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m17:08:45.282536 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:08:53.381833 [info ] [MainThread]: Installed from version 1.3.1
[0m17:08:53.382583 [info ] [MainThread]: Up to date!
[0m17:08:53.383392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '15063345-40b4-4db3-bf33-ca806e599ecd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba40a2a5ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba40a415820>]}
[0m17:08:53.384080 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m17:08:59.279579 [info ] [MainThread]: Installed from version 0.10.9
[0m17:08:59.280527 [info ] [MainThread]: Up to date!
[0m17:08:59.281510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '15063345-40b4-4db3-bf33-ca806e599ecd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba40a1bdbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba40a1bdd30>]}
[0m17:08:59.282536 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m17:09:01.853745 [info ] [MainThread]: Installed from version 0.15.0
[0m17:09:01.854581 [info ] [MainThread]: Up to date!
[0m17:09:01.855421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '15063345-40b4-4db3-bf33-ca806e599ecd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba40a1bde20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba40a1be030>]}
[0m17:09:01.858301 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 19.168169, "process_user_time": 2.718137, "process_kernel_time": 0.877476, "process_mem_max_rss": "208328", "process_out_blocks": "7712", "process_in_blocks": "0"}
[0m17:09:01.859668 [debug] [MainThread]: Command `dbt deps` succeeded at 17:09:01.859443 after 19.17 seconds
[0m17:09:01.860546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba40ee0b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba40a3c7e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba40b0b7c80>]}
[0m17:09:01.861350 [debug] [MainThread]: Flushing usage events
[0m17:09:06.536917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7730f4d100e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7730f4d12420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7730f4d11370>]}


============================== 17:09:06.543227 | bbace5d9-c0b4-4057-b0ad-a702749ed4e3 ==============================
[0m17:09:06.543227 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:09:06.544047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:09:07.462116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbace5d9-c0b4-4057-b0ad-a702749ed4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7730cc7c20c0>]}
[0m17:09:07.535781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbace5d9-c0b4-4057-b0ad-a702749ed4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7730cedfe990>]}
[0m17:09:07.537164 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m17:09:07.642629 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:09:15.242389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:15.243310 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:15.244322 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m17:09:15.250575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbace5d9-c0b4-4057-b0ad-a702749ed4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7730c7c9aea0>]}
[0m17:09:15.316790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbace5d9-c0b4-4057-b0ad-a702749ed4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7730c774da60>]}
[0m17:09:15.318666 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m17:09:15.320347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbace5d9-c0b4-4057-b0ad-a702749ed4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7730cc65aba0>]}
[0m17:09:15.336326 [info ] [MainThread]: 
[0m17:09:15.338859 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:09:15.341919 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m17:09:15.343373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:15.953017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod)
[0m17:09:15.953891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:09:16.498369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbace5d9-c0b4-4057-b0ad-a702749ed4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7730f4d137a0>]}
[0m17:09:16.499921 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:09:16.500985 [info ] [MainThread]: 
[0m17:09:16.510922 [debug] [Thread-1 (]: Began running node model.retail.bronze__orders
[0m17:09:16.511490 [debug] [Thread-2 (]: Began running node model.retail.bronze__users
[0m17:09:16.512171 [info ] [Thread-1 (]: 1 of 2 START sql table model retail_prod.bronze__orders ........................ [RUN]
[0m17:09:16.513223 [info ] [Thread-2 (]: 2 of 2 START sql table model retail_prod.bronze__users ......................... [RUN]
[0m17:09:16.515223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.bronze__orders)
[0m17:09:16.516545 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.retail.bronze__users'
[0m17:09:16.517411 [debug] [Thread-1 (]: Began compiling node model.retail.bronze__orders
[0m17:09:16.518259 [debug] [Thread-2 (]: Began compiling node model.retail.bronze__users
[0m17:09:16.526114 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.bronze__orders"
[0m17:09:16.528892 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail.bronze__users"
[0m17:09:16.544053 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (compile): 17:09:16.518966 => 17:09:16.543728
[0m17:09:16.545006 [debug] [Thread-1 (]: Began executing node model.retail.bronze__orders
[0m17:09:16.551751 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (compile): 17:09:16.526497 => 17:09:16.551442
[0m17:09:16.558176 [debug] [Thread-2 (]: Began executing node model.retail.bronze__users
[0m17:09:16.558646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:16.560957 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:09:17.117208 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.bronze__orders"
[0m17:09:17.138272 [debug] [Thread-1 (]: On model.retail.bronze__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__orders"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    order_id,
    user_id,
    order_created_at as order_created_at_raw,
    
  coalesce(
    safe.parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%m-%d-%Y %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%m/%d/%Y %H:%M:%S', cast(order_created_at as string)),
    safe.parse_timestamp('%Y/%m/%d %H:%M:%S', cast(order_created_at as string))
  )
 as order_created_at_ts,
    cast(total_amount as numeric) as total_amount,
    lower(trim(payment_method)) as payment_method,
    lower(trim(status)) as order_status,
    trim(branch) as branch
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
)

select
  order_id,
  user_id,
  order_created_at_raw,
  order_created_at_ts as order_created_at,
  order_created_at_ts is null as order_created_at_parse_failed,
  total_amount,
  payment_method,
  order_status,
  branch
from raw
    );
  
[0m17:09:17.165622 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail.bronze__users"
[0m17:09:17.178444 [debug] [Thread-2 (]: On model.retail.bronze__users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.bronze__users"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
      
    
    

    OPTIONS()
    as (
      with raw as (
  select
    user_id,
    trim(full_name) as full_name,
    lower(trim(username)) as username,
    lower(trim(email)) as email,
    regexp_replace(trim(phone), r'[^0-9+]', '') as phone_normalised,
    trim(city) as city,
    created_at as created_at_raw,
    
  coalesce(
    safe.parse_timestamp('%Y-%m-%dT%H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%m-%d-%Y %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%m/%d/%Y %H:%M:%S', cast(created_at as string)),
    safe.parse_timestamp('%Y/%m/%d %H:%M:%S', cast(created_at as string))
  )
 as created_at_ts
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
)

select
  user_id,
  full_name,
  username,
  email,
  phone_normalised as phone,
  city,
  created_at_raw,
  created_at_ts as created_at,
  created_at_ts is null as created_at_parse_failed
from raw
    );
  
[0m17:09:17.508225 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:7e71ae2f-5067-46f3-b6b2-0e1cf02d905a&page=queryresults
[0m17:09:17.558474 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:0b67f913-2c05-4659-90d8-147fdddab665&page=queryresults
[0m17:09:19.570362 [debug] [Thread-2 (]: Timing info for model.retail.bronze__users (execute): 17:09:16.559088 => 17:09:19.570184
[0m17:09:19.571831 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbace5d9-c0b4-4057-b0ad-a702749ed4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7730c77d7ce0>]}
[0m17:09:19.573363 [info ] [Thread-2 (]: 2 of 2 OK created sql table model retail_prod.bronze__users .................... [[32mCREATE TABLE (1.0k rows, 106.6 KiB processed)[0m in 3.06s]
[0m17:09:19.574490 [debug] [Thread-2 (]: Finished running node model.retail.bronze__users
[0m17:09:23.224417 [debug] [Thread-1 (]: Timing info for model.retail.bronze__orders (execute): 17:09:16.545592 => 17:09:23.224188
[0m17:09:23.226610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbace5d9-c0b4-4057-b0ad-a702749ed4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7730c77ab8c0>]}
[0m17:09:23.227897 [info ] [Thread-1 (]: 1 of 2 OK created sql table model retail_prod.bronze__orders ................... [[32mCREATE TABLE (5.0k rows, 412.1 KiB processed)[0m in 6.71s]
[0m17:09:23.228870 [debug] [Thread-1 (]: Finished running node model.retail.bronze__orders
[0m17:09:23.232122 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:23.233114 [debug] [MainThread]: Connection 'model.retail.bronze__orders' was properly closed.
[0m17:09:23.233920 [debug] [MainThread]: Connection 'model.retail.bronze__users' was properly closed.
[0m17:09:23.234570 [info ] [MainThread]: 
[0m17:09:23.235270 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 7.90 seconds (7.90s).
[0m17:09:23.236292 [debug] [MainThread]: Command end result
[0m17:09:23.278713 [info ] [MainThread]: 
[0m17:09:23.280038 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:09:23.280838 [info ] [MainThread]: 
[0m17:09:23.281727 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:09:23.283262 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.817465, "process_user_time": 3.622877, "process_kernel_time": 1.495091, "process_mem_max_rss": "236868", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:09:23.284413 [debug] [MainThread]: Command `dbt run` succeeded at 17:09:23.284256 after 16.82 seconds
[0m17:09:23.285400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7730f4f75cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7730cc333440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7730cd22cbf0>]}
[0m17:09:23.286347 [debug] [MainThread]: Flushing usage events
[0m17:09:28.257829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7175620803e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717562083f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717562080380>]}


============================== 17:09:28.264924 | 04c18fc7-8031-4cd1-9719-26043dd6bbb8 ==============================
[0m17:09:28.264924 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:09:28.266229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/bronze', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:09:29.314341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04c18fc7-8031-4cd1-9719-26043dd6bbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717535027590>]}
[0m17:09:29.396138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04c18fc7-8031-4cd1-9719-26043dd6bbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7175359daa80>]}
[0m17:09:29.398267 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m17:09:29.515052 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:09:36.564522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:36.565524 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:36.566704 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m17:09:36.574134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04c18fc7-8031-4cd1-9719-26043dd6bbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71753508f770>]}
[0m17:09:36.617647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04c18fc7-8031-4cd1-9719-26043dd6bbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717534b26840>]}
[0m17:09:36.619119 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m17:09:36.620171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04c18fc7-8031-4cd1-9719-26043dd6bbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71753518d370>]}
[0m17:09:36.630510 [info ] [MainThread]: 
[0m17:09:36.631983 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:09:36.634037 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev_retail_prod'
[0m17:09:36.635081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:37.145298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04c18fc7-8031-4cd1-9719-26043dd6bbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717537384aa0>]}
[0m17:09:37.146705 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:09:37.147456 [info ] [MainThread]: 
[0m17:09:37.157735 [debug] [Thread-1 (]: Began running node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m17:09:37.158748 [debug] [Thread-2 (]: Began running node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m17:09:37.159285 [debug] [Thread-3 (]: Began running node test.retail.not_null_bronze__users_email.2bec59e73f
[0m17:09:37.160173 [debug] [Thread-4 (]: Began running node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m17:09:37.159819 [info ] [Thread-1 (]: 1 of 15 START test not_null_bronze__orders_order_created_at .................... [RUN]
[0m17:09:37.161039 [info ] [Thread-2 (]: 2 of 15 START test not_null_bronze__orders_order_id ............................ [RUN]
[0m17:09:37.161878 [info ] [Thread-3 (]: 3 of 15 START test not_null_bronze__users_email ................................ [RUN]
[0m17:09:37.162656 [info ] [Thread-4 (]: 4 of 15 START test not_null_bronze__users_user_id .............................. [RUN]
[0m17:09:37.164058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now test.retail.not_null_bronze__orders_order_created_at.05e711bf75)
[0m17:09:37.165494 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__orders_order_id.4b38fb230a'
[0m17:09:37.167247 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__users_email.2bec59e73f'
[0m17:09:37.168894 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.retail.not_null_bronze__users_user_id.cb91e05164'
[0m17:09:37.169935 [debug] [Thread-1 (]: Began compiling node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m17:09:37.172011 [debug] [Thread-2 (]: Began compiling node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m17:09:37.173530 [debug] [Thread-3 (]: Began compiling node test.retail.not_null_bronze__users_email.2bec59e73f
[0m17:09:37.174784 [debug] [Thread-4 (]: Began compiling node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m17:09:37.195913 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"
[0m17:09:37.197719 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.not_null_bronze__orders_order_id.4b38fb230a"
[0m17:09:37.202505 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.not_null_bronze__users_email.2bec59e73f"
[0m17:09:37.208085 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.not_null_bronze__users_user_id.cb91e05164"
[0m17:09:37.222507 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__users_user_id.cb91e05164 (compile): 17:09:37.203562 => 17:09:37.221745
[0m17:09:37.224073 [debug] [Thread-4 (]: Began executing node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m17:09:37.230927 [debug] [Thread-3 (]: Timing info for test.retail.not_null_bronze__users_email.2bec59e73f (compile): 17:09:37.198220 => 17:09:37.230431
[0m17:09:37.232751 [debug] [Thread-3 (]: Began executing node test.retail.not_null_bronze__users_email.2bec59e73f
[0m17:09:37.234012 [debug] [Thread-2 (]: Timing info for test.retail.not_null_bronze__orders_order_id.4b38fb230a (compile): 17:09:37.186954 => 17:09:37.233518
[0m17:09:37.246104 [debug] [Thread-1 (]: Timing info for test.retail.not_null_bronze__orders_order_created_at.05e711bf75 (compile): 17:09:37.175919 => 17:09:37.245529
[0m17:09:37.265697 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.not_null_bronze__users_email.2bec59e73f"
[0m17:09:37.266384 [debug] [Thread-2 (]: Began executing node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m17:09:37.269814 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.not_null_bronze__users_user_id.cb91e05164"
[0m17:09:37.271060 [debug] [Thread-1 (]: Began executing node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m17:09:37.275288 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.not_null_bronze__orders_order_id.4b38fb230a"
[0m17:09:37.279598 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"
[0m17:09:37.293316 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:09:37.296223 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:09:37.297060 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:09:37.334109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:37.334816 [debug] [Thread-3 (]: On test.retail.not_null_bronze__users_email.2bec59e73f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__users_email.2bec59e73f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
where email is null



      
    ) dbt_internal_test
[0m17:09:37.401127 [debug] [Thread-4 (]: On test.retail.not_null_bronze__users_user_id.cb91e05164: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__users_user_id.cb91e05164"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
where user_id is null



      
    ) dbt_internal_test
[0m17:09:37.403845 [debug] [Thread-2 (]: On test.retail.not_null_bronze__orders_order_id.4b38fb230a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__orders_order_id.4b38fb230a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
where order_id is null



      
    ) dbt_internal_test
[0m17:09:37.446282 [debug] [Thread-1 (]: On test.retail.not_null_bronze__orders_order_created_at.05e711bf75: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_bronze__orders_order_created_at.05e711bf75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_created_at
from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
where order_created_at is null



      
    ) dbt_internal_test
[0m17:09:38.148893 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:d1dd2e91-b244-4406-b81a-50702fe3cda2&page=queryresults
[0m17:09:38.153281 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:98ed2b42-6d9e-4bf6-9f9b-4f866b138303&page=queryresults
[0m17:09:38.191072 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:c2eab732-8ad6-42cc-8efb-14fcf4b32c94&page=queryresults
[0m17:09:38.215884 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:66812406-f1fb-45c3-aa35-c468330b6fd8&page=queryresults
[0m17:09:38.666052 [debug] [Thread-1 (]: Timing info for test.retail.not_null_bronze__orders_order_created_at.05e711bf75 (execute): 17:09:37.276612 => 17:09:38.665763
[0m17:09:38.667787 [warn ] [Thread-1 (]: 1 of 15 WARN 982 not_null_bronze__orders_order_created_at ...................... [[33mWARN 982[0m in 1.50s]
[0m17:09:38.668915 [debug] [Thread-1 (]: Finished running node test.retail.not_null_bronze__orders_order_created_at.05e711bf75
[0m17:09:38.669631 [debug] [Thread-1 (]: Began running node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m17:09:38.670463 [info ] [Thread-1 (]: 5 of 15 START test source_not_null_raw_csv_order_items_order_id ................ [RUN]
[0m17:09:38.671544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__orders_order_created_at.05e711bf75, now test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2)
[0m17:09:38.672298 [debug] [Thread-1 (]: Began compiling node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m17:09:38.676766 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"
[0m17:09:38.698285 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2 (compile): 17:09:38.672944 => 17:09:38.697954
[0m17:09:38.699012 [debug] [Thread-1 (]: Began executing node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m17:09:38.702108 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"
[0m17:09:38.721129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:38.759051 [debug] [Thread-2 (]: Timing info for test.retail.not_null_bronze__orders_order_id.4b38fb230a (execute): 17:09:37.272947 => 17:09:38.758768
[0m17:09:38.759903 [debug] [Thread-4 (]: Timing info for test.retail.not_null_bronze__users_user_id.cb91e05164 (execute): 17:09:37.225186 => 17:09:38.759680
[0m17:09:38.760724 [info ] [Thread-2 (]: 2 of 15 PASS not_null_bronze__orders_order_id .................................. [[32mPASS[0m in 1.60s]
[0m17:09:38.761242 [debug] [Thread-1 (]: On test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_raw`.`order_items`
where order_id is null



      
    ) dbt_internal_test
[0m17:09:38.762573 [info ] [Thread-4 (]: 4 of 15 PASS not_null_bronze__users_user_id .................................... [[32mPASS[0m in 1.59s]
[0m17:09:38.763485 [debug] [Thread-2 (]: Finished running node test.retail.not_null_bronze__orders_order_id.4b38fb230a
[0m17:09:38.767532 [debug] [Thread-4 (]: Finished running node test.retail.not_null_bronze__users_user_id.cb91e05164
[0m17:09:38.769389 [debug] [Thread-3 (]: Timing info for test.retail.not_null_bronze__users_email.2bec59e73f (execute): 17:09:37.240203 => 17:09:38.768937
[0m17:09:38.770073 [debug] [Thread-2 (]: Began running node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m17:09:38.770960 [debug] [Thread-4 (]: Began running node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m17:09:38.772244 [info ] [Thread-3 (]: 3 of 15 PASS not_null_bronze__users_email ...................................... [[32mPASS[0m in 1.61s]
[0m17:09:38.773131 [info ] [Thread-2 (]: 6 of 15 START test source_not_null_raw_csv_orders_order_id ..................... [RUN]
[0m17:09:38.773868 [info ] [Thread-4 (]: 7 of 15 START test source_not_null_raw_csv_products_product_id ................. [RUN]
[0m17:09:38.774621 [debug] [Thread-3 (]: Finished running node test.retail.not_null_bronze__users_email.2bec59e73f
[0m17:09:38.775549 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__orders_order_id.4b38fb230a, now test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336)
[0m17:09:38.776462 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__users_user_id.cb91e05164, now test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6)
[0m17:09:38.777474 [debug] [Thread-3 (]: Began running node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m17:09:38.778504 [debug] [Thread-2 (]: Began compiling node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m17:09:38.779535 [debug] [Thread-4 (]: Began compiling node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m17:09:38.780454 [info ] [Thread-3 (]: 8 of 15 START test source_not_null_raw_csv_sessions_session_id ................. [RUN]
[0m17:09:38.791976 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"
[0m17:09:38.792850 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"
[0m17:09:38.793974 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.not_null_bronze__users_email.2bec59e73f, now test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194)
[0m17:09:38.795362 [debug] [Thread-3 (]: Began compiling node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m17:09:38.799458 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"
[0m17:09:38.805204 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6 (compile): 17:09:38.788466 => 17:09:38.804734
[0m17:09:38.806122 [debug] [Thread-4 (]: Began executing node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m17:09:38.806644 [debug] [Thread-3 (]: Timing info for test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194 (compile): 17:09:38.796027 => 17:09:38.806420
[0m17:09:38.809008 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"
[0m17:09:38.809987 [debug] [Thread-3 (]: Began executing node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m17:09:38.811389 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336 (compile): 17:09:38.780922 => 17:09:38.811131
[0m17:09:38.813765 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"
[0m17:09:38.814668 [debug] [Thread-2 (]: Began executing node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m17:09:38.818669 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"
[0m17:09:38.821441 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:09:38.823798 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:09:38.826098 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:09:38.863481 [debug] [Thread-4 (]: On test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `retail-data-pipeline-dev`.`retail_raw`.`products`
where product_id is null



      
    ) dbt_internal_test
[0m17:09:38.900146 [debug] [Thread-3 (]: On test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from `retail-data-pipeline-dev`.`retail_raw`.`sessions`
where session_id is null



      
    ) dbt_internal_test
[0m17:09:38.941160 [debug] [Thread-2 (]: On test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_raw`.`orders`
where order_id is null



      
    ) dbt_internal_test
[0m17:09:39.507207 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:9acd8cc7-893e-4dc0-8a0b-7038ba9a25bd&page=queryresults
[0m17:09:39.575834 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:c17e0973-1ac8-4f33-9758-67eaabc138ae&page=queryresults
[0m17:09:39.623253 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:7d2e497c-0c2b-4830-9a23-50a8d3fc21bb&page=queryresults
[0m17:09:39.662354 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:ca7fb391-e4dd-4863-b1d7-90a832bf91dd&page=queryresults
[0m17:09:40.044849 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2 (execute): 17:09:38.699525 => 17:09:40.044546
[0m17:09:40.046076 [info ] [Thread-1 (]: 5 of 15 PASS source_not_null_raw_csv_order_items_order_id ...................... [[32mPASS[0m in 1.37s]
[0m17:09:40.047157 [debug] [Thread-1 (]: Finished running node test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2
[0m17:09:40.047861 [debug] [Thread-1 (]: Began running node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m17:09:40.048676 [info ] [Thread-1 (]: 9 of 15 START test source_not_null_raw_csv_users_user_id ....................... [RUN]
[0m17:09:40.049579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_order_items_order_id.e2e6db35c2, now test.retail.source_not_null_raw_csv_users_user_id.3380c1257d)
[0m17:09:40.050349 [debug] [Thread-1 (]: Began compiling node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m17:09:40.054985 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"
[0m17:09:40.069594 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_users_user_id.3380c1257d (compile): 17:09:40.050836 => 17:09:40.069117
[0m17:09:40.070288 [debug] [Thread-1 (]: Began executing node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m17:09:40.073795 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"
[0m17:09:40.091382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:40.127113 [debug] [Thread-1 (]: On test.retail.source_not_null_raw_csv_users_user_id.3380c1257d: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_not_null_raw_csv_users_user_id.3380c1257d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `retail-data-pipeline-dev`.`retail_raw`.`users`
where user_id is null



      
    ) dbt_internal_test
[0m17:09:40.140245 [debug] [Thread-4 (]: Timing info for test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6 (execute): 17:09:38.806920 => 17:09:40.139959
[0m17:09:40.141563 [info ] [Thread-4 (]: 7 of 15 PASS source_not_null_raw_csv_products_product_id ....................... [[32mPASS[0m in 1.37s]
[0m17:09:40.142830 [debug] [Thread-4 (]: Finished running node test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6
[0m17:09:40.143697 [debug] [Thread-4 (]: Began running node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m17:09:40.144602 [info ] [Thread-4 (]: 10 of 15 START test source_unique_raw_csv_orders_order_id ...................... [RUN]
[0m17:09:40.145615 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_products_product_id.e5eec0bee6, now test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53)
[0m17:09:40.146293 [debug] [Thread-4 (]: Began compiling node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m17:09:40.152083 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"
[0m17:09:40.171464 [debug] [Thread-4 (]: Timing info for test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53 (compile): 17:09:40.146897 => 17:09:40.171027
[0m17:09:40.172479 [debug] [Thread-4 (]: Began executing node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m17:09:40.175386 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"
[0m17:09:40.192763 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:09:40.229500 [debug] [Thread-2 (]: Timing info for test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336 (execute): 17:09:38.815982 => 17:09:40.229165
[0m17:09:40.230282 [debug] [Thread-4 (]: On test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:09:40.231646 [info ] [Thread-2 (]: 6 of 15 PASS source_not_null_raw_csv_orders_order_id ........................... [[32mPASS[0m in 1.46s]
[0m17:09:40.235516 [debug] [Thread-2 (]: Finished running node test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336
[0m17:09:40.236280 [debug] [Thread-2 (]: Began running node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m17:09:40.237206 [info ] [Thread-2 (]: 11 of 15 START test source_unique_raw_csv_products_product_id .................. [RUN]
[0m17:09:40.238303 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_orders_order_id.c3aff63336, now test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1)
[0m17:09:40.239021 [debug] [Thread-2 (]: Began compiling node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m17:09:40.243463 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"
[0m17:09:40.261063 [debug] [Thread-2 (]: Timing info for test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1 (compile): 17:09:40.239641 => 17:09:40.260522
[0m17:09:40.262010 [debug] [Thread-2 (]: Began executing node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m17:09:40.264700 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"
[0m17:09:40.265935 [debug] [Thread-3 (]: Timing info for test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194 (execute): 17:09:38.811628 => 17:09:40.265563
[0m17:09:40.267406 [info ] [Thread-3 (]: 8 of 15 PASS source_not_null_raw_csv_sessions_session_id ....................... [[32mPASS[0m in 1.47s]
[0m17:09:40.268368 [debug] [Thread-3 (]: Finished running node test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194
[0m17:09:40.269083 [debug] [Thread-3 (]: Began running node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m17:09:40.269782 [info ] [Thread-3 (]: 12 of 15 START test source_unique_raw_csv_sessions_session_id .................. [RUN]
[0m17:09:40.270822 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_sessions_session_id.831e1c5194, now test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8)
[0m17:09:40.271435 [debug] [Thread-3 (]: Began compiling node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m17:09:40.275515 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"
[0m17:09:40.287128 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:09:40.322386 [debug] [Thread-3 (]: Timing info for test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8 (compile): 17:09:40.271974 => 17:09:40.322010
[0m17:09:40.323564 [debug] [Thread-3 (]: Began executing node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m17:09:40.324653 [debug] [Thread-2 (]: On test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:09:40.327720 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"
[0m17:09:40.345972 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:09:40.382079 [debug] [Thread-3 (]: On test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select session_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`sessions`
  where session_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:09:40.822171 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:120d39bc-f646-49a0-abb6-b8b19b566f8d&page=queryresults
[0m17:09:40.970766 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:3baa1462-0b9a-46d0-8b6c-18ddae83ef60&page=queryresults
[0m17:09:41.070339 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:dfc771ab-918d-4958-a0b3-b1a186a2afa3&page=queryresults
[0m17:09:41.090290 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:5c6bbba2-ce4e-4243-938f-5dae3b17327e&page=queryresults
[0m17:09:41.338271 [debug] [Thread-1 (]: Timing info for test.retail.source_not_null_raw_csv_users_user_id.3380c1257d (execute): 17:09:40.070714 => 17:09:41.338007
[0m17:09:41.340975 [info ] [Thread-1 (]: 9 of 15 PASS source_not_null_raw_csv_users_user_id ............................. [[32mPASS[0m in 1.29s]
[0m17:09:41.341998 [debug] [Thread-1 (]: Finished running node test.retail.source_not_null_raw_csv_users_user_id.3380c1257d
[0m17:09:41.342785 [debug] [Thread-1 (]: Began running node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m17:09:41.343457 [info ] [Thread-1 (]: 13 of 15 START test source_unique_raw_csv_users_user_id ........................ [RUN]
[0m17:09:41.344470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.source_not_null_raw_csv_users_user_id.3380c1257d, now test.retail.source_unique_raw_csv_users_user_id.d8f871acc9)
[0m17:09:41.345240 [debug] [Thread-1 (]: Began compiling node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m17:09:41.349947 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"
[0m17:09:41.365687 [debug] [Thread-1 (]: Timing info for test.retail.source_unique_raw_csv_users_user_id.d8f871acc9 (compile): 17:09:41.345805 => 17:09:41.365229
[0m17:09:41.366517 [debug] [Thread-1 (]: Began executing node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m17:09:41.369004 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"
[0m17:09:41.383624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:41.422269 [debug] [Thread-1 (]: On test.retail.source_unique_raw_csv_users_user_id.d8f871acc9: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.source_unique_raw_csv_users_user_id.d8f871acc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `retail-data-pipeline-dev`.`retail_raw`.`users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:09:41.495198 [debug] [Thread-4 (]: Timing info for test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53 (execute): 17:09:40.173257 => 17:09:41.494884
[0m17:09:41.496664 [info ] [Thread-4 (]: 10 of 15 PASS source_unique_raw_csv_orders_order_id ............................ [[32mPASS[0m in 1.35s]
[0m17:09:41.497975 [debug] [Thread-4 (]: Finished running node test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53
[0m17:09:41.498779 [debug] [Thread-4 (]: Began running node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m17:09:41.499515 [info ] [Thread-4 (]: 14 of 15 START test unique_bronze__orders_order_id ............................. [RUN]
[0m17:09:41.500543 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail.source_unique_raw_csv_orders_order_id.dc1631fc53, now test.retail.unique_bronze__orders_order_id.cd2f27ce5f)
[0m17:09:41.501192 [debug] [Thread-4 (]: Began compiling node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m17:09:41.505496 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"
[0m17:09:41.520928 [debug] [Thread-4 (]: Timing info for test.retail.unique_bronze__orders_order_id.cd2f27ce5f (compile): 17:09:41.501790 => 17:09:41.520572
[0m17:09:41.521749 [debug] [Thread-4 (]: Began executing node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m17:09:41.524942 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"
[0m17:09:41.540345 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:09:41.576751 [debug] [Thread-4 (]: On test.retail.unique_bronze__orders_order_id.cd2f27ce5f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_bronze__orders_order_id.cd2f27ce5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:09:41.607259 [debug] [Thread-2 (]: Timing info for test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1 (execute): 17:09:40.262468 => 17:09:41.606960
[0m17:09:41.608590 [info ] [Thread-2 (]: 11 of 15 PASS source_unique_raw_csv_products_product_id ........................ [[32mPASS[0m in 1.37s]
[0m17:09:41.609511 [debug] [Thread-2 (]: Finished running node test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1
[0m17:09:41.610196 [debug] [Thread-2 (]: Began running node test.retail.unique_bronze__users_user_id.129342c645
[0m17:09:41.611024 [info ] [Thread-2 (]: 15 of 15 START test unique_bronze__users_user_id ............................... [RUN]
[0m17:09:41.612008 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail.source_unique_raw_csv_products_product_id.c5a64acaa1, now test.retail.unique_bronze__users_user_id.129342c645)
[0m17:09:41.612727 [debug] [Thread-2 (]: Began compiling node test.retail.unique_bronze__users_user_id.129342c645
[0m17:09:41.618137 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.unique_bronze__users_user_id.129342c645"
[0m17:09:41.621038 [debug] [Thread-3 (]: Timing info for test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8 (execute): 17:09:40.325123 => 17:09:41.620738
[0m17:09:41.622198 [info ] [Thread-3 (]: 12 of 15 PASS source_unique_raw_csv_sessions_session_id ........................ [[32mPASS[0m in 1.35s]
[0m17:09:41.623306 [debug] [Thread-3 (]: Finished running node test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8
[0m17:09:41.635740 [debug] [Thread-2 (]: Timing info for test.retail.unique_bronze__users_user_id.129342c645 (compile): 17:09:41.613214 => 17:09:41.635201
[0m17:09:41.636712 [debug] [Thread-2 (]: Began executing node test.retail.unique_bronze__users_user_id.129342c645
[0m17:09:41.639237 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.unique_bronze__users_user_id.129342c645"
[0m17:09:41.657460 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:09:41.693241 [debug] [Thread-2 (]: On test.retail.unique_bronze__users_user_id.129342c645: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_bronze__users_user_id.129342c645"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:09:42.177058 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:4cac27cf-952a-4c8a-bbca-a5ca6e2c941c&page=queryresults
[0m17:09:42.336993 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:37bbbfb4-4226-49d3-89a0-720ec9c78d5b&page=queryresults
[0m17:09:42.396418 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:33e6f697-4e8c-4129-9db3-345c36e15dc3&page=queryresults
[0m17:09:42.689078 [debug] [Thread-1 (]: Timing info for test.retail.source_unique_raw_csv_users_user_id.d8f871acc9 (execute): 17:09:41.367068 => 17:09:42.688766
[0m17:09:42.690377 [info ] [Thread-1 (]: 13 of 15 PASS source_unique_raw_csv_users_user_id .............................. [[32mPASS[0m in 1.35s]
[0m17:09:42.691516 [debug] [Thread-1 (]: Finished running node test.retail.source_unique_raw_csv_users_user_id.d8f871acc9
[0m17:09:42.872574 [debug] [Thread-4 (]: Timing info for test.retail.unique_bronze__orders_order_id.cd2f27ce5f (execute): 17:09:41.522323 => 17:09:42.872163
[0m17:09:42.873835 [info ] [Thread-4 (]: 14 of 15 PASS unique_bronze__orders_order_id ................................... [[32mPASS[0m in 1.37s]
[0m17:09:42.874854 [debug] [Thread-4 (]: Finished running node test.retail.unique_bronze__orders_order_id.cd2f27ce5f
[0m17:09:42.937886 [debug] [Thread-2 (]: Timing info for test.retail.unique_bronze__users_user_id.129342c645 (execute): 17:09:41.637228 => 17:09:42.937602
[0m17:09:42.939638 [info ] [Thread-2 (]: 15 of 15 PASS unique_bronze__users_user_id ..................................... [[32mPASS[0m in 1.33s]
[0m17:09:42.940985 [debug] [Thread-2 (]: Finished running node test.retail.unique_bronze__users_user_id.129342c645
[0m17:09:42.944540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:42.945323 [debug] [MainThread]: Connection 'test.retail.source_unique_raw_csv_users_user_id.d8f871acc9' was properly closed.
[0m17:09:42.946015 [debug] [MainThread]: Connection 'test.retail.unique_bronze__users_user_id.129342c645' was properly closed.
[0m17:09:42.946580 [debug] [MainThread]: Connection 'test.retail.source_unique_raw_csv_sessions_session_id.69c87299f8' was properly closed.
[0m17:09:42.947105 [debug] [MainThread]: Connection 'test.retail.unique_bronze__orders_order_id.cd2f27ce5f' was properly closed.
[0m17:09:42.947783 [info ] [MainThread]: 
[0m17:09:42.948562 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 6.32 seconds (6.32s).
[0m17:09:42.950830 [debug] [MainThread]: Command end result
[0m17:09:42.996022 [info ] [MainThread]: 
[0m17:09:42.997551 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m17:09:42.998807 [info ] [MainThread]: 
[0m17:09:42.999865 [warn ] [MainThread]: [33mWarning in test not_null_bronze__orders_order_created_at (models/bronze/schema.yml)[0m
[0m17:09:43.000750 [warn ] [MainThread]: Got 982 results, configured to warn if != 0
[0m17:09:43.002129 [info ] [MainThread]: 
[0m17:09:43.003104 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/bronze/schema.yml/not_null_bronze__orders_order_created_at.sql
[0m17:09:43.003918 [info ] [MainThread]: 
[0m17:09:43.004682 [info ] [MainThread]: Done. PASS=14 WARN=1 ERROR=0 SKIP=0 TOTAL=15
[0m17:09:43.006040 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 14.782841, "process_user_time": 4.901209, "process_kernel_time": 1.492754, "process_mem_max_rss": "239300", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:09:43.007162 [debug] [MainThread]: Command `dbt test` succeeded at 17:09:43.006877 after 14.78 seconds
[0m17:09:43.007947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7175622e7230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71756562d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717562087620>]}
[0m17:09:43.008721 [debug] [MainThread]: Flushing usage events
[0m17:09:47.714551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c683cc9d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c683cc9c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c683cc9d190>]}


============================== 17:09:47.721307 | 2c459e8a-6b25-4276-9ff3-a5b8f2e7cecc ==============================
[0m17:09:47.721307 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:09:47.722322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/silver path:models/gold', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:09:48.661928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c459e8a-6b25-4276-9ff3-a5b8f2e7cecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c680fc5a0f0>]}
[0m17:09:48.767436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c459e8a-6b25-4276-9ff3-a5b8f2e7cecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c683da9f470>]}
[0m17:09:48.769040 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m17:09:48.913954 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:09:55.987654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:55.988508 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:55.989617 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m17:09:55.994995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c459e8a-6b25-4276-9ff3-a5b8f2e7cecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c680fa4d580>]}
[0m17:09:56.051252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c459e8a-6b25-4276-9ff3-a5b8f2e7cecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c680f6497f0>]}
[0m17:09:56.052326 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m17:09:56.053121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c459e8a-6b25-4276-9ff3-a5b8f2e7cecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c680fb4f110>]}
[0m17:09:56.069614 [info ] [MainThread]: 
[0m17:09:56.071074 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:09:56.072818 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev'
[0m17:09:56.073518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:56.674754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev, now list_retail-data-pipeline-dev_retail_prod)
[0m17:09:56.676421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:09:57.150314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c459e8a-6b25-4276-9ff3-a5b8f2e7cecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c680fb4f230>]}
[0m17:09:57.151868 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:09:57.152900 [info ] [MainThread]: 
[0m17:09:57.162244 [debug] [Thread-1 (]: Began running node model.retail.silver__orders_enriched
[0m17:09:57.163316 [info ] [Thread-1 (]: 1 of 2 START sql view model retail_prod.silver__orders_enriched ................ [RUN]
[0m17:09:57.164446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now model.retail.silver__orders_enriched)
[0m17:09:57.165282 [debug] [Thread-1 (]: Began compiling node model.retail.silver__orders_enriched
[0m17:09:57.171570 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.silver__orders_enriched"
[0m17:09:57.189777 [debug] [Thread-1 (]: Timing info for model.retail.silver__orders_enriched (compile): 17:09:57.165916 => 17:09:57.189305
[0m17:09:57.190912 [debug] [Thread-1 (]: Began executing node model.retail.silver__orders_enriched
[0m17:09:57.219651 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.silver__orders_enriched"
[0m17:09:57.237393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:57.273067 [debug] [Thread-1 (]: On model.retail.silver__orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.silver__orders_enriched"} */


  create or replace view `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
  OPTIONS()
  as with orders as (
  select *
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__orders`
),
users as (
  select *
  from `retail-data-pipeline-dev`.`retail_prod`.`bronze__users`
),
joined as (
  select
    o.order_id,
    o.user_id,
    o.order_created_at,
    o.order_created_at_parse_failed,
    date(o.order_created_at) as order_date,
    o.total_amount,
    o.payment_method,
    o.order_status,
    o.branch,
    u.full_name,
    u.email,
    u.phone,
    u.city as user_city,
    u.created_at as user_created_at,
    u.created_at_parse_failed as user_created_at_parse_failed
  from orders o
  left join users u using (user_id)
)

select *
from joined;


[0m17:09:57.889730 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:56ae6a5f-a883-4cc1-a830-640d104e0a05&page=queryresults
[0m17:09:58.210979 [debug] [Thread-1 (]: Timing info for model.retail.silver__orders_enriched (execute): 17:09:57.191469 => 17:09:58.210706
[0m17:09:58.212898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c459e8a-6b25-4276-9ff3-a5b8f2e7cecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c680fa1f920>]}
[0m17:09:58.214507 [info ] [Thread-1 (]: 1 of 2 OK created sql view model retail_prod.silver__orders_enriched ........... [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m17:09:58.217167 [debug] [Thread-1 (]: Finished running node model.retail.silver__orders_enriched
[0m17:09:58.219503 [debug] [Thread-3 (]: Began running node model.retail.gold__daily_branch_metrics
[0m17:09:58.220690 [info ] [Thread-3 (]: 2 of 2 START sql table model retail_prod.gold__daily_branch_metrics ............ [RUN]
[0m17:09:58.222063 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.retail.gold__daily_branch_metrics'
[0m17:09:58.223115 [debug] [Thread-3 (]: Began compiling node model.retail.gold__daily_branch_metrics
[0m17:09:58.227088 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail.gold__daily_branch_metrics"
[0m17:09:58.246683 [debug] [Thread-3 (]: Timing info for model.retail.gold__daily_branch_metrics (compile): 17:09:58.223765 => 17:09:58.246330
[0m17:09:58.247835 [debug] [Thread-3 (]: Began executing node model.retail.gold__daily_branch_metrics
[0m17:09:58.257602 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:09:58.765143 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail.gold__daily_branch_metrics"
[0m17:09:58.781473 [debug] [Thread-3 (]: On model.retail.gold__daily_branch_metrics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.gold__daily_branch_metrics"} */

  
    

    create or replace table `retail-data-pipeline-dev`.`retail_prod`.`gold__daily_branch_metrics`
      
    
    

    OPTIONS()
    as (
      with fact_orders as (
  select *
  from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
  where order_created_at is not null
),
aggregated as (
  select
    order_date,
    branch,
    count(distinct order_id) as orders_count,
    count(distinct user_id) as customers_count,
    sum(case when order_status = 'completed' then total_amount else 0 end) as completed_revenue,
    sum(case when order_status != 'completed' then total_amount else 0 end) as non_completed_revenue,
    sum(total_amount) as gross_revenue
  from fact_orders
  group by order_date, branch
)

select *
from aggregated
    );
  
[0m17:09:59.427265 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:e1b3810a-a61b-4ba8-b343-9ebb1be2cba9&page=queryresults
[0m17:10:01.666047 [debug] [Thread-3 (]: Timing info for model.retail.gold__daily_branch_metrics (execute): 17:09:58.248691 => 17:10:01.665845
[0m17:10:01.667363 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c459e8a-6b25-4276-9ff3-a5b8f2e7cecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c680f6dc770>]}
[0m17:10:01.668300 [info ] [Thread-3 (]: 2 of 2 OK created sql table model retail_prod.gold__daily_branch_metrics ....... [[32mCREATE TABLE (3.7k rows, 358.4 KiB processed)[0m in 3.45s]
[0m17:10:01.669401 [debug] [Thread-3 (]: Finished running node model.retail.gold__daily_branch_metrics
[0m17:10:01.673460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:01.674724 [debug] [MainThread]: Connection 'model.retail.silver__orders_enriched' was properly closed.
[0m17:10:01.675979 [debug] [MainThread]: Connection 'model.retail.gold__daily_branch_metrics' was properly closed.
[0m17:10:01.677133 [info ] [MainThread]: 
[0m17:10:01.678291 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.61 seconds (5.61s).
[0m17:10:01.680006 [debug] [MainThread]: Command end result
[0m17:10:01.727957 [info ] [MainThread]: 
[0m17:10:01.729415 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:01.730568 [info ] [MainThread]: 
[0m17:10:01.731823 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:10:01.733985 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.100379, "process_user_time": 3.71125, "process_kernel_time": 1.505206, "process_mem_max_rss": "235784", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:10:01.735208 [debug] [MainThread]: Command `dbt run` succeeded at 17:10:01.734985 after 14.10 seconds
[0m17:10:01.736193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c683d9675f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6814641c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6816085a00>]}
[0m17:10:01.737097 [debug] [MainThread]: Flushing usage events
[0m17:10:07.763678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c957be120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c957bf080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c957bffb0>]}


============================== 17:10:07.769882 | bf450d42-facb-4db3-8dc6-4dfd1445f365 ==============================
[0m17:10:07.769882 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:10:07.771113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/retail', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/retail --profiles-dir /opt/airflow/dbt/retail --select path:models/silver path:models/gold', 'send_anonymous_usage_stats': 'True'}
[0m17:10:08.852917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf450d42-facb-4db3-8dc6-4dfd1445f365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c6c9c47d0>]}
[0m17:10:08.922357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf450d42-facb-4db3-8dc6-4dfd1445f365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c6d063ce0>]}
[0m17:10:08.924249 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m17:10:09.015585 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:10:15.522522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:10:15.523634 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:10:15.524724 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m17:10:15.529715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf450d42-facb-4db3-8dc6-4dfd1445f365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c6c8bade0>]}
[0m17:10:15.582394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf450d42-facb-4db3-8dc6-4dfd1445f365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c6c24d760>]}
[0m17:10:15.583796 [info ] [MainThread]: Found 4 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 848 macros, 0 groups, 0 semantic models
[0m17:10:15.584833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf450d42-facb-4db3-8dc6-4dfd1445f365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c6c8f0c50>]}
[0m17:10:15.602489 [info ] [MainThread]: 
[0m17:10:15.603960 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:10:15.606126 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_retail-data-pipeline-dev_retail_prod'
[0m17:10:15.606998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:16.116223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf450d42-facb-4db3-8dc6-4dfd1445f365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c957bd5b0>]}
[0m17:10:16.117646 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:10:16.118874 [info ] [MainThread]: 
[0m17:10:16.126757 [debug] [Thread-1 (]: Began running node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m17:10:16.127305 [debug] [Thread-2 (]: Began running node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m17:10:16.127718 [debug] [Thread-3 (]: Began running node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m17:10:16.128656 [debug] [Thread-4 (]: Began running node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m17:10:16.128224 [info ] [Thread-1 (]: 1 of 5 START test not_null_gold__daily_branch_metrics_branch ................... [RUN]
[0m17:10:16.129554 [info ] [Thread-2 (]: 2 of 5 START test not_null_gold__daily_branch_metrics_order_date ............... [RUN]
[0m17:10:16.130455 [info ] [Thread-3 (]: 3 of 5 START test not_null_silver__orders_enriched_order_date .................. [RUN]
[0m17:10:16.131461 [info ] [Thread-4 (]: 4 of 5 START test not_null_silver__orders_enriched_order_id .................... [RUN]
[0m17:10:16.132489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail-data-pipeline-dev_retail_prod, now test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761)
[0m17:10:16.133812 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948'
[0m17:10:16.134908 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.retail.not_null_silver__orders_enriched_order_date.658d753d80'
[0m17:10:16.136391 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.retail.not_null_silver__orders_enriched_order_id.782515c964'
[0m17:10:16.137284 [debug] [Thread-1 (]: Began compiling node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m17:10:16.138173 [debug] [Thread-2 (]: Began compiling node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m17:10:16.138934 [debug] [Thread-3 (]: Began compiling node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m17:10:16.139718 [debug] [Thread-4 (]: Began compiling node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m17:10:16.158028 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948"
[0m17:10:16.159427 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761"
[0m17:10:16.163124 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail.not_null_silver__orders_enriched_order_date.658d753d80"
[0m17:10:16.167609 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail.not_null_silver__orders_enriched_order_id.782515c964"
[0m17:10:16.179845 [debug] [Thread-1 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761 (compile): 17:10:16.140280 => 17:10:16.179333
[0m17:10:16.180933 [debug] [Thread-1 (]: Began executing node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m17:10:16.187332 [debug] [Thread-3 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_date.658d753d80 (compile): 17:10:16.159861 => 17:10:16.187024
[0m17:10:16.188765 [debug] [Thread-3 (]: Began executing node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m17:10:16.194858 [debug] [Thread-2 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948 (compile): 17:10:16.151222 => 17:10:16.194425
[0m17:10:16.201244 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761"
[0m17:10:16.204698 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail.not_null_silver__orders_enriched_order_date.658d753d80"
[0m17:10:16.205302 [debug] [Thread-4 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_id.782515c964 (compile): 17:10:16.164404 => 17:10:16.205059
[0m17:10:16.206409 [debug] [Thread-2 (]: Began executing node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m17:10:16.208406 [debug] [Thread-4 (]: Began executing node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m17:10:16.211401 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948"
[0m17:10:16.214361 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail.not_null_silver__orders_enriched_order_id.782515c964"
[0m17:10:16.224839 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:10:16.225716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:16.227516 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:10:16.228363 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:10:16.293824 [debug] [Thread-3 (]: On test.retail.not_null_silver__orders_enriched_order_date.658d753d80: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_silver__orders_enriched_order_date.658d753d80"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
where order_date is null



      
    ) dbt_internal_test
[0m17:10:16.294689 [debug] [Thread-1 (]: On test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select branch
from `retail-data-pipeline-dev`.`retail_prod`.`gold__daily_branch_metrics`
where branch is null



      
    ) dbt_internal_test
[0m17:10:16.360330 [debug] [Thread-4 (]: On test.retail.not_null_silver__orders_enriched_order_id.782515c964: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_silver__orders_enriched_order_id.782515c964"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
where order_id is null



      
    ) dbt_internal_test
[0m17:10:16.363541 [debug] [Thread-2 (]: On test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from `retail-data-pipeline-dev`.`retail_prod`.`gold__daily_branch_metrics`
where order_date is null



      
    ) dbt_internal_test
[0m17:10:17.115764 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:551d8f22-63fe-4230-9282-403780113e8a&page=queryresults
[0m17:10:17.121667 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:b77bbec1-e1ac-40c2-8003-7b8ae482065d&page=queryresults
[0m17:10:17.467990 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:a0e44d8b-4bb7-4144-ba26-0bd3a6dce484&page=queryresults
[0m17:10:17.485256 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:d02fea7f-82fe-4793-9003-f444f9f780f2&page=queryresults
[0m17:10:17.648526 [debug] [Thread-1 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761 (execute): 17:10:16.181492 => 17:10:17.648214
[0m17:10:17.650197 [info ] [Thread-1 (]: 1 of 5 PASS not_null_gold__daily_branch_metrics_branch ......................... [[32mPASS[0m in 1.52s]
[0m17:10:17.653122 [debug] [Thread-1 (]: Finished running node test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761
[0m17:10:17.654818 [debug] [Thread-1 (]: Began running node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m17:10:17.655909 [info ] [Thread-1 (]: 5 of 5 START test unique_silver__orders_enriched_order_id ...................... [RUN]
[0m17:10:17.657734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail.not_null_gold__daily_branch_metrics_branch.efc543b761, now test.retail.unique_silver__orders_enriched_order_id.761e0577f3)
[0m17:10:17.658896 [debug] [Thread-1 (]: Began compiling node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m17:10:17.668790 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail.unique_silver__orders_enriched_order_id.761e0577f3"
[0m17:10:17.670424 [debug] [Thread-2 (]: Timing info for test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948 (execute): 17:10:16.209107 => 17:10:17.670100
[0m17:10:17.672415 [info ] [Thread-2 (]: 2 of 5 PASS not_null_gold__daily_branch_metrics_order_date ..................... [[32mPASS[0m in 1.54s]
[0m17:10:17.673957 [debug] [Thread-2 (]: Finished running node test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948
[0m17:10:17.691717 [debug] [Thread-1 (]: Timing info for test.retail.unique_silver__orders_enriched_order_id.761e0577f3 (compile): 17:10:17.659664 => 17:10:17.691163
[0m17:10:17.692710 [debug] [Thread-1 (]: Began executing node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m17:10:17.695767 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail.unique_silver__orders_enriched_order_id.761e0577f3"
[0m17:10:17.717048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:17.755778 [debug] [Thread-1 (]: On test.retail.unique_silver__orders_enriched_order_id.761e0577f3: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "retail", "target_name": "dev", "node_id": "test.retail.unique_silver__orders_enriched_order_id.761e0577f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `retail-data-pipeline-dev`.`retail_prod`.`silver__orders_enriched`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:10:17.990782 [debug] [Thread-4 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_id.782515c964 (execute): 17:10:16.212186 => 17:10:17.990447
[0m17:10:17.991717 [debug] [Thread-3 (]: Timing info for test.retail.not_null_silver__orders_enriched_order_date.658d753d80 (execute): 17:10:16.201842 => 17:10:17.991460
[0m17:10:17.992552 [info ] [Thread-4 (]: 4 of 5 PASS not_null_silver__orders_enriched_order_id .......................... [[32mPASS[0m in 1.86s]
[0m17:10:17.994078 [warn ] [Thread-3 (]: 3 of 5 WARN 982 not_null_silver__orders_enriched_order_date .................... [[33mWARN 982[0m in 1.86s]
[0m17:10:17.995397 [debug] [Thread-4 (]: Finished running node test.retail.not_null_silver__orders_enriched_order_id.782515c964
[0m17:10:17.996607 [debug] [Thread-3 (]: Finished running node test.retail.not_null_silver__orders_enriched_order_date.658d753d80
[0m17:10:19.039706 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=retail-data-pipeline-dev&j=bq:asia-southeast1:5ce7804d-cad4-4b7a-9e27-3746b156bd56&page=queryresults
[0m17:10:19.568338 [debug] [Thread-1 (]: Timing info for test.retail.unique_silver__orders_enriched_order_id.761e0577f3 (execute): 17:10:17.693444 => 17:10:19.568045
[0m17:10:19.569586 [info ] [Thread-1 (]: 5 of 5 PASS unique_silver__orders_enriched_order_id ............................ [[32mPASS[0m in 1.91s]
[0m17:10:19.570584 [debug] [Thread-1 (]: Finished running node test.retail.unique_silver__orders_enriched_order_id.761e0577f3
[0m17:10:19.573748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:19.574624 [debug] [MainThread]: Connection 'test.retail.unique_silver__orders_enriched_order_id.761e0577f3' was properly closed.
[0m17:10:19.575542 [debug] [MainThread]: Connection 'test.retail.not_null_gold__daily_branch_metrics_order_date.a00cec0948' was properly closed.
[0m17:10:19.576290 [debug] [MainThread]: Connection 'test.retail.not_null_silver__orders_enriched_order_date.658d753d80' was properly closed.
[0m17:10:19.577098 [debug] [MainThread]: Connection 'test.retail.not_null_silver__orders_enriched_order_id.782515c964' was properly closed.
[0m17:10:19.578046 [info ] [MainThread]: 
[0m17:10:19.579167 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 3.97 seconds (3.97s).
[0m17:10:19.581465 [debug] [MainThread]: Command end result
[0m17:10:19.624851 [info ] [MainThread]: 
[0m17:10:19.626130 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m17:10:19.627043 [info ] [MainThread]: 
[0m17:10:19.628307 [warn ] [MainThread]: [33mWarning in test not_null_silver__orders_enriched_order_date (models/silver/schema.yml)[0m
[0m17:10:19.629758 [warn ] [MainThread]: Got 982 results, configured to warn if != 0
[0m17:10:19.630980 [info ] [MainThread]: 
[0m17:10:19.631837 [info ] [MainThread]:   compiled Code at target/compiled/retail/models/silver/schema.yml/not_null_silver__orders_enriched_order_date.sql
[0m17:10:19.632804 [info ] [MainThread]: 
[0m17:10:19.633799 [info ] [MainThread]: Done. PASS=4 WARN=1 ERROR=0 SKIP=0 TOTAL=5
[0m17:10:19.635337 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.960113, "process_user_time": 4.224027, "process_kernel_time": 1.37039, "process_mem_max_rss": "235912", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:10:19.636488 [debug] [MainThread]: Command `dbt test` succeeded at 17:10:19.636269 after 11.96 seconds
[0m17:10:19.637510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c957bf080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c998805f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c6cb13770>]}
[0m17:10:19.638478 [debug] [MainThread]: Flushing usage events
